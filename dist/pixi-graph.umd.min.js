!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).PixiGraph={})}(this,(function(t){"use strict";
/*!
     * @pixi/constants - v6.1.2
     * Compiled Thu, 12 Aug 2021 17:11:19 UTC
     *
     * @pixi/constants is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */var e,r,n,i,o,s,a,h,u,l,c,d,f,p,m,g,v,y,b;!function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(e||(e={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(r||(r={})),function(t){t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL"}(n||(n={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(i||(i={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(o||(o={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(s||(s={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(a||(a={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(h||(h={})),function(t){t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT"}(u||(u={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(l||(l={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(c||(c={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL"}(d||(d={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(f||(f={})),function(t){t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT"}(p||(p={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(m||(m={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(g||(g={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(v||(v={})),function(t){t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH"}(y||(y={})),function(t){t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(b||(b={}));var _=/iPhone/i,E=/iPod/i,x=/iPad/i,T=/\biOS-universal(?:.+)Mac\b/i,w=/\bAndroid(?:.+)Mobile\b/i,A=/Android/i,S=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,O=/Silk/i,I=/Windows Phone/i,R=/\bWindows(?:.+)ARM\b/i,N=/BlackBerry/i,L=/BB10/i,M=/Opera Mini/i,P=/\b(CriOS|Chrome)(?:.+)Mobile/i,C=/Mobile(?:.+)Firefox\b/i,D=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};
/*!
     * @pixi/settings - v6.1.2
     * Compiled Thu, 12 Aug 2021 17:11:19 UTC
     *
     * @pixi/settings is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */
var U,B,F,k,G,j,H,X,z,V,W,Y,q,K,Z,J,Q,$,tt,et=function(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var r=e.userAgent,n=r.split("[FBAN");void 0!==n[1]&&(r=n[0]),void 0!==(n=r.split("Twitter"))[1]&&(r=n[0]);var i=function(t){return function(e){return e.test(t)}}(r),o={apple:{phone:i(_)&&!i(I),ipod:i(E),tablet:!i(_)&&(i(x)||D(e))&&!i(I),universal:i(T),device:(i(_)||i(E)||i(x)||i(T)||D(e))&&!i(I)},amazon:{phone:i(S),tablet:!i(S)&&i(O),device:i(S)||i(O)},android:{phone:!i(I)&&i(S)||!i(I)&&i(w),tablet:!i(I)&&!i(S)&&!i(w)&&(i(O)||i(A)),device:!i(I)&&(i(S)||i(O)||i(w)||i(A))||i(/\bokhttp\b/i)},windows:{phone:i(I),tablet:i(R),device:i(I)||i(R)},other:{blackberry:i(N),blackberry10:i(L),opera:i(M),firefox:i(C),chrome:i(P),device:i(N)||i(L)||i(M)||i(C)||i(P)},any:!1,phone:!1,tablet:!1};return o.any=o.apple.device||o.android.device||o.windows.device||o.other.device,o.phone=o.apple.phone||o.android.phone||o.windows.phone,o.tablet=o.apple.tablet||o.android.tablet||o.windows.tablet,o}(self.navigator);!function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(U||(U={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(B||(B={})),function(t){t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL"}(F||(F={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(k||(k={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(G||(G={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(j||(j={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(H||(H={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(X||(X={})),function(t){t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT"}(z||(z={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(V||(V={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(W||(W={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL"}(Y||(Y={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(q||(q={})),function(t){t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT"}(K||(K={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(Z||(Z={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(J||(J={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(Q||(Q={})),function(t){t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH"}($||($={})),function(t){t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(tt||(tt={}));var rt={MIPMAP_TEXTURES:Y.POW2,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,FILTER_MULTISAMPLE:$.NONE,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(et.tablet||et.phone){var r;if(et.apple.device)if(r=navigator.userAgent.match(/OS (\d+)_(\d+)?/))parseInt(r[1],10)<11&&(e=!1);if(et.android.device)if(r=navigator.userAgent.match(/Android\s([0-9.]*)/))parseInt(r[1],10)<7&&(e=!1)}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,useContextAlpha:!0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:Z.AUTO,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:W.CLAMP,SCALE_MODE:V.LINEAR,PRECISION_VERTEX:J.HIGH,PRECISION_FRAGMENT:et.apple.device?J.HIGH:J.MEDIUM,CAN_UPLOAD_SAME_BUFFER:!et.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},nt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function it(t){var e={exports:{}};return t(e,e.exports),e.exports}var ot=it((function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}function i(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function o(t,e,n,o,s){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new i(n,o||t,s),h=r?r+e:e;return t._events[h]?t._events[h].fn?t._events[h]=[t._events[h],a]:t._events[h].push(a):(t._events[h]=a,t._eventsCount++),t}function s(t,e){0==--t._eventsCount?t._events=new n:delete t._events[e]}function a(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),a.prototype.eventNames=function(){var t,n,i=[];if(0===this._eventsCount)return i;for(n in t=this._events)e.call(t,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},a.prototype.listeners=function(t){var e=r?r+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,s=new Array(o);i<o;i++)s[i]=n[i].fn;return s},a.prototype.listenerCount=function(t){var e=r?r+t:t,n=this._events[e];return n?n.fn?1:n.length:0},a.prototype.emit=function(t,e,n,i,o,s){var a=r?r+t:t;if(!this._events[a])return!1;var h,u,l=this._events[a],c=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),c){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,n),!0;case 4:return l.fn.call(l.context,e,n,i),!0;case 5:return l.fn.call(l.context,e,n,i,o),!0;case 6:return l.fn.call(l.context,e,n,i,o,s),!0}for(u=1,h=new Array(c-1);u<c;u++)h[u-1]=arguments[u];l.fn.apply(l.context,h)}else{var d,f=l.length;for(u=0;u<f;u++)switch(l[u].once&&this.removeListener(t,l[u].fn,void 0,!0),c){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,e);break;case 3:l[u].fn.call(l[u].context,e,n);break;case 4:l[u].fn.call(l[u].context,e,n,i);break;default:if(!h)for(d=1,h=new Array(c-1);d<c;d++)h[d-1]=arguments[d];l[u].fn.apply(l[u].context,h)}}return!0},a.prototype.on=function(t,e,r){return o(this,t,e,r,!1)},a.prototype.once=function(t,e,r){return o(this,t,e,r,!0)},a.prototype.removeListener=function(t,e,n,i){var o=r?r+t:t;if(!this._events[o])return this;if(!e)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn!==e||i&&!a.once||n&&a.context!==n||s(this,o);else{for(var h=0,u=[],l=a.length;h<l;h++)(a[h].fn!==e||i&&!a[h].once||n&&a[h].context!==n)&&u.push(a[h]);u.length?this._events[o]=1===u.length?u[0]:u:s(this,o)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=r?r+t:t,this._events[e]&&s(this,e)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,t.exports=a})),st=ht,at=ht;function ht(t,e,r){r=r||2;var n,i,o,s,a,h,u,l=e&&e.length,c=l?e[0]*r:t.length,d=ut(t,0,c,r,!0),f=[];if(!d||d.next===d.prev)return f;if(l&&(d=function(t,e,r,n){var i,o,s,a=[];for(i=0,o=e.length;i<o;i++)(s=ut(t,e[i]*n,i<o-1?e[i+1]*n:t.length,n,!1))===s.next&&(s.steiner=!0),a.push(_t(s));for(a.sort(gt),i=0;i<a.length;i++)r=vt(a[i],r);return r}(t,e,d,r)),t.length>80*r){n=o=t[0],i=s=t[1];for(var p=r;p<c;p+=r)(a=t[p])<n&&(n=a),(h=t[p+1])<i&&(i=h),a>o&&(o=a),h>s&&(s=h);u=0!==(u=Math.max(o-n,s-i))?32767/u:0}return ct(d,f,r,n,i,u,0),f}function ut(t,e,r,n,i){var o,s;if(i===Pt(t,e,r,n)>0)for(o=e;o<r;o+=n)s=Nt(o,t[o],t[o+1],s);else for(o=r-n;o>=e;o-=n)s=Nt(o,t[o],t[o+1],s);return s&&wt(s,s.next)&&(Lt(s),s=s.next),s}function lt(t,e){if(!t)return t;e||(e=t);var r,n=t;do{if(r=!1,n.steiner||!wt(n,n.next)&&0!==Tt(n.prev,n,n.next))n=n.next;else{if(Lt(n),(n=e=n.prev)===n.next)break;r=!0}}while(r||n!==e);return e}function ct(t,e,r,n,i,o,s){if(t){!s&&o&&function(t,e,r,n){var i=t;do{0===i.z&&(i.z=bt(i.x,i.y,e,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,r,n,i,o,s,a,h,u=1;do{for(r=t,t=null,o=null,s=0;r;){for(s++,n=r,a=0,e=0;e<u&&(a++,n=n.nextZ);e++);for(h=u;a>0||h>0&&n;)0!==a&&(0===h||!n||r.z<=n.z)?(i=r,r=r.nextZ,a--):(i=n,n=n.nextZ,h--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;r=n}o.nextZ=null,u*=2}while(s>1)}(i)}(t,n,i,o);for(var a,h,u=t;t.prev!==t.next;)if(a=t.prev,h=t.next,o?ft(t,n,i,o):dt(t))e.push(a.i/r|0),e.push(t.i/r|0),e.push(h.i/r|0),Lt(t),t=h.next,u=h.next;else if((t=h)===u){s?1===s?ct(t=pt(lt(t),e,r),e,r,n,i,o,2):2===s&&mt(t,e,r,n,i,o):ct(lt(t),e,r,n,i,o,1);break}}}function dt(t){var e=t.prev,r=t,n=t.next;if(Tt(e,r,n)>=0)return!1;for(var i=e.x,o=r.x,s=n.x,a=e.y,h=r.y,u=n.y,l=i<o?i<s?i:s:o<s?o:s,c=a<h?a<u?a:u:h<u?h:u,d=i>o?i>s?i:s:o>s?o:s,f=a>h?a>u?a:u:h>u?h:u,p=n.next;p!==e;){if(p.x>=l&&p.x<=d&&p.y>=c&&p.y<=f&&Et(i,a,o,h,s,u,p.x,p.y)&&Tt(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function ft(t,e,r,n){var i=t.prev,o=t,s=t.next;if(Tt(i,o,s)>=0)return!1;for(var a=i.x,h=o.x,u=s.x,l=i.y,c=o.y,d=s.y,f=a<h?a<u?a:u:h<u?h:u,p=l<c?l<d?l:d:c<d?c:d,m=a>h?a>u?a:u:h>u?h:u,g=l>c?l>d?l:d:c>d?c:d,v=bt(f,p,e,r,n),y=bt(m,g,e,r,n),b=t.prevZ,_=t.nextZ;b&&b.z>=v&&_&&_.z<=y;){if(b.x>=f&&b.x<=m&&b.y>=p&&b.y<=g&&b!==i&&b!==s&&Et(a,l,h,c,u,d,b.x,b.y)&&Tt(b.prev,b,b.next)>=0)return!1;if(b=b.prevZ,_.x>=f&&_.x<=m&&_.y>=p&&_.y<=g&&_!==i&&_!==s&&Et(a,l,h,c,u,d,_.x,_.y)&&Tt(_.prev,_,_.next)>=0)return!1;_=_.nextZ}for(;b&&b.z>=v;){if(b.x>=f&&b.x<=m&&b.y>=p&&b.y<=g&&b!==i&&b!==s&&Et(a,l,h,c,u,d,b.x,b.y)&&Tt(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;_&&_.z<=y;){if(_.x>=f&&_.x<=m&&_.y>=p&&_.y<=g&&_!==i&&_!==s&&Et(a,l,h,c,u,d,_.x,_.y)&&Tt(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function pt(t,e,r){var n=t;do{var i=n.prev,o=n.next.next;!wt(i,o)&&At(i,n,n.next,o)&&It(i,o)&&It(o,i)&&(e.push(i.i/r|0),e.push(n.i/r|0),e.push(o.i/r|0),Lt(n),Lt(n.next),n=t=o),n=n.next}while(n!==t);return lt(n)}function mt(t,e,r,n,i,o){var s=t;do{for(var a=s.next.next;a!==s.prev;){if(s.i!==a.i&&xt(s,a)){var h=Rt(s,a);return s=lt(s,s.next),h=lt(h,h.next),ct(s,e,r,n,i,o,0),void ct(h,e,r,n,i,o,0)}a=a.next}s=s.next}while(s!==t)}function gt(t,e){return t.x-e.x}function vt(t,e){var r=function(t,e){var r,n=e,i=t.x,o=t.y,s=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var a=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=i&&a>s&&(s=a,r=n.x<n.next.x?n:n.next,a===i))return r}n=n.next}while(n!==e);if(!r)return null;var h,u=r,l=r.x,c=r.y,d=1/0;n=r;do{i>=n.x&&n.x>=l&&i!==n.x&&Et(o<c?i:s,o,l,c,o<c?s:i,o,n.x,n.y)&&(h=Math.abs(o-n.y)/(i-n.x),It(n,t)&&(h<d||h===d&&(n.x>r.x||n.x===r.x&&yt(r,n)))&&(r=n,d=h)),n=n.next}while(n!==u);return r}(t,e);if(!r)return e;var n=Rt(r,t);return lt(n,n.next),lt(r,r.next)}function yt(t,e){return Tt(t.prev,t,e.prev)<0&&Tt(e.next,t,t.next)<0}function bt(t,e,r,n,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function _t(t){var e=t,r=t;do{(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next}while(e!==t);return r}function Et(t,e,r,n,i,o,s,a){return(i-s)*(e-a)>=(t-s)*(o-a)&&(t-s)*(n-a)>=(r-s)*(e-a)&&(r-s)*(o-a)>=(i-s)*(n-a)}function xt(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&At(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}(t,e)&&(It(t,e)&&It(e,t)&&function(t,e){var r=t,n=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{r.y>o!=r.next.y>o&&r.next.y!==r.y&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==t);return n}(t,e)&&(Tt(t.prev,t,e.prev)||Tt(t,e.prev,e))||wt(t,e)&&Tt(t.prev,t,t.next)>0&&Tt(e.prev,e,e.next)>0)}function Tt(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function wt(t,e){return t.x===e.x&&t.y===e.y}function At(t,e,r,n){var i=Ot(Tt(t,e,r)),o=Ot(Tt(t,e,n)),s=Ot(Tt(r,n,t)),a=Ot(Tt(r,n,e));return i!==o&&s!==a||(!(0!==i||!St(t,r,e))||(!(0!==o||!St(t,n,e))||(!(0!==s||!St(r,t,n))||!(0!==a||!St(r,e,n)))))}function St(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function Ot(t){return t>0?1:t<0?-1:0}function It(t,e){return Tt(t.prev,t,t.next)<0?Tt(t,e,t.next)>=0&&Tt(t,t.prev,e)>=0:Tt(t,e,t.prev)<0||Tt(t,t.next,e)<0}function Rt(t,e){var r=new Mt(t.i,t.x,t.y),n=new Mt(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,r.next=i,i.prev=r,n.next=r,r.prev=n,o.next=n,n.prev=o,n}function Nt(t,e,r,n){var i=new Mt(t,e,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function Lt(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Mt(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Pt(t,e,r,n){for(var i=0,o=e,s=r-n;o<r;o+=n)i+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return i}ht.deviation=function(t,e,r,n){var i=e&&e.length,o=i?e[0]*r:t.length,s=Math.abs(Pt(t,0,o,r));if(i)for(var a=0,h=e.length;a<h;a++){var u=e[a]*r,l=a<h-1?e[a+1]*r:t.length;s-=Math.abs(Pt(t,u,l,r))}var c=0;for(a=0;a<n.length;a+=3){var d=n[a]*r,f=n[a+1]*r,p=n[a+2]*r;c+=Math.abs((t[d]-t[p])*(t[f+1]-t[d+1])-(t[d]-t[f])*(t[p+1]-t[d+1]))}return 0===s&&0===c?0:Math.abs((c-s)/s)},ht.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var s=0;s<e;s++)r.vertices.push(t[i][o][s]);i>0&&(n+=t[i-1].length,r.holes.push(n))}return r},st.default=at;
/*! https://mths.be/punycode v1.3.2 by @mathias */
var Ct=it((function(t,e){!function(r){var n=e&&!e.nodeType&&e,i=t&&!t.nodeType&&t,o="object"==typeof nt&&nt;o.global!==o&&o.window!==o&&o.self!==o||(r=o);var s,a,h=2147483647,u=36,l=/^xn--/,c=/[^\x20-\x7E]/,d=/[\x2E\u3002\uFF0E\uFF61]/g,f={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},p=Math.floor,m=String.fromCharCode;function g(t){throw RangeError(f[t])}function v(t,e){for(var r=t.length,n=[];r--;)n[r]=e(t[r]);return n}function y(t,e){var r=t.split("@"),n="";return r.length>1&&(n=r[0]+"@",t=r[1]),n+v((t=t.replace(d,".")).split("."),e).join(".")}function b(t){for(var e,r,n=[],i=0,o=t.length;i<o;)(e=t.charCodeAt(i++))>=55296&&e<=56319&&i<o?56320==(64512&(r=t.charCodeAt(i++)))?n.push(((1023&e)<<10)+(1023&r)+65536):(n.push(e),i--):n.push(e);return n}function _(t){return v(t,(function(t){var e="";return t>65535&&(e+=m((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=m(t)})).join("")}function E(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function x(t,e,r){var n=0;for(t=r?p(t/700):t>>1,t+=p(t/e);t>455;n+=u)t=p(t/35);return p(n+36*t/(t+38))}function T(t){var e,r,n,i,o,s,a,l,c,d,f,m=[],v=t.length,y=0,b=128,E=72;for((r=t.lastIndexOf("-"))<0&&(r=0),n=0;n<r;++n)t.charCodeAt(n)>=128&&g("not-basic"),m.push(t.charCodeAt(n));for(i=r>0?r+1:0;i<v;){for(o=y,s=1,a=u;i>=v&&g("invalid-input"),((l=(f=t.charCodeAt(i++))-48<10?f-22:f-65<26?f-65:f-97<26?f-97:u)>=u||l>p((h-y)/s))&&g("overflow"),y+=l*s,!(l<(c=a<=E?1:a>=E+26?26:a-E));a+=u)s>p(h/(d=u-c))&&g("overflow"),s*=d;E=x(y-o,e=m.length+1,0==o),p(y/e)>h-b&&g("overflow"),b+=p(y/e),y%=e,m.splice(y++,0,b)}return _(m)}function w(t){var e,r,n,i,o,s,a,l,c,d,f,v,y,_,T,w=[];for(v=(t=b(t)).length,e=128,r=0,o=72,s=0;s<v;++s)(f=t[s])<128&&w.push(m(f));for(n=i=w.length,i&&w.push("-");n<v;){for(a=h,s=0;s<v;++s)(f=t[s])>=e&&f<a&&(a=f);for(a-e>p((h-r)/(y=n+1))&&g("overflow"),r+=(a-e)*y,e=a,s=0;s<v;++s)if((f=t[s])<e&&++r>h&&g("overflow"),f==e){for(l=r,c=u;!(l<(d=c<=o?1:c>=o+26?26:c-o));c+=u)T=l-d,_=u-d,w.push(m(E(d+T%_,0))),l=p(T/_);w.push(m(E(l,0))),o=x(r,y,n==i),r=0,++n}++r,++e}return w.join("")}if(s={version:"1.3.2",ucs2:{decode:b,encode:_},decode:T,encode:w,toASCII:function(t){return y(t,(function(t){return c.test(t)?"xn--"+w(t):t}))},toUnicode:function(t){return y(t,(function(t){return l.test(t)?T(t.slice(4).toLowerCase()):t}))}},n&&i)if(t.exports==n)i.exports=s;else for(a in s)s.hasOwnProperty(a)&&(n[a]=s[a]);else r.punycode=s}(nt)})),Dt=function(t){return"string"==typeof t},Ut=function(t){return"object"==typeof t&&null!==t},Bt=function(t){return null===t},Ft=function(t){return null==t};function kt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var Gt=function(t,e,r,n){e=e||"&",r=r||"=";var i={};if("string"!=typeof t||0===t.length)return i;var o=/\+/g;t=t.split(e);var s=1e3;n&&"number"==typeof n.maxKeys&&(s=n.maxKeys);var a=t.length;s>0&&a>s&&(a=s);for(var h=0;h<a;++h){var u,l,c,d,f=t[h].replace(o,"%20"),p=f.indexOf(r);p>=0?(u=f.substr(0,p),l=f.substr(p+1)):(u=f,l=""),c=decodeURIComponent(u),d=decodeURIComponent(l),kt(i,c)?Array.isArray(i[c])?i[c].push(d):i[c]=[i[c],d]:i[c]=d}return i},jt=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}},Ht=function(t,e,r,n){return e=e||"&",r=r||"=",null===t&&(t=void 0),"object"==typeof t?Object.keys(t).map((function(n){var i=encodeURIComponent(jt(n))+r;return Array.isArray(t[n])?t[n].map((function(t){return i+encodeURIComponent(jt(t))})).join(e):i+encodeURIComponent(jt(t[n]))})).join(e):n?encodeURIComponent(jt(n))+r+encodeURIComponent(jt(t)):""},Xt=it((function(t,e){e.decode=e.parse=Gt,e.encode=e.stringify=Ht})),zt=se,Vt=function(t,e){return se(t,!1,!0).resolve(e)},Wt=function(t){Dt(t)&&(t=se(t));return t instanceof Yt?t.format():Yt.prototype.format.call(t)};function Yt(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var qt=/^([a-z0-9.+-]+:)/i,Kt=/:[0-9]*$/,Zt=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,Jt=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),Qt=["'"].concat(Jt),$t=["%","/","?",";","#"].concat(Qt),te=["/","?","#"],ee=/^[+a-z0-9A-Z_-]{0,63}$/,re=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,ne={javascript:!0,"javascript:":!0},ie={javascript:!0,"javascript:":!0},oe={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function se(t,e,r){if(t&&Ut(t)&&t instanceof Yt)return t;var n=new Yt;return n.parse(t,e,r),n}Yt.prototype.parse=function(t,e,r){if(!Dt(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var n=t.indexOf("?"),i=-1!==n&&n<t.indexOf("#")?"?":"#",o=t.split(i);o[0]=o[0].replace(/\\/g,"/");var s=t=o.join(i);if(s=s.trim(),!r&&1===t.split("#").length){var a=Zt.exec(s);if(a)return this.path=s,this.href=s,this.pathname=a[1],a[2]?(this.search=a[2],this.query=e?Xt.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var h=qt.exec(s);if(h){var u=(h=h[0]).toLowerCase();this.protocol=u,s=s.substr(h.length)}if(r||h||s.match(/^\/\/[^@\/]+@[^@\/]+/)){var l="//"===s.substr(0,2);!l||h&&ie[h]||(s=s.substr(2),this.slashes=!0)}if(!ie[h]&&(l||h&&!oe[h])){for(var c,d,f=-1,p=0;p<te.length;p++){-1!==(m=s.indexOf(te[p]))&&(-1===f||m<f)&&(f=m)}-1!==(d=-1===f?s.lastIndexOf("@"):s.lastIndexOf("@",f))&&(c=s.slice(0,d),s=s.slice(d+1),this.auth=decodeURIComponent(c)),f=-1;for(p=0;p<$t.length;p++){var m;-1!==(m=s.indexOf($t[p]))&&(-1===f||m<f)&&(f=m)}-1===f&&(f=s.length),this.host=s.slice(0,f),s=s.slice(f),this.parseHost(),this.hostname=this.hostname||"";var g="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!g)for(var v=this.hostname.split(/\./),y=(p=0,v.length);p<y;p++){var b=v[p];if(b&&!b.match(ee)){for(var _="",E=0,x=b.length;E<x;E++)b.charCodeAt(E)>127?_+="x":_+=b[E];if(!_.match(ee)){var T=v.slice(0,p),w=v.slice(p+1),A=b.match(re);A&&(T.push(A[1]),w.unshift(A[2])),w.length&&(s="/"+w.join(".")+s),this.hostname=T.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),g||(this.hostname=Ct.toASCII(this.hostname));var S=this.port?":"+this.port:"",O=this.hostname||"";this.host=O+S,this.href+=this.host,g&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==s[0]&&(s="/"+s))}if(!ne[u])for(p=0,y=Qt.length;p<y;p++){var I=Qt[p];if(-1!==s.indexOf(I)){var R=encodeURIComponent(I);R===I&&(R=escape(I)),s=s.split(I).join(R)}}var N=s.indexOf("#");-1!==N&&(this.hash=s.substr(N),s=s.slice(0,N));var L=s.indexOf("?");if(-1!==L?(this.search=s.substr(L),this.query=s.substr(L+1),e&&(this.query=Xt.parse(this.query)),s=s.slice(0,L)):e&&(this.search="",this.query={}),s&&(this.pathname=s),oe[u]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){S=this.pathname||"";var M=this.search||"";this.path=S+M}return this.href=this.format(),this},Yt.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",r=this.pathname||"",n=this.hash||"",i=!1,o="";this.host?i=t+this.host:this.hostname&&(i=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&Ut(this.query)&&Object.keys(this.query).length&&(o=Xt.stringify(this.query));var s=this.search||o&&"?"+o||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||oe[e])&&!1!==i?(i="//"+(i||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):i||(i=""),n&&"#"!==n.charAt(0)&&(n="#"+n),s&&"?"!==s.charAt(0)&&(s="?"+s),e+i+(r=r.replace(/[?#]/g,(function(t){return encodeURIComponent(t)})))+(s=s.replace("#","%23"))+n},Yt.prototype.resolve=function(t){return this.resolveObject(se(t,!1,!0)).format()},Yt.prototype.resolveObject=function(t){if(Dt(t)){var e=new Yt;e.parse(t,!1,!0),t=e}for(var r=new Yt,n=Object.keys(this),i=0;i<n.length;i++){var o=n[i];r[o]=this[o]}if(r.hash=t.hash,""===t.href)return r.href=r.format(),r;if(t.slashes&&!t.protocol){for(var s=Object.keys(t),a=0;a<s.length;a++){var h=s[a];"protocol"!==h&&(r[h]=t[h])}return oe[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(t.protocol&&t.protocol!==r.protocol){if(!oe[t.protocol]){for(var u=Object.keys(t),l=0;l<u.length;l++){var c=u[l];r[c]=t[c]}return r.href=r.format(),r}if(r.protocol=t.protocol,t.host||ie[t.protocol])r.pathname=t.pathname;else{for(var d=(t.pathname||"").split("/");d.length&&!(t.host=d.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),r.pathname=d.join("/")}if(r.search=t.search,r.query=t.query,r.host=t.host||"",r.auth=t.auth,r.hostname=t.hostname||t.host,r.port=t.port,r.pathname||r.search){var f=r.pathname||"",p=r.search||"";r.path=f+p}return r.slashes=r.slashes||t.slashes,r.href=r.format(),r}var m=r.pathname&&"/"===r.pathname.charAt(0),g=t.host||t.pathname&&"/"===t.pathname.charAt(0),v=g||m||r.host&&t.pathname,y=v,b=r.pathname&&r.pathname.split("/")||[],_=(d=t.pathname&&t.pathname.split("/")||[],r.protocol&&!oe[r.protocol]);if(_&&(r.hostname="",r.port=null,r.host&&(""===b[0]?b[0]=r.host:b.unshift(r.host)),r.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===d[0]?d[0]=t.host:d.unshift(t.host)),t.host=null),v=v&&(""===d[0]||""===b[0])),g)r.host=t.host||""===t.host?t.host:r.host,r.hostname=t.hostname||""===t.hostname?t.hostname:r.hostname,r.search=t.search,r.query=t.query,b=d;else if(d.length)b||(b=[]),b.pop(),b=b.concat(d),r.search=t.search,r.query=t.query;else if(!Ft(t.search)){if(_)r.hostname=r.host=b.shift(),(A=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=A.shift(),r.host=r.hostname=A.shift());return r.search=t.search,r.query=t.query,Bt(r.pathname)&&Bt(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!b.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var E=b.slice(-1)[0],x=(r.host||t.host||b.length>1)&&("."===E||".."===E)||""===E,T=0,w=b.length;w>=0;w--)"."===(E=b[w])?b.splice(w,1):".."===E?(b.splice(w,1),T++):T&&(b.splice(w,1),T--);if(!v&&!y)for(;T--;T)b.unshift("..");!v||""===b[0]||b[0]&&"/"===b[0].charAt(0)||b.unshift(""),x&&"/"!==b.join("/").substr(-1)&&b.push("");var A,S=""===b[0]||b[0]&&"/"===b[0].charAt(0);_&&(r.hostname=r.host=S?"":b.length?b.shift():"",(A=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=A.shift(),r.host=r.hostname=A.shift()));return(v=v||r.host&&b.length)&&!S&&b.unshift(""),b.length?r.pathname=b.join("/"):(r.pathname=null,r.path=null),Bt(r.pathname)&&Bt(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=t.auth||r.auth,r.slashes=r.slashes||t.slashes,r.href=r.format(),r},Yt.prototype.parseHost=function(){var t=this.host,e=Kt.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)};
/*!
     * @pixi/utils - v6.1.2
     * Compiled Thu, 12 Aug 2021 17:11:19 UTC
     *
     * @pixi/utils is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */
var ae={parse:zt,format:Wt,resolve:Vt};rt.RETINA_PREFIX=/@([0-9\.]+)x/,rt.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var he,ue=!1;var le={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function ce(t,e){return void 0===e&&(e=[]),e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e}function de(t){var e=t.toString(16);return"#"+(e="000000".substr(0,6-e.length)+e)}function fe(t){return"string"==typeof t&&"#"===(t=le[t.toLowerCase()]||t)[0]&&(t=t.substr(1)),parseInt(t,16)}var pe=function(){for(var t=[],e=[],r=0;r<32;r++)t[r]=r,e[r]=r;t[i.NORMAL_NPM]=i.NORMAL,t[i.ADD_NPM]=i.ADD,t[i.SCREEN_NPM]=i.SCREEN,e[i.NORMAL]=i.NORMAL_NPM,e[i.ADD]=i.ADD_NPM,e[i.SCREEN]=i.SCREEN_NPM;var n=[];return n.push(e),n.push(t),n}();function me(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var r=t>>16&255,n=t>>8&255,i=255&t;return(255*e<<24)+((r=r*e+.5|0)<<16)+((n=n*e+.5|0)<<8)+(i=i*e+.5|0)}function ge(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}function ve(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function ye(t){return!(t&t-1||!t)}function be(t){var e=(t>65535?1:0)<<4,r=((t>>>=e)>255?1:0)<<3;return e|=r,e|=r=((t>>>=r)>15?1:0)<<2,(e|=r=((t>>>=r)>3?1:0)<<1)|(t>>>=r)>>1}function _e(t,e,r){var n,i=t.length;if(!(e>=i||0===r)){var o=i-(r=e+r>i?i-e:r);for(n=e;n<o;++n)t[n]=t[n+r];t.length=o}}function Ee(t){return 0===t?0:t<0?-1:1}var xe=0;function Te(){return++xe}var we={};function Ae(t,e,r){if(void 0===r&&(r=3),!we[e]){var n=(new Error).stack;void 0===n?console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t):(n=n.split("\n").splice(r).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",e+"\nDeprecated since v"+t),console.warn(n),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t),console.warn(n))),we[e]=!0}}var Se,Oe={},Ie=Object.create(null),Re=Object.create(null);function Ne(t,e){if(void 0===e&&(e=self.location),0===t.indexOf("data:"))return"";e=e||self.location,Se||(Se=document.createElement("a")),Se.href=t;var r=ae.parse(Se.href),n=!r.port&&""===e.port||r.port===e.port;return r.hostname===e.hostname&&n&&r.protocol===e.protocol?"":"anonymous"}function Le(t,e){var r=rt.RETINA_PREFIX.exec(t);return r?parseFloat(r[1]):void 0!==e?e:1}
/*!
     * @pixi/runner - v6.1.2
     * Compiled Thu, 12 Aug 2021 17:11:19 UTC
     *
     * @pixi/runner is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */!function(){function t(t,e,r){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=r||rt.RESOLUTION,this.resize(t,e)}t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.resize=function(t,e){this.canvas.width=Math.round(t*this.resolution),this.canvas.height=Math.round(e*this.resolution)},t.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.canvas.width},set:function(t){this.canvas.width=Math.round(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.canvas.height},set:function(t){this.canvas.height=Math.round(t)},enumerable:!1,configurable:!0})}();var Me,Pe=function(){function t(t){this.items=[],this._name=t,this._aliasCount=0}return t.prototype.emit=function(t,e,r,n,i,o,s,a){if(arguments.length>8)throw new Error("max arguments reached");var h=this,u=h.name,l=h.items;this._aliasCount++;for(var c=0,d=l.length;c<d;c++)l[c][u](t,e,r,n,i,o,s,a);return l===this.items&&this._aliasCount--,this},t.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},t.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},t.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},t.prototype.contains=function(t){return-1!==this.items.indexOf(t)},t.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},t.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),t}();Object.defineProperties(Pe.prototype,{dispatch:{value:Pe.prototype.emit},run:{value:Pe.prototype.emit}}),
/*!
     * @pixi/ticker - v6.1.2
     * Compiled Thu, 12 Aug 2021 17:11:19 UTC
     *
     * @pixi/ticker is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */
rt.TARGET_FPMS=.06,function(t){t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY"}(Me||(Me={}));var Ce,De=function(){function t(t,e,r,n){void 0===e&&(e=null),void 0===r&&(r=0),void 0===n&&(n=!1),this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=r,this.once=n}return t.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},t.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},t.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},t.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},t}(),Ue=function(){function t(){var t=this;this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new De(null,null,1/0),this.deltaMS=1/rt.TARGET_FPMS,this.elapsedMS=1/rt.TARGET_FPMS,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return t.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},t.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},t.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},t.prototype.add=function(t,e,r){return void 0===r&&(r=Me.NORMAL),this._addListener(new De(t,e,r))},t.prototype.addOnce=function(t,e,r){return void 0===r&&(r=Me.NORMAL),this._addListener(new De(t,e,r,!0))},t.prototype._addListener=function(t){var e=this._head.next,r=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(r);break}r=e,e=e.next}t.previous||t.connect(r)}else t.connect(r);return this._startIfPossible(),this},t.prototype.remove=function(t,e){for(var r=this._head.next;r;)r=r.match(t,e)?r.destroy():r.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(t.prototype,"count",{get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t},enumerable:!1,configurable:!0}),t.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},t.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},t.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},t.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var r=t-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=t-r%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*rt.TARGET_FPMS;for(var n=this._head,i=n.next;i;)i=i.emit(this.deltaTime);n.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(t.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),r=Math.min(Math.max(0,e)/1e3,rt.TARGET_FPMS);this._maxElapsedMS=1/r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"shared",{get:function(){if(!t._shared){var e=t._shared=new t;e.autoStart=!0,e._protected=!0}return t._shared},enumerable:!1,configurable:!0}),Object.defineProperty(t,"system",{get:function(){if(!t._system){var e=t._system=new t;e.autoStart=!0,e._protected=!0}return t._system},enumerable:!1,configurable:!0}),t}(),Be=function(){function t(){}return t.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,Me.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?Ue.shared:new Ue,t.autoStart&&this.start()},t.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}},t}(),Fe=2*Math.PI,ke=180/Math.PI,Ge=Math.PI/180;!function(t){t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC"}(Ce||(Ce={}));var je=function(){function t(t,e,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===n&&(n=0),this.x=Number(t),this.y=Number(e),this.width=Number(r),this.height=Number(n),this.type=Ce.RECT}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(t,"EMPTY",{get:function(){return new t(0,0,0,0)},enumerable:!1,configurable:!0}),t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},t.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)},t.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},t.prototype.fit=function(t){var e=Math.max(this.x,t.x),r=Math.min(this.x+this.width,t.x+t.width),n=Math.max(this.y,t.y),i=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(r-e,0),this.y=n,this.height=Math.max(i-n,0),this},t.prototype.ceil=function(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var r=Math.ceil((this.x+this.width-e)*t)/t,n=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=r-this.x,this.height=n-this.y,this},t.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),r=Math.max(this.x+this.width,t.x+t.width),n=Math.min(this.y,t.y),i=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=r-e,this.y=n,this.height=i-n,this},t.prototype.toString=function(){return"[@pixi/math:Rectangle x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},t}(),He=function(){function t(t,e,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),this.x=t,this.y=e,this.radius=r,this.type=Ce.CIRC}return t.prototype.clone=function(){return new t(this.x,this.y,this.radius)},t.prototype.contains=function(t,e){if(this.radius<=0)return!1;var r=this.radius*this.radius,n=this.x-t,i=this.y-e;return(n*=n)+(i*=i)<=r},t.prototype.getBounds=function(){return new je(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},t.prototype.toString=function(){return"[@pixi/math:Circle x="+this.x+" y="+this.y+" radius="+this.radius+"]"},t}(),Xe=function(){function t(t,e,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===n&&(n=0),this.x=t,this.y=e,this.width=r,this.height=n,this.type=Ce.ELIP}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var r=(t-this.x)/this.width,n=(e-this.y)/this.height;return(r*=r)+(n*=n)<=1},t.prototype.getBounds=function(){return new je(this.x-this.width,this.y-this.height,this.width,this.height)},t.prototype.toString=function(){return"[@pixi/math:Ellipse x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},t}(),ze=function(){function t(){for(var t=arguments,e=[],r=0;r<arguments.length;r++)e[r]=t[r];var n=Array.isArray(e[0])?e[0]:e;if("number"!=typeof n[0]){for(var i=[],o=0,s=n.length;o<s;o++)i.push(n[o].x,n[o].y);n=i}this.points=n,this.type=Ce.POLY,this.closeStroke=!0}return t.prototype.clone=function(){var e=new t(this.points.slice());return e.closeStroke=this.closeStroke,e},t.prototype.contains=function(t,e){for(var r=!1,n=this.points.length/2,i=0,o=n-1;i<n;o=i++){var s=this.points[2*i],a=this.points[2*i+1],h=this.points[2*o],u=this.points[2*o+1];a>e!=u>e&&t<(e-a)/(u-a)*(h-s)+s&&(r=!r)}return r},t.prototype.toString=function(){return"[@pixi/math:PolygoncloseStroke="+this.closeStroke+"points="+this.points.reduce((function(t,e){return t+", "+e}),"")+"]"},t}(),Ve=function(){function t(t,e,r,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===n&&(n=0),void 0===i&&(i=20),this.x=t,this.y=e,this.width=r,this.height=n,this.radius=i,this.type=Ce.RREC}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height,this.radius)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var r=t-(this.x+this.radius),n=e-(this.y+this.radius),i=this.radius*this.radius;if(r*r+n*n<=i)return!0;if((r=t-(this.x+this.width-this.radius))*r+n*n<=i)return!0;if(r*r+(n=e-(this.y+this.height-this.radius))*n<=i)return!0;if((r=t-(this.x+this.radius))*r+n*n<=i)return!0}return!1},t.prototype.toString=function(){return"[@pixi/math:RoundedRectangle x="+this.x+" y="+this.y+"width="+this.width+" height="+this.height+" radius="+this.radius+"]"},t}(),We=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=0,this.y=0,this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},t.prototype.copyTo=function(t){return t.set(this.x,this.y),t},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this},t.prototype.toString=function(){return"[@pixi/math:Point x="+this.x+" y="+this.y+"]"},t}(),Ye=function(){function t(t,e,r,n){void 0===r&&(r=0),void 0===n&&(n=0),this._x=r,this._y=n,this.cb=t,this.scope=e}return t.prototype.clone=function(e,r){return void 0===e&&(e=this.cb),void 0===r&&(r=this.scope),new t(e,r,this._x,this._y)},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope)),this},t.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},t.prototype.copyTo=function(t){return t.set(this._x,this._y),t},t.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},t.prototype.toString=function(){return"[@pixi/math:ObservablePoint x=0 y=0 scope="+this.scope+"]"},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),t}(),qe=function(){function t(t,e,r,n,i,o){void 0===t&&(t=1),void 0===e&&(e=0),void 0===r&&(r=0),void 0===n&&(n=1),void 0===i&&(i=0),void 0===o&&(o=0),this.array=null,this.a=t,this.b=e,this.c=r,this.d=n,this.tx=i,this.ty=o}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.set=function(t,e,r,n,i,o){return this.a=t,this.b=e,this.c=r,this.d=n,this.tx=i,this.ty=o,this},t.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var r=e||this.array;return t?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r},t.prototype.apply=function(t,e){e=e||new We;var r=t.x,n=t.y;return e.x=this.a*r+this.c*n+this.tx,e.y=this.b*r+this.d*n+this.ty,e},t.prototype.applyInverse=function(t,e){e=e||new We;var r=1/(this.a*this.d+this.c*-this.b),n=t.x,i=t.y;return e.x=this.d*r*n+-this.c*r*i+(this.ty*this.c-this.tx*this.d)*r,e.y=this.a*r*i+-this.b*r*n+(-this.ty*this.a+this.tx*this.b)*r,e},t.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},t.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),r=Math.sin(t),n=this.a,i=this.c,o=this.tx;return this.a=n*e-this.b*r,this.b=n*r+this.b*e,this.c=i*e-this.d*r,this.d=i*r+this.d*e,this.tx=o*e-this.ty*r,this.ty=o*r+this.ty*e,this},t.prototype.append=function(t){var e=this.a,r=this.b,n=this.c,i=this.d;return this.a=t.a*e+t.b*n,this.b=t.a*r+t.b*i,this.c=t.c*e+t.d*n,this.d=t.c*r+t.d*i,this.tx=t.tx*e+t.ty*n+this.tx,this.ty=t.tx*r+t.ty*i+this.ty,this},t.prototype.setTransform=function(t,e,r,n,i,o,s,a,h){return this.a=Math.cos(s+h)*i,this.b=Math.sin(s+h)*i,this.c=-Math.sin(s-a)*o,this.d=Math.cos(s-a)*o,this.tx=t-(r*this.a+n*this.c),this.ty=e-(r*this.b+n*this.d),this},t.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var r=this.a,n=this.c;this.a=r*t.a+this.b*t.c,this.b=r*t.b+this.b*t.d,this.c=n*t.a+this.d*t.c,this.d=n*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},t.prototype.decompose=function(t){var e=this.a,r=this.b,n=this.c,i=this.d,o=t.pivot,s=-Math.atan2(-n,i),a=Math.atan2(r,e),h=Math.abs(s+a);return h<1e-5||Math.abs(Fe-h)<1e-5?(t.rotation=a,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=a),t.scale.x=Math.sqrt(e*e+r*r),t.scale.y=Math.sqrt(n*n+i*i),t.position.x=this.tx+(o.x*e+o.y*n),t.position.y=this.ty+(o.x*r+o.y*i),t},t.prototype.invert=function(){var t=this.a,e=this.b,r=this.c,n=this.d,i=this.tx,o=t*n-e*r;return this.a=n/o,this.b=-e/o,this.c=-r/o,this.d=t/o,this.tx=(r*this.ty-n*i)/o,this.ty=-(t*this.ty-e*i)/o,this},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},t.prototype.clone=function(){var e=new t;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},t.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},t.prototype.toString=function(){return"[@pixi/math:Matrix a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+"]"},Object.defineProperty(t,"IDENTITY",{get:function(){return new t},enumerable:!1,configurable:!0}),Object.defineProperty(t,"TEMP_MATRIX",{get:function(){return new t},enumerable:!1,configurable:!0}),t}(),Ke=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Ze=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Je=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Qe=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],$e=[],tr=[],er=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];$e.push(e);for(var r=0;r<16;r++)for(var n=er(Ke[t]*Ke[r]+Je[t]*Ze[r]),i=er(Ze[t]*Ke[r]+Qe[t]*Ze[r]),o=er(Ke[t]*Je[r]+Je[t]*Qe[r]),s=er(Ze[t]*Je[r]+Qe[t]*Qe[r]),a=0;a<16;a++)if(Ke[a]===n&&Ze[a]===i&&Je[a]===o&&Qe[a]===s){e.push(a);break}}for(t=0;t<16;t++){var h=new qe;h.set(Ke[t],Ze[t],Je[t],Qe[t],0,0),tr.push(h)}}();var rr={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return Ke[t]},uY:function(t){return Ze[t]},vX:function(t){return Je[t]},vY:function(t){return Qe[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return $e[t][e]},sub:function(t,e){return $e[t][rr.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?rr.S:rr.N:2*Math.abs(e)<=Math.abs(t)?t>0?rr.E:rr.W:e>0?t>0?rr.SE:rr.SW:t>0?rr.NE:rr.NW},matrixAppendRotationInv:function(t,e,r,n){void 0===r&&(r=0),void 0===n&&(n=0);var i=tr[rr.inv(e)];i.tx=r,i.ty=n,t.append(i)}},nr=function(){function t(){this.worldTransform=new qe,this.localTransform=new qe,this.position=new Ye(this.onChange,this,0,0),this.scale=new Ye(this.onChange,this,1,1),this.pivot=new Ye(this.onChange,this,0,0),this.skew=new Ye(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return t.prototype.onChange=function(){this._localID++},t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},t.prototype.toString=function(){return"[@pixi/math:Transform position=("+this.position.x+", "+this.position.y+") rotation="+this.rotation+" scale=("+this.scale.x+", "+this.scale.y+") skew=("+this.skew.x+", "+this.skew.y+") ]"},t.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},t.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var r=t.worldTransform,n=this.worldTransform;n.a=e.a*r.a+e.b*r.c,n.b=e.a*r.b+e.b*r.d,n.c=e.c*r.a+e.d*r.c,n.d=e.c*r.b+e.d*r.d,n.tx=e.tx*r.a+e.ty*r.c+r.tx,n.ty=e.tx*r.b+e.ty*r.d+r.ty,this._parentID=t._worldID,this._worldID++}},t.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!1,configurable:!0}),t.IDENTITY=new t,t}();
/*!
     * @pixi/core - v6.1.2
     * Compiled Thu, 12 Aug 2021 17:11:19 UTC
     *
     * @pixi/core is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */
rt.PREFER_ENV=et.any?e.WEBGL:e.WEBGL2,rt.STRICT_TEXTURE_CACHE=!1;var ir=[];function or(t,e){if(!t)return null;var r="";if("string"==typeof t){var n=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);n&&(r=n[1].toLowerCase())}for(var i=ir.length-1;i>=0;--i){var o=ir[i];if(o.test&&o.test(t,r))return new o(t,e)}throw new Error("Unrecognized source type to auto-detect Resource")}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var sr=function(t,e){return(sr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function ar(t,e){function r(){this.constructor=t}sr(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var hr=function(){return(hr=Object.assign||function(t){for(var e,r=arguments,n=1,i=arguments.length;n<i;n++)for(var o in e=r[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};var ur=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new Pe("setRealSize"),this.onUpdate=new Pe("update"),this.onError=new Pe("onError")}return t.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},t.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},t.prototype.resize=function(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.emit(t,e))},Object.defineProperty(t.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),t.prototype.update=function(){this.destroyed||this.onUpdate.emit()},t.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),t.prototype.style=function(t,e,r){return!1},t.prototype.dispose=function(){},t.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},t.test=function(t,e){return!1},t}(),lr=function(t){function e(e,r){var n=this,i=r||{},o=i.width,s=i.height;if(!o||!s)throw new Error("BufferResource width or height invalid");return(n=t.call(this,o,s)||this).data=e,n}return ar(e,t),e.prototype.upload=function(t,e,r){var n=t.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===f.UNPACK);var i=e.realWidth,o=e.realHeight;return r.width===i&&r.height===o?n.texSubImage2D(e.target,0,0,0,i,o,e.format,r.type,this.data):(r.width=i,r.height=o,n.texImage2D(e.target,0,r.internalFormat,i,o,0,e.format,r.type,this.data)),!0},e.prototype.dispose=function(){this.data=null},e.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},e}(ur),cr={scaleMode:l.NEAREST,format:s.RGBA,alphaMode:f.NPM},dr=function(t){function e(e,r){void 0===e&&(e=null),void 0===r&&(r=null);var n=t.call(this)||this,i=(r=r||{}).alphaMode,o=r.mipmap,u=r.anisotropicLevel,l=r.scaleMode,c=r.width,d=r.height,p=r.wrapMode,m=r.format,g=r.type,v=r.target,y=r.resolution,b=r.resourceOptions;return!e||e instanceof ur||((e=or(e,b)).internal=!0),n.resolution=y||rt.RESOLUTION,n.width=Math.round((c||0)*n.resolution)/n.resolution,n.height=Math.round((d||0)*n.resolution)/n.resolution,n._mipmap=void 0!==o?o:rt.MIPMAP_TEXTURES,n.anisotropicLevel=void 0!==u?u:rt.ANISOTROPIC_LEVEL,n._wrapMode=p||rt.WRAP_MODE,n._scaleMode=void 0!==l?l:rt.SCALE_MODE,n.format=m||s.RGBA,n.type=g||h.UNSIGNED_BYTE,n.target=v||a.TEXTURE_2D,n.alphaMode=void 0!==i?i:f.UNPACK,n.uid=Te(),n.touched=0,n.isPowerOfTwo=!1,n._refreshPOT(),n._glTextures={},n.dirtyId=0,n.dirtyStyleId=0,n.cacheId=null,n.valid=c>0&&d>0,n.textureCacheIds=[],n.destroyed=!1,n.resource=null,n._batchEnabled=0,n._batchLocation=0,n.parentTextureArray=null,n.setResource(e),n}return ar(e,t),Object.defineProperty(e.prototype,"realWidth",{get:function(){return Math.round(this.width*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"realHeight",{get:function(){return Math.round(this.height*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mipmap",{get:function(){return this._mipmap},set:function(t){this._mipmap!==t&&(this._mipmap=t,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(t){this._scaleMode!==t&&(this._scaleMode=t,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wrapMode",{get:function(){return this._wrapMode},set:function(t){this._wrapMode!==t&&(this._wrapMode=t,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),e.prototype.setStyle=function(t,e){var r;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,r=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,r=!0),r&&this.dirtyStyleId++,this},e.prototype.setSize=function(t,e,r){return r=r||this.resolution,this.setRealSize(t*r,e*r,r)},e.prototype.setRealSize=function(t,e,r){return this.resolution=r||this.resolution,this.width=Math.round(t)/this.resolution,this.height=Math.round(e)/this.resolution,this._refreshPOT(),this.update(),this},e.prototype._refreshPOT=function(){this.isPowerOfTwo=ye(this.realWidth)&&ye(this.realHeight)},e.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=Math.round(this.width*e)/t,this.height=Math.round(this.height*e)/t,this.emit("update",this)),this._refreshPOT()),this},e.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},e.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},e.prototype.onError=function(t){this.emit("error",this,t)},e.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Re[this.cacheId],delete Ie[this.cacheId],this.cacheId=null),this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},e.prototype.dispose=function(){this.emit("dispose",this)},e.prototype.castToBaseTexture=function(){return this},e.from=function(t,r,n){void 0===n&&(n=rt.STRICT_TEXTURE_CACHE);var i="string"==typeof t,o=null;if(i)o=t;else{if(!t._pixiId){var s=r&&r.pixiIdPrefix||"pixiid";t._pixiId=s+"_"+Te()}o=t._pixiId}var a=Re[o];if(i&&n&&!a)throw new Error('The cacheId "'+o+'" does not exist in BaseTextureCache.');return a||((a=new e(t,r)).cacheId=o,e.addToCache(a,o)),a},e.fromBuffer=function(t,r,n,i){t=t||new Float32Array(r*n*4);var o=new lr(t,{width:r,height:n}),s=t instanceof Float32Array?h.FLOAT:h.UNSIGNED_BYTE;return new e(o,Object.assign(cr,i||{width:r,height:n,type:s}))},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Re[e]&&console.warn("BaseTexture added to the cache with an id ["+e+"] that already had an entry"),Re[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=Re[t];if(e){var r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete Re[t],e}}else if(t&&t.textureCacheIds){for(var n=0;n<t.textureCacheIds.length;++n)delete Re[t.textureCacheIds[n]];return t.textureCacheIds.length=0,t}return null},e._globalBatch=0,e}(ot),fr=function(t){function e(e,r){var n=this,i=r||{},o=i.width,s=i.height;(n=t.call(this,o,s)||this).items=[],n.itemDirtyIds=[];for(var a=0;a<e;a++){var h=new dr;n.items.push(h),n.itemDirtyIds.push(-2)}return n.length=e,n._load=null,n.baseTexture=null,n}return ar(e,t),e.prototype.initFromArray=function(t,e){for(var r=0;r<this.length;r++)t[r]&&(t[r].castToBaseTexture?this.addBaseTextureAt(t[r].castToBaseTexture(),r):t[r]instanceof ur?this.addResourceAt(t[r],r):this.addResourceAt(or(t[r],e),r))},e.prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},e.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},e.prototype.bind=function(e){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");t.prototype.bind.call(this,e);for(var r=0;r<this.length;r++)this.items[r].parentTextureArray=e,this.items[r].on("update",e.update,e)},e.prototype.unbind=function(e){t.prototype.unbind.call(this,e);for(var r=0;r<this.length;r++)this.items[r].parentTextureArray=null,this.items[r].off("update",e.update,e)},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.items.map((function(t){return t.resource})).filter((function(t){return t})).map((function(t){return t.load()}));return this._load=Promise.all(e).then((function(){var e=t.items[0],r=e.realWidth,n=e.realHeight;return t.resize(r,n),Promise.resolve(t)})),this._load},e}(ur),pr=function(t){function e(e,r){var n,i,o=this,s=r||{},a=s.width,h=s.height;return Array.isArray(e)?(n=e,i=e.length):i=e,o=t.call(this,i,{width:a,height:h})||this,n&&o.initFromArray(n,r),o}return ar(e,t),e.prototype.addBaseTextureAt=function(t,e){if(!t.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(t.resource,e),this},e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=a.TEXTURE_2D_ARRAY},e.prototype.upload=function(t,e,r){var n=this,i=n.length,o=n.itemDirtyIds,s=n.items,a=t.gl;r.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,r.internalFormat,this._width,this._height,i,0,e.format,r.type,null);for(var h=0;h<i;h++){var u=s[h];o[h]<u.dirtyId&&(o[h]=u.dirtyId,u.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,h,u.resource.width,u.resource.height,1,e.format,r.type,u.resource.source))}return!0},e}(fr),mr=function(t){function e(e){var r=this,n=e,i=n.naturalWidth||n.videoWidth||n.width,o=n.naturalHeight||n.videoHeight||n.height;return(r=t.call(this,i,o)||this).source=e,r.noSubImage=!1,r}return ar(e,t),e.crossOrigin=function(t,e,r){void 0===r&&0!==e.indexOf("data:")?t.crossOrigin=Ne(e):!1!==r&&(t.crossOrigin="string"==typeof r?r:"anonymous")},e.prototype.upload=function(t,e,r,n){var i=t.gl,o=e.realWidth,s=e.realHeight;return n=n||this.source,i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===f.UNPACK),this.noSubImage||e.target!==i.TEXTURE_2D||r.width!==o||r.height!==s?(r.width=o,r.height=s,i.texImage2D(e.target,0,r.internalFormat,e.format,r.type,n)):i.texSubImage2D(i.TEXTURE_2D,0,0,0,e.format,r.type,n),!0},e.prototype.update=function(){if(!this.destroyed){var e=this.source,r=e.naturalWidth||e.videoWidth||e.width,n=e.naturalHeight||e.videoHeight||e.height;this.resize(r,n),t.prototype.update.call(this)}},e.prototype.dispose=function(){this.source=null},e}(ur),gr=function(t){function e(e){return t.call(this,e)||this}return ar(e,t),e.test=function(t){var e=self.OffscreenCanvas;return!!(e&&t instanceof e)||self.HTMLCanvasElement&&t instanceof HTMLCanvasElement},e}(mr),vr=function(t){function e(r,n){var i=this,o=n||{},s=o.width,h=o.height,u=o.autoLoad,l=o.linkBaseTexture;if(r&&r.length!==e.SIDES)throw new Error("Invalid length. Got "+r.length+", expected 6");i=t.call(this,6,{width:s,height:h})||this;for(var c=0;c<e.SIDES;c++)i.items[c].target=a.TEXTURE_CUBE_MAP_POSITIVE_X+c;return i.linkBaseTexture=!1!==l,r&&i.initFromArray(r,n),!1!==u&&i.load(),i}return ar(e,t),e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=a.TEXTURE_CUBE_MAP},e.prototype.addBaseTextureAt=function(t,e,r){if(void 0===r&&(r=this.linkBaseTexture),!this.items[e])throw new Error("Index "+e+" is out of bounds");if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0){if(!t.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(t.resource,e)}else t.target=a.TEXTURE_CUBE_MAP_POSITIVE_X+e,t.parentTextureArray=this.baseTexture,this.items[e]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[e]=t,this},e.prototype.upload=function(t,r,n){for(var i=this.itemDirtyIds,o=0;o<e.SIDES;o++){var s=this.items[o];i[o]<s.dirtyId&&(s.valid&&s.resource?(s.resource.upload(t,s,n),i[o]=s.dirtyId):i[o]<-1&&(t.gl.texImage2D(s.target,0,n.internalFormat,r.realWidth,r.realHeight,0,r.format,n.type,null),i[o]=-1))}return!0},e.test=function(t){return Array.isArray(t)&&t.length===e.SIDES},e.SIDES=6,e}(fr),yr=function(t){function e(e,r){var n=this;if(r=r||{},!(e instanceof HTMLImageElement)){var i=new Image;mr.crossOrigin(i,e,r.crossorigin),i.src=e,e=i}return n=t.call(this,e)||this,!e.complete&&n._width&&n._height&&(n._width=0,n._height=0),n.url=e.src,n._process=null,n.preserveBitmap=!1,n.createBitmap=(void 0!==r.createBitmap?r.createBitmap:rt.CREATE_IMAGE_BITMAP)&&!!self.createImageBitmap,n.alphaMode="number"==typeof r.alphaMode?r.alphaMode:null,n.bitmap=null,n._load=null,!1!==r.autoLoad&&n.load(),n}return ar(e,t),e.prototype.load=function(t){var e=this;return this._load||(void 0!==t&&(this.createBitmap=t),this._load=new Promise((function(t,r){var n=e.source;e.url=n.src;var i=function(){e.destroyed||(n.onload=null,n.onerror=null,e.resize(n.width,n.height),e._load=null,e.createBitmap?t(e.process()):t(e))};n.complete&&n.src?i():(n.onload=i,n.onerror=function(t){r(t),e.onError.emit(t)})}))),this._load},e.prototype.process=function(){var t=this,e=this.source;if(null!==this._process)return this._process;if(null!==this.bitmap||!self.createImageBitmap)return Promise.resolve(this);var r=self.createImageBitmap,n=!e.crossOrigin||"anonymous"===e.crossOrigin;return this._process=fetch(e.src,{mode:n?"cors":"no-cors"}).then((function(t){return t.blob()})).then((function(n){return r(n,0,0,e.width,e.height,{premultiplyAlpha:t.alphaMode===f.UNPACK?"premultiply":"none"})})).then((function(e){return t.destroyed?Promise.reject():(t.bitmap=e,t.update(),t._process=null,Promise.resolve(t))})),this._process},e.prototype.upload=function(e,r,n){if("number"==typeof this.alphaMode&&(r.alphaMode=this.alphaMode),!this.createBitmap)return t.prototype.upload.call(this,e,r,n);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(t.prototype.upload.call(this,e,r,n,this.bitmap),!this.preserveBitmap){var i=!0,o=r._glTextures;for(var s in o){var a=o[s];if(a!==n&&a.dirtyId!==r.dirtyId){i=!1;break}}i&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},e.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,t.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},e.test=function(t){return"string"==typeof t||t instanceof HTMLImageElement},e}(mr),br=function(t){function e(e,r){var n=this;return r=r||{},(n=t.call(this,document.createElement("canvas"))||this)._width=0,n._height=0,n.svg=e,n.scale=r.scale||1,n._overrideWidth=r.width,n._overrideHeight=r.height,n._resolve=null,n._crossorigin=r.crossorigin,n._load=null,!1!==r.autoLoad&&n.load(),n}return ar(e,t),e.prototype.load=function(){var t=this;return this._load||(this._load=new Promise((function(e){if(t._resolve=function(){t.resize(t.source.width,t.source.height),e(t)},/^\<svg/.test(t.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");t.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.svg)))}t._loadSvg()}))),this._load},e.prototype._loadSvg=function(){var t=this,e=new Image;mr.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=function(r){t._resolve&&(e.onerror=null,t.onError.emit(r))},e.onload=function(){if(t._resolve){var r=e.width,n=e.height;if(!r||!n)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var i=r*t.scale,o=n*t.scale;(t._overrideWidth||t._overrideHeight)&&(i=t._overrideWidth||t._overrideHeight/n*r,o=t._overrideHeight||t._overrideWidth/r*n),i=Math.round(i),o=Math.round(o);var s=t.source;s.width=i,s.height=o,s._pixiId="canvas_"+Te(),s.getContext("2d").drawImage(e,0,0,r,n,0,0,i,o),t._resolve(),t._resolve=null}}},e.getSize=function(t){var r=e.SVG_SIZE.exec(t),n={};return r&&(n[r[1]]=Math.round(parseFloat(r[3])),n[r[5]]=Math.round(parseFloat(r[7]))),n},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},e.test=function(t,r){return"svg"===r||"string"==typeof t&&/^data:image\/svg\+xml(;(charset=utf8|utf8))?;base64/.test(t)||"string"==typeof t&&e.SVG_XML.test(t)},e.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,e.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,e}(mr),_r=function(t){function e(r,n){var i=this;if(n=n||{},!(r instanceof HTMLVideoElement)){var o=document.createElement("video");o.setAttribute("preload","auto"),o.setAttribute("webkit-playsinline",""),o.setAttribute("playsinline",""),"string"==typeof r&&(r=[r]);var s=r[0].src||r[0];mr.crossOrigin(o,s,n.crossorigin);for(var a=0;a<r.length;++a){var h=document.createElement("source"),u=r[a],l=u.src,c=u.mime,d=(l=l||r[a]).split("?").shift().toLowerCase(),f=d.substr(d.lastIndexOf(".")+1);c=c||e.MIME_TYPES[f]||"video/"+f,h.src=l,h.type=c,o.appendChild(h)}r=o}return(i=t.call(this,r)||this).noSubImage=!0,i._autoUpdate=!0,i._isConnectedToTicker=!1,i._updateFPS=n.updateFPS||0,i._msToNextUpdate=0,i.autoPlay=!1!==n.autoPlay,i._load=null,i._resolve=null,i._onCanPlay=i._onCanPlay.bind(i),i._onError=i._onError.bind(i),!1!==n.autoLoad&&i.load(),i}return ar(e,t),e.prototype.update=function(e){if(!this.destroyed){var r=Ue.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-r),(!this._updateFPS||this._msToNextUpdate<=0)&&(t.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((function(r){t.valid?r(t):(t._resolve=r,e.load())})),this._load},e.prototype._onError=function(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t)},e.prototype._isSourcePlaying=function(){var t=this.source;return t.currentTime>0&&!1===t.paused&&!1===t.ended&&t.readyState>2},e.prototype._isSourceReady=function(){var t=this.source;return 3===t.readyState||4===t.readyState},e.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Ue.shared.add(this.update,this),this._isConnectedToTicker=!0)},e.prototype._onPlayStop=function(){this._isConnectedToTicker&&(Ue.shared.remove(this.update,this),this._isConnectedToTicker=!1)},e.prototype._onCanPlay=function(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},e.prototype.dispose=function(){this._isConnectedToTicker&&(Ue.shared.remove(this.update,this),this._isConnectedToTicker=!1);var e=this.source;e&&(e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),t.prototype.dispose.call(this)},Object.defineProperty(e.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Ue.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Ue.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(t){t!==this._updateFPS&&(this._updateFPS=t)},enumerable:!1,configurable:!0}),e.test=function(t,r){return self.HTMLVideoElement&&t instanceof HTMLVideoElement||e.TYPES.indexOf(r)>-1},e.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],e.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},e}(mr),Er=function(t){function e(e){return t.call(this,e)||this}return ar(e,t),e.test=function(t){return!!self.createImageBitmap&&t instanceof ImageBitmap},e}(mr);ir.push(yr,Er,gr,_r,br,lr,vr,pr);var xr={__proto__:null,Resource:ur,BaseImageResource:mr,INSTALLED:ir,autoDetectResource:or,AbstractMultiResource:fr,ArrayResource:pr,BufferResource:lr,CanvasResource:gr,CubeResource:vr,ImageResource:yr,SVGResource:br,VideoResource:_r,ImageBitmapResource:Er},Tr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ar(e,t),e.prototype.upload=function(t,e,r){var n=t.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===f.UNPACK);var i=e.realWidth,o=e.realHeight;return r.width===i&&r.height===o?n.texSubImage2D(e.target,0,0,0,i,o,e.format,r.type,this.data):(r.width=i,r.height=o,n.texImage2D(e.target,0,r.internalFormat,i,o,0,e.format,r.type,this.data)),!0},e}(lr),wr=function(){function t(t,e){this.width=Math.round(t||100),this.height=Math.round(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Pe("disposeFramebuffer"),this.multisample=y.NONE}return Object.defineProperty(t.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),t.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),this.colorTextures[t]=e||new dr(null,{scaleMode:l.NEAREST,resolution:1,mipmap:d.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},t.prototype.addDepthTexture=function(t){return this.depthTexture=t||new dr(new Tr(null,{width:this.width,height:this.height}),{scaleMode:l.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:d.OFF,format:s.DEPTH_COMPONENT,type:h.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},t.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},t.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},t.prototype.resize=function(t,e){if(t=Math.round(t),e=Math.round(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var r=0;r<this.colorTextures.length;r++){var n=this.colorTextures[r],i=n.resolution;n.setSize(t/i,e/i)}if(this.depthTexture){i=this.depthTexture.resolution;this.depthTexture.setSize(t/i,e/i)}}},t.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},t.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},t}(),Ar=function(t){function e(e){var r=this;if("number"==typeof e){var n=arguments[0],i=arguments[1],o=arguments[2],s=arguments[3];e={width:n,height:i,scaleMode:o,resolution:s}}return e.width=e.width||100,e.height=e.height||100,e.multisample=void 0!==e.multisample?e.multisample:y.NONE,(r=t.call(this,null,e)||this).mipmap=d.OFF,r.valid=!0,r.clearColor=[0,0,0,0],r.framebuffer=new wr(r.realWidth,r.realHeight).addColorTexture(0,r),r.framebuffer.multisample=e.multisample,r.maskStack=[],r.filterStack=[{}],r}return ar(e,t),e.prototype.resize=function(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)},e.prototype.dispose=function(){this.framebuffer.dispose(),t.prototype.dispose.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},e}(dr),Sr=function(){function t(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return t.prototype.set=function(t,e,r){var n=e.width,i=e.height;if(r){var o=t.width/2/n,s=t.height/2/i,a=t.x/n+o,h=t.y/i+s;r=rr.add(r,rr.NW),this.x0=a+o*rr.uX(r),this.y0=h+s*rr.uY(r),r=rr.add(r,2),this.x1=a+o*rr.uX(r),this.y1=h+s*rr.uY(r),r=rr.add(r,2),this.x2=a+o*rr.uX(r),this.y2=h+s*rr.uY(r),r=rr.add(r,2),this.x3=a+o*rr.uX(r),this.y3=h+s*rr.uY(r)}else this.x0=t.x/n,this.y0=t.y/i,this.x1=(t.x+t.width)/n,this.y1=t.y/i,this.x2=(t.x+t.width)/n,this.y2=(t.y+t.height)/i,this.x3=t.x/n,this.y3=(t.y+t.height)/i;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},t.prototype.toString=function(){return"[@pixi/core:TextureUvs x0="+this.x0+" y0="+this.y0+" x1="+this.x1+" y1="+this.y1+" x2="+this.x2+" y2="+this.y2+" x3="+this.x3+" y3="+this.y3+"]"},t}(),Or=new Sr,Ir=function(t){function e(r,n,i,o,s,a){var h=t.call(this)||this;if(h.noFrame=!1,n||(h.noFrame=!0,n=new je(0,0,1,1)),r instanceof e&&(r=r.baseTexture),h.baseTexture=r,h._frame=n,h.trim=o,h.valid=!1,h._uvs=Or,h.uvMatrix=null,h.orig=i||n,h._rotate=Number(s||0),!0===s)h._rotate=2;else if(h._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return h.defaultAnchor=a?new We(a.x,a.y):new We(0,0),h._updateID=0,h.textureCacheIds=[],r.valid?h.noFrame?r.valid&&h.onBaseTextureUpdated(r):h.frame=n:r.once("loaded",h.onBaseTextureUpdated,h),h.noFrame&&r.on("update",h.onBaseTextureUpdated,h),h}return ar(e,t),e.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},e.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},e.prototype.destroy=function(t){if(this.baseTexture){if(t){var r=this.baseTexture.resource;r&&r.url&&Ie[r.url]&&e.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){var t=this._frame.clone(),r=this._frame===this.orig?t:this.orig.clone(),n=new e(this.baseTexture,!this.noFrame&&t,r,this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(n._frame=t),n},e.prototype.updateUvs=function(){this._uvs===Or&&(this._uvs=new Sr),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.from=function(t,r,n){void 0===r&&(r={}),void 0===n&&(n=rt.STRICT_TEXTURE_CACHE);var i="string"==typeof t,o=null;if(i)o=t;else{if(!t._pixiId){var s=r&&r.pixiIdPrefix||"pixiid";t._pixiId=s+"_"+Te()}o=t._pixiId}var a=Ie[o];if(i&&n&&!a)throw new Error('The cacheId "'+o+'" does not exist in TextureCache.');return a||(r.resolution||(r.resolution=Le(t)),(a=new e(new dr(t,r))).baseTexture.cacheId=o,dr.addToCache(a.baseTexture,o),e.addToCache(a,o)),a},e.fromURL=function(t,r){var n=Object.assign({autoLoad:!1},null==r?void 0:r.resourceOptions),i=e.from(t,Object.assign({resourceOptions:n},r),!1),o=i.baseTexture.resource;return i.baseTexture.valid?Promise.resolve(i):o.load().then((function(){return Promise.resolve(i)}))},e.fromBuffer=function(t,r,n,i){return new e(dr.fromBuffer(t,r,n,i))},e.fromLoader=function(t,r,n,i){var o=new dr(t,Object.assign({scaleMode:rt.SCALE_MODE,resolution:Le(r)},i)),s=o.resource;s instanceof yr&&(s.url=r);var a=new e(o);return n||(n=r),dr.addToCache(a.baseTexture,n),e.addToCache(a,n),n!==r&&(dr.addToCache(a.baseTexture,r),e.addToCache(a,r)),a.baseTexture.valid?Promise.resolve(a):new Promise((function(t){a.baseTexture.once("loaded",(function(){return t(a)}))}))},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Ie[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),Ie[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=Ie[t];if(e){var r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete Ie[t],e}}else if(t&&t.textureCacheIds){for(var n=0;n<t.textureCacheIds.length;++n)Ie[t.textureCacheIds[n]]===t&&delete Ie[t.textureCacheIds[n]];return t.textureCacheIds.length=0,t}return null},Object.defineProperty(e.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frame",{get:function(){return this._frame},set:function(t){this._frame=t,this.noFrame=!1;var e=t.x,r=t.y,n=t.width,i=t.height,o=e+n>this.baseTexture.width,s=r+i>this.baseTexture.height;if(o||s){var a=o&&s?"and":"or",h="X: "+e+" + "+n+" = "+(e+n)+" > "+this.baseTexture.width,u="Y: "+r+" + "+i+" = "+(r+i)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u)}this.valid=n&&i&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotate",{get:function(){return this._rotate},set:function(t){this._rotate=t,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),e.prototype.castToBaseTexture=function(){return this.baseTexture},e}(ot);function Rr(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}Ir.EMPTY=new Ir(new dr),Rr(Ir.EMPTY),Rr(Ir.EMPTY.baseTexture),Ir.WHITE=function(){var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new Ir(new dr(new gr(t)))}(),Rr(Ir.WHITE),Rr(Ir.WHITE.baseTexture);var Nr=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.valid=!0,n.filterFrame=null,n.filterPoolKey=null,n.updateUvs(),n}return ar(e,t),Object.defineProperty(e.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"multisample",{get:function(){return this.framebuffer.multisample},set:function(t){this.framebuffer.multisample=t},enumerable:!1,configurable:!0}),e.prototype.resize=function(t,e,r){void 0===r&&(r=!0);var n=this.baseTexture.resolution,i=Math.round(t*n)/n,o=Math.round(e*n)/n;this.valid=i>0&&o>0,this._frame.width=this.orig.width=i,this._frame.height=this.orig.height=o,r&&this.baseTexture.resize(i,o),this.updateUvs()},e.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},e.create=function(t){for(var r=arguments,n=[],i=1;i<arguments.length;i++)n[i-1]=r[i];return"number"==typeof t&&(Ae("6.0.0","Arguments (width, height, scaleMode, resolution) have been deprecated."),t={width:t,height:n[0],scaleMode:n[1],resolution:n[2]}),new e(new Ar(t))},e}(Ir),Lr=function(){function t(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return t.prototype.createTexture=function(t,e,r){void 0===r&&(r=y.NONE);var n=new Ar(Object.assign({width:t,height:e,resolution:1,multisample:r},this.textureOptions));return new Nr(n)},t.prototype.getOptimalTexture=function(t,e,r,n){var i;void 0===r&&(r=1),void 0===n&&(n=y.NONE),t=Math.ceil(t*r),e=Math.ceil(e*r),this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight?i=n>1?-n:-1:(i=((65535&(t=ve(t)))<<16|65535&(e=ve(e)))>>>0,n>1&&(i+=4294967296*n)),this.texturePool[i]||(this.texturePool[i]=[]);var o=this.texturePool[i].pop();return o||(o=this.createTexture(t,e,n)),o.filterPoolKey=i,o.setResolution(r),o},t.prototype.getFilterTexture=function(t,e,r){var n=this.getOptimalTexture(t.width,t.height,e||t.resolution,r||y.NONE);return n.filterFrame=t.filterFrame,n},t.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},t.prototype.returnFilterTexture=function(t){this.returnTexture(t)},t.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){var r=this.texturePool[e];if(r)for(var n=0;n<r.length;n++)r[n].destroy(!0)}this.texturePool={}},t.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){for(var e in this.enableFullScreen=t.width>0&&t.height>0,this.texturePool)if(Number(e)<0){var r=this.texturePool[e];if(r)for(var n=0;n<r.length;n++)r[n].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}},t.SCREEN_KEY=-1,t}(),Mr=function(){function t(t,e,r,n,i,o,s){void 0===e&&(e=0),void 0===r&&(r=!1),void 0===n&&(n=h.FLOAT),this.buffer=t,this.size=e,this.normalized=r,this.type=n,this.stride=i,this.start=o,this.instance=s}return t.prototype.destroy=function(){this.buffer=null},t.from=function(e,r,n,i,o){return new t(e,r,n,i,o)},t}(),Pr=0,Cr=function(){function t(t,e,r){void 0===e&&(e=!0),void 0===r&&(r=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=e,this.id=Pr++,this.disposeRunner=new Pe("disposeBuffer")}return t.prototype.update=function(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++},t.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},t.prototype.destroy=function(){this.dispose(),this.data=null},Object.defineProperty(t.prototype,"index",{get:function(){return this.type===b.ELEMENT_ARRAY_BUFFER},set:function(t){this.type=t?b.ELEMENT_ARRAY_BUFFER:b.ARRAY_BUFFER},enumerable:!1,configurable:!0}),t.from=function(e){return e instanceof Array&&(e=new Float32Array(e)),new t(e)},t}(),Dr={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};var Ur={5126:4,5123:2,5121:1},Br=0,Fr={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},kr=function(){function t(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=Br++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Pe("disposeGeometry"),this.refCount=0}return t.prototype.addAttribute=function(t,e,r,n,i,o,s,a){if(void 0===r&&(r=0),void 0===n&&(n=!1),void 0===a&&(a=!1),!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof Cr||(e instanceof Array&&(e=new Float32Array(e)),e=new Cr(e));var h=t.split("|");if(h.length>1){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,r,n,i);return this}var l=this.buffers.indexOf(e);return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new Mr(l,r,n,i,o,s,a),this.instanced=this.instanced||a,this},t.prototype.getAttribute=function(t){return this.attributes[t]},t.prototype.getBuffer=function(t){return this.buffers[this.getAttribute(t).buffer]},t.prototype.addIndex=function(t){return t instanceof Cr||(t instanceof Array&&(t=new Uint16Array(t)),t=new Cr(t)),t.type=b.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},t.prototype.getIndex=function(){return this.indexBuffer},t.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],r=[],n=new Cr;for(t in this.attributes){var i=this.attributes[t],o=this.buffers[i.buffer];e.push(o.data),r.push(i.size*Ur[i.type]/4),i.buffer=0}for(n.data=function(t,e){for(var r=0,n=0,i={},o=0;o<t.length;o++)n+=e[o],r+=t[o].length;var s=new ArrayBuffer(4*r),a=null,h=0;for(o=0;o<t.length;o++){var u=e[o],l=t[o],c=ge(l);i[c]||(i[c]=new Dr[c](s)),a=i[c];for(var d=0;d<l.length;d++)a[(d/u|0)*n+h+d%u]=l[d];h+=u}return new Float32Array(s)}(e,r),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[n],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},t.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},t.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},t.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},t.prototype.clone=function(){for(var e=new t,r=0;r<this.buffers.length;r++)e.buffers[r]=new Cr(this.buffers[r].data.slice(0));for(var r in this.attributes){var n=this.attributes[r];e.attributes[r]=new Mr(n.buffer,n.size,n.normalized,n.type,n.stride,n.start,n.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=b.ELEMENT_ARRAY_BUFFER),e},t.merge=function(e){for(var r,n=new t,i=[],o=[],s=[],a=0;a<e.length;a++){r=e[a];for(var h=0;h<r.buffers.length;h++)o[h]=o[h]||0,o[h]+=r.buffers[h].data.length,s[h]=0}for(a=0;a<r.buffers.length;a++)i[a]=new(Fr[ge(r.buffers[a].data)])(o[a]),n.buffers[a]=new Cr(i[a]);for(a=0;a<e.length;a++){r=e[a];for(h=0;h<r.buffers.length;h++)i[h].set(r.buffers[h].data,s[h]),s[h]+=r.buffers[h].data.length}if(n.attributes=r.attributes,r.indexBuffer){n.indexBuffer=n.buffers[r.buffers.indexOf(r.indexBuffer)],n.indexBuffer.type=b.ELEMENT_ARRAY_BUFFER;var u=0,l=0,c=0,d=0;for(a=0;a<r.buffers.length;a++)if(r.buffers[a]!==r.indexBuffer){d=a;break}for(var a in r.attributes){var f=r.attributes[a];(0|f.buffer)===d&&(l+=f.size*Ur[f.type]/4)}for(a=0;a<e.length;a++){var p=e[a].indexBuffer.data;for(h=0;h<p.length;h++)n.indexBuffer.data[h+c]+=u;u+=e[a].buffers[d].data.length/l,c+=p.length}}return n},t}(),Gr=function(t){function e(){var e=t.call(this)||this;return e.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),e}return ar(e,t),e}(kr),jr=function(t){function e(){var e=t.call(this)||this;return e.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),e.uvs=new Float32Array([0,0,1,0,1,1,0,1]),e.vertexBuffer=new Cr(e.vertices),e.uvBuffer=new Cr(e.uvs),e.addAttribute("aVertexPosition",e.vertexBuffer).addAttribute("aTextureCoord",e.uvBuffer).addIndex([0,1,2,0,2,3]),e}return ar(e,t),e.prototype.map=function(t,e){var r=0,n=0;return this.uvs[0]=r,this.uvs[1]=n,this.uvs[2]=r+e.width/t.width,this.uvs[3]=n,this.uvs[4]=r+e.width/t.width,this.uvs[5]=n+e.height/t.height,this.uvs[6]=r,this.uvs[7]=n+e.height/t.height,r=e.x,n=e.y,this.vertices[0]=r,this.vertices[1]=n,this.vertices[2]=r+e.width,this.vertices[3]=n,this.vertices[4]=r+e.width,this.vertices[5]=n+e.height,this.vertices[6]=r,this.vertices[7]=n+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(kr),Hr=0,Xr=function(){function t(t,e,r){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=Hr++,this.static=!!e,this.ubo=!!r,t instanceof Cr?(this.buffer=t,this.buffer.type=b.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new Cr(new Float32Array(1)),this.buffer.type=b.UNIFORM_BUFFER,this.autoManage=!0))}return t.prototype.update=function(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()},t.prototype.add=function(e,r,n){if(this.ubo)throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[e]=new t(r,n)},t.from=function(e,r,n){return new t(e,r,n)},t.uboFrom=function(e,r){return new t(e,null==r||r,!0)},t}(),zr=function(){function t(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=y.NONE,this.sourceFrame=new je,this.destinationFrame=new je,this.bindingSourceFrame=new je,this.bindingDestinationFrame=new je,this.filters=[],this.transform=null}return t.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},t}(),Vr=[new We,new We,new We,new We],Wr=new qe,Yr=function(){function t(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new Lr,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new Gr,this.quadUv=new jr,this.tempRect=new je,this.activeState={},this.globalUniforms=new Xr({outputFrame:new je,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return t.prototype.push=function(t,e){for(var r=this.renderer,n=this.defaultFilterStack,i=this.statePool.pop()||new zr,o=this.renderer.renderTexture,s=e[0].resolution,a=e[0].multisample,h=e[0].padding,u=e[0].autoFit,l=e[0].legacy,c=1;c<e.length;c++){var d=e[c];s=Math.min(s,d.resolution),a=Math.min(a,d.multisample),h=this.useMaxPadding?Math.max(h,d.padding):h+d.padding,u=u&&d.autoFit,l=l||d.legacy}if(1===n.length&&(this.defaultFilterStack[0].renderTexture=o.current),n.push(i),i.resolution=s,i.multisample=a,i.legacy=l,i.target=t,i.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),i.sourceFrame.pad(h),u){var f=this.tempRect.copyFrom(o.sourceFrame);r.projection.transform&&this.transformAABB(Wr.copyFrom(r.projection.transform).invert(),f),i.sourceFrame.fit(f)}this.roundFrame(i.sourceFrame,o.current?o.current.resolution:r.resolution,o.sourceFrame,o.destinationFrame,r.projection.transform),i.renderTexture=this.getOptimalFilterTexture(i.sourceFrame.width,i.sourceFrame.height,s,a),i.filters=e,i.destinationFrame.width=i.renderTexture.width,i.destinationFrame.height=i.renderTexture.height;var p=this.tempRect;p.x=0,p.y=0,p.width=i.sourceFrame.width,p.height=i.sourceFrame.height,i.renderTexture.filterFrame=i.sourceFrame,i.bindingSourceFrame.copyFrom(o.sourceFrame),i.bindingDestinationFrame.copyFrom(o.destinationFrame),i.transform=r.projection.transform,r.projection.transform=null,o.bind(i.renderTexture,i.sourceFrame,p),r.framebuffer.clear(0,0,0,0)},t.prototype.pop=function(){var t=this.defaultFilterStack,e=t.pop(),r=e.filters;this.activeState=e;var n=this.globalUniforms.uniforms;n.outputFrame=e.sourceFrame,n.resolution=e.resolution;var i=n.inputSize,o=n.inputPixel,s=n.inputClamp;if(i[0]=e.destinationFrame.width,i[1]=e.destinationFrame.height,i[2]=1/i[0],i[3]=1/i[1],o[0]=Math.round(i[0]*e.resolution),o[1]=Math.round(i[1]*e.resolution),o[2]=1/o[0],o[3]=1/o[1],s[0]=.5*o[2],s[1]=.5*o[3],s[2]=e.sourceFrame.width*i[2]-.5*o[2],s[3]=e.sourceFrame.height*i[3]-.5*o[3],e.legacy){var a=n.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,n.filterClamp=n.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(this.renderer.framebuffer.blit(),1===r.length)r[0].apply(this,e.renderTexture,h.renderTexture,p.BLEND,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<r.length-1;++c){1===c&&e.multisample>1&&((l=this.getOptimalFilterTexture(u.width,u.height,e.resolution)).filterFrame=u.filterFrame),r[c].apply(this,u,l,p.CLEAR,e);var d=u;u=l,l=d}r[c].apply(this,u,h.renderTexture,p.BLEND,e),c>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},t.prototype.bindAndClear=function(t,e){void 0===e&&(e=p.CLEAR);var r=this.renderer,n=r.renderTexture,i=r.state;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t&&t.filterFrame){var o=this.tempRect;o.x=0,o.y=0,o.width=t.filterFrame.width,o.height=t.filterFrame.height,n.bind(t,t.filterFrame,o)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?n.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);var s=1&i.stateId||this.forceClear;(e===p.CLEAR||e===p.BLIT&&s)&&this.renderer.framebuffer.clear(0,0,0,0)},t.prototype.applyFilter=function(t,e,r,n){var i=this.renderer;i.state.set(t.state),this.bindAndClear(r,n),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,i.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),i.geometry.bind(this.quadUv),i.geometry.draw(o.TRIANGLES)):(i.geometry.bind(this.quad),i.geometry.draw(o.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(t,e){var r=this.activeState,n=r.sourceFrame,i=r.destinationFrame,o=e._texture.orig,s=t.set(i.width,0,0,i.height,n.x,n.y),a=e.worldTransform.copyTo(qe.TEMP_MATRIX);return a.invert(),s.prepend(a),s.scale(1/o.width,1/o.height),s.translate(e.anchor.x,e.anchor.y),s},t.prototype.destroy=function(){this.renderer=null,this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(t,e,r,n){return void 0===r&&(r=1),void 0===n&&(n=y.NONE),this.texturePool.getOptimalTexture(t,e,r,n)},t.prototype.getFilterTexture=function(t,e,r){if("number"==typeof t){var n=t;t=e,e=n}t=t||this.activeState.renderTexture;var i=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,r||y.NONE);return i.filterFrame=t.filterFrame,i},t.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},t.prototype.transformAABB=function(t,e){var r=Vr[0],n=Vr[1],i=Vr[2],o=Vr[3];r.set(e.left,e.top),n.set(e.left,e.bottom),i.set(e.right,e.top),o.set(e.right,e.bottom),t.apply(r,r),t.apply(n,n),t.apply(i,i),t.apply(o,o);var s=Math.min(r.x,n.x,i.x,o.x),a=Math.min(r.y,n.y,i.y,o.y),h=Math.max(r.x,n.x,i.x,o.x),u=Math.max(r.y,n.y,i.y,o.y);e.x=s,e.y=a,e.width=h-s,e.height=u-a},t.prototype.roundFrame=function(t,e,r,n,i){if(i){var o=i.a,s=i.b,a=i.c,h=i.d;if((Math.abs(s)>1e-4||Math.abs(a)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(h)>1e-4))return}(i=i?Wr.copyFrom(i):Wr.identity()).translate(-r.x,-r.y).scale(n.width/r.width,n.height/r.height).translate(n.x,n.y),this.transformAABB(i,t),t.ceil(e),this.transformAABB(i.invert(),t)},t}(),qr=function(){function t(t){this.renderer=t}return t.prototype.flush=function(){},t.prototype.destroy=function(){this.renderer=null},t.prototype.start=function(){},t.prototype.stop=function(){this.flush()},t.prototype.render=function(t){},t}(),Kr=function(){function t(t){this.renderer=t,this.emptyRenderer=new qr(t),this.currentRenderer=this.emptyRenderer}return t.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.copyBoundTextures=function(t,e){for(var r=this.renderer.texture.boundTextures,n=e-1;n>=0;--n)t[n]=r[n]||null,t[n]&&(t[n]._batchLocation=n)},t.prototype.boundArray=function(t,e,r,n){for(var i=t.elements,o=t.ids,s=t.count,a=0,h=0;h<s;h++){var u=i[h],l=u._batchLocation;if(l>=0&&l<n&&e[l]===u)o[h]=l;else for(;a<n;){var c=e[a];if(!c||c._batchEnabled!==r||c._batchLocation!==a){o[h]=a,u._batchLocation=a,e[a]=u;break}a++}}},t.prototype.destroy=function(){this.renderer=null},t}(),Zr=0,Jr=function(){function t(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),t.view.addEventListener("webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}return Object.defineProperty(t.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),t.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=Zr++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext()},t.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=Zr++,this.renderer.runners.contextChange.emit(t)},t.prototype.initFromOptions=function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},t.prototype.createContext=function(t,r){var n;if(rt.PREFER_ENV>=e.WEBGL2&&(n=t.getContext("webgl2",r)),n)this.webGLVersion=2;else if(this.webGLVersion=1,!(n=t.getContext("webgl",r)||t.getContext("experimental-webgl",r)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=n,this.getExtensions(),this.gl},t.prototype.getExtensions=function(){var t=this.gl,e={anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};1===this.webGLVersion?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})},t.prototype.handleContextLost=function(t){t.preventDefault()},t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},t.prototype.destroy=function(){var t=this.renderer.view;this.renderer=null,t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},t.prototype.validateContext=function(t){var e=t.getContextAttributes(),r="WebGL2RenderingContext"in self&&t instanceof self.WebGL2RenderingContext;r&&(this.webGLVersion=2),e.stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var n=r||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=n,n||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},t}(),Qr=function(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=y.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0},$r=new je,tn=function(){function t(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new wr(10,10),this.msaaSamples=null}return t.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new je,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var r=this.renderer.context.extensions.drawBuffers,n=this.renderer.context.extensions.depthTexture;rt.PREFER_ENV===e.WEBGL_LEGACY&&(r=null,n=null),r?t.drawBuffers=function(t){return r.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),n||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)},t.prototype.bind=function(t,e,r){void 0===r&&(r=0);var n=this.gl;if(t){var i=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,n.bindFramebuffer(n.FRAMEBUFFER,i.framebuffer)),i.mipLevel!==r&&(t.dirtyId++,t.dirtyFormat++,i.mipLevel=r),i.dirtyId!==t.dirtyId&&(i.dirtyId=t.dirtyId,i.dirtyFormat!==t.dirtyFormat?(i.dirtyFormat=t.dirtyFormat,i.dirtySize=t.dirtySize,this.updateFramebuffer(t,r)):i.dirtySize!==t.dirtySize&&(i.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var o=0;o<t.colorTextures.length;o++){var s=t.colorTextures[o];this.renderer.texture.unbind(s.parentTextureArray||s)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){var a=e.width>>r,h=e.height>>r,u=a/e.width;this.setViewport(e.x*u,e.y*u,a,h)}else{a=t.width>>r,h=t.height>>r;this.setViewport(0,0,a,h)}}else this.current&&(this.current=null,n.bindFramebuffer(n.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},t.prototype.setViewport=function(t,e,r,n){var i=this.viewport;t=Math.round(t),e=Math.round(e),r=Math.round(r),n=Math.round(n),i.width===r&&i.height===n&&i.x===t&&i.y===e||(i.x=t,i.y=e,i.width=r,i.height=n,this.gl.viewport(t,e,r,n))},Object.defineProperty(t.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),t.prototype.clear=function(t,e,r,i,o){void 0===o&&(o=n.COLOR|n.DEPTH);var s=this.gl;s.clearColor(t,e,r,i),s.clear(o)},t.prototype.initFramebuffer=function(t){var e=this.gl,r=new Qr(e.createFramebuffer());return r.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=r,this.managedFramebuffers.push(t),t.disposeRunner.add(this),r},t.prototype.resizeFramebuffer=function(t){var e=this.gl,r=t.glFramebuffers[this.CONTEXT_UID];r.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,r.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,r.multisample,e.RGBA8,t.width,t.height)),r.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,r.stencil),r.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,r.multisample,e.DEPTH24_STENCIL8,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));var n=t.colorTextures,i=n.length;e.drawBuffers||(i=Math.min(i,1));for(var o=0;o<i;o++){var s=n[o],a=s.parentTextureArray||s;this.renderer.texture.bind(a,0)}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)},t.prototype.updateFramebuffer=function(t,e){var r=this.gl,n=t.glFramebuffers[this.CONTEXT_UID],i=t.colorTextures,o=i.length;r.drawBuffers||(o=Math.min(o,1)),n.multisample>1&&this.canMultisampleFramebuffer(t)?(n.msaaBuffer=n.msaaBuffer||r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,n.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,n.multisample,r.RGBA8,t.width,t.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.RENDERBUFFER,n.msaaBuffer)):n.msaaBuffer&&(r.deleteRenderbuffer(n.msaaBuffer),n.msaaBuffer=null);for(var s=[],a=0;a<o;a++){var h=i[a],u=h.parentTextureArray||h;this.renderer.texture.bind(u,0),0===a&&n.msaaBuffer||(r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+a,h.target,u._glTextures[this.CONTEXT_UID].texture,e),s.push(r.COLOR_ATTACHMENT0+a))}if((s.length>1&&r.drawBuffers(s),t.depthTexture)&&this.writeDepthTexture){var l=t.depthTexture;this.renderer.texture.bind(l,0),r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,l._glTextures[this.CONTEXT_UID].texture,e)}!t.stencil&&!t.depth||t.depthTexture&&this.writeDepthTexture?n.stencil&&(r.deleteRenderbuffer(n.stencil),n.stencil=null):(n.stencil=n.stencil||r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,n.stencil),n.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,n.multisample,r.DEPTH24_STENCIL8,t.width,t.height):r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,t.width,t.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,n.stencil))},t.prototype.canMultisampleFramebuffer=function(t){return 1!==this.renderer.context.webGLVersion&&t.colorTextures.length<=1&&!t.depthTexture},t.prototype.detectSamples=function(t){var e=this.msaaSamples,r=y.NONE;if(t<=1||null===e)return r;for(var n=0;n<e.length;n++)if(e[n]<=t){r=e[n];break}return 1===r&&(r=y.NONE),r},t.prototype.blit=function(t,e,r){var n=this,i=n.current,o=n.renderer,s=n.gl,a=n.CONTEXT_UID;if(2===o.context.webGLVersion&&i){var h=i.glFramebuffers[a];if(h){if(!t){if(!h.msaaBuffer)return;h.blitFramebuffer||(h.blitFramebuffer=new wr(i.width,i.height),h.blitFramebuffer.addColorTexture(0,i.colorTextures[0])),(t=h.blitFramebuffer).width=i.width,t.height=i.height}e||((e=$r).width=i.width,e.height=i.height),r||(r=e);var u=e.width===r.width&&e.height===r.height;this.bind(t),s.bindFramebuffer(s.READ_FRAMEBUFFER,h.framebuffer),s.blitFramebuffer(e.x,e.y,e.width,e.height,r.x,r.y,r.width,r.height,s.COLOR_BUFFER_BIT,u?s.NEAREST:s.LINEAR)}}},t.prototype.disposeFramebuffer=function(t,e){var r=t.glFramebuffers[this.CONTEXT_UID],n=this.gl;if(r){delete t.glFramebuffers[this.CONTEXT_UID];var i=this.managedFramebuffers.indexOf(t);i>=0&&this.managedFramebuffers.splice(i,1),t.disposeRunner.remove(this),e||(n.deleteFramebuffer(r.framebuffer),r.msaaBuffer&&n.deleteRenderbuffer(r.msaaBuffer),r.stencil&&n.deleteRenderbuffer(r.stencil))}},t.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var r=0;r<e.length;r++)this.disposeFramebuffer(e[r],t)},t.prototype.forceStencil=function(){var t=this.current;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.stencil=!0;var r=t.width,n=t.height,i=this.gl,o=i.createRenderbuffer();i.bindRenderbuffer(i.RENDERBUFFER,o),e.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,e.multisample,i.DEPTH24_STENCIL8,r,n):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,r,n),e.stencil=o,i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,o)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new je},t.prototype.destroy=function(){this.renderer=null},t}(),en={5126:4,5123:2,5121:1},rn=function(){function t(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}return t.prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,r=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==r.webGLVersion){var n=this.renderer.context.extensions.vertexArrayObject;rt.PREFER_ENV===e.WEBGL_LEGACY&&(n=null),n?(t.createVertexArray=function(){return n.createVertexArrayOES()},t.bindVertexArray=function(t){return n.bindVertexArrayOES(t)},t.deleteVertexArray=function(t){return n.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){return null},t.bindVertexArray=function(){return null},t.deleteVertexArray=function(){return null})}if(2!==r.webGLVersion){var i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=function(t,e){return i.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,r,n,o){return i.drawElementsInstancedANGLE(t,e,r,n,o)},t.drawArraysInstanced=function(t,e,r,n){return i.drawArraysInstancedANGLE(t,e,r,n)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===r.webGLVersion||!!r.extensions.uint32ElementIndex},t.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var r=this.gl,n=t.glVertexArrayObjects[this.CONTEXT_UID],i=!1;n||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=n={},i=!0);var o=n[e.program.id]||this.initGeometryVao(t,e,i);this._activeGeometry=t,this._activeVao!==o&&(this._activeVao=o,this.hasVao?r.bindVertexArray(o):this.activateVao(t,e.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.renderer.buffer,r=0;r<t.buffers.length;r++){var n=t.buffers[r];e.update(n)}},t.prototype.checkCompatibility=function(t,e){var r=t.attributes,n=e.attributeData;for(var i in n)if(!r[i])throw new Error('shader and geometry incompatible, geometry missing the "'+i+'" attribute')},t.prototype.getSignature=function(t,e){var r=t.attributes,n=e.attributeData,i=["g",t.id];for(var o in r)n[o]&&i.push(o);return i.join("-")},t.prototype.initGeometryVao=function(t,e,r){void 0===r&&(r=!0);var n=this.gl,i=this.CONTEXT_UID,o=this.renderer.buffer,s=e.program;s.glPrograms[i]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,s);var a=this.getSignature(t,s),h=t.glVertexArrayObjects[this.CONTEXT_UID],u=h[a];if(u)return h[s.id]=u,u;var l=t.buffers,c=t.attributes,d={},f={};for(var p in l)d[p]=0,f[p]=0;for(var p in c)!c[p].size&&s.attributeData[p]?c[p].size=s.attributeData[p].size:c[p].size||console.warn("PIXI Geometry attribute '"+p+"' size cannot be determined (likely the bound shader does not have the attribute)"),d[c[p].buffer]+=c[p].size*en[c[p].type];for(var p in c){var m=c[p],g=m.size;void 0===m.stride&&(d[m.buffer]===g*en[m.type]?m.stride=0:m.stride=d[m.buffer]),void 0===m.start&&(m.start=f[m.buffer],f[m.buffer]+=g*en[m.type])}u=n.createVertexArray(),n.bindVertexArray(u);for(var v=0;v<l.length;v++){var y=l[v];o.bind(y),r&&y._glBuffers[i].refCount++}return this.activateVao(t,s),this._activeVao=u,h[s.id]=u,h[a]=u,u},t.prototype.disposeGeometry=function(t,e){var r;if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var n=t.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,o=t.buffers,s=null===(r=this.renderer)||void 0===r?void 0:r.buffer;if(t.disposeRunner.remove(this),n){if(s)for(var a=0;a<o.length;a++){var h=o[a]._glBuffers[this.CONTEXT_UID];h&&(h.refCount--,0!==h.refCount||e||s.dispose(o[a],e))}if(!e)for(var u in n)if("g"===u[0]){var l=n[u];this._activeVao===l&&this.unbind(),i.deleteVertexArray(l)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedGeometries),r=0;r<e.length;r++)this.disposeGeometry(this.managedGeometries[e[r]],t)},t.prototype.activateVao=function(t,e){var r=this.gl,n=this.CONTEXT_UID,i=this.renderer.buffer,o=t.buffers,s=t.attributes;t.indexBuffer&&i.bind(t.indexBuffer);var a=null;for(var h in s){var u=s[h],l=o[u.buffer],c=l._glBuffers[n];if(e.attributeData[h]){a!==c&&(i.bind(l),a=c);var d=e.attributeData[h].location;if(r.enableVertexAttribArray(d),r.vertexAttribPointer(d,u.size,u.type||r.FLOAT,u.normalized,u.stride,u.start),u.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");r.vertexAttribDivisor(d,1)}}}},t.prototype.draw=function(t,e,r,n){var i=this.gl,o=this._activeGeometry;if(o.indexBuffer){var s=o.indexBuffer.data.BYTES_PER_ELEMENT,a=2===s?i.UNSIGNED_SHORT:i.UNSIGNED_INT;2===s||4===s&&this.canUseUInt32ElementIndex?o.instanced?i.drawElementsInstanced(t,e||o.indexBuffer.data.length,a,(r||0)*s,n||1):i.drawElements(t,e||o.indexBuffer.data.length,a,(r||0)*s):console.warn("unsupported index buffer type: uint32")}else o.instanced?i.drawArraysInstanced(t,r,e||o.getSize(),n||1):i.drawArrays(t,r,e||o.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},t.prototype.destroy=function(){this.renderer=null},t}(),nn=function(){function t(t){void 0===t&&(t=null),this.type=v.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=rt.FILTER_MULTISAMPLE,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null}return t.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=v.NONE,this.autoDetect=!0),this._target=null},t.prototype.copyCountersOrReset=function(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},t}();function on(t,e,r){var n=t.createShader(e);return t.shaderSource(n,r),t.compileShader(n),n}function sn(t,e){var r=t.getShaderSource(e).split("\n").map((function(t,e){return e+": "+t})),n=t.getShaderInfoLog(e),i=n.split("\n"),o={},s=i.map((function(t){return parseFloat(t.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))})).filter((function(t){return!(!t||o[t])&&(o[t]=!0,!0)})),a=[""];s.forEach((function(t){r[t-1]="%c"+r[t-1]+"%c",a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")}));var h=r.join("\n");a[0]=h,console.error(n),console.groupCollapsed("click to view full shader code"),console.warn.apply(console,a),console.groupEnd()}function an(t){for(var e=new Array(t),r=0;r<e.length;r++)e[r]=!1;return e}function hn(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return an(2*e);case"bvec3":return an(3*e);case"bvec4":return an(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var un,ln={},cn=ln;function dn(){if(!un){un=g.MEDIUM;var t=function(){if(cn===ln||cn&&cn.isContextLost()){var t=document.createElement("canvas"),r=void 0;rt.PREFER_ENV>=e.WEBGL2&&(r=t.getContext("webgl2",{})),r||((r=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}))?r.getExtension("WEBGL_draw_buffers"):r=null),cn=r}return cn}();if(t&&t.getShaderPrecisionFormat){var r=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);un=r.precision?g.HIGH:g.MEDIUM}}return un}function fn(t,e,r){if("precision"!==t.substring(0,9)){var n=e;return e===g.HIGH&&r!==g.HIGH&&(n=g.MEDIUM),"precision "+n+" float;\n"+t}return r!==g.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t}var pn={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function mn(t){return pn[t]}var gn=null,vn={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function yn(t,e){if(!gn){var r=Object.keys(vn);gn={};for(var n=0;n<r.length;++n){var i=r[n];gn[t[i]]=vn[i]}}return gn[e]}var bn=[{test:function(t){return"float"===t.type&&1===t.size},code:function(t){return'\n            if(uv["'+t+'"] !== ud["'+t+'"].value)\n            {\n                ud["'+t+'"].value = uv["'+t+'"]\n                gl.uniform1f(ud["'+t+'"].location, uv["'+t+'"])\n            }\n            '}},{test:function(t){return("sampler2D"===t.type||"samplerCube"===t.type||"sampler2DArray"===t.type)&&1===t.size&&!t.isArray},code:function(t){return't = syncData.textureCount++;\n\n            renderer.texture.bind(uv["'+t+'"], t);\n\n            if(ud["'+t+'"].value !== t)\n            {\n                ud["'+t+'"].value = t;\n                gl.uniform1i(ud["'+t+'"].location, t);\n; // eslint-disable-line max-len\n            }'}},{test:function(t,e){return"mat3"===t.type&&1===t.size&&void 0!==e.a},code:function(t){return'\n            gl.uniformMatrix3fv(ud["'+t+'"].location, false, uv["'+t+'"].toArray(true));\n            '},codeUbo:function(t){return"\n                var "+t+"_matrix = uv."+t+".toArray(true);\n\n                data[offset] = "+t+"_matrix[0];\n                data[offset+1] = "+t+"_matrix[1];\n                data[offset+2] = "+t+"_matrix[2];\n        \n                data[offset + 4] = "+t+"_matrix[3];\n                data[offset + 5] = "+t+"_matrix[4];\n                data[offset + 6] = "+t+"_matrix[5];\n        \n                data[offset + 8] = "+t+"_matrix[6];\n                data[offset + 9] = "+t+"_matrix[7];\n                data[offset + 10] = "+t+"_matrix[8];\n            "}},{test:function(t,e){return"vec2"===t.type&&1===t.size&&void 0!==e.x},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["'+t+'"].location, v.x, v.y);\n                }'},codeUbo:function(t){return"\n                v = uv."+t+";\n\n                data[offset] = v.x;\n                data[offset+1] = v.y;\n            "}},{test:function(t){return"vec2"===t.type&&1===t.size},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["'+t+'"].location, v[0], v[1]);\n                }\n            '}},{test:function(t,e){return"vec4"===t.type&&1===t.size&&void 0!==e.width},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["'+t+'"].location, v.x, v.y, v.width, v.height)\n                }'},codeUbo:function(t){return"\n                    v = uv."+t+";\n\n                    data[offset] = v.x;\n                    data[offset+1] = v.y;\n                    data[offset+2] = v.width;\n                    data[offset+3] = v.height;\n                "}},{test:function(t){return"vec4"===t.type&&1===t.size},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["'+t+'"].location, v[0], v[1], v[2], v[3])\n                }'}}],_n={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",uint:"gl.uniform1ui(location, v)",uvec2:"gl.uniform2ui(location, v[0], v[1])",uvec3:"gl.uniform3ui(location, v[0], v[1], v[2])",uvec4:"gl.uniform4ui(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},En={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var xn,Tn=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function wn(t){for(var e="",r=0;r<t;++r)r>0&&(e+="\nelse "),r<t-1&&(e+="if(test == "+r+".0){}");return e}var An=0,Sn={},On=function(){function t(e,r,n){void 0===n&&(n="pixi-shader"),this.id=An++,this.vertexSrc=e||t.defaultVertexSrc,this.fragmentSrc=r||t.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(n=n.replace(/\s+/g,"-"),Sn[n]?(Sn[n]++,n+="-"+Sn[n]):Sn[n]=1,this.vertexSrc="#define SHADER_NAME "+n+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+n+"\n"+this.fragmentSrc,this.vertexSrc=fn(this.vertexSrc,rt.PRECISION_VERTEX,g.HIGH),this.fragmentSrc=fn(this.fragmentSrc,rt.PRECISION_FRAGMENT,dn())),this.glPrograms={},this.syncUniforms=null}return Object.defineProperty(t,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},enumerable:!1,configurable:!0}),t.from=function(e,r,n){var i=e+r,o=Oe[i];return o||(Oe[i]=o=new t(e,r,n)),o},t}(),In=function(){function t(t,e){this.uniformBindCount=0,this.program=t,this.uniformGroup=e?e instanceof Xr?e:new Xr(e):new Xr({})}return t.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var r in e.uniforms){var n=e.uniforms[r];if(n.group&&this.checkUniformExists(t,n))return!0}return!1},t.prototype.destroy=function(){this.uniformGroup=null},Object.defineProperty(t.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),t.from=function(e,r,n){return new t(On.from(e,r),n)},t}(),Rn=function(){function t(){this.data=0,this.blendMode=i.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}return Object.defineProperty(t.prototype,"blend",{get:function(){return!!(1&this.data)},set:function(t){!!(1&this.data)!==t&&(this.data^=1)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"offsets",{get:function(){return!!(2&this.data)},set:function(t){!!(2&this.data)!==t&&(this.data^=2)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"culling",{get:function(){return!!(4&this.data)},set:function(t){!!(4&this.data)!==t&&(this.data^=4)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"depthTest",{get:function(){return!!(8&this.data)},set:function(t){!!(8&this.data)!==t&&(this.data^=8)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"depthMask",{get:function(){return!!(32&this.data)},set:function(t){!!(32&this.data)!==t&&(this.data^=32)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"clockwiseFrontFace",{get:function(){return!!(16&this.data)},set:function(t){!!(16&this.data)!==t&&(this.data^=16)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blendMode",{get:function(){return this._blendMode},set:function(t){this.blend=t!==i.NONE,this._blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(t){this.offsets=!!t,this._polygonOffset=t},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return"[@pixi/core:State blendMode="+this.blendMode+" clockwiseFrontFace="+this.clockwiseFrontFace+" culling="+this.culling+" depthMask="+this.depthMask+" polygonOffset="+this.polygonOffset+"]"},t.for2d=function(){var e=new t;return e.depthTest=!1,e.blend=!0,e},t}(),Nn=function(t){function e(r,n,i){var o=this,s=On.from(r||e.defaultVertexSrc,n||e.defaultFragmentSrc);return(o=t.call(this,s,i)||this).padding=0,o.resolution=rt.FILTER_RESOLUTION,o.multisample=rt.FILTER_MULTISAMPLE,o.enabled=!0,o.autoFit=!0,o.state=new Rn,o}return ar(e,t),e.prototype.apply=function(t,e,r,n,i){t.applyFilter(this,e,r,n)},Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},enumerable:!1,configurable:!0}),e}(In),Ln=new qe,Mn=function(){function t(t,e){this._texture=t,this.mapCoord=new qe,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}return Object.defineProperty(t.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture=t,this._textureID=-1},enumerable:!1,configurable:!0}),t.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var r=this.mapCoord,n=0;n<t.length;n+=2){var i=t[n],o=t[n+1];e[n]=i*r.a+o*r.c+r.tx,e[n+1]=i*r.b+o*r.d+r.ty}return e},t.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;var r=e._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);var n=e.orig,i=e.trim;i&&(Ln.set(n.width/i.width,0,0,n.height/i.height,-i.x/i.width,-i.y/i.height),this.mapCoord.append(Ln));var o=e.baseTexture,s=this.uClampFrame,a=this.clampMargin/o.resolution,h=this.clampOffset;return s[0]=(e._frame.x+a+h)/o.width,s[1]=(e._frame.y+a+h)/o.height,s[2]=(e._frame.x+e._frame.width-a+h)/o.width,s[3]=(e._frame.y+e._frame.height-a+h)/o.height,this.uClampOffset[0]=h/o.realWidth,this.uClampOffset[1]=h/o.realHeight,this.isSimple=e._frame.width===o.width&&e._frame.height===o.height&&0===e.rotate,!0},t}(),Pn=function(t){function e(e){var r=this,n=new qe;return r=t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n")||this,e.renderable=!1,r.maskSprite=e,r.maskMatrix=n,r}return ar(e,t),e.prototype.apply=function(t,e,r,n){var i=this.maskSprite,o=i._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new Mn(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,i).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=i.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,t.applyFilter(this,e,r,n))},e}(Nn),Cn=function(){function t(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return t.prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},t.prototype.push=function(t,e){var r=e;if(!r.isMaskData){var n=this.maskDataPool.pop()||new nn;n.pooled=!0,n.maskObject=e,r=n}switch(r.autoDetect&&this.detect(r),r.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),r._target=t,r.type){case v.SCISSOR:this.maskStack.push(r),this.renderer.scissor.push(r);break;case v.STENCIL:this.maskStack.push(r),this.renderer.stencil.push(r);break;case v.SPRITE:r.copyCountersOrReset(null),this.pushSpriteMask(r),this.maskStack.push(r)}},t.prototype.pop=function(t){var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case v.SCISSOR:this.renderer.scissor.pop();break;case v.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case v.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e)}},t.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=v.SPRITE;else if(t.type=v.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var r=e.worldTransform,n=Math.atan2(r.b,r.a),i=Math.atan2(r.d,r.c);n=Math.round(n*(180/Math.PI)*100),i=((i=Math.round(i*(180/Math.PI)*100)-n)%18e3+18e3)%18e3,0===(n=(n%9e3+9e3)%9e3)&&9e3===i&&(t.type=v.SCISSOR)}},t.prototype.pushSpriteMask=function(t){var e,r,n=t.maskObject,i=t._target,o=this.alphaMaskPool[this.alphaMaskIndex];o||(o=this.alphaMaskPool[this.alphaMaskIndex]=[new Pn(n)]);var s,a,h=this.renderer,u=h.renderTexture;if(u.current){var l=u.current;s=t.resolution||l.resolution,a=null!==(e=t.multisample)&&void 0!==e?e:l.multisample}else s=t.resolution||h.resolution,a=null!==(r=t.multisample)&&void 0!==r?r:h.multisample;o[0].resolution=s,o[0].multisample=a,o[0].maskSprite=n;var c=i.filterArea;i.filterArea=n.getBounds(!0),h.filter.push(i,o),i.filterArea=c,this.alphaMaskIndex++},t.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},t.prototype.destroy=function(){this.renderer=null},t}(),Dn=function(){function t(t){this.renderer=t,this.maskStack=[],this.glConst=0}return t.prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(t){var e=this.renderer.gl,r=this.getStackLength();this.maskStack=t;var n=this.getStackLength();n!==r&&(0===n?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){this.renderer=null,this.maskStack=null},t}(),Un=function(t){function e(e){var r=t.call(this,e)||this;return r.glConst=WebGLRenderingContext.SCISSOR_TEST,r}return ar(e,t),e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},e.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var r=t._scissorRect,n=e.getBounds(!0),i=this.renderer.gl;e.renderable=!1,r?n.fit(r):i.enable(i.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=n,this._useCurrent()},e.prototype.pop=function(){var t=this.renderer.gl;this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)},e.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,r=this.renderer.projection,n=r.transform,i=r.sourceFrame,o=r.destinationFrame,s=e?e.resolution:this.renderer.resolution,a=o.width/i.width,h=o.height/i.height,u=((t.x-i.x)*a+o.x)*s,l=((t.y-i.y)*h+o.y)*s,c=t.width*a*s,d=t.height*h*s;n&&(u+=n.tx*s,l+=n.ty*s),e||(l=this.renderer.height-d-l),u=Math.round(u),l=Math.round(l),c=Math.round(c),d=Math.round(d),this.renderer.gl.scissor(u,l,c,d)},e}(Dn),Bn=function(t){function e(e){var r=t.call(this,e)||this;return r.glConst=WebGLRenderingContext.STENCIL_TEST,r}return ar(e,t),e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},e.prototype.push=function(t){var e=t.maskObject,r=this.renderer.gl,n=t._stencilCounter;0===n&&(this.renderer.framebuffer.forceStencil(),r.enable(r.STENCIL_TEST)),t._stencilCounter++,r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.EQUAL,n,this._getBitwiseMask()),r.stencilOp(r.KEEP,r.KEEP,r.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},e.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},e}(Dn),Fn=function(){function t(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new qe,this.transform=null}return t.prototype.update=function(t,e,r,n){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,n),this.transform&&this.projectionMatrix.append(this.transform);var i=this.renderer;i.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,i.globalUniforms.update(),i.shader.shader&&i.shader.syncUniformGroup(i.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(t,e,r,n){var i=this.projectionMatrix,o=n?-1:1;i.identity(),i.a=1/e.width*2,i.d=o*(1/e.height*2),i.tx=-1-e.x*i.a,i.ty=-o-e.y*i.d},t.prototype.setTransform=function(t){},t.prototype.destroy=function(){this.renderer=null},t}(),kn=new je,Gn=new je,jn=function(){function t(t){this.renderer=t,this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new je,this.destinationFrame=new je,this.viewportFrame=new je}return t.prototype.bind=function(t,e,r){void 0===t&&(t=null);var n,i,o,s=this.renderer;this.current=t,t?(o=(n=t.baseTexture).resolution,e||(kn.width=t.frame.width,kn.height=t.frame.height,e=kn),r||(Gn.x=t.frame.x,Gn.y=t.frame.y,Gn.width=e.width,Gn.height=e.height,r=Gn),i=n.framebuffer):(o=s.resolution,e||(kn.width=s.screen.width,kn.height=s.screen.height,e=kn),r||((r=kn).width=e.width,r.height=e.height));var a=this.viewportFrame;a.x=r.x*o,a.y=r.y*o,a.width=r.width*o,a.height=r.height*o,t||(a.y=s.view.height-(a.y+a.height)),a.ceil(),this.renderer.framebuffer.bind(i,a),this.renderer.projection.update(r,e,o,!i),t?this.renderer.mask.setMaskStack(n.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(r)},t.prototype.clear=function(t,e){t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor;var r=this.destinationFrame,n=this.current?this.current.baseTexture:this.renderer.screen,i=r.width!==n.width||r.height!==n.height;if(i){var o=this.viewportFrame,s=o.x,a=o.y,h=o.width,u=o.height;s=Math.round(s),a=Math.round(a),h=Math.round(h),u=Math.round(u),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(s,a,h,u)}this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3],e),i&&this.renderer.scissor.pop()},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t.prototype.destroy=function(){this.renderer=null},t}();function Hn(t,e,r,n,i){r.buffer.update(i)}var Xn={float:"\n        data[offset] = v;\n    ",vec2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n    ",vec3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n    ",vec4:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n        data[offset+3] = v[3];\n    ",mat2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n\n        data[offset+4] = v[2];\n        data[offset+5] = v[3];\n    ",mat3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n        data[offset + 4] = v[3];\n        data[offset + 5] = v[4];\n        data[offset + 6] = v[5];\n\n        data[offset + 8] = v[6];\n        data[offset + 9] = v[7];\n        data[offset + 10] = v[8];\n    ",mat4:"\n        for(var i = 0; i < 16; i++)\n        {\n            data[offset + i] = v[i];\n        }\n    "},zn={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};function Vn(t,e){if(!t.autoManage)return{size:0,syncFunc:Hn};for(var r=function(t){for(var e=t.map((function(t){return{data:t,offset:0,dataLen:0,dirty:0}})),r=0,n=0,i=0,o=0;o<e.length;o++){var s=e[o];if(r=zn[s.data.type],s.data.size>1&&(r=Math.max(r,16)*s.data.size),s.dataLen=r,n%r!=0&&n<16){var a=n%r%16;n+=a,i+=a}n+r>16?(i=16*Math.ceil(i/16),s.offset=i,i+=r,n=r):(s.offset=i,n+=r,i+=r)}return{uboElements:e,size:i=16*Math.ceil(i/16)}}(function(t,e){var r=[];for(var n in t)e[n]&&r.push(e[n]);return r.sort((function(t,e){return t.index-e.index})),r}(t.uniforms,e)),n=r.uboElements,i=r.size,o=["\n    var v = null;\n    var v2 = null;\n    var cv = null;\n    var t = 0;\n    var gl = renderer.gl\n    var index = 0;\n    var data = buffer.data;\n    "],s=0;s<n.length;s++){for(var a=n[s],h=t.uniforms[a.data.name],u=a.data.name,l=!1,c=0;c<bn.length;c++){var d=bn[c];if(d.codeUbo&&d.test(a.data,h)){o.push("offset = "+a.offset/4+";",bn[c].codeUbo(a.data.name,h)),l=!0;break}}if(!l)if(a.data.size>1){var f=mn(a.data.type),p=Math.max(zn[a.data.type]/16,1),m=f/p,g=(4-m%4)%4;o.push("\n                cv = ud."+u+".value;\n                v = uv."+u+";\n                offset = "+a.offset/4+";\n\n                t = 0;\n\n                for(var i=0; i < "+a.data.size*p+"; i++)\n                {\n                    for(var j = 0; j < "+m+"; j++)\n                    {\n                        data[offset++] = v[t++];\n                    }\n                    offset += "+g+";\n                }\n\n                ")}else{var v=Xn[a.data.type];o.push("\n                cv = ud."+u+".value;\n                v = uv."+u+";\n                offset = "+a.offset/4+";\n                "+v+";\n                ")}}return o.push("\n       renderer.buffer.update(buffer);\n    "),{size:i,syncFunc:new Function("ud","uv","renderer","syncData","buffer",o.join("\n"))}}var Wn=function(){function t(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}return t.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null},t}();function Yn(t,e){var r=on(t,t.VERTEX_SHADER,e.vertexSrc),n=on(t,t.FRAGMENT_SHADER,e.fragmentSrc),i=t.createProgram();t.attachShader(i,r),t.attachShader(i,n),t.linkProgram(i),t.getProgramParameter(i,t.LINK_STATUS)||function(t,e,r,n){t.getProgramParameter(e,t.LINK_STATUS)||(t.getShaderParameter(r,t.COMPILE_STATUS)||sn(t,r),t.getShaderParameter(n,t.COMPILE_STATUS)||sn(t,n),console.error("PixiJS Error: Could not initialize shader."),""!==t.getProgramInfoLog(e)&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(e)))}(t,i,r,n),e.attributeData=function(t,e){for(var r={},n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),i=0;i<n;i++){var o=e.getActiveAttrib(t,i);if(!o.name.startsWith("gl_")){var s=yn(e,o.type),a={type:s,name:o.name,size:mn(s),location:i};r[o.name]=a}}return r}(i,t),e.uniformData=function(t,e){for(var r={},n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),i=0;i<n;i++){var o=e.getActiveUniform(t,i),s=o.name.replace(/\[.*?\]$/,""),a=!!o.name.match(/\[.*?\]$/),h=yn(e,o.type);r[s]={name:s,index:i,type:h,size:o.size,isArray:a,value:hn(h,o.size)}}return r}(i,t);var o=Object.keys(e.attributeData);o.sort((function(t,e){return t>e?1:-1}));for(var s=0;s<o.length;s++)e.attributeData[o[s]].location=s,t.bindAttribLocation(i,s,o[s]);t.linkProgram(i),t.deleteShader(r),t.deleteShader(n);var a={};for(var s in e.uniformData){var h=e.uniformData[s];a[s]={location:t.getUniformLocation(i,s),value:hn(h.type,h.size)}}return new Wn(i,a)}var qn=0,Kn={textureCount:0,uboCount:0},Zn=function(){function t(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=qn++}return t.prototype.systemCheck=function(){if(!function(){if("boolean"==typeof xn)return xn;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;");xn=!0===t({a:"b"},"a","b")}catch(t){xn=!1}return xn}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(t){this.gl=t,this.reset()},t.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var r=t.program,n=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==r&&(this.program=r,this.gl.useProgram(n.program)),e||(Kn.textureCount=0,Kn.uboCount=0,this.syncUniformGroup(t.uniformGroup,Kn)),n},t.prototype.setUniforms=function(t){var e=this.shader.program,r=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(r.uniformData,t,this.renderer)},t.prototype.syncUniformGroup=function(t,e){var r=this.getGlProgram();t.static&&t.dirtyId===r.uniformDirtyGroups[t.id]||(r.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,r,e))},t.prototype.syncUniforms=function(t,e,r){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,r)},t.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=function(t,e){var r=["\n        var v = null;\n        var cv = null\n        var t = 0;\n        var gl = renderer.gl\n    "];for(var n in t.uniforms){var i=e[n];if(i){for(var o=t.uniforms[n],s=!1,a=0;a<bn.length;a++)if(bn[a].test(i,o)){r.push(bn[a].code(n,o)),s=!0;break}if(!s){var h=(1===i.size?_n:En)[i.type].replace("location",'ud["'+n+'"].location');r.push('\n            cv = ud["'+n+'"].value;\n            v = uv["'+n+'"];\n            '+h+";")}}else t.uniforms[n].group&&(t.uniforms[n].ubo?r.push("\n                        renderer.shader.syncUniformBufferGroup(uv."+n+", '"+n+"');\n                    "):r.push("\n                        renderer.shader.syncUniformGroup(uv."+n+", syncData);\n                    "))}return new Function("ud","uv","renderer","syncData",r.join("\n"))}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]},t.prototype.syncUniformBufferGroup=function(t,e){var r=this.getGlProgram();if(!t.static||0!==t.dirtyId||!r.uniformGroups[t.id]){t.dirtyId=0;var n=r.uniformGroups[t.id]||this.createSyncBufferGroup(t,r,e);t.buffer.update(),n(r.uniformData,t.uniforms,this.renderer,Kn,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,r.uniformBufferBindings[e])},t.prototype.createSyncBufferGroup=function(t,e,r){var n=this.renderer.gl;this.renderer.buffer.bind(t.buffer);var i=this.gl.getUniformBlockIndex(e.program,r);e.uniformBufferBindings[r]=this.shader.uniformBindCount,n.uniformBlockBinding(e.program,i,this.shader.uniformBindCount),this.shader.uniformBindCount++;var o=this.getSignature(t,this.shader.program.uniformData,"ubo"),s=this._uboCache[o];if(s||(s=this._uboCache[o]=Vn(t,this.shader.program.uniformData)),t.autoManage){var a=new Float32Array(s.size/4);t.buffer.update(a)}return e.uniformGroups[t.id]=s.syncFunc,e.uniformGroups[t.id]},t.prototype.getSignature=function(t,e,r){var n=t.uniforms,i=[r+"-"];for(var o in n)i.push(o),e[o]&&i.push(e[o].type);return i.join("-")},t.prototype.getGlProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateProgram=function(t){var e=this.gl,r=t.program,n=Yn(e,r);return r.glPrograms[this.renderer.CONTEXT_UID]=n,n},t.prototype.reset=function(){this.program=null,this.shader=null},t.prototype.destroy=function(){this.renderer=null,this.destroyed=!0},t}();var Jn=function(){function t(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=i.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=new Rn,this.defaultState.blend=!0}return t.prototype.contextChange=function(t){this.gl=t,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[i.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.ADD]=[t.ONE,t.ONE],e[i.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.NONE]=[0,0],e[i.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[i.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[i.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[i.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[i.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[i.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[i.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[i.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[i.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[i.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[i.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},t.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,r=0;e;)1&e&&this.map[r].call(this,!!(t.data&1<<r)),e>>=1,r++;this.stateId=t.data}for(r=0;r<this.checks.length;r++)this.checks[r](this,t)},t.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data},t.prototype.setBlend=function(e){this.updateCheck(t.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)},t.prototype.setOffset=function(e){this.updateCheck(t.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},t.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},t.prototype.setDepthMask=function(t){this.gl.depthMask(t)},t.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},t.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},t.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],r=this.gl;2===e.length?r.blendFunc(e[0],e[1]):r.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,r.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}},t.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},t.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},t.prototype.updateCheck=function(t,e){var r=this.checks.indexOf(t);e&&-1===r?this.checks.push(t):e||-1===r||this.checks.splice(r,1)},t.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},t.checkPolygonOffset=function(t,e){t.setPolygonOffset(1,e.polygonOffset)},t.prototype.destroy=function(){this.gl=null},t}(),Qn=function(){function t(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=rt.GC_MAX_IDLE,this.checkCountMax=rt.GC_MAX_CHECK_COUNT,this.mode=rt.GC_MODE}return t.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==m.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,r=!1,n=0;n<e.length;n++){var i=e[n];!i.framebuffer&&this.count-i.touched>this.maxIdle&&(t.destroyTexture(i,!0),e[n]=null,r=!0)}if(r){var o=0;for(n=0;n<e.length;n++)null!==e[n]&&(e[o++]=e[n]);e.length=o}},t.prototype.unload=function(t){var e=this.renderer.texture,r=t._texture;r&&!r.framebuffer&&e.destroyTexture(r);for(var n=t.children.length-1;n>=0;n--)this.unload(t.children[n])},t.prototype.destroy=function(){this.renderer=null},t}();var $n=function(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=h.UNSIGNED_BYTE,this.internalFormat=s.RGBA,this.samplerType=0},ti=function(){function t(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new dr,this.hasIntegerTextures=!1}return t.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=function(t){var e,r,n,i,o,a,u,l,c,d,f,p,m,g,v,y,b,_,E,x,T,w,A;return"WebGL2RenderingContext"in self&&t instanceof self.WebGL2RenderingContext?((e={})[h.UNSIGNED_BYTE]=((r={})[s.RGBA]=t.RGBA8,r[s.RGB]=t.RGB8,r[s.RG]=t.RG8,r[s.RED]=t.R8,r[s.RGBA_INTEGER]=t.RGBA8UI,r[s.RGB_INTEGER]=t.RGB8UI,r[s.RG_INTEGER]=t.RG8UI,r[s.RED_INTEGER]=t.R8UI,r[s.ALPHA]=t.ALPHA,r[s.LUMINANCE]=t.LUMINANCE,r[s.LUMINANCE_ALPHA]=t.LUMINANCE_ALPHA,r),e[h.BYTE]=((n={})[s.RGBA]=t.RGBA8_SNORM,n[s.RGB]=t.RGB8_SNORM,n[s.RG]=t.RG8_SNORM,n[s.RED]=t.R8_SNORM,n[s.RGBA_INTEGER]=t.RGBA8I,n[s.RGB_INTEGER]=t.RGB8I,n[s.RG_INTEGER]=t.RG8I,n[s.RED_INTEGER]=t.R8I,n),e[h.UNSIGNED_SHORT]=((i={})[s.RGBA_INTEGER]=t.RGBA16UI,i[s.RGB_INTEGER]=t.RGB16UI,i[s.RG_INTEGER]=t.RG16UI,i[s.RED_INTEGER]=t.R16UI,i[s.DEPTH_COMPONENT]=t.DEPTH_COMPONENT16,i),e[h.SHORT]=((o={})[s.RGBA_INTEGER]=t.RGBA16I,o[s.RGB_INTEGER]=t.RGB16I,o[s.RG_INTEGER]=t.RG16I,o[s.RED_INTEGER]=t.R16I,o),e[h.UNSIGNED_INT]=((a={})[s.RGBA_INTEGER]=t.RGBA32UI,a[s.RGB_INTEGER]=t.RGB32UI,a[s.RG_INTEGER]=t.RG32UI,a[s.RED_INTEGER]=t.R32UI,a[s.DEPTH_COMPONENT]=t.DEPTH_COMPONENT24,a),e[h.INT]=((u={})[s.RGBA_INTEGER]=t.RGBA32I,u[s.RGB_INTEGER]=t.RGB32I,u[s.RG_INTEGER]=t.RG32I,u[s.RED_INTEGER]=t.R32I,u),e[h.FLOAT]=((l={})[s.RGBA]=t.RGBA32F,l[s.RGB]=t.RGB32F,l[s.RG]=t.RG32F,l[s.RED]=t.R32F,l[s.DEPTH_COMPONENT]=t.DEPTH_COMPONENT32F,l),e[h.HALF_FLOAT]=((c={})[s.RGBA]=t.RGBA16F,c[s.RGB]=t.RGB16F,c[s.RG]=t.RG16F,c[s.RED]=t.R16F,c),e[h.UNSIGNED_SHORT_5_6_5]=((d={})[s.RGB]=t.RGB565,d),e[h.UNSIGNED_SHORT_4_4_4_4]=((f={})[s.RGBA]=t.RGBA4,f),e[h.UNSIGNED_SHORT_5_5_5_1]=((p={})[s.RGBA]=t.RGB5_A1,p),e[h.UNSIGNED_INT_2_10_10_10_REV]=((m={})[s.RGBA]=t.RGB10_A2,m[s.RGBA_INTEGER]=t.RGB10_A2UI,m),e[h.UNSIGNED_INT_10F_11F_11F_REV]=((g={})[s.RGB]=t.R11F_G11F_B10F,g),e[h.UNSIGNED_INT_5_9_9_9_REV]=((v={})[s.RGB]=t.RGB9_E5,v),e[h.UNSIGNED_INT_24_8]=((y={})[s.DEPTH_STENCIL]=t.DEPTH24_STENCIL8,y),e[h.FLOAT_32_UNSIGNED_INT_24_8_REV]=((b={})[s.DEPTH_STENCIL]=t.DEPTH32F_STENCIL8,b),A=e):((_={})[h.UNSIGNED_BYTE]=((E={})[s.RGBA]=t.RGBA,E[s.RGB]=t.RGB,E[s.ALPHA]=t.ALPHA,E[s.LUMINANCE]=t.LUMINANCE,E[s.LUMINANCE_ALPHA]=t.LUMINANCE_ALPHA,E),_[h.UNSIGNED_SHORT_5_6_5]=((x={})[s.RGB]=t.RGB,x),_[h.UNSIGNED_SHORT_4_4_4_4]=((T={})[s.RGBA]=t.RGBA,T),_[h.UNSIGNED_SHORT_5_5_5_1]=((w={})[s.RGBA]=t.RGBA,w),A=_),A}(t);var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var r=0;r<e;r++)this.boundTextures[r]=null;this.emptyTextures={};var n=new $n(t.createTexture());t.bindTexture(t.TEXTURE_2D,n.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=n,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new $n(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(r=0;r<6;r++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(r=0;r<this.boundTextures.length;r++)this.bind(null,r)},t.prototype.bind=function(t,e){void 0===e&&(e=0);var r=this.gl;if((t=null==t?void 0:t.castToBaseTexture())&&t.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;var n=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(t.target,n.texture)),n.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),this.updateTexture(t)),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[e]=null},t.prototype.reset=function(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},t.prototype.unbind=function(t){var e=this.gl,r=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var n=0;n<r.length;n++)r[n]===this.unknownTexture&&this.bind(null,n)}for(n=0;n<r.length;n++)r[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),e.bindTexture(t.target,this.emptyTextures[t.target].texture),r[n]=null)},t.prototype.ensureSamplerType=function(t){var e=this,r=e.boundTextures,n=e.hasIntegerTextures,i=e.CONTEXT_UID;if(n)for(var o=t-1;o>=0;--o){var s=r[o];if(s)s._glTextures[i].samplerType!==u.FLOAT&&this.renderer.texture.unbind(s)}},t.prototype.initTexture=function(t){var e=new $n(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},t.prototype.initTextureType=function(t,e){var r,n;e.internalFormat=null!==(n=null===(r=this.internalFormats[t.type])||void 0===r?void 0:r[t.format])&&void 0!==n?n:t.format,2===this.webGLVersion&&t.type===h.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type},t.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var r=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(r,t,e))e.samplerType!==u.FLOAT&&(this.hasIntegerTextures=!0);else{var n=t.realWidth,i=t.realHeight,o=r.gl;(e.width!==n||e.height!==i||e.dirtyId<0)&&(e.width=n,e.height=i,o.texImage2D(t.target,0,e.internalFormat,n,i,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}},t.prototype.destroyTexture=function(t,e){var r=this.gl;if((t=t.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(t),r.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){var n=this.managedTextures.indexOf(t);-1!==n&&_e(this.managedTextures,n,1)}},t.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==d.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=t.mipmap>=1:e.mipmap=!1,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=c.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)},t.prototype.setStyle=function(t,e){var r=this.gl;if(e.mipmap&&t.mipmap!==d.ON_MANUAL&&r.generateMipmap(t.target),r.texParameteri(t.target,r.TEXTURE_WRAP_S,e.wrapMode),r.texParameteri(t.target,r.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===l.LINEAR?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST);var n=this.renderer.context.extensions.anisotropicFiltering;if(n&&t.anisotropicLevel>0&&t.scaleMode===l.LINEAR){var i=Math.min(t.anisotropicLevel,r.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT));r.texParameterf(t.target,n.TEXTURE_MAX_ANISOTROPY_EXT,i)}}else r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===l.LINEAR?r.LINEAR:r.NEAREST);r.texParameteri(t.target,r.TEXTURE_MAG_FILTER,t.scaleMode===l.LINEAR?r.LINEAR:r.NEAREST)},t.prototype.destroy=function(){this.renderer=null},t}(),ei={__proto__:null,FilterSystem:Yr,BatchSystem:Kr,ContextSystem:Jr,FramebufferSystem:tn,GeometrySystem:rn,MaskSystem:Cn,ScissorSystem:Un,StencilSystem:Bn,ProjectionSystem:Fn,RenderTextureSystem:jn,ShaderSystem:Zn,StateSystem:Jn,TextureGCSystem:Qn,TextureSystem:ti},ri=new qe,ni=function(t){function e(e,n){void 0===e&&(e=r.UNKNOWN);var i=t.call(this)||this;return n=Object.assign({},rt.RENDER_OPTIONS,n),i.options=n,i.type=e,i.screen=new je(0,0,n.width,n.height),i.view=n.view||document.createElement("canvas"),i.resolution=n.resolution||rt.RESOLUTION,i.useContextAlpha=n.useContextAlpha,i.autoDensity=!!n.autoDensity,i.preserveDrawingBuffer=n.preserveDrawingBuffer,i.clearBeforeRender=n.clearBeforeRender,i._backgroundColor=0,i._backgroundColorRgba=[0,0,0,1],i._backgroundColorString="#000000",i.backgroundColor=n.backgroundColor||i._backgroundColor,i.backgroundAlpha=n.backgroundAlpha,void 0!==n.transparent&&(Ae("6.0.0","Option transparent is deprecated, please use backgroundAlpha instead."),i.useContextAlpha=n.transparent,i.backgroundAlpha=n.transparent?0:1),i._lastObjectRendered=null,i.plugins={},i}return ar(e,t),e.prototype.initPlugins=function(t){for(var e in t)this.plugins[e]=new t[e](this)},Object.defineProperty(e.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),e.prototype.resize=function(t,e){this.view.width=Math.round(t*this.resolution),this.view.height=Math.round(e*this.resolution);var r=this.view.width/this.resolution,n=this.view.height/this.resolution;this.screen.width=r,this.screen.height=n,this.autoDensity&&(this.view.style.width=r+"px",this.view.style.height=n+"px"),this.emit("resize",r,n)},e.prototype.generateTexture=function(t,e,r,n){void 0===e&&(e={}),"number"==typeof e&&(Ae("6.1.0","generateTexture options (scaleMode, resolution, region) are now object options."),e={scaleMode:e,resolution:r,region:n});var i=e.region,o=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&(r[n[i]]=t[n[i]])}return r}(e,["region"]);0===(n=i||t.getLocalBounds(null,!0)).width&&(n.width=1),0===n.height&&(n.height=1);var s=Nr.create(hr({width:n.width,height:n.height},o));return ri.tx=-n.x,ri.ty=-n.y,this.render(t,{renderTexture:s,clear:!1,transform:ri,skipUpdateTransform:!!t.parent}),s},e.prototype.destroy=function(t){for(var e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null;t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view);var n=this;n.plugins=null,n.type=r.UNKNOWN,n.view=null,n.screen=null,n._tempDisplayObjectParent=null,n.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(e.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this._backgroundColorString=de(t),ce(t,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"backgroundAlpha",{get:function(){return this._backgroundColorRgba[3]},set:function(t){this._backgroundColorRgba[3]=t},enumerable:!1,configurable:!0}),e}(ot),ii=function(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0},oi=function(){function t(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}return t.prototype.destroy=function(){this.renderer=null},t.prototype.contextChange=function(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID},t.prototype.bind=function(t){var e=this.gl,r=this.CONTEXT_UID,n=t._glBuffers[r]||this.createGLBuffer(t);e.bindBuffer(t.type,n.buffer)},t.prototype.bindBufferBase=function(t,e){var r=this.gl,n=this.CONTEXT_UID;if(this.boundBufferBases[e]!==t){var i=t._glBuffers[n]||this.createGLBuffer(t);this.boundBufferBases[e]=t,r.bindBufferBase(r.UNIFORM_BUFFER,e,i.buffer)}},t.prototype.bindBufferRange=function(t,e,r){var n=this.gl,i=this.CONTEXT_UID;r=r||0;var o=t._glBuffers[i]||this.createGLBuffer(t);n.bindBufferRange(n.UNIFORM_BUFFER,e||0,o.buffer,256*r,256)},t.prototype.update=function(t){var e=this.gl,r=this.CONTEXT_UID,n=t._glBuffers[r];if(t._updateID!==n.updateID)if(n.updateID=t._updateID,e.bindBuffer(t.type,n.buffer),n.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{var i=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,i)}},t.prototype.dispose=function(t,e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var r=t._glBuffers[this.CONTEXT_UID],n=this.gl;t.disposeRunner.remove(this),r&&(e||n.deleteBuffer(r.buffer),delete t._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedBuffers),r=0;r<e.length;r++)this.dispose(this.managedBuffers[e[r]],t)},t.prototype.createGLBuffer=function(t){var e=this.CONTEXT_UID,r=this.gl;return t._glBuffers[e]=new ii(r.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]},t}(),si=function(t){function e(n){var i=t.call(this,r.WEBGL,n)||this;return n=i.options,i.gl=null,i.CONTEXT_UID=0,i.runners={destroy:new Pe("destroy"),contextChange:new Pe("contextChange"),reset:new Pe("reset"),update:new Pe("update"),postrender:new Pe("postrender"),prerender:new Pe("prerender"),resize:new Pe("resize")},i.runners.contextChange.add(i),i.globalUniforms=new Xr({projectionMatrix:new qe},!0),i.addSystem(Cn,"mask").addSystem(Jr,"context").addSystem(Jn,"state").addSystem(Zn,"shader").addSystem(ti,"texture").addSystem(oi,"buffer").addSystem(rn,"geometry").addSystem(tn,"framebuffer").addSystem(Un,"scissor").addSystem(Bn,"stencil").addSystem(Fn,"projection").addSystem(Qn,"textureGC").addSystem(Yr,"filter").addSystem(jn,"renderTexture").addSystem(Kr,"batch"),i.initPlugins(e.__plugins),i.multisample=void 0,n.context?i.context.initFromContext(n.context):i.context.initFromOptions({alpha:!!i.useContextAlpha,antialias:n.antialias,premultipliedAlpha:i.useContextAlpha&&"notMultiplied"!==i.useContextAlpha,stencil:!0,preserveDrawingBuffer:n.preserveDrawingBuffer,powerPreference:i.options.powerPreference}),i.renderingToScreen=!0,function(t){var e;if(!ue){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var r=["\n %c %c %c PixiJS 6.1.2 -  "+t+"   %c  %c  http://www.pixijs.com/  %c %c %c%c \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(e=self.console).log.apply(e,r)}else self.console&&self.console.log("PixiJS 6.1.2 - "+t+" - http://www.pixijs.com/");ue=!0}}(2===i.context.webGLVersion?"WebGL 2":"WebGL 1"),i.resize(i.options.width,i.options.height),i}return ar(e,t),e.create=function(t){if(void 0===he&&(he=function(){var t={stencil:!0,failIfMajorPerformanceCaveat:rt.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!self.WebGLRenderingContext)return!1;var e=document.createElement("canvas"),r=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),n=!(!r||!r.getContextAttributes().stencil);if(r){var i=r.getExtension("WEBGL_lose_context");i&&i.loseContext()}return r=null,n}catch(t){return!1}}()),he)return new e(t);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},e.prototype.contextChange=function(){var t,e=this.gl;if(1===this.context.webGLVersion){var r=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,r)}else{r=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,r)}t>=y.HIGH?this.multisample=y.HIGH:t>=y.MEDIUM?this.multisample=y.MEDIUM:t>=y.LOW?this.multisample=y.LOW:this.multisample=y.NONE},e.prototype.addSystem=function(t,e){var r=new t(this);if(this[e])throw new Error('Whoops! The name "'+e+'" is already in use');for(var n in this[e]=r,this.runners)this.runners[n].add(r);return this},e.prototype.render=function(t,e){var r,n,i,o;if(e&&(e instanceof Nr?(Ae("6.0.0","Renderer#render arguments changed, use options instead."),r=e,n=arguments[2],i=arguments[3],o=arguments[4]):(r=e.renderTexture,n=e.clear,i=e.transform,o=e.skipUpdateTransform)),this.renderingToScreen=!r,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=i,!this.context.isLost){if(r||(this._lastObjectRendered=t),!o){var s=t.enableTempParent();t.updateTransform(),t.disableTempParent(s)}this.renderTexture.bind(r),this.batch.currentRenderer.start(),(void 0!==n?n:this.clearBeforeRender)&&this.renderTexture.clear(),t.render(this),this.batch.currentRenderer.flush(),r&&r.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},e.prototype.generateTexture=function(e,r,n,i){void 0===r&&(r={});var o=t.prototype.generateTexture.call(this,e,r,n,i);return this.framebuffer.blit(),o},e.prototype.resize=function(e,r){t.prototype.resize.call(this,e,r),this.runners.resize.emit(this.screen.height,this.screen.width)},e.prototype.reset=function(){return this.runners.reset.emit(),this},e.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},e.prototype.destroy=function(e){for(var r in this.runners.destroy.emit(),this.runners)this.runners[r].destroy();t.prototype.destroy.call(this,e),this.gl=null},Object.defineProperty(e.prototype,"extract",{get:function(){return Ae("6.0.0","Renderer#extract has been deprecated, please use Renderer#plugins.extract instead."),this.plugins.extract},enumerable:!1,configurable:!0}),e.registerPlugin=function(t,r){e.__plugins=e.__plugins||{},e.__plugins[t]=r},e}(ni);var ai=function(){this.texArray=null,this.blend=0,this.type=o.TRIANGLES,this.start=0,this.size=0,this.data=null},hi=function(){function t(){this.elements=[],this.ids=[],this.count=0}return t.prototype.clear=function(){for(var t=0;t<this.count;t++)this.elements[t]=null;this.count=0},t}(),ui=function(){function t(t){"number"==typeof t?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(t.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),t.prototype.view=function(t){return this[t+"View"]},t.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},t.sizeOf=function(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},t}(),li=function(t){function r(e){var r=t.call(this,e)||this;return r.shaderGenerator=null,r.geometryClass=null,r.vertexSize=null,r.state=Rn.for2d(),r.size=4*rt.SPRITE_BATCH_SIZE,r._vertexCount=0,r._indexCount=0,r._bufferedElements=[],r._bufferedTextures=[],r._bufferSize=0,r._shader=null,r._packedGeometries=[],r._packedGeometryPoolSize=2,r._flushId=0,r._aBuffers={},r._iBuffers={},r.MAX_TEXTURES=1,r.renderer.on("prerender",r.onPrerender,r),e.runners.contextChange.add(r),r._dcIndex=0,r._aIndex=0,r._iIndex=0,r._attributeBuffer=null,r._indexBuffer=null,r._tempBoundTextures=[],r}return ar(r,t),r.prototype.contextChange=function(){var t=this.renderer.gl;rt.PREFER_ENV===e.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),rt.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var r=e.createShader(e.FRAGMENT_SHADER);;){var n=Tn.replace(/%forloop%/gi,wn(t));if(e.shaderSource(r,n),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS))break;t=t/2|0}return t}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var r=0;r<this._packedGeometryPoolSize;r++)this._packedGeometries[r]=new this.geometryClass;this.initFlushBuffers()},r.prototype.initFlushBuffers=function(){for(var t=r._drawCallPool,e=r._textureArrayPool,n=this.size/4,i=Math.floor(n/this.MAX_TEXTURES)+1;t.length<n;)t.push(new ai);for(;e.length<i;)e.push(new hi);for(var o=0;o<this.MAX_TEXTURES;o++)this._tempBoundTextures[o]=null},r.prototype.onPrerender=function(){this._flushId=0},r.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},r.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,e=this.MAX_TEXTURES,n=r._textureArrayPool,i=this.renderer.batch,o=this._tempBoundTextures,s=this.renderer.textureGC.count,a=++dr._globalBatch,h=0,u=n[0],l=0;i.copyBoundTextures(o,e);for(var c=0;c<this._bufferSize;++c){var d=t[c];t[c]=null,d._batchEnabled!==a&&(u.count>=e&&(i.boundArray(u,o,a,e),this.buildDrawCalls(u,l,c),l=c,u=n[++h],++a),d._batchEnabled=a,d.touched=s,u.elements[u.count++]=d)}u.count>0&&(i.boundArray(u,o,a,e),this.buildDrawCalls(u,l,this._bufferSize),++h,++a);for(c=0;c<o.length;c++)o[c]=null;dr._globalBatch=a},r.prototype.buildDrawCalls=function(t,e,n){var i=this,o=i._bufferedElements,s=i._attributeBuffer,a=i._indexBuffer,h=i.vertexSize,u=r._drawCallPool,l=this._dcIndex,c=this._aIndex,d=this._iIndex,f=u[l];f.start=this._iIndex,f.texArray=t;for(var p=e;p<n;++p){var m=o[p],g=m._texture.baseTexture,v=pe[g.alphaMode?1:0][m.blendMode];o[p]=null,e<p&&f.blend!==v&&(f.size=d-f.start,e=p,(f=u[++l]).texArray=t,f.start=d),this.packInterleavedGeometry(m,s,a,c,d),c+=m.vertexData.length/2*h,d+=m.indices.length,f.blend=v}e<n&&(f.size=d-f.start,++l),this._dcIndex=l,this._aIndex=c,this._iIndex=d},r.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,r=0;r<t.count;r++)e.bind(t.elements[r],t.ids[r]),t.elements[r]=null;t.count=0},r.prototype.updateGeometry=function(){var t=this,e=t._packedGeometries,r=t._attributeBuffer,n=t._indexBuffer;rt.CAN_UPLOAD_SAME_BUFFER?(e[this._flushId]._buffer.update(r.rawBinaryData),e[this._flushId]._indexBuffer.update(n),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(r.rawBinaryData),e[this._flushId]._indexBuffer.update(n),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},r.prototype.drawBatches=function(){for(var t=this._dcIndex,e=this.renderer,n=e.gl,i=e.state,o=r._drawCallPool,s=null,a=0;a<t;a++){var h=o[a],u=h.texArray,l=h.type,c=h.size,d=h.start,f=h.blend;s!==u&&(s=u,this.bindAndClearTexArray(u)),this.state.blendMode=f,i.set(this.state),n.drawElements(l,c,n.UNSIGNED_SHORT,2*d)}},r.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},r.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),this.renderer.shader.bind(this._shader),rt.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},r.prototype.stop=function(){this.flush()},r.prototype.destroy=function(){for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),t.prototype.destroy.call(this)},r.prototype.getAttributeBuffer=function(t){var e=ve(Math.ceil(t/8)),r=be(e),n=8*e;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);var i=this._aBuffers[n];return i||(this._aBuffers[n]=i=new ui(n*this.vertexSize*4)),i},r.prototype.getIndexBuffer=function(t){var e=ve(Math.ceil(t/12)),r=be(e),n=12*e;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);var i=this._iBuffers[r];return i||(this._iBuffers[r]=i=new Uint16Array(n)),i},r.prototype.packInterleavedGeometry=function(t,e,r,n,i){for(var o=e.uint32View,s=e.float32View,a=n/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),f=d<1&&t._texture.baseTexture.alphaMode?me(t._tintRGB,d):t._tintRGB+(255*d<<24),p=0;p<l.length;p+=2)s[n++]=l[p],s[n++]=l[p+1],s[n++]=h[p],s[n++]=h[p+1],o[n++]=f,s[n++]=c;for(p=0;p<u.length;p++)r[i++]=a+u[p]},r._drawCallPool=[],r._textureArrayPool=[],r}(qr),ci=function(){function t(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return t.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),r=0;r<t;r++)e[r]=r;this.defaultGroupCache[t]=Xr.from({uSamplers:e},!0);var n=this.fragTemplate;n=(n=n.replace(/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new On(this.vertexSrc,n)}var i={tint:new Float32Array([1,1,1,1]),translationMatrix:new qe,default:this.defaultGroupCache[t]};return new In(this.programCache[t],i)},t.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var r=0;r<t;r++)r>0&&(e+="\nelse "),r<t-1&&(e+="if(vTextureId < "+r+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+r+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"},t}(),di=function(t){function e(e){void 0===e&&(e=!1);var r=t.call(this)||this;return r._buffer=new Cr(null,e,!1),r._indexBuffer=new Cr(null,e,!0),r.addAttribute("aVertexPosition",r._buffer,2,!1,h.FLOAT).addAttribute("aTextureCoord",r._buffer,2,!1,h.FLOAT).addAttribute("aColor",r._buffer,4,!0,h.UNSIGNED_BYTE).addAttribute("aTextureId",r._buffer,1,!0,h.FLOAT).addIndex(r._indexBuffer),r}return ar(e,t),e}(kr),fi="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",pi="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",mi=function(){function t(){}return t.create=function(t){var e=Object.assign({vertex:fi,fragment:pi,geometryClass:di,vertexSize:6},t),r=e.vertex,n=e.fragment,i=e.vertexSize,o=e.geometryClass;return function(t){function e(e){var s=t.call(this,e)||this;return s.shaderGenerator=new ci(r,n),s.geometryClass=o,s.vertexSize=i,s}return ar(e,t),e}(li)},Object.defineProperty(t,"defaultVertexSrc",{get:function(){return fi},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultFragmentTemplate",{get:function(){return pi},enumerable:!1,configurable:!0}),t}().create(),gi={},vi=function(t){Object.defineProperty(gi,t,{get:function(){return Ae("6.0.0","PIXI.systems."+t+" has moved to PIXI."+t),xr[t]}})};for(var yi in xr)vi(yi);var bi={},_i=function(t){Object.defineProperty(bi,t,{get:function(){return Ae("6.0.0","PIXI.resources."+t+" has moved to PIXI."+t),ei[t]}})};for(var yi in ei)_i(yi);
/*!
     * @pixi/display - v6.1.2
     * Compiled Thu, 12 Aug 2021 17:11:19 UTC
     *
     * @pixi/display is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */rt.SORTABLE_CHILDREN=!1;var Ei=function(){function t(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return t.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},t.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},t.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?je.EMPTY:((t=t||new je(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},t.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},t.prototype.addPointMatrix=function(t,e){var r=t.a,n=t.b,i=t.c,o=t.d,s=t.tx,a=t.ty,h=r*e.x+i*e.y+s,u=n*e.x+o*e.y+a;this.minX=Math.min(this.minX,h),this.maxX=Math.max(this.maxX,h),this.minY=Math.min(this.minY,u),this.maxY=Math.max(this.maxY,u)},t.prototype.addQuad=function(t){var e=this.minX,r=this.minY,n=this.maxX,i=this.maxY,o=t[0],s=t[1];e=o<e?o:e,r=s<r?s:r,n=o>n?o:n,i=s>i?s:i,e=(o=t[2])<e?o:e,r=(s=t[3])<r?s:r,n=o>n?o:n,i=s>i?s:i,e=(o=t[4])<e?o:e,r=(s=t[5])<r?s:r,n=o>n?o:n,i=s>i?s:i,e=(o=t[6])<e?o:e,r=(s=t[7])<r?s:r,n=o>n?o:n,i=s>i?s:i,this.minX=e,this.minY=r,this.maxX=n,this.maxY=i},t.prototype.addFrame=function(t,e,r,n,i){this.addFrameMatrix(t.worldTransform,e,r,n,i)},t.prototype.addFrameMatrix=function(t,e,r,n,i){var o=t.a,s=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,f=this.maxX,p=this.maxY,m=o*e+a*r+u,g=s*e+h*r+l;c=m<c?m:c,d=g<d?g:d,f=m>f?m:f,p=g>p?g:p,c=(m=o*n+a*r+u)<c?m:c,d=(g=s*n+h*r+l)<d?g:d,f=m>f?m:f,p=g>p?g:p,c=(m=o*e+a*i+u)<c?m:c,d=(g=s*e+h*i+l)<d?g:d,f=m>f?m:f,p=g>p?g:p,c=(m=o*n+a*i+u)<c?m:c,d=(g=s*n+h*i+l)<d?g:d,f=m>f?m:f,p=g>p?g:p,this.minX=c,this.minY=d,this.maxX=f,this.maxY=p},t.prototype.addVertexData=function(t,e,r){for(var n=this.minX,i=this.minY,o=this.maxX,s=this.maxY,a=e;a<r;a+=2){var h=t[a],u=t[a+1];n=h<n?h:n,i=u<i?u:i,o=h>o?h:o,s=u>s?u:s}this.minX=n,this.minY=i,this.maxX=o,this.maxY=s},t.prototype.addVertices=function(t,e,r,n){this.addVerticesMatrix(t.worldTransform,e,r,n)},t.prototype.addVerticesMatrix=function(t,e,r,n,i,o){void 0===i&&(i=0),void 0===o&&(o=i);for(var s=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty,d=this.minX,f=this.minY,p=this.maxX,m=this.maxY,g=r;g<n;g+=2){var v=e[g],y=e[g+1],b=s*v+h*y+l,_=u*y+a*v+c;d=Math.min(d,b-i),p=Math.max(p,b+i),f=Math.min(f,_-o),m=Math.max(m,_+o)}this.minX=d,this.minY=f,this.maxX=p,this.maxY=m},t.prototype.addBounds=function(t){var e=this.minX,r=this.minY,n=this.maxX,i=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<r?t.minY:r,this.maxX=t.maxX>n?t.maxX:n,this.maxY=t.maxY>i?t.maxY:i},t.prototype.addBoundsMask=function(t,e){var r=t.minX>e.minX?t.minX:e.minX,n=t.minY>e.minY?t.minY:e.minY,i=t.maxX<e.maxX?t.maxX:e.maxX,o=t.maxY<e.maxY?t.maxY:e.maxY;if(r<=i&&n<=o){var s=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=r<s?r:s,this.minY=n<a?n:a,this.maxX=i>h?i:h,this.maxY=o>u?o:u}},t.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},t.prototype.addBoundsArea=function(t,e){var r=t.minX>e.x?t.minX:e.x,n=t.minY>e.y?t.minY:e.y,i=t.maxX<e.x+e.width?t.maxX:e.x+e.width,o=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(r<=i&&n<=o){var s=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=r<s?r:s,this.minY=n<a?n:a,this.maxX=i>h?i:h,this.maxY=o>u?o:u}},t.prototype.pad=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},t.prototype.addFramePad=function(t,e,r,n,i,o){t-=i,e-=o,r+=i,n+=o,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>n?this.maxY:n},t}(),xi=function(t,e){return(xi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function Ti(t,e){function r(){this.constructor=t}xi(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var wi=function(t){function e(){var e=t.call(this)||this;return e.tempDisplayObjectParent=null,e.transform=new nr,e.alpha=1,e.visible=!0,e.renderable=!0,e.parent=null,e.worldAlpha=1,e._lastSortedIndex=0,e._zIndex=0,e.filterArea=null,e.filters=null,e._enabledFilters=null,e._bounds=new Ei,e._localBounds=null,e._boundsID=0,e._boundsRect=null,e._localBoundsRect=null,e._mask=null,e._destroyed=!1,e.isSprite=!1,e.isMask=!1,e}return Ti(e,t),e.mixin=function(t){for(var r=Object.keys(t),n=0;n<r.length;++n){var i=r[n];Object.defineProperty(e.prototype,i,Object.getOwnPropertyDescriptor(t,i))}},Object.defineProperty(e.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!1,configurable:!0}),e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new je),e=this._boundsRect),this._bounds.getRectangle(e)},e.prototype.getLocalBounds=function(t){t||(this._localBoundsRect||(this._localBoundsRect=new je),t=this._localBoundsRect),this._localBounds||(this._localBounds=new Ei);var e=this.transform,r=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var n=this._bounds,i=this._boundsID;this._bounds=this._localBounds;var o=this.getBounds(!1,t);return this.parent=r,this.transform=e,this._bounds=n,this._bounds.updateID+=this._boundsID-i,o},e.prototype.toGlobal=function(t,e,r){return void 0===r&&(r=!1),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},e.prototype.toLocal=function(t,e,r,n){return e&&(t=e.toGlobal(t,r,n)),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,r)},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(t,e,r,n,i,o,s,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=1),void 0===n&&(n=1),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=r||1,this.scale.y=n||1,this.rotation=i,this.skew.x=o,this.skew.y=s,this.pivot.x=a,this.pivot.y=h,this},e.prototype.destroy=function(t){this.parent&&this.parent.removeChild(this),this.emit("destroyed"),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},Object.defineProperty(e.prototype,"_tempDisplayObjectParent",{get:function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new Ai),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),e.prototype.enableTempParent=function(){var t=this.parent;return this.parent=this._tempDisplayObjectParent,t},e.prototype.disableTempParent=function(t){this.parent=t},Object.defineProperty(e.prototype,"x",{get:function(){return this.position.x},set:function(t){this.transform.position.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.position.y},set:function(t){this.transform.position.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this.transform.position},set:function(t){this.transform.position.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this.transform.scale},set:function(t){this.transform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pivot",{get:function(){return this.transform.pivot},set:function(t){this.transform.pivot.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skew",{get:function(){return this.transform.skew},set:function(t){this.transform.skew.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return this.transform.rotation*ke},set:function(t){this.transform.rotation=t*Ge},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zIndex",{get:function(){return this._zIndex},set:function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldVisible",{get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return this._mask},set:function(t){var e;this._mask&&((e=this._mask.maskObject||this._mask).renderable=!0,e.isMask=!1);(this._mask=t,this._mask)&&((e=this._mask.maskObject||this._mask).renderable=!1,e.isMask=!0)},enumerable:!1,configurable:!0}),e}(ot),Ai=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sortDirty=null,e}return Ti(e,t),e}(wi);function Si(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}wi.prototype.displayObjectUpdateTransform=wi.prototype.updateTransform;var Oi=function(t){function e(){var e=t.call(this)||this;return e.children=[],e.sortableChildren=rt.SORTABLE_CHILDREN,e.sortDirty=!1,e}return Ti(e,t),e.prototype.onChildrenChange=function(t){},e.prototype.addChild=function(){for(var t=arguments,e=[],r=0;r<arguments.length;r++)e[r]=t[r];if(e.length>1)for(var n=0;n<e.length;n++)this.addChild(e[n]);else{var i=e[0];i.parent&&i.parent.removeChild(i),i.parent=this,this.sortDirty=!0,i.transform._parentID=-1,this.children.push(i),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",i,this,this.children.length-1),i.emit("added",this)}return e[0]},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},e.prototype.swapChildren=function(t,e){if(t!==e){var r=this.getChildIndex(t),n=this.getChildIndex(e);this.children[r]=e,this.children[n]=t,this.onChildrenChange(r<n?r:n)}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var r=this.getChildIndex(t);_e(this.children,r,1),this.children.splice(e,0,t),this.onChildrenChange(e)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(){for(var t=arguments,e=[],r=0;r<arguments.length;r++)e[r]=t[r];if(e.length>1)for(var n=0;n<e.length;n++)this.removeChild(e[n]);else{var i=e[0],o=this.children.indexOf(i);if(-1===o)return null;i.parent=null,i.transform._parentID=-1,_e(this.children,o,1),this._boundsID++,this.onChildrenChange(o),i.emit("removed",this),this.emit("childRemoved",i,this,o)}return e[0]},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,_e(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},e.prototype.removeChildren=function(t,e){void 0===t&&(t=0),void 0===e&&(e=this.children.length);var r,n=t,i=e-n;if(i>0&&i<=e){r=this.children.splice(n,i);for(var o=0;o<r.length;++o)r[o].parent=null,r[o].transform&&(r[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(o=0;o<r.length;++o)r[o].emit("removed",this),this.emit("childRemoved",r[o],this,o);return r}if(0===i&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.sortChildren=function(){for(var t=!1,e=0,r=this.children.length;e<r;++e){var n=this.children[e];n._lastSortedIndex=e,t||0===n.zIndex||(t=!0)}t&&this.children.length>1&&this.children.sort(Si),this.sortDirty=!1},e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var r=this.children[t];r.visible&&r.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var r=e._mask.maskObject||e._mask;r.calculateBounds(),this._bounds.addBoundsMask(e._bounds,r._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._bounds.updateID=this._boundsID},e.prototype.getLocalBounds=function(e,r){void 0===r&&(r=!1);var n=t.prototype.getLocalBounds.call(this,e);if(!r)for(var i=0,o=this.children.length;i<o;++i){var s=this.children[i];s.visible&&s.updateTransform()}return n},e.prototype._calculateBounds=function(){},e.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,r=this.children.length;e<r;++e)this.children[e].render(t)}},e.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,r=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var n=0;n<e.length;n++)e[n].enabled&&this._enabledFilters.push(e[n]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}r&&t.mask.push(this,this._mask),this._render(t);n=0;for(var i=this.children.length;n<i;n++)this.children[n].render(t);t.batch.flush(),r&&t.mask.pop(this),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},e.prototype._render=function(t){},e.prototype.destroy=function(e){t.prototype.destroy.call(this),this.sortDirty=!1;var r="boolean"==typeof e?e:e&&e.children,n=this.removeChildren(0,this.children.length);if(r)for(var i=0;i<n.length;++i)n[i].destroy(e)},Object.defineProperty(e.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},enumerable:!1,configurable:!0}),e}(wi);Oi.prototype.containerUpdateTransform=Oi.prototype.updateTransform;
/*!
     * @pixi/sprite - v6.1.2
     * Compiled Thu, 12 Aug 2021 17:11:19 UTC
     *
     * @pixi/sprite is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
var Ii=function(t,e){return(Ii=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};var Ri,Ni=new We,Li=new Uint16Array([0,1,2,0,2,3]),Mi=function(t){function e(e){var r=t.call(this)||this;return r._anchor=new Ye(r._onAnchorUpdate,r,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),r._texture=null,r._width=0,r._height=0,r._tint=null,r._tintRGB=null,r.tint=16777215,r.blendMode=i.NORMAL,r._cachedTint=16777215,r.uvs=null,r.texture=e||Ir.EMPTY,r.vertexData=new Float32Array(8),r.vertexTrimmedData=null,r._transformID=-1,r._textureID=-1,r._transformTrimmedID=-1,r._textureTrimmedID=-1,r.indices=Li,r.pluginName="batch",r.isSprite=!0,r._roundPixels=rt.ROUND_PIXELS,r}return function(t,e){function r(){this.constructor=t}Ii(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Ee(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Ee(this.scale.y)*this._height/this._texture.orig.height)},e.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},e.prototype.calculateVertices=function(){var t=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==t._updateID){this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;var e=this.transform.worldTransform,r=e.a,n=e.b,i=e.c,o=e.d,s=e.tx,a=e.ty,h=this.vertexData,u=t.trim,l=t.orig,c=this._anchor,d=0,f=0,p=0,m=0;if(u?(d=(f=u.x-c._x*l.width)+u.width,p=(m=u.y-c._y*l.height)+u.height):(d=(f=-c._x*l.width)+l.width,p=(m=-c._y*l.height)+l.height),h[0]=r*f+i*m+s,h[1]=o*m+n*f+a,h[2]=r*d+i*m+s,h[3]=o*m+n*d+a,h[4]=r*d+i*p+s,h[5]=o*p+n*d+a,h[6]=r*f+i*p+s,h[7]=o*p+n*f+a,this._roundPixels)for(var g=rt.RESOLUTION,v=0;v<h.length;++v)h[v]=Math.round((h[v]*g|0)/g)}},e.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,e=this.vertexTrimmedData,r=t.orig,n=this._anchor,i=this.transform.worldTransform,o=i.a,s=i.b,a=i.c,h=i.d,u=i.tx,l=i.ty,c=-n._x*r.width,d=c+r.width,f=-n._y*r.height,p=f+r.height;e[0]=o*c+a*f+u,e[1]=h*f+s*c+l,e[2]=o*d+a*f+u,e[3]=h*f+s*d+l,e[4]=o*d+a*p+u,e[5]=h*p+s*d+l,e[6]=o*c+a*p+u,e[7]=h*p+s*c+l},e.prototype._render=function(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},e.prototype._calculateBounds=function(){var t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new je),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,Ni);var e=this._texture.orig.width,r=this._texture.orig.height,n=-e*this.anchor.x,i=0;return Ni.x>=n&&Ni.x<n+e&&(i=-r*this.anchor.y,Ni.y>=i&&Ni.y<i+r)},e.prototype.destroy=function(e){if(t.prototype.destroy.call(this,e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof e?e:e&&e.texture){var r="boolean"==typeof e?e:e&&e.baseTexture;this._texture.destroy(!!r)}this._texture=null},e.from=function(t,r){return new e(t instanceof Ir?t:Ir.from(t,r))},Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){var e=Ee(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){var e=Ee(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{get:function(){return this._anchor},set:function(t){this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||Ir.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))},enumerable:!1,configurable:!0}),e}(Oi),Pi=function(t,e){return(Pi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};!function(t){t[t.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",t[t.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL"}(Ri||(Ri={}));var Ci={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Ri.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},Di=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Ui=function(){function t(t){this.styleID=0,this.reset(),ki(this,t,t)}return t.prototype.clone=function(){var e={};return ki(e,this,Ci),new t(e)},t.prototype.reset=function(){ki(this,Ci,Ci)},Object.defineProperty(t.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"breakWords",{get:function(){return this._breakWords},set:function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadow",{get:function(){return this._dropShadow},set:function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowAlpha",{get:function(){return this._dropShadowAlpha},set:function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowAngle",{get:function(){return this._dropShadowAngle},set:function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowBlur",{get:function(){return this._dropShadowBlur},set:function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowColor",{get:function(){return this._dropShadowColor},set:function(t){var e=Fi(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowDistance",{get:function(){return this._dropShadowDistance},set:function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fill",{get:function(){return this._fill},set:function(t){var e=Fi(t);this._fill!==e&&(this._fill=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fillGradientType",{get:function(){return this._fillGradientType},set:function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fillGradientStops",{get:function(){return this._fillGradientStops},set:function(t){(function(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(var r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontVariant",{get:function(){return this._fontVariant},set:function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineHeight",{get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leading",{get:function(){return this._leading},set:function(t){this._leading!==t&&(this._leading=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineJoin",{get:function(){return this._lineJoin},set:function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"miterLimit",{get:function(){return this._miterLimit},set:function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"padding",{get:function(){return this._padding},set:function(t){this._padding!==t&&(this._padding=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stroke",{get:function(){return this._stroke},set:function(t){var e=Fi(t);this._stroke!==e&&(this._stroke=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"strokeThickness",{get:function(){return this._strokeThickness},set:function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textBaseline",{get:function(){return this._textBaseline},set:function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"trim",{get:function(){return this._trim},set:function(t){this._trim!==t&&(this._trim=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"whiteSpace",{get:function(){return this._whiteSpace},set:function(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wordWrap",{get:function(){return this._wordWrap},set:function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wordWrapWidth",{get:function(){return this._wordWrapWidth},set:function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)},enumerable:!1,configurable:!0}),t.prototype.toFontString=function(){var t="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var r=e.length-1;r>=0;r--){var n=e[r].trim();!/([\"\'])[^\'\"]+\1/.test(n)&&Di.indexOf(n)<0&&(n='"'+n+'"'),e[r]=n}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+e.join(",")},t}();function Bi(t){return"number"==typeof t?de(t):("string"==typeof t&&0===t.indexOf("0x")&&(t=t.replace("0x","#")),t)}function Fi(t){if(Array.isArray(t)){for(var e=0;e<t.length;++e)t[e]=Bi(t[e]);return t}return Bi(t)}function ki(t,e,r){for(var n in r)Array.isArray(e[n])?t[n]=e[n].slice():t[n]=e[n]}var Gi=function(){function t(t,e,r,n,i,o,s,a,h){this.text=t,this.style=e,this.width=r,this.height=n,this.lines=i,this.lineWidths=o,this.lineHeight=s,this.maxLineWidth=a,this.fontProperties=h}return t.measureText=function(e,r,n,i){void 0===i&&(i=t._canvas),n=null==n?r.wordWrap:n;var o=r.toFontString(),s=t.measureFont(o);0===s.fontSize&&(s.fontSize=r.fontSize,s.ascent=r.fontSize);var a=i.getContext("2d");a.font=o;for(var h=(n?t.wordWrap(e,r,i):e).split(/(?:\r\n|\r|\n)/),u=new Array(h.length),l=0,c=0;c<h.length;c++){var d=a.measureText(h[c]).width+(h[c].length-1)*r.letterSpacing;u[c]=d,l=Math.max(l,d)}var f=l+r.strokeThickness;r.dropShadow&&(f+=r.dropShadowDistance);var p=r.lineHeight||s.fontSize+r.strokeThickness,m=Math.max(p,s.fontSize+r.strokeThickness)+(h.length-1)*(p+r.leading);return r.dropShadow&&(m+=r.dropShadowDistance),new t(e,r,f,m,h,u,p+r.leading,l,s)},t.wordWrap=function(e,r,n){void 0===n&&(n=t._canvas);for(var i=n.getContext("2d"),o=0,s="",a="",h=Object.create(null),u=r.letterSpacing,l=r.whiteSpace,c=t.collapseSpaces(l),d=t.collapseNewlines(l),f=!c,p=r.wordWrapWidth+u,m=t.tokenize(e),g=0;g<m.length;g++){var v=m[g];if(t.isNewline(v)){if(!d){a+=t.addLine(s),f=!c,s="",o=0;continue}v=" "}if(c){var y=t.isBreakingSpace(v),b=t.isBreakingSpace(s[s.length-1]);if(y&&b)continue}var _=t.getFromCache(v,u,h,i);if(_>p)if(""!==s&&(a+=t.addLine(s),s="",o=0),t.canBreakWords(v,r.breakWords))for(var E=t.wordWrapSplit(v),x=0;x<E.length;x++){for(var T=E[x],w=1;E[x+w];){var A=E[x+w],S=T[T.length-1];if(t.canBreakChars(S,A,v,x,r.breakWords))break;T+=A,w++}x+=T.length-1;var O=t.getFromCache(T,u,h,i);O+o>p&&(a+=t.addLine(s),f=!1,s="",o=0),s+=T,o+=O}else{s.length>0&&(a+=t.addLine(s),s="",o=0);var I=g===m.length-1;a+=t.addLine(v,!I),f=!1,s="",o=0}else _+o>p&&(f=!1,a+=t.addLine(s),s="",o=0),(s.length>0||!t.isBreakingSpace(v)||f)&&(s+=v,o+=_)}return a+=t.addLine(s,!1)},t.addLine=function(e,r){return void 0===r&&(r=!0),e=t.trimRight(e),e=r?e+"\n":e},t.getFromCache=function(t,e,r,n){var i=r[t];if("number"!=typeof i){var o=t.length*e;i=n.measureText(t).width+o,r[t]=i}return i},t.collapseSpaces=function(t){return"normal"===t||"pre-line"===t},t.collapseNewlines=function(t){return"normal"===t},t.trimRight=function(e){if("string"!=typeof e)return"";for(var r=e.length-1;r>=0;r--){var n=e[r];if(!t.isBreakingSpace(n))break;e=e.slice(0,-1)}return e},t.isNewline=function(e){return"string"==typeof e&&t._newlines.indexOf(e.charCodeAt(0))>=0},t.isBreakingSpace=function(e,r){return"string"==typeof e&&t._breakingSpaces.indexOf(e.charCodeAt(0))>=0},t.tokenize=function(e){var r=[],n="";if("string"!=typeof e)return r;for(var i=0;i<e.length;i++){var o=e[i],s=e[i+1];t.isBreakingSpace(o,s)||t.isNewline(o)?(""!==n&&(r.push(n),n=""),r.push(o)):n+=o}return""!==n&&r.push(n),r},t.canBreakWords=function(t,e){return e},t.canBreakChars=function(t,e,r,n,i){return!0},t.wordWrapSplit=function(t){return t.split("")},t.measureFont=function(e){if(t._fonts[e])return t._fonts[e];var r={ascent:0,descent:0,fontSize:0},n=t._canvas,i=t._context;i.font=e;var o=t.METRICS_STRING+t.BASELINE_SYMBOL,s=Math.ceil(i.measureText(o).width),a=Math.ceil(i.measureText(t.BASELINE_SYMBOL).width),h=Math.ceil(t.HEIGHT_MULTIPLIER*a);a=a*t.BASELINE_MULTIPLIER|0,n.width=s,n.height=h,i.fillStyle="#f00",i.fillRect(0,0,s,h),i.font=e,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(o,0,a);var u=i.getImageData(0,0,s,h).data,l=u.length,c=4*s,d=0,f=0,p=!1;for(d=0;d<a;++d){for(var m=0;m<c;m+=4)if(255!==u[f+m]){p=!0;break}if(p)break;f+=c}for(r.ascent=a-d,f=l-c,p=!1,d=h;d>a;--d){for(m=0;m<c;m+=4)if(255!==u[f+m]){p=!0;break}if(p)break;f-=c}return r.descent=d-a,r.fontSize=r.ascent+r.descent,t._fonts[e]=r,r},t.clearMetrics=function(e){void 0===e&&(e=""),e?delete t._fonts[e]:t._fonts={}},t}(),ji=function(){try{var t=new OffscreenCanvas(0,0),e=t.getContext("2d");return e&&e.measureText?t:document.createElement("canvas")}catch(t){return document.createElement("canvas")}}();ji.width=ji.height=10,Gi._canvas=ji,Gi._context=ji.getContext("2d"),Gi._fonts={},Gi.METRICS_STRING="|q",Gi.BASELINE_SYMBOL="M",Gi.BASELINE_MULTIPLIER=1.4,Gi.HEIGHT_MULTIPLIER=2,Gi._newlines=[10,13],Gi._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var Hi={texture:!0,children:!1,baseTexture:!0},Xi=function(t){function e(e,r,n){var i=this,o=!1;n||(n=document.createElement("canvas"),o=!0),n.width=3,n.height=3;var s=Ir.from(n);return s.orig=new je,s.trim=new je,(i=t.call(this,s)||this)._ownCanvas=o,i.canvas=n,i.context=i.canvas.getContext("2d"),i._resolution=rt.RESOLUTION,i._autoResolution=!0,i._text=null,i._style=null,i._styleListener=null,i._font="",i.text=e,i.style=r,i.localStyleID=-1,i}return function(t,e){function r(){this.constructor=t}Pi(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e.prototype.updateText=function(t){var r=this._style;if(this.localStyleID!==r.styleID&&(this.dirty=!0,this.localStyleID=r.styleID),this.dirty||!t){this._font=this._style.toFontString();var n,i,o=this.context,s=Gi.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),a=s.width,h=s.height,u=s.lines,l=s.lineHeight,c=s.lineWidths,d=s.maxLineWidth,f=s.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,a)+2*r.padding)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,h)+2*r.padding)*this._resolution),o.scale(this._resolution,this._resolution),o.clearRect(0,0,this.canvas.width,this.canvas.height),o.font=this._font,o.lineWidth=r.strokeThickness,o.textBaseline=r.textBaseline,o.lineJoin=r.lineJoin,o.miterLimit=r.miterLimit;for(var p=r.dropShadow?2:1,m=0;m<p;++m){var g=r.dropShadow&&0===m,v=g?Math.ceil(Math.max(1,h)+2*r.padding):0,y=v*this._resolution;if(g){o.fillStyle="black",o.strokeStyle="black";var b=r.dropShadowColor,_=ce("number"==typeof b?b:fe(b));o.shadowColor="rgba("+255*_[0]+","+255*_[1]+","+255*_[2]+","+r.dropShadowAlpha+")",o.shadowBlur=r.dropShadowBlur,o.shadowOffsetX=Math.cos(r.dropShadowAngle)*r.dropShadowDistance,o.shadowOffsetY=Math.sin(r.dropShadowAngle)*r.dropShadowDistance+y}else o.fillStyle=this._generateFillStyle(r,u,s),o.strokeStyle=r.stroke,o.shadowColor="black",o.shadowBlur=0,o.shadowOffsetX=0,o.shadowOffsetY=0;var E=(l-f.fontSize)/2;(!e.nextLineHeightBehavior||l-f.fontSize<0)&&(E=0);for(var x=0;x<u.length;x++)n=r.strokeThickness/2,i=r.strokeThickness/2+x*l+f.ascent+E,"right"===r.align?n+=d-c[x]:"center"===r.align&&(n+=(d-c[x])/2),r.stroke&&r.strokeThickness&&this.drawLetterSpacing(u[x],n+r.padding,i+r.padding-v,!0),r.fill&&this.drawLetterSpacing(u[x],n+r.padding,i+r.padding-v)}this.updateTexture()}},e.prototype.drawLetterSpacing=function(t,e,r,n){void 0===n&&(n=!1);var i=this._style.letterSpacing;if(0!==i)for(var o=e,s=Array.from?Array.from(t):t.split(""),a=this.context.measureText(t).width,h=0,u=0;u<s.length;++u){var l=s[u];n?this.context.strokeText(l,o,r):this.context.fillText(l,o,r),o+=a-(h=this.context.measureText(t.substring(u+1)).width)+i,a=h}else n?this.context.strokeText(t,e,r):this.context.fillText(t,e,r)},e.prototype.updateTexture=function(){var t=this.canvas;if(this._style.trim){var e=function(t){var e,r,n,i=t.width,o=t.height,s=t.getContext("2d"),a=s.getImageData(0,0,i,o).data,h=a.length,u={top:null,left:null,right:null,bottom:null},l=null;for(e=0;e<h;e+=4)0!==a[e+3]&&(r=e/4%i,n=~~(e/4/i),null===u.top&&(u.top=n),(null===u.left||r<u.left)&&(u.left=r),(null===u.right||u.right<r)&&(u.right=r+1),(null===u.bottom||u.bottom<n)&&(u.bottom=n));return null!==u.top&&(i=u.right-u.left,o=u.bottom-u.top+1,l=s.getImageData(u.left,u.top,i,o)),{height:o,width:i,data:l}}(t);e.data&&(t.width=e.width,t.height=e.height,this.context.putImageData(e.data,0,0))}var r=this._texture,n=this._style,i=n.trim?0:n.padding,o=r.baseTexture;r.trim.width=r._frame.width=t.width/this._resolution,r.trim.height=r._frame.height=t.height/this._resolution,r.trim.x=-i,r.trim.y=-i,r.orig.width=r._frame.width-2*i,r.orig.height=r._frame.height-2*i,this._onTextureUpdate(),o.setRealSize(t.width,t.height,this._resolution),r.updateUvs(),this._recursivePostUpdateTransform(),this.dirty=!1},e.prototype._render=function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),t.prototype._render.call(this,e)},e.prototype.getLocalBounds=function(e){return this.updateText(!0),t.prototype.getLocalBounds.call(this,e)},e.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},e.prototype._generateFillStyle=function(t,e,r){var n,i=t.fill;if(!Array.isArray(i))return i;if(1===i.length)return i[0];var o=t.dropShadow?t.dropShadowDistance:0,s=t.padding||0,a=this.canvas.width/this._resolution-o-2*s,h=this.canvas.height/this._resolution-o-2*s,u=i.slice(),l=t.fillGradientStops.slice();if(!l.length)for(var c=u.length+1,d=1;d<c;++d)l.push(d/c);if(u.unshift(i[0]),l.unshift(0),u.push(i[i.length-1]),l.push(1),t.fillGradientType===Ri.LINEAR_VERTICAL){n=this.context.createLinearGradient(a/2,s,a/2,h+s);var f=r.fontProperties.fontSize+t.strokeThickness;for(d=0;d<e.length;d++){var p=r.lineHeight*(d-1)+f,m=r.lineHeight*d,g=m;d>0&&p>m&&(g=(m+p)/2);var v=m+f,y=r.lineHeight*(d+1),b=v;d+1<e.length&&y<v&&(b=(v+y)/2);for(var _=(b-g)/h,E=0;E<u.length;E++){var x=0;x="number"==typeof l[E]?l[E]:E/u.length;var T=Math.min(1,Math.max(0,g/h+x*_));T=Number(T.toFixed(5)),n.addColorStop(T,u[E])}}}else{n=this.context.createLinearGradient(s,h/2,a+s,h/2);var w=u.length+1,A=1;for(d=0;d<u.length;d++){var S=void 0;S="number"==typeof l[d]?l[d]:A/w,n.addColorStop(S,u[d]),A++}}return n},e.prototype.destroy=function(e){"boolean"==typeof e&&(e={children:e}),e=Object.assign({},Hi,e),t.prototype.destroy.call(this,e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},Object.defineProperty(e.prototype,"width",{get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){this.updateText(!0);var e=Ee(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){this.updateText(!0);var e=Ee(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){return this._style},set:function(t){t=t||{},this._style=t instanceof Ui?t:new Ui(t),this.localStyleID=-1,this.dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)},enumerable:!1,configurable:!0}),e.nextLineHeightBehavior=!1,e}(Mi),zi=function(t,e){return(zi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function Vi(t,e){function r(){this.constructor=t}zi(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var Wi=function(){function t(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}return t.prototype.update=function(t){if(t||this._bufferUpdateId!==this.uvBuffer._updateID||this._textureUpdateId!==this.uvMatrix._updateID){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var e=this.uvBuffer.data;this.data&&this.data.length===e.length||(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}},t}(),Yi=new We,qi=new ze,Ki=function(t){function e(e,r,n,i){void 0===i&&(i=o.TRIANGLES);var s=t.call(this)||this;return s.geometry=e,e.refCount++,s.shader=r,s.state=n||Rn.for2d(),s.drawMode=i,s.start=0,s.size=0,s.uvs=null,s.indices=null,s.vertexData=new Float32Array(1),s.vertexDirty=-1,s._transformID=-1,s._roundPixels=rt.ROUND_PIXELS,s.batchUvs=null,s}return Vi(e,t),Object.defineProperty(e.prototype,"uvBuffer",{get:function(){return this.geometry.buffers[1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticesBuffer",{get:function(){return this.geometry.buffers[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"material",{get:function(){return this.shader},set:function(t){this.shader=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return"tint"in this.shader?this.shader.tint:null},set:function(t){this.shader.tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return"texture"in this.shader?this.shader.texture:null},set:function(t){this.shader.texture=t},enumerable:!1,configurable:!0}),e.prototype._render=function(t){var r=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===o.TRIANGLES&&r.length<2*e.BATCHABLE_SIZE?this._renderToBatch(t):this._renderDefault(t)},e.prototype._renderDefault=function(t){var e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},e.prototype._renderToBatch=function(t){var e=this.geometry,r=this.shader;r.uvMatrix&&(r.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=r._tintRGB,this._texture=r.texture;var n=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[n]),t.plugins[n].render(this)},e.prototype.calculateVertices=function(){var t=this.geometry.buffers[0],e=t.data,r=t._updateID;if(r!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));for(var n=this.transform.worldTransform,i=n.a,o=n.b,s=n.c,a=n.d,h=n.tx,u=n.ty,l=this.vertexData,c=0;c<l.length/2;c++){var d=e[2*c],f=e[2*c+1];l[2*c]=i*d+s*f+h,l[2*c+1]=o*d+a*f+u}if(this._roundPixels){var p=rt.RESOLUTION;for(c=0;c<l.length;++c)l[c]=Math.round((l[c]*p|0)/p)}this.vertexDirty=r}},e.prototype.calculateUvs=function(){var t=this.geometry.buffers[1],e=this.shader;e.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new Wi(t,e.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},e.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},e.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,Yi);for(var e=this.geometry.getBuffer("aVertexPosition").data,r=qi.points,n=this.geometry.getIndex().data,i=n.length,o=4===this.drawMode?3:1,s=0;s+2<i;s+=o){var a=2*n[s],h=2*n[s+1],u=2*n[s+2];if(r[0]=e[a],r[1]=e[a+1],r[2]=e[h],r[3]=e[h+1],r[4]=e[u],r[5]=e[u+1],qi.contains(Yi.x,Yi.y))return!0}return!1},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.geometry.refCount--,0===this.geometry.refCount&&this.geometry.dispose(),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},e.BATCHABLE_SIZE=100,e}(Oi),Zi=function(t){function e(e,r){var n=this,i={uSampler:e,alpha:1,uTextureMatrix:qe.IDENTITY,uColor:new Float32Array([1,1,1,1])};return(r=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},r)).uniforms&&Object.assign(i,r.uniforms),(n=t.call(this,r.program||On.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n"),i)||this)._colorDirty=!1,n.uvMatrix=new Mn(e),n.batchable=void 0===r.program,n.pluginName=r.pluginName,n.tint=r.tint,n.alpha=r.alpha,n}return Vi(e,t),Object.defineProperty(e.prototype,"texture",{get:function(){return this.uniforms.uSampler},set:function(t){this.uniforms.uSampler!==t&&(this.uniforms.uSampler=t,this.uvMatrix.texture=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16),this._colorDirty=!0)},enumerable:!1,configurable:!0}),e.prototype.update=function(){if(this._colorDirty){this._colorDirty=!1;var t=this.texture.baseTexture;e=this._tint,r=this._alpha,n=this.uniforms.uColor,i=t.alphaMode,(n=n||new Float32Array(4))[0]=(e>>16&255)/255,n[1]=(e>>8&255)/255,n[2]=(255&e)/255,(i||void 0===i)&&(n[0]*=r,n[1]*=r,n[2]*=r),n[3]=r}var e,r,n,i;this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},e}(In),Ji=function(t){function e(e,r,n){var i=t.call(this)||this,o=new Cr(e),s=new Cr(r,!0),a=new Cr(n,!0,!0);return i.addAttribute("aVertexPosition",o,2,!1,h.FLOAT).addAttribute("aTextureCoord",s,2,!1,h.FLOAT).addIndex(a),i._updateId=-1,i}return Vi(e,t),Object.defineProperty(e.prototype,"vertexDirtyId",{get:function(){return this.buffers[0]._updateID},enumerable:!1,configurable:!0}),e}(kr),Qi=function(){function t(t,e,r){void 0===e&&(e=!1),this._fn=t,this._once=e,this._thisArg=r,this._next=this._prev=this._owner=null}return t.prototype.detach=function(){return null!==this._owner&&(this._owner.detach(this),!0)},t}();function $i(t,e){return t._head?(t._tail._next=e,e._prev=t._tail,t._tail=e):(t._head=e,t._tail=e),e._owner=t,e}var to=function(){function t(){this._head=this._tail=void 0}return t.prototype.handlers=function(t){void 0===t&&(t=!1);var e=this._head;if(t)return!!e;for(var r=[];e;)r.push(e),e=e._next;return r},t.prototype.has=function(t){if(!(t instanceof Qi))throw new Error("MiniSignal#has(): First arg must be a SignalBinding object.");return t._owner===this},t.prototype.dispatch=function(){for(var t=arguments,e=[],r=0;r<arguments.length;r++)e[r]=t[r];var n=this._head;if(!n)return!1;for(;n;)n._once&&this.detach(n),n._fn.apply(n._thisArg,e),n=n._next;return!0},t.prototype.add=function(t,e){if(void 0===e&&(e=null),"function"!=typeof t)throw new Error("MiniSignal#add(): First arg must be a Function.");return $i(this,new Qi(t,!1,e))},t.prototype.once=function(t,e){if(void 0===e&&(e=null),"function"!=typeof t)throw new Error("MiniSignal#once(): First arg must be a Function.");return $i(this,new Qi(t,!0,e))},t.prototype.detach=function(t){if(!(t instanceof Qi))throw new Error("MiniSignal#detach(): First arg must be a SignalBinding object.");return t._owner!==this||(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,null===t._next&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null),this},t.prototype.detachAll=function(){var t=this._head;if(!t)return this;for(this._head=this._tail=null;t;)t._owner=null,t=t._next;return this},t}();function eo(t,e){e=e||{};for(var r={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},n=r.parser[e.strictMode?"strict":"loose"].exec(t),i={},o=14;o--;)i[r.key[o]]=n[o]||"";return i[r.q.name]={},i[r.key[12]].replace(r.q.parser,(function(t,e,n){e&&(i[r.q.name][e]=n)})),i}var ro=!(!self.XDomainRequest||"withCredentials"in new XMLHttpRequest),no=null;function io(){}function oo(t,e,r){e&&0===e.indexOf(".")&&(e=e.substring(1)),e&&(t[e]=r)}function so(t){return t.toString().replace("object ","")}var ao=function(){function t(e,r,n){if(this._dequeue=io,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=null,this._boundOnError=null,this._boundOnProgress=null,this._boundOnTimeout=null,this._boundXhrOnError=null,this._boundXhrOnTimeout=null,this._boundXhrOnAbort=null,this._boundXhrOnLoad=null,"string"!=typeof e||"string"!=typeof r)throw new Error("Both name and url are required for constructing a resource.");n=n||{},this._flags=0,this._setFlag(t.STATUS_FLAGS.DATA_URL,0===r.indexOf("data:")),this.name=e,this.url=r,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===n.crossOrigin?"anonymous":n.crossOrigin,this.timeout=n.timeout||0,this.loadType=n.loadType||this._determineLoadType(),this.xhrType=n.xhrType,this.metadata=n.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=t.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=io,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new to,this.onProgress=new to,this.onComplete=new to,this.onAfterMiddleware=new to}return t.setExtensionLoadType=function(e,r){oo(t._loadTypeMap,e,r)},t.setExtensionXhrType=function(e,r){oo(t._xhrTypeMap,e,r)},Object.defineProperty(t.prototype,"isDataUrl",{get:function(){return this._hasFlag(t.STATUS_FLAGS.DATA_URL)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isComplete",{get:function(){return this._hasFlag(t.STATUS_FLAGS.COMPLETE)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isLoading",{get:function(){return this._hasFlag(t.STATUS_FLAGS.LOADING)},enumerable:!1,configurable:!0}),t.prototype.complete=function(){this._clearEvents(),this._finish()},t.prototype.abort=function(e){if(!this.error){if(this.error=new Error(e),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=t.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},t.prototype.load=function(e){var r=this;if(!this.isLoading)if(this.isComplete)e&&setTimeout((function(){return e(r)}),1);else switch(e&&this.onComplete.once(e),this._setFlag(t.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),!1!==this.crossOrigin&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case t.LOAD_TYPE.IMAGE:this.type=t.TYPE.IMAGE,this._loadElement("image");break;case t.LOAD_TYPE.AUDIO:this.type=t.TYPE.AUDIO,this._loadSourceElement("audio");break;case t.LOAD_TYPE.VIDEO:this.type=t.TYPE.VIDEO,this._loadSourceElement("video");break;case t.LOAD_TYPE.XHR:default:ro&&this.crossOrigin?this._loadXdr():this._loadXhr()}},t.prototype._hasFlag=function(t){return 0!=(this._flags&t)},t.prototype._setFlag=function(t,e){this._flags=e?this._flags|t:this._flags&~t},t.prototype._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},t.prototype._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(t.STATUS_FLAGS.COMPLETE,!0),this._setFlag(t.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},t.prototype._loadElement=function(t){this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===t&&void 0!==self.Image?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},t.prototype._loadSourceElement=function(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===t&&void 0!==self.Audio?this.data=new Audio:this.data=document.createElement(t),null!==this.data){if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=this.metadata.mimeType,r=0;r<this.url.length;++r)this.data.appendChild(this._createSource(t,this.url[r],Array.isArray(e)?e[r]:e));else{e=this.metadata.mimeType;this.data.appendChild(this._createSource(t,this.url,Array.isArray(e)?e[0]:e))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))}else this.abort("Unsupported element: "+t)},t.prototype._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XMLHttpRequest;e.open("GET",this.url,!0),e.timeout=this.timeout,this.xhrType===t.XHR_RESPONSE_TYPE.JSON||this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT?e.responseType=t.XHR_RESPONSE_TYPE.TEXT:e.responseType=this.xhrType,e.addEventListener("error",this._boundXhrOnError,!1),e.addEventListener("timeout",this._boundXhrOnTimeout,!1),e.addEventListener("abort",this._boundXhrOnAbort,!1),e.addEventListener("progress",this._boundOnProgress,!1),e.addEventListener("load",this._boundXhrOnLoad,!1),e.send()},t.prototype._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new self.XDomainRequest;t.timeout=this.timeout||5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXhrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout((function(){return t.send()}),1)},t.prototype._createSource=function(t,e,r){r||(r=t+"/"+this._getExtension(e));var n=document.createElement("source");return n.src=e,n.type=r,n},t.prototype._onError=function(t){this.abort("Failed to load element using: "+t.target.nodeName)},t.prototype._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},t.prototype._onTimeout=function(){this.abort("Load timed out.")},t.prototype._xhrOnError=function(){var t=this.xhr;this.abort(so(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},t.prototype._xhrOnTimeout=function(){var t=this.xhr;this.abort(so(t)+" Request timed out.")},t.prototype._xhrOnAbort=function(){var t=this.xhr;this.abort(so(t)+" Request was aborted by the user.")},t.prototype._xhrOnLoad=function(){var e=this.xhr,r="",n=void 0===e.status?200:e.status;if(""!==e.responseType&&"text"!==e.responseType&&void 0!==e.responseType||(r=e.responseText),0===n&&(r.length>0||e.responseType===t.XHR_RESPONSE_TYPE.BUFFER)?n=200:1223===n&&(n=204),2===(n/100|0)){if(this.xhrType===t.XHR_RESPONSE_TYPE.TEXT)this.data=r,this.type=t.TYPE.TEXT;else if(this.xhrType===t.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(r),this.type=t.TYPE.JSON}catch(t){return void this.abort("Error trying to parse loaded json: "+t)}else if(this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT)try{if(self.DOMParser){var i=new DOMParser;this.data=i.parseFromString(r,"text/xml")}else{var o=document.createElement("div");o.innerHTML=r,this.data=o}this.type=t.TYPE.XML}catch(t){return void this.abort("Error trying to parse loaded xml: "+t)}else this.data=e.response||r;this.complete()}else this.abort("["+e.status+"] "+e.statusText+": "+e.responseURL)},t.prototype._determineCrossOrigin=function(t,e){if(0===t.indexOf("data:"))return"";if(self.origin!==self.location.origin)return"anonymous";e=e||self.location,no||(no=document.createElement("a")),no.href=t;var r=eo(no.href,{strictMode:!0}),n=!r.port&&""===e.port||r.port===e.port,i=r.protocol?r.protocol+":":"";return r.host===e.hostname&&n&&i===e.protocol?"":"anonymous"},t.prototype._determineXhrType=function(){return t._xhrTypeMap[this.extension]||t.XHR_RESPONSE_TYPE.TEXT},t.prototype._determineLoadType=function(){return t._loadTypeMap[this.extension]||t.LOAD_TYPE.XHR},t.prototype._getExtension=function(t){void 0===t&&(t=this.url);var e="";if(this.isDataUrl){var r=t.indexOf("/");e=t.substring(r+1,t.indexOf(";",r))}else{var n=t.indexOf("?"),i=t.indexOf("#"),o=Math.min(n>-1?n:t.length,i>-1?i:t.length);e=(t=t.substring(0,o)).substring(t.lastIndexOf(".")+1)}return e.toLowerCase()},t.prototype._getMimeFromXhrType=function(e){switch(e){case t.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case t.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case t.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case t.XHR_RESPONSE_TYPE.JSON:return"application/json";case t.XHR_RESPONSE_TYPE.DEFAULT:case t.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},t}();function ho(){}function uo(t){return function(){for(var e=arguments,r=[],n=0;n<arguments.length;n++)r[n]=e[n];if(null===t)throw new Error("Callback was already called.");var i=t;t=null,i.apply(this,r)}}!function(t){var e,r,n,i;(e=t.STATUS_FLAGS||(t.STATUS_FLAGS={}))[e.NONE=0]="NONE",e[e.DATA_URL=1]="DATA_URL",e[e.COMPLETE=2]="COMPLETE",e[e.LOADING=4]="LOADING",(r=t.TYPE||(t.TYPE={}))[r.UNKNOWN=0]="UNKNOWN",r[r.JSON=1]="JSON",r[r.XML=2]="XML",r[r.IMAGE=3]="IMAGE",r[r.AUDIO=4]="AUDIO",r[r.VIDEO=5]="VIDEO",r[r.TEXT=6]="TEXT",(n=t.LOAD_TYPE||(t.LOAD_TYPE={}))[n.XHR=1]="XHR",n[n.IMAGE=2]="IMAGE",n[n.AUDIO=3]="AUDIO",n[n.VIDEO=4]="VIDEO",(i=t.XHR_RESPONSE_TYPE||(t.XHR_RESPONSE_TYPE={})).DEFAULT="text",i.BUFFER="arraybuffer",i.BLOB="blob",i.DOCUMENT="document",i.JSON="json",i.TEXT="text",t._loadTypeMap={gif:t.LOAD_TYPE.IMAGE,png:t.LOAD_TYPE.IMAGE,bmp:t.LOAD_TYPE.IMAGE,jpg:t.LOAD_TYPE.IMAGE,jpeg:t.LOAD_TYPE.IMAGE,tif:t.LOAD_TYPE.IMAGE,tiff:t.LOAD_TYPE.IMAGE,webp:t.LOAD_TYPE.IMAGE,tga:t.LOAD_TYPE.IMAGE,svg:t.LOAD_TYPE.IMAGE,"svg+xml":t.LOAD_TYPE.IMAGE,mp3:t.LOAD_TYPE.AUDIO,ogg:t.LOAD_TYPE.AUDIO,wav:t.LOAD_TYPE.AUDIO,mp4:t.LOAD_TYPE.VIDEO,webm:t.LOAD_TYPE.VIDEO},t._xhrTypeMap={xhtml:t.XHR_RESPONSE_TYPE.DOCUMENT,html:t.XHR_RESPONSE_TYPE.DOCUMENT,htm:t.XHR_RESPONSE_TYPE.DOCUMENT,xml:t.XHR_RESPONSE_TYPE.DOCUMENT,tmx:t.XHR_RESPONSE_TYPE.DOCUMENT,svg:t.XHR_RESPONSE_TYPE.DOCUMENT,tsx:t.XHR_RESPONSE_TYPE.DOCUMENT,gif:t.XHR_RESPONSE_TYPE.BLOB,png:t.XHR_RESPONSE_TYPE.BLOB,bmp:t.XHR_RESPONSE_TYPE.BLOB,jpg:t.XHR_RESPONSE_TYPE.BLOB,jpeg:t.XHR_RESPONSE_TYPE.BLOB,tif:t.XHR_RESPONSE_TYPE.BLOB,tiff:t.XHR_RESPONSE_TYPE.BLOB,webp:t.XHR_RESPONSE_TYPE.BLOB,tga:t.XHR_RESPONSE_TYPE.BLOB,json:t.XHR_RESPONSE_TYPE.JSON,text:t.XHR_RESPONSE_TYPE.TEXT,txt:t.XHR_RESPONSE_TYPE.TEXT,ttf:t.XHR_RESPONSE_TYPE.BUFFER,otf:t.XHR_RESPONSE_TYPE.BUFFER},t.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="}(ao||(ao={}));var lo=function(t,e){this.data=t,this.callback=e},co=function(){function t(t,e){var r=this;if(void 0===e&&(e=1),this.workers=0,this.saturated=ho,this.unsaturated=ho,this.empty=ho,this.drain=ho,this.error=ho,this.started=!1,this.paused=!1,this._tasks=[],this._insert=function(t,e,n){if(n&&"function"!=typeof n)throw new Error("task callback must be a function");if(r.started=!0,null==t&&r.idle())setTimeout((function(){return r.drain()}),1);else{var i=new lo(t,"function"==typeof n?n:ho);e?r._tasks.unshift(i):r._tasks.push(i),setTimeout(r.process,1)}},this.process=function(){for(;!r.paused&&r.workers<r.concurrency&&r._tasks.length;){var t=r._tasks.shift();0===r._tasks.length&&r.empty(),r.workers+=1,r.workers===r.concurrency&&r.saturated(),r._worker(t.data,uo(r._next(t)))}},this._worker=t,0===e)throw new Error("Concurrency must not be zero");this.concurrency=e,this.buffer=e/4}return t.prototype._next=function(t){var e=this;return function(){for(var r=arguments,n=[],i=0;i<arguments.length;i++)n[i]=r[i];e.workers-=1,t.callback.apply(t,n),null!=n[0]&&e.error(n[0],t.data),e.workers<=e.concurrency-e.buffer&&e.unsaturated(),e.idle()&&e.drain(),e.process()}},t.prototype.push=function(t,e){this._insert(t,!1,e)},t.prototype.kill=function(){this.workers=0,this.drain=ho,this.started=!1,this._tasks=[]},t.prototype.unshift=function(t,e){this._insert(t,!0,e)},t.prototype.length=function(){return this._tasks.length},t.prototype.running=function(){return this.workers},t.prototype.idle=function(){return this._tasks.length+this.workers===0},t.prototype.pause=function(){!0!==this.paused&&(this.paused=!0)},t.prototype.resume=function(){if(!1!==this.paused){this.paused=!1;for(var t=1;t<=this.concurrency;t++)this.process()}},t.eachSeries=function(t,e,r,n){var i=0,o=t.length;!function s(a){a||i===o?r&&r(a):n?setTimeout((function(){e(t[i++],s)}),1):e(t[i++],s)}()},t.queue=function(e,r){return new t(e,r)},t}(),fo=/(#[\w-]+)?$/,po=function(){function t(e,r){var n=this;void 0===e&&(e=""),void 0===r&&(r=10),this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(t,e){return n._loadResource(t,e)},this.resources={},this.baseUrl=e,this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(t,e){return n._loadResource(t,e)},this._queue=co.queue(this._boundLoadResource,r),this._queue.pause(),this.resources={},this.onProgress=new to,this.onError=new to,this.onLoad=new to,this.onStart=new to,this.onComplete=new to;for(var i=0;i<t._plugins.length;++i){var o=t._plugins[i],s=o.pre,a=o.use;s&&this.pre(s),a&&this.use(a)}this._protected=!1}return t.prototype._add=function(t,e,r,n){if(this.loading&&(!r||!r.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[t])throw new Error('Resource named "'+t+'" already exists.');if(e=this._prepareUrl(e),this.resources[t]=new ao(t,e,r),"function"==typeof n&&this.resources[t].onAfterMiddleware.once(n),this.loading){for(var i=r.parentResource,o=[],s=0;s<i.children.length;++s)i.children[s].isComplete||o.push(i.children[s]);var a=i.progressChunk*(o.length+1)/(o.length+2);i.children.push(this.resources[t]),i.progressChunk=a;for(s=0;s<o.length;++s)o[s].progressChunk=a;this.resources[t].progressChunk=a}return this._queue.push(this.resources[t]),this},t.prototype.pre=function(t){return this._beforeMiddleware.push(t),this},t.prototype.use=function(t){return this._afterMiddleware.push(t),this},t.prototype.reset=function(){for(var t in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var e=this.resources[t];e._onLoadBinding&&e._onLoadBinding.detach(),e.isLoading&&e.abort("loader reset")}return this.resources={},this},t.prototype.load=function(t){if("function"==typeof t&&this.onComplete.once(t),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var e=100/this._queue._tasks.length,r=0;r<this._queue._tasks.length;++r)this._queue._tasks[r].data.progressChunk=e;this._onStart(),this._queue.resume()}return this},Object.defineProperty(t.prototype,"concurrency",{get:function(){return this._queue.concurrency},set:function(t){this._queue.concurrency=t},enumerable:!1,configurable:!0}),t.prototype._prepareUrl=function(t){var e,r=eo(t,{strictMode:!0});if(e=r.protocol||!r.path||0===t.indexOf("//")?t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==t.charAt(0)?this.baseUrl+"/"+t:this.baseUrl+t,this.defaultQueryString){var n=fo.exec(e)[0];-1!==(e=e.substr(0,e.length-n.length)).indexOf("?")?e+="&"+this.defaultQueryString:e+="?"+this.defaultQueryString,e+=n}return e},t.prototype._loadResource=function(t,e){var r=this;t._dequeue=e,co.eachSeries(this._beforeMiddleware,(function(e,n){e.call(r,t,(function(){n(t.isComplete?{}:null)}))}),(function(){t.isComplete?r._onLoad(t):(t._onLoadBinding=t.onComplete.once(r._onLoad,r),t.load())}),!0)},t.prototype._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},t.prototype._onComplete=function(){this.progress=100,this.loading=!1,this.onComplete.dispatch(this,this.resources)},t.prototype._onLoad=function(t){var e=this;t._onLoadBinding=null,this._resourcesParsing.push(t),t._dequeue(),co.eachSeries(this._afterMiddleware,(function(r,n){r.call(e,t,n)}),(function(){t.onAfterMiddleware.dispatch(t),e.progress=Math.min(100,e.progress+t.progressChunk),e.onProgress.dispatch(e,t),t.error?e.onError.dispatch(t.error,e,t):e.onLoad.dispatch(e,t),e._resourcesParsing.splice(e._resourcesParsing.indexOf(t),1),e._queue.idle()&&0===e._resourcesParsing.length&&e._onComplete()}),!0)},t.prototype.destroy=function(){this._protected||this.reset()},Object.defineProperty(t,"shared",{get:function(){var e=t._shared;return e||((e=new t)._protected=!0,t._shared=e),e},enumerable:!1,configurable:!0}),t.registerPlugin=function(e){return t._plugins.push(e),e.add&&e.add(),t},t._plugins=[],t}();po.prototype.add=function(t,e,r,n){if(Array.isArray(t)){for(var i=0;i<t.length;++i)this.add(t[i]);return this}if("object"==typeof t&&(r=t,n=e||r.callback||r.onComplete,e=r.url,t=r.name||r.key||r.url),"string"!=typeof e&&(n=r,r=e,e=t),"string"!=typeof e)throw new Error("No url passed to add resource to loader.");return"function"==typeof r&&(n=r,r=null),this._add(t,e,r,n)};var mo=function(){function t(){}return t.init=function(t){t=Object.assign({sharedLoader:!1},t),this.loader=t.sharedLoader?po.shared:new po},t.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},t}(),go=function(){function t(){}return t.add=function(){ao.setExtensionLoadType("svg",ao.LOAD_TYPE.XHR),ao.setExtensionXhrType("svg",ao.XHR_RESPONSE_TYPE.TEXT)},t.use=function(t,e){if(!t.data||t.type!==ao.TYPE.IMAGE&&"svg"!==t.extension)e();else{var r=t.data,n=t.url,i=t.name,o=t.metadata;Ir.fromLoader(r,n,i,o).then((function(r){t.texture=r,e()})).catch(e)}},t}();var vo=self.URL||self.webkitURL;po.registerPlugin({use:function(t,e){if(t.data){if(t.xhr&&t.xhrType===ao.XHR_RESPONSE_TYPE.BLOB)if(self.Blob&&"string"!=typeof t.data){if(0===t.data.type.indexOf("image")){var r=vo.createObjectURL(t.data);return t.blob=t.data,t.data=new Image,t.data.src=r,t.type=ao.TYPE.IMAGE,void(t.data.onload=function(){vo.revokeObjectURL(r),t.data.onload=null,e()})}}else{var n=t.xhr.getResponseHeader("content-type");if(n&&0===n.indexOf("image"))return t.data=new Image,t.data.src="data:"+n+";base64,"+function(t){for(var e="",r=0;r<t.length;){for(var n=[0,0,0],i=[0,0,0,0],o=0;o<n.length;++o)r<t.length?n[o]=255&t.charCodeAt(r++):n[o]=0;switch(i[0]=n[0]>>2,i[1]=(3&n[0])<<4|n[1]>>4,i[2]=(15&n[1])<<2|n[2]>>6,i[3]=63&n[2],r-(t.length-1)){case 2:i[3]=64,i[2]=64;break;case 1:i[3]=64}for(o=0;o<i.length;++o)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(i[o])}return e}(t.xhr.responseText),t.type=ao.TYPE.IMAGE,void(t.data.onload=function(){t.data.onload=null,e()})}e()}else e()}}),po.registerPlugin(go);
/*!
     * @pixi/text-bitmap - v6.1.2
     * Compiled Thu, 12 Aug 2021 17:11:19 UTC
     *
     * @pixi/text-bitmap is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
var yo=function(t,e){return(yo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};var bo=function(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[]},_o=function(){function t(){}return t.test=function(t){return"string"==typeof t&&0===t.indexOf("info face=")},t.parse=function(t){var e=t.match(/^[a-z]+\s+.+$/gm),r={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[]};for(var n in e){var i=e[n].match(/^[a-z]+/gm)[0],o=e[n].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),s={};for(var a in o){var h=o[a].split("="),u=h[0],l=h[1].replace(/"/gm,""),c=parseFloat(l),d=isNaN(c)?l:c;s[u]=d}r[i].push(s)}var f=new bo;return r.info.forEach((function(t){return f.info.push({face:t.face,size:parseInt(t.size,10)})})),r.common.forEach((function(t){return f.common.push({lineHeight:parseInt(t.lineHeight,10)})})),r.page.forEach((function(t){return f.page.push({id:parseInt(t.id,10),file:t.file})})),r.char.forEach((function(t){return f.char.push({id:parseInt(t.id,10),page:parseInt(t.page,10),x:parseInt(t.x,10),y:parseInt(t.y,10),width:parseInt(t.width,10),height:parseInt(t.height,10),xoffset:parseInt(t.xoffset,10),yoffset:parseInt(t.yoffset,10),xadvance:parseInt(t.xadvance,10)})})),r.kerning.forEach((function(t){return f.kerning.push({first:parseInt(t.first,10),second:parseInt(t.second,10),amount:parseInt(t.amount,10)})})),f},t}(),Eo=function(){function t(){}return t.test=function(t){return t instanceof XMLDocument&&t.getElementsByTagName("page").length&&null!==t.getElementsByTagName("info")[0].getAttribute("face")},t.parse=function(t){for(var e=new bo,r=t.getElementsByTagName("info"),n=t.getElementsByTagName("common"),i=t.getElementsByTagName("page"),o=t.getElementsByTagName("char"),s=t.getElementsByTagName("kerning"),a=0;a<r.length;a++)e.info.push({face:r[a].getAttribute("face"),size:parseInt(r[a].getAttribute("size"),10)});for(a=0;a<n.length;a++)e.common.push({lineHeight:parseInt(n[a].getAttribute("lineHeight"),10)});for(a=0;a<i.length;a++)e.page.push({id:parseInt(i[a].getAttribute("id"),10)||0,file:i[a].getAttribute("file")});for(a=0;a<o.length;a++){var h=o[a];e.char.push({id:parseInt(h.getAttribute("id"),10),page:parseInt(h.getAttribute("page"),10)||0,x:parseInt(h.getAttribute("x"),10),y:parseInt(h.getAttribute("y"),10),width:parseInt(h.getAttribute("width"),10),height:parseInt(h.getAttribute("height"),10),xoffset:parseInt(h.getAttribute("xoffset"),10),yoffset:parseInt(h.getAttribute("yoffset"),10),xadvance:parseInt(h.getAttribute("xadvance"),10)})}for(a=0;a<s.length;a++)e.kerning.push({first:parseInt(s[a].getAttribute("first"),10),second:parseInt(s[a].getAttribute("second"),10),amount:parseInt(s[a].getAttribute("amount"),10)});return e},t}(),xo=function(){function t(){}return t.test=function(t){if("string"==typeof t&&t.indexOf("<font>")>-1){var e=(new self.DOMParser).parseFromString(t,"text/xml");return Eo.test(e)}return!1},t.parse=function(t){var e=(new self.DOMParser).parseFromString(t,"text/xml");return Eo.parse(e)},t}(),To=[_o,Eo,xo];function wo(t){for(var e=0;e<To.length;e++)if(To[e].test(t))return To[e];return null}function Ao(t,e,r,n,i,o,s){var a=r.text,h=r.fontProperties;e.translate(n,i),e.scale(o,o);var u=s.strokeThickness/2,l=-s.strokeThickness/2;e.font=s.toFontString(),e.lineWidth=s.strokeThickness,e.textBaseline=s.textBaseline,e.lineJoin=s.lineJoin,e.miterLimit=s.miterLimit,e.fillStyle=function(t,e,r,n,i,o){var s,a=r.fill;if(!Array.isArray(a))return a;if(1===a.length)return a[0];var h=r.dropShadow?r.dropShadowDistance:0,u=r.padding||0,l=t.width/n-h-2*u,c=t.height/n-h-2*u,d=a.slice(),f=r.fillGradientStops.slice();if(!f.length)for(var p=d.length+1,m=1;m<p;++m)f.push(m/p);if(d.unshift(a[0]),f.unshift(0),d.push(a[a.length-1]),f.push(1),r.fillGradientType===Ri.LINEAR_VERTICAL){s=e.createLinearGradient(l/2,u,l/2,c+u);var g=0,v=(o.fontProperties.fontSize+r.strokeThickness)/c;for(m=0;m<i.length;m++)for(var y=o.lineHeight*m,b=0;b<d.length;b++){var _=y/c+("number"==typeof f[b]?f[b]:b/d.length)*v,E=Math.max(g,_);E=Math.min(E,1),s.addColorStop(E,d[b]),g=E}}else{s=e.createLinearGradient(u,c/2,l+u,c/2);var x=d.length+1,T=1;for(m=0;m<d.length;m++){var w=void 0;w="number"==typeof f[m]?f[m]:T/x,s.addColorStop(w,d[m]),T++}}return s}(t,e,s,o,[a],r),e.strokeStyle=s.stroke;var c=s.dropShadowColor,d=ce("number"==typeof c?c:fe(c));s.dropShadow?(e.shadowColor="rgba("+255*d[0]+","+255*d[1]+","+255*d[2]+","+s.dropShadowAlpha+")",e.shadowBlur=s.dropShadowBlur,e.shadowOffsetX=Math.cos(s.dropShadowAngle)*s.dropShadowDistance,e.shadowOffsetY=Math.sin(s.dropShadowAngle)*s.dropShadowDistance):(e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),s.stroke&&s.strokeThickness&&e.strokeText(a,u,l+r.lineHeight-h.descent),s.fill&&e.fillText(a,u,l+r.lineHeight-h.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}var So,Oo=function(){function t(t,e,r){var n=t.info[0],i=t.common[0],o=Le(t.page[0].file),s={};this._ownsTextures=r,this.font=n.face,this.size=n.size,this.lineHeight=i.lineHeight/o,this.chars={},this.pageTextures=s;for(var a=0;a<t.page.length;a++){var h=t.page[a],u=h.id,l=h.file;s[u]=e instanceof Array?e[a]:e[l]}for(a=0;a<t.char.length;a++){var c=t.char[a],d=(u=c.id,c.page),f=t.char[a],p=f.x,m=f.y,g=f.width,v=f.height,y=f.xoffset,b=f.yoffset,_=f.xadvance;m/=o,g/=o,v/=o,y/=o,b/=o,_/=o;var E=new je((p/=o)+s[d].frame.x/o,m+s[d].frame.y/o,g,v);this.chars[u]={xOffset:y,yOffset:b,xAdvance:_,kerning:{},texture:new Ir(s[d].baseTexture,E),page:d}}for(a=0;a<t.kerning.length;a++){var x=t.kerning[a],T=x.first,w=x.second,A=x.amount;T/=o,w/=o,A/=o,this.chars[w]&&(this.chars[w].kerning[T]=A)}}return t.prototype.destroy=function(){for(var t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(var t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null},t.install=function(e,r,n){var i;if(e instanceof bo)i=e;else{var o=wo(e);if(!o)throw new Error("Unrecognized data format for font.");i=o.parse(e)}r instanceof Ir&&(r=[r]);var s=new t(i,r,n);return t.available[s.font]=s,s},t.uninstall=function(e){var r=t.available[e];if(!r)throw new Error("No font found named '"+e+"'");r.destroy(),delete t.available[e]},t.from=function(e,r,n){if(!e)throw new Error("[BitmapFont] Property `name` is required.");var i=Object.assign({},t.defaultOptions,n),o=i.chars,s=i.padding,a=i.resolution,h=i.textureWidth,u=i.textureHeight,l=function(t){"string"==typeof t&&(t=[t]);for(var e=[],r=0,n=t.length;r<n;r++){var i=t[r];if(Array.isArray(i)){if(2!==i.length)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got "+i.length+".");var o=i[0].charCodeAt(0),s=i[1].charCodeAt(0);if(s<o)throw new Error("[BitmapFont]: Invalid character range.");for(var a=o,h=s;a<=h;a++)e.push(String.fromCharCode(a))}else e.push.apply(e,i.split(""))}if(0===e.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}(o),c=r instanceof Ui?r:new Ui(r),d=h,f=new bo;f.info[0]={face:c.fontFamily,size:c.fontSize},f.common[0]={lineHeight:c.fontSize};for(var p,m,g,v=0,y=0,b=0,_=[],E=0;E<l.length;E++){p||((p=document.createElement("canvas")).width=h,p.height=u,m=p.getContext("2d"),g=new dr(p,{resolution:a}),_.push(new Ir(g)),f.page.push({id:_.length-1,file:""}));var x=Gi.measureText(l[E],c,!1,p),T=x.width,w=Math.ceil(x.height),A=Math.ceil(("italic"===c.fontStyle?2:1)*T);if(y>=u-w*a){if(0===y)throw new Error("[BitmapFont] textureHeight "+u+"px is too small for "+c.fontSize+"px fonts");--E,p=null,m=null,g=null,y=0,v=0,b=0}else if(b=Math.max(w+x.fontProperties.descent,b),A*a+v>=d)--E,y+=b*a,y=Math.ceil(y),v=0,b=0;else{Ao(p,m,x,v,y,a,c);var S=x.text.charCodeAt(0);f.char.push({id:S,page:_.length-1,x:v/a,y:y/a,width:A,height:w,xoffset:0,yoffset:0,xadvance:Math.ceil(T-(c.dropShadow?c.dropShadowDistance:0)-(c.stroke?c.strokeThickness:0))}),v+=(A+2*s)*a,v=Math.ceil(v)}}E=0;for(var O=l.length;E<O;E++)for(var I=l[E],R=0;R<O;R++){var N=l[R],L=m.measureText(I).width,M=m.measureText(N).width,P=m.measureText(I+N).width-(L+M);P&&f.kerning.push({first:I.charCodeAt(0),second:N.charCodeAt(0),amount:P})}var C=new t(f,_,!0);return void 0!==t.available[e]&&t.uninstall(e),t.available[e]=C,C},t.ALPHA=[["a","z"],["A","Z"]," "],t.NUMERIC=[["0","9"]],t.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],t.ASCII=[[" ","~"]],t.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:t.ALPHANUMERIC},t.available={},t}(),Io=[],Ro=[],No=function(t){function e(r,n){void 0===n&&(n={});var i=t.call(this)||this;i._tint=16777215;var o=Object.assign({},e.styleDefaults,n),s=o.align,a=o.tint,h=o.maxWidth,u=o.letterSpacing,l=o.fontName,c=o.fontSize;if(!Oo.available[l])throw new Error('Missing BitmapFont "'+l+'"');return i._activePagesMeshData=[],i._textWidth=0,i._textHeight=0,i._align=s,i._tint=a,i._fontName=l,i._fontSize=c||Oo.available[l].size,i._text=r,i._maxWidth=h,i._maxLineHeight=0,i._letterSpacing=u,i._anchor=new Ye((function(){i.dirty=!0}),i,0,0),i._roundPixels=rt.ROUND_PIXELS,i.dirty=!0,i._textureCache={},i}return function(t,e){function r(){this.constructor=t}yo(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e.prototype.updateText=function(){for(var t,e=Oo.available[this._fontName],r=this._fontSize/e.size,n=new We,i=[],o=[],s=[],a=this._text.replace(/(?:\r\n|\r)/g,"\n")||" ",h=a.length,u=this._maxWidth*e.size/this._fontSize,l=null,c=0,d=0,f=0,p=-1,m=0,g=0,v=0,y=0,b=0;b<h;b++){var _=a.charCodeAt(b),E=a.charAt(b);if(/(?:\s)/.test(E)&&(p=b,m=c,y++),"\r"!==E&&"\n"!==E){var x=e.chars[_];if(x){l&&x.kerning[l]&&(n.x+=x.kerning[l]);var T=Ro.pop()||{texture:Ir.EMPTY,line:0,charCode:0,prevSpaces:0,position:new We};T.texture=x.texture,T.line=f,T.charCode=_,T.position.x=n.x+x.xOffset+this._letterSpacing/2,T.position.y=n.y+x.yOffset,T.prevSpaces=y,i.push(T),c=T.position.x+x.texture.orig.width,n.x+=x.xAdvance+this._letterSpacing,v=Math.max(v,x.yOffset+x.texture.height),l=_,-1!==p&&u>0&&n.x>u&&(_e(i,1+p-++g,1+b-p),b=p,p=-1,o.push(m),s.push(i.length>0?i[i.length-1].prevSpaces:0),d=Math.max(d,m),f++,n.x=0,n.y+=e.lineHeight,l=null,y=0)}}else o.push(c),s.push(-1),d=Math.max(d,c),++f,++g,n.x=0,n.y+=e.lineHeight,l=null,y=0}var w=a.charAt(a.length-1);"\r"!==w&&"\n"!==w&&(/(?:\s)/.test(w)&&(c=m),o.push(c),d=Math.max(d,c),s.push(-1));var A=[];for(b=0;b<=f;b++){var S=0;"right"===this._align?S=d-o[b]:"center"===this._align?S=(d-o[b])/2:"justify"===this._align&&(S=s[b]<0?0:(d-o[b])/s[b]),A.push(S)}var O=i.length,I={},R=[],N=this._activePagesMeshData;for(b=0;b<N.length;b++)Io.push(N[b]);for(b=0;b<O;b++){var L=(G=i[b].texture).baseTexture.uid;if(!I[L]){if(!(Y=Io.pop())){var M=new Ji,P=new Zi(Ir.EMPTY);Y={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:new Ki(M,P),vertices:null,uvs:null,indices:null}}Y.index=0,Y.indexCount=0,Y.vertexCount=0,Y.uvsCount=0,Y.total=0;var C=this._textureCache;C[L]=C[L]||new Ir(G.baseTexture),Y.mesh.texture=C[L],Y.mesh.tint=this._tint,R.push(Y),I[L]=Y}I[L].total++}for(b=0;b<N.length;b++)-1===R.indexOf(N[b])&&this.removeChild(N[b].mesh);for(b=0;b<R.length;b++)R[b].mesh.parent!==this&&this.addChild(R[b].mesh);for(var b in this._activePagesMeshData=R,I){var D=(Y=I[b]).total;if(!((null===(t=Y.indices)||void 0===t?void 0:t.length)>6*D)||Y.vertices.length<2*Ki.BATCHABLE_SIZE)Y.vertices=new Float32Array(8*D),Y.uvs=new Float32Array(8*D),Y.indices=new Uint16Array(6*D);else for(var U=Y.total,B=Y.vertices,F=4*U*2;F<B.length;F++)B[F]=0;Y.mesh.size=6*D}for(b=0;b<O;b++){var k=(E=i[b]).position.x+A[E.line]*("justify"===this._align?E.prevSpaces:1);this._roundPixels&&(k=Math.round(k));var G,j=k*r,H=E.position.y*r,X=I[(G=E.texture).baseTexture.uid],z=G.frame,V=G._uvs,W=X.index++;X.indices[6*W+0]=0+4*W,X.indices[6*W+1]=1+4*W,X.indices[6*W+2]=2+4*W,X.indices[6*W+3]=0+4*W,X.indices[6*W+4]=2+4*W,X.indices[6*W+5]=3+4*W,X.vertices[8*W+0]=j,X.vertices[8*W+1]=H,X.vertices[8*W+2]=j+z.width*r,X.vertices[8*W+3]=H,X.vertices[8*W+4]=j+z.width*r,X.vertices[8*W+5]=H+z.height*r,X.vertices[8*W+6]=j,X.vertices[8*W+7]=H+z.height*r,X.uvs[8*W+0]=V.x0,X.uvs[8*W+1]=V.y0,X.uvs[8*W+2]=V.x1,X.uvs[8*W+3]=V.y1,X.uvs[8*W+4]=V.x2,X.uvs[8*W+5]=V.y2,X.uvs[8*W+6]=V.x3,X.uvs[8*W+7]=V.y3}for(var b in this._textWidth=d*r,this._textHeight=(n.y+e.lineHeight)*r,I){var Y=I[b];if(0!==this.anchor.x||0!==this.anchor.y)for(var q=0,K=this._textWidth*this.anchor.x,Z=this._textHeight*this.anchor.y,J=0;J<Y.total;J++)Y.vertices[q++]-=K,Y.vertices[q++]-=Z,Y.vertices[q++]-=K,Y.vertices[q++]-=Z,Y.vertices[q++]-=K,Y.vertices[q++]-=Z,Y.vertices[q++]-=K,Y.vertices[q++]-=Z;this._maxLineHeight=v*r;var Q=Y.mesh.geometry.getBuffer("aVertexPosition"),$=Y.mesh.geometry.getBuffer("aTextureCoord"),tt=Y.mesh.geometry.getIndex();Q.data=Y.vertices,$.data=Y.uvs,tt.data=Y.indices,Q.update(),$.update(),tt.update()}for(b=0;b<i.length;b++)Ro.push(i[b])},e.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},e.prototype.getLocalBounds=function(){return this.validate(),t.prototype.getLocalBounds.call(this)},e.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){if(this._tint!==t){this._tint=t;for(var e=0;e<this._activePagesMeshData.length;e++)this._activePagesMeshData[e].mesh.tint=t}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontName",{get:function(){return this._fontName},set:function(t){if(!Oo.available[t])throw new Error('Missing BitmapFont "'+t+'"');this._fontName!==t&&(this._fontName=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{get:function(){return this._anchor},set:function(t){"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxLineHeight",{get:function(){return this.validate(),this._maxLineHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textWidth",{get:function(){return this.validate(),this._textWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textHeight",{get:function(){return this.validate(),this._textHeight},enumerable:!1,configurable:!0}),e.prototype.destroy=function(e){var r=this._textureCache;for(var n in r){r[n].destroy(),delete r[n]}this._textureCache=null,t.prototype.destroy.call(this,e)},e.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0},e}(Oi),Lo=function(){function t(){}return t.add=function(){ao.setExtensionXhrType("fnt",ao.XHR_RESPONSE_TYPE.TEXT)},t.use=function(e,r){var n=wo(e.data);if(n)for(var i=t.getBaseUrl(this,e),o=n.parse(e.data),s={},a=function(t){s[t.metadata.pageFile]=t.texture,Object.keys(s).length===o.page.length&&(e.bitmapFont=Oo.install(o,s,!0),r())},h=0;h<o.page.length;++h){var u=o.page[h].file,l=i+u,c=!1;for(var d in this.resources){var f=this.resources[d];if(f.url===l){f.metadata.pageFile=u,f.texture?a(f):f.onAfterMiddleware.add(a),c=!0;break}}if(!c){var p={crossOrigin:e.crossOrigin,loadType:ao.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:u},e.metadata.imageMetadata),parentResource:e};this.add(l,p,a)}}else r()},t.getBaseUrl=function(e,r){var n=r.isDataUrl?"":t.dirname(r.url);return r.isDataUrl&&("."===n&&(n=""),e.baseUrl&&n&&"/"===e.baseUrl.charAt(e.baseUrl.length-1)&&(n+="/")),(n=n.replace(e.baseUrl,""))&&"/"!==n.charAt(n.length-1)&&(n+="/"),n},t.dirname=function(t){var e=t.replace(/\\/g,"/").replace(/\/$/,"").replace(/\/[^\/]*$/,"");return e===t?".":""===e?"/":e},t}();function Mo(e,r,n){var i;if(e===t.TextType.TEXT)(i=new Xi(r,{fontSize:n.fontSize,fill:16777215})).resolution=8;else{if(e!==t.TextType.BITMAP_TEXT)throw new Error("Invalid state");i=new No(r,{fontName:n.fontFamily,fontSize:n.fontSize})}return i.roundPixels=!0,i}t.TextType=void 0,(So=t.TextType||(t.TextType={})).TEXT="TEXT",So.BITMAP_TEXT="BITMAP_TEXT";var Po=function(t,e){return(Po=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)};function Co(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}Po(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var Do=function(){return(Do=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},Uo=function(){function t(e){var r=this;this.stage=new Oi,e=Object.assign({forceCanvas:!1},e),this.renderer=function(t){return si.create(t)}(e),t._plugins.forEach((function(t){t.init.call(r,e)}))}return t.registerPlugin=function(e){t._plugins.push(e)},t.prototype.render=function(){this.renderer.render(this.stage)},Object.defineProperty(t.prototype,"view",{get:function(){return this.renderer.view},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"screen",{get:function(){return this.renderer.screen},enumerable:!1,configurable:!0}),t.prototype.destroy=function(e,r){var n=this,i=t._plugins.slice(0);i.reverse(),i.forEach((function(t){t.destroy.call(n)})),this.stage.destroy(r),this.stage=null,this.renderer.destroy(e),this.renderer=null},t._plugins=[],t}(),Bo=function(){function t(){}return t.init=function(t){var e=this;Object.defineProperty(this,"resizeTo",{set:function(t){self.removeEventListener("resize",this.queueResize),this._resizeTo=t,t&&(self.addEventListener("resize",this.queueResize),this.resize())},get:function(){return this._resizeTo}}),this.queueResize=function(){e._resizeTo&&(e.cancelResize(),e._resizeId=requestAnimationFrame((function(){return e.resize()})))},this.cancelResize=function(){e._resizeId&&(cancelAnimationFrame(e._resizeId),e._resizeId=null)},this.resize=function(){if(e._resizeTo){var t,r;if(e.cancelResize(),e._resizeTo===self)t=self.innerWidth,r=self.innerHeight;else{var n=e._resizeTo;t=n.clientWidth,r=n.clientHeight}e.renderer.resize(t,r)}},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null},t.destroy=function(){self.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null},t}();
/*!
     * @pixi/app - v6.1.2
     * Compiled Thu, 12 Aug 2021 17:11:19 UTC
     *
     * @pixi/app is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */Uo.registerPlugin(Bo);
/*!
     * @pixi/interaction - v6.1.2
     * Compiled Thu, 12 Aug 2021 17:11:19 UTC
     *
     * @pixi/interaction is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */
var Fo=function(){function t(){this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0,this.global=new We,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return Object.defineProperty(t.prototype,"pointerId",{get:function(){return this.identifier},enumerable:!1,configurable:!0}),t.prototype.getLocalPosition=function(t,e,r){return t.worldTransform.applyInverse(r||this.global,e)},t.prototype.copyEvent=function(t){"isPrimary"in t&&t.isPrimary&&(this.isPrimary=!0),this.button="button"in t&&t.button;var e="buttons"in t&&t.buttons;this.buttons=Number.isInteger(e)?e:"which"in t&&t.which,this.width="width"in t&&t.width,this.height="height"in t&&t.height,this.tiltX="tiltX"in t&&t.tiltX,this.tiltY="tiltY"in t&&t.tiltY,this.pointerType="pointerType"in t&&t.pointerType,this.pressure="pressure"in t&&t.pressure,this.rotationAngle="rotationAngle"in t&&t.rotationAngle,this.twist="twist"in t&&t.twist||0,this.tangentialPressure="tangentialPressure"in t&&t.tangentialPressure||0},t.prototype.reset=function(){this.isPrimary=!1},t}(),ko=function(t,e){return(ko=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var Go=function(){function t(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return t.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},t.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null},t}(),jo=function(){function t(e){this._pointerId=e,this._flags=t.FLAGS.NONE}return t.prototype._doSet=function(t,e){this._flags=e?this._flags|t:this._flags&~t},Object.defineProperty(t.prototype,"pointerId",{get:function(){return this._pointerId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"flags",{get:function(){return this._flags},set:function(t){this._flags=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"none",{get:function(){return this._flags===t.FLAGS.NONE},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"over",{get:function(){return 0!=(this._flags&t.FLAGS.OVER)},set:function(e){this._doSet(t.FLAGS.OVER,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightDown",{get:function(){return 0!=(this._flags&t.FLAGS.RIGHT_DOWN)},set:function(e){this._doSet(t.FLAGS.RIGHT_DOWN,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leftDown",{get:function(){return 0!=(this._flags&t.FLAGS.LEFT_DOWN)},set:function(e){this._doSet(t.FLAGS.LEFT_DOWN,e)},enumerable:!1,configurable:!0}),t.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4}),t}(),Ho=function(){function t(){this._tempPoint=new We}return t.prototype.recursiveFindHit=function(t,e,r,n,i){if(!e||!e.visible)return!1;var o=t.data.global,s=!1,a=i=e.interactive||i,h=!0;if(e.hitArea?(n&&(e.worldTransform.applyInverse(o,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?s=!0:(n=!1,h=!1)),a=!1):e._mask&&n&&(e._mask.containsPoint&&e._mask.containsPoint(o)||(n=!1)),h&&e.interactiveChildren&&e.children)for(var u=e.children,l=u.length-1;l>=0;l--){var c=u[l],d=this.recursiveFindHit(t,c,r,n,a);if(d){if(!c.parent)continue;a=!1,d&&(t.target&&(n=!1),s=!0)}}return i&&(n&&!t.target&&!e.hitArea&&e.containsPoint&&e.containsPoint(o)&&(s=!0),e.interactive&&(s&&!t.target&&(t.target=e),r&&r(t,e,!!s))),s},t.prototype.findHit=function(t,e,r,n){this.recursiveFindHit(t,e,r,n,!1)},t}(),Xo={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return"pointer"===this.cursor},set buttonMode(t){t?this.cursor="pointer":"pointer"===this.cursor&&(this.cursor=null)},cursor:null,get trackedPointers(){return void 0===this._trackedPointers&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};wi.mixin(Xo);var zo={target:null,data:{global:null}},Vo=function(t){function e(e,r){var n=t.call(this)||this;return r=r||{},n.renderer=e,n.autoPreventDefault=void 0===r.autoPreventDefault||r.autoPreventDefault,n.interactionFrequency=r.interactionFrequency||10,n.mouse=new Fo,n.mouse.identifier=1,n.mouse.global.set(-999999),n.activeInteractionData={},n.activeInteractionData[1]=n.mouse,n.interactionDataPool=[],n.eventData=new Go,n.interactionDOMElement=null,n.moveWhenInside=!1,n.eventsAdded=!1,n.tickerAdded=!1,n.mouseOverRenderer=!("PointerEvent"in self),n.supportsTouchEvents="ontouchstart"in self,n.supportsPointerEvents=!!self.PointerEvent,n.onPointerUp=n.onPointerUp.bind(n),n.processPointerUp=n.processPointerUp.bind(n),n.onPointerCancel=n.onPointerCancel.bind(n),n.processPointerCancel=n.processPointerCancel.bind(n),n.onPointerDown=n.onPointerDown.bind(n),n.processPointerDown=n.processPointerDown.bind(n),n.onPointerMove=n.onPointerMove.bind(n),n.processPointerMove=n.processPointerMove.bind(n),n.onPointerOut=n.onPointerOut.bind(n),n.processPointerOverOut=n.processPointerOverOut.bind(n),n.onPointerOver=n.onPointerOver.bind(n),n.cursorStyles={default:"inherit",pointer:"pointer"},n.currentCursorMode=null,n.cursor=null,n.resolution=1,n.delayedEvents=[],n.search=new Ho,n._tempDisplayObject=new Ai,n._eventListenerOptions={capture:!0,passive:!1},n._useSystemTicker=void 0===r.useSystemTicker||r.useSystemTicker,n.setTargetElement(n.renderer.view,n.renderer.resolution),n}return function(t,e){function r(){this.constructor=t}ko(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),Object.defineProperty(e.prototype,"useSystemTicker",{get:function(){return this._useSystemTicker},set:function(t){this._useSystemTicker=t,t?this.addTickerListener():this.removeTickerListener()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastObjectRendered",{get:function(){return this.renderer._lastObjectRendered||this._tempDisplayObject},enumerable:!1,configurable:!0}),e.prototype.hitTest=function(t,e){return zo.target=null,zo.data.global=t,e||(e=this.lastObjectRendered),this.processInteractive(zo,e,null,!0),zo.target},e.prototype.setTargetElement=function(t,e){void 0===e&&(e=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=t,this.resolution=e,this.addEvents(),this.addTickerListener()},e.prototype.addTickerListener=function(){!this.tickerAdded&&this.interactionDOMElement&&this._useSystemTicker&&(Ue.system.add(this.tickerUpdate,this,Me.INTERACTION),this.tickerAdded=!0)},e.prototype.removeTickerListener=function(){this.tickerAdded&&(Ue.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)},e.prototype.addEvents=function(){if(!this.eventsAdded&&this.interactionDOMElement){var t=this.interactionDOMElement.style;self.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none"),this.supportsPointerEvents?(self.document.addEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),self.addEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),self.addEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(self.document.addEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),self.addEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.eventsAdded=!0}},e.prototype.removeEvents=function(){if(this.eventsAdded&&this.interactionDOMElement){var t=this.interactionDOMElement.style;self.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(self.document.removeEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),self.removeEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),self.removeEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(self.document.removeEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),self.removeEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.interactionDOMElement=null,this.eventsAdded=!1}},e.prototype.tickerUpdate=function(t){this._deltaTime+=t,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this.update())},e.prototype.update=function(){if(this.interactionDOMElement)if(this._didMove)this._didMove=!1;else{for(var t in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(t)){var e=this.activeInteractionData[t];if(e.originalEvent&&"touch"!==e.pointerType){var r=this.configureInteractionEventForDOMEvent(this.eventData,e.originalEvent,e);this.processInteractive(r,this.lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},e.prototype.setCursorMode=function(t){t=t||"default";var e=!0;if(self.OffscreenCanvas&&this.interactionDOMElement instanceof OffscreenCanvas&&(e=!1),this.currentCursorMode!==t){this.currentCursorMode=t;var r=this.cursorStyles[t];if(r)switch(typeof r){case"string":e&&(this.interactionDOMElement.style.cursor=r);break;case"function":r(t);break;case"object":e&&Object.assign(this.interactionDOMElement.style,r)}else e&&"string"==typeof t&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.interactionDOMElement.style.cursor=t)}},e.prototype.dispatchEvent=function(t,e,r){r.stopPropagationHint&&t!==r.stopsPropagatingAt||(r.currentTarget=t,r.type=e,t.emit(e,r),t[e]&&t[e](r))},e.prototype.delayDispatchEvent=function(t,e,r){this.delayedEvents.push({displayObject:t,eventString:e,eventData:r})},e.prototype.mapPositionToPoint=function(t,e,r){var n;n=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:this.interactionDOMElement.width,height:this.interactionDOMElement.height,left:0,top:0};var i=1/this.resolution;t.x=(e-n.left)*(this.interactionDOMElement.width/n.width)*i,t.y=(r-n.top)*(this.interactionDOMElement.height/n.height)*i},e.prototype.processInteractive=function(t,e,r,n){var i=this.search.findHit(t,e,r,n),o=this.delayedEvents;if(!o.length)return i;t.stopPropagationHint=!1;var s=o.length;this.delayedEvents=[];for(var a=0;a<s;a++){var h=o[a],u=h.displayObject,l=h.eventString,c=h.eventData;c.stopsPropagatingAt===u&&(c.stopPropagationHint=!0),this.dispatchEvent(u,l,c)}return i},e.prototype.onPointerDown=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);if(this.autoPreventDefault&&e[0].isNormalized)(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(var r=e.length,n=0;n<r;n++){var i=e[n],o=this.getInteractionDataForPointerId(i),s=this.configureInteractionEventForDOMEvent(this.eventData,i,o);if(s.data.originalEvent=t,this.processInteractive(s,this.lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",s),"touch"===i.pointerType)this.emit("touchstart",s);else if("mouse"===i.pointerType||"pen"===i.pointerType){var a=2===i.button;this.emit(a?"rightdown":"mousedown",this.eventData)}}}},e.prototype.processPointerDown=function(t,e,r){var n=t.data,i=t.data.identifier;if(r)if(e.trackedPointers[i]||(e.trackedPointers[i]=new jo(i)),this.dispatchEvent(e,"pointerdown",t),"touch"===n.pointerType)this.dispatchEvent(e,"touchstart",t);else if("mouse"===n.pointerType||"pen"===n.pointerType){var o=2===n.button;o?e.trackedPointers[i].rightDown=!0:e.trackedPointers[i].leftDown=!0,this.dispatchEvent(e,o?"rightdown":"mousedown",t)}},e.prototype.onPointerComplete=function(t,e,r){for(var n=this.normalizeToPointerData(t),i=n.length,o=t.target!==this.interactionDOMElement?"outside":"",s=0;s<i;s++){var a=n[s],h=this.getInteractionDataForPointerId(a),u=this.configureInteractionEventForDOMEvent(this.eventData,a,h);if(u.data.originalEvent=t,this.processInteractive(u,this.lastObjectRendered,r,e||!o),this.emit(e?"pointercancel":"pointerup"+o,u),"mouse"===a.pointerType||"pen"===a.pointerType){var l=2===a.button;this.emit(l?"rightup"+o:"mouseup"+o,u)}else"touch"===a.pointerType&&(this.emit(e?"touchcancel":"touchend"+o,u),this.releaseInteractionDataForPointerId(a.pointerId))}},e.prototype.onPointerCancel=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!0,this.processPointerCancel)},e.prototype.processPointerCancel=function(t,e){var r=t.data,n=t.data.identifier;void 0!==e.trackedPointers[n]&&(delete e.trackedPointers[n],this.dispatchEvent(e,"pointercancel",t),"touch"===r.pointerType&&this.dispatchEvent(e,"touchcancel",t))},e.prototype.onPointerUp=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!1,this.processPointerUp)},e.prototype.processPointerUp=function(t,e,r){var n=t.data,i=t.data.identifier,o=e.trackedPointers[i],s="touch"===n.pointerType,a="mouse"===n.pointerType||"pen"===n.pointerType,h=!1;if(a){var u=2===n.button,l=jo.FLAGS,c=u?l.RIGHT_DOWN:l.LEFT_DOWN,d=void 0!==o&&o.flags&c;r?(this.dispatchEvent(e,u?"rightup":"mouseup",t),d&&(this.dispatchEvent(e,u?"rightclick":"click",t),h=!0)):d&&this.dispatchEvent(e,u?"rightupoutside":"mouseupoutside",t),o&&(u?o.rightDown=!1:o.leftDown=!1)}r?(this.dispatchEvent(e,"pointerup",t),s&&this.dispatchEvent(e,"touchend",t),o&&(a&&!h||this.dispatchEvent(e,"pointertap",t),s&&(this.dispatchEvent(e,"tap",t),o.over=!1))):o&&(this.dispatchEvent(e,"pointerupoutside",t),s&&this.dispatchEvent(e,"touchendoutside",t)),o&&o.none&&delete e.trackedPointers[i]},e.prototype.onPointerMove=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);"mouse"!==e[0].pointerType&&"pen"!==e[0].pointerType||(this._didMove=!0,this.cursor=null);for(var r=e.length,n=0;n<r;n++){var i=e[n],o=this.getInteractionDataForPointerId(i),s=this.configureInteractionEventForDOMEvent(this.eventData,i,o);s.data.originalEvent=t,this.processInteractive(s,this.lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",s),"touch"===i.pointerType&&this.emit("touchmove",s),"mouse"!==i.pointerType&&"pen"!==i.pointerType||this.emit("mousemove",s)}"mouse"===e[0].pointerType&&this.setCursorMode(this.cursor)}},e.prototype.processPointerMove=function(t,e,r){var n=t.data,i="touch"===n.pointerType,o="mouse"===n.pointerType||"pen"===n.pointerType;o&&this.processPointerOverOut(t,e,r),this.moveWhenInside&&!r||(this.dispatchEvent(e,"pointermove",t),i&&this.dispatchEvent(e,"touchmove",t),o&&this.dispatchEvent(e,"mousemove",t))},e.prototype.onPointerOut=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t)[0];"mouse"===e.pointerType&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var r=this.getInteractionDataForPointerId(e),n=this.configureInteractionEventForDOMEvent(this.eventData,e,r);n.data.originalEvent=e,this.processInteractive(n,this.lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",n),"mouse"===e.pointerType||"pen"===e.pointerType?this.emit("mouseout",n):this.releaseInteractionDataForPointerId(r.identifier)}},e.prototype.processPointerOverOut=function(t,e,r){var n=t.data,i=t.data.identifier,o="mouse"===n.pointerType||"pen"===n.pointerType,s=e.trackedPointers[i];r&&!s&&(s=e.trackedPointers[i]=new jo(i)),void 0!==s&&(r&&this.mouseOverRenderer?(s.over||(s.over=!0,this.delayDispatchEvent(e,"pointerover",t),o&&this.delayDispatchEvent(e,"mouseover",t)),o&&null===this.cursor&&(this.cursor=e.cursor)):s.over&&(s.over=!1,this.dispatchEvent(e,"pointerout",this.eventData),o&&this.dispatchEvent(e,"mouseout",t),s.none&&delete e.trackedPointers[i]))},e.prototype.onPointerOver=function(t){var e=this.normalizeToPointerData(t)[0],r=this.getInteractionDataForPointerId(e),n=this.configureInteractionEventForDOMEvent(this.eventData,e,r);n.data.originalEvent=e,"mouse"===e.pointerType&&(this.mouseOverRenderer=!0),this.emit("pointerover",n),"mouse"!==e.pointerType&&"pen"!==e.pointerType||this.emit("mouseover",n)},e.prototype.getInteractionDataForPointerId=function(t){var e,r=t.pointerId;return 1===r||"mouse"===t.pointerType?e=this.mouse:this.activeInteractionData[r]?e=this.activeInteractionData[r]:((e=this.interactionDataPool.pop()||new Fo).identifier=r,this.activeInteractionData[r]=e),e.copyEvent(t),e},e.prototype.releaseInteractionDataForPointerId=function(t){var e=this.activeInteractionData[t];e&&(delete this.activeInteractionData[t],e.reset(),this.interactionDataPool.push(e))},e.prototype.configureInteractionEventForDOMEvent=function(t,e,r){return t.data=r,this.mapPositionToPoint(r.global,e.clientX,e.clientY),"touch"===e.pointerType&&(e.globalX=r.global.x,e.globalY=r.global.y),r.originalEvent=e,t.reset(),t},e.prototype.normalizeToPointerData=function(t){var e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(var r=0,n=t.changedTouches.length;r<n;r++){var i=t.changedTouches[r];void 0===i.button&&(i.button=t.touches.length?1:0),void 0===i.buttons&&(i.buttons=t.touches.length?1:0),void 0===i.isPrimary&&(i.isPrimary=1===t.touches.length&&"touchstart"===t.type),void 0===i.width&&(i.width=i.radiusX||1),void 0===i.height&&(i.height=i.radiusY||1),void 0===i.tiltX&&(i.tiltX=0),void 0===i.tiltY&&(i.tiltY=0),void 0===i.pointerType&&(i.pointerType="touch"),void 0===i.pointerId&&(i.pointerId=i.identifier||0),void 0===i.pressure&&(i.pressure=i.force||.5),void 0===i.twist&&(i.twist=0),void 0===i.tangentialPressure&&(i.tangentialPressure=0),void 0===i.layerX&&(i.layerX=i.offsetX=i.clientX),void 0===i.layerY&&(i.layerY=i.offsetY=i.clientY),i.isNormalized=!0,e.push(i)}else if(self.MouseEvent&&(!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof self.PointerEvent))e.push(t);else{var o=t;void 0===o.isPrimary&&(o.isPrimary=!0),void 0===o.width&&(o.width=1),void 0===o.height&&(o.height=1),void 0===o.tiltX&&(o.tiltX=0),void 0===o.tiltY&&(o.tiltY=0),void 0===o.pointerType&&(o.pointerType="mouse"),void 0===o.pointerId&&(o.pointerId=1),void 0===o.pressure&&(o.pressure=.5),void 0===o.twist&&(o.twist=0),void 0===o.tangentialPressure&&(o.tangentialPressure=0),o.isNormalized=!0,e.push(o)}return e},e.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},e}(ot),Wo=it((function(t,e){(function(){var e;(function(e){t.exports=e})(e={linear:function(t,e,r,n){return r*t/n+e},easeInQuad:function(t,e,r,n){return r*(t/=n)*t+e},easeOutQuad:function(t,e,r,n){return-r*(t/=n)*(t-2)+e},easeInOutQuad:function(t,e,r,n){return(t/=n/2)<1?r/2*t*t+e:-r/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,r,n){return r*(t/=n)*t*t+e},easeOutCubic:function(t,e,r,n){return r*((t=t/n-1)*t*t+1)+e},easeInOutCubic:function(t,e,r,n){return(t/=n/2)<1?r/2*t*t*t+e:r/2*((t-=2)*t*t+2)+e},easeInQuart:function(t,e,r,n){return r*(t/=n)*t*t*t+e},easeOutQuart:function(t,e,r,n){return-r*((t=t/n-1)*t*t*t-1)+e},easeInOutQuart:function(t,e,r,n){return(t/=n/2)<1?r/2*t*t*t*t+e:-r/2*((t-=2)*t*t*t-2)+e},easeInQuint:function(t,e,r,n){return r*(t/=n)*t*t*t*t+e},easeOutQuint:function(t,e,r,n){return r*((t=t/n-1)*t*t*t*t+1)+e},easeInOutQuint:function(t,e,r,n){return(t/=n/2)<1?r/2*t*t*t*t*t+e:r/2*((t-=2)*t*t*t*t+2)+e},easeInSine:function(t,e,r,n){return-r*Math.cos(t/n*(Math.PI/2))+r+e},easeOutSine:function(t,e,r,n){return r*Math.sin(t/n*(Math.PI/2))+e},easeInOutSine:function(t,e,r,n){return-r/2*(Math.cos(Math.PI*t/n)-1)+e},easeInExpo:function(t,e,r,n){return 0===t?e:r*Math.pow(2,10*(t/n-1))+e},easeOutExpo:function(t,e,r,n){return t===n?e+r:r*(1-Math.pow(2,-10*t/n))+e},easeInOutExpo:function(t,e,r,n){return(t/=n/2)<1?r/2*Math.pow(2,10*(t-1))+e:r/2*(2-Math.pow(2,-10*--t))+e},easeInCirc:function(t,e,r,n){return-r*(Math.sqrt(1-(t/=n)*t)-1)+e},easeOutCirc:function(t,e,r,n){return r*Math.sqrt(1-(t=t/n-1)*t)+e},easeInOutCirc:function(t,e,r,n){return(t/=n/2)<1?-r/2*(Math.sqrt(1-t*t)-1)+e:r/2*(Math.sqrt(1-(t-=2)*t)+1)+e},easeInElastic:function(t,e,r,n){var i,o,s;return s=1.70158,0===t||(t/=n),(o=0)||(o=.3*n),(i=r)<Math.abs(r)?(i=r,s=o/4):s=o/(2*Math.PI)*Math.asin(r/i),-i*Math.pow(2,10*(t-=1))*Math.sin((t*n-s)*(2*Math.PI)/o)+e},easeOutElastic:function(t,e,r,n){var i,o,s;return s=1.70158,0===t||(t/=n),(o=0)||(o=.3*n),(i=r)<Math.abs(r)?(i=r,s=o/4):s=o/(2*Math.PI)*Math.asin(r/i),i*Math.pow(2,-10*t)*Math.sin((t*n-s)*(2*Math.PI)/o)+r+e},easeInOutElastic:function(t,e,r,n){var i,o,s;return s=1.70158,0===t||(t/=n/2),(o=0)||(o=n*(.3*1.5)),(i=r)<Math.abs(r)?(i=r,s=o/4):s=o/(2*Math.PI)*Math.asin(r/i),t<1?i*Math.pow(2,10*(t-=1))*Math.sin((t*n-s)*(2*Math.PI)/o)*-.5+e:i*Math.pow(2,-10*(t-=1))*Math.sin((t*n-s)*(2*Math.PI)/o)*.5+r+e},easeInBack:function(t,e,r,n,i){return void 0===i&&(i=1.70158),r*(t/=n)*t*((i+1)*t-i)+e},easeOutBack:function(t,e,r,n,i){return void 0===i&&(i=1.70158),r*((t=t/n-1)*t*((i+1)*t+i)+1)+e},easeInOutBack:function(t,e,r,n,i){return void 0===i&&(i=1.70158),(t/=n/2)<1?r/2*(t*t*((1+(i*=1.525))*t-i))+e:r/2*((t-=2)*t*((1+(i*=1.525))*t+i)+2)+e},easeInBounce:function(t,r,n,i){return n-e.easeOutBounce(i-t,0,n,i)+r},easeOutBounce:function(t,e,r,n){return(t/=n)<1/2.75?r*(7.5625*t*t)+e:t<2/2.75?r*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?r*(7.5625*(t-=2.25/2.75)*t+.9375)+e:r*(7.5625*(t-=2.625/2.75)*t+.984375)+e},easeInOutBounce:function(t,r,n,i){return t<i/2?.5*e.easeInBounce(2*t,0,n,i)+r:.5*e.easeOutBounce(2*t-i,0,n,i)+.5*n+r}})}).call(nt)}));class Yo{constructor(t){this.parent=t,this.paused=!1}destroy(){}down(t){return!1}move(t){return!1}up(t){return!1}wheel(t){return!1}update(t){}resize(){}reset(){}pause(){this.paused=!0}resume(){this.paused=!1}}function qo(t,e){return t?"function"==typeof t?t:"string"==typeof t?Wo[t]:void 0:Wo[e]}const Ko={removeOnInterrupt:!1,ease:"linear",time:1e3};class Zo extends Yo{__init(){this.startWidth=null}__init2(){this.startHeight=null}__init3(){this.deltaWidth=null}__init4(){this.deltaHeight=null}__init5(){this.width=null}__init6(){this.height=null}__init7(){this.time=0}constructor(t,e={}){super(t),Zo.prototype.__init.call(this),Zo.prototype.__init2.call(this),Zo.prototype.__init3.call(this),Zo.prototype.__init4.call(this),Zo.prototype.__init5.call(this),Zo.prototype.__init6.call(this),Zo.prototype.__init7.call(this),this.options=Object.assign({},Ko,e),this.options.ease=qo(this.options.ease),this.setupPosition(),this.setupZoom(),this.time=0}setupPosition(){void 0!==this.options.position?(this.startX=this.parent.center.x,this.startY=this.parent.center.y,this.deltaX=this.options.position.x-this.parent.center.x,this.deltaY=this.options.position.y-this.parent.center.y,this.keepCenter=!1):this.keepCenter=!0}setupZoom(){this.width=null,this.height=null,void 0!==this.options.scale?this.width=this.parent.screenWidth/this.options.scale:void 0!==this.options.scaleX||void 0!==this.options.scaleY?(void 0!==this.options.scaleX&&(this.width=this.parent.screenWidth/this.options.scaleX),void 0!==this.options.scaleY&&(this.height=this.parent.screenHeight/this.options.scaleY)):(void 0!==this.options.width&&(this.width=this.options.width),void 0!==this.options.height&&(this.height=this.options.height)),null!==this.width&&(this.startWidth=this.parent.screenWidthInWorldPixels,this.deltaWidth=this.width-this.startWidth),null!==this.height&&(this.startHeight=this.parent.screenHeightInWorldPixels,this.deltaHeight=this.height-this.startHeight)}down(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("animate"),!1}complete(){this.parent.plugins.remove("animate"),null!==this.width&&this.parent.fitWidth(this.width,this.keepCenter,null===this.height),null!==this.height&&this.parent.fitHeight(this.height,this.keepCenter,null===this.width),this.keepCenter||this.parent.moveCenter(this.options.position),this.parent.emit("animate-end",this.parent),this.options.callbackOnComplete&&this.options.callbackOnComplete(this.parent)}update(t){if(!this.paused)if(this.time+=t,this.time>=this.options.time)this.complete();else{const t=new We(this.parent.scale.x,this.parent.scale.y),e=this.options.ease(this.time,0,1,this.options.time);if(null!==this.width){const t=this.startWidth,r=this.deltaWidth;this.parent.fitWidth(t+r*e,this.keepCenter,null===this.height)}if(null!==this.height){const t=this.startHeight,r=this.deltaHeight;this.parent.fitHeight(t+r*e,this.keepCenter,null===this.width)}if(null===this.width?this.parent.scale.x=this.parent.scale.y:null===this.height&&(this.parent.scale.y=this.parent.scale.x),!this.keepCenter){const t=this.startX,r=this.startY,n=this.deltaX,i=this.deltaY,o=new We(this.parent.x,this.parent.y);this.parent.moveCenter(t+n*e,r+i*e),this.parent.emit("moved",{viewport:this.parent,original:o,type:"animate"})}(this.width||this.height)&&this.parent.emit("zoomed",{viewport:this.parent,original:t,type:"animate"})}}}function Jo(t){let e=void 0,r=t[0],n=1;for(;n<t.length;){const i=t[n],o=t[n+1];if(n+=2,("optionalAccess"===i||"optionalCall"===i)&&null==r)return;"access"===i||"optionalAccess"===i?(e=r,r=o(r)):"call"!==i&&"optionalCall"!==i||(r=o((...t)=>r.call(e,...t)),e=void 0)}return r}const Qo={sides:"all",friction:.5,time:150,ease:"easeInOutSine",underflow:"center",bounceBox:null};class $o extends Yo{constructor(t,e={}){super(t),this.options=Object.assign({},Qo,e),this.ease=qo(this.options.ease,"easeInOutSine"),this.options.sides?"all"===this.options.sides?this.top=this.bottom=this.left=this.right=!0:"horizontal"===this.options.sides?(this.right=this.left=!0,this.top=this.bottom=!1):"vertical"===this.options.sides?(this.left=this.right=!1,this.top=this.bottom=!0):(this.top=-1!==this.options.sides.indexOf("top"),this.bottom=-1!==this.options.sides.indexOf("bottom"),this.left=-1!==this.options.sides.indexOf("left"),this.right=-1!==this.options.sides.indexOf("right")):this.left=this.top=this.right=this.bottom=!1;const r=this.options.underflow.toLowerCase();"center"===r?(this.underflowX=0,this.underflowY=0):(this.underflowX=-1!==r.indexOf("left")?-1:-1!==r.indexOf("right")?1:0,this.underflowY=-1!==r.indexOf("top")?-1:-1!==r.indexOf("bottom")?1:0),this.reset()}isActive(){return null!==this.toX||null!==this.toY}down(){return this.toX=this.toY=null,!1}up(){return this.bounce(),!1}update(t){if(!this.paused){if(this.bounce(),this.toX){const e=this.toX;e.time+=t,this.parent.emit("moved",{viewport:this.parent,type:"bounce-x"}),e.time>=this.options.time?(this.parent.x=e.end,this.toX=null,this.parent.emit("bounce-x-end",this.parent)):this.parent.x=this.ease(e.time,e.start,e.delta,this.options.time)}if(this.toY){const e=this.toY;e.time+=t,this.parent.emit("moved",{viewport:this.parent,type:"bounce-y"}),e.time>=this.options.time?(this.parent.y=e.end,this.toY=null,this.parent.emit("bounce-y-end",this.parent)):this.parent.y=this.ease(e.time,e.start,e.delta,this.options.time)}}}calcUnderflowX(){let t;switch(this.underflowX){case-1:t=0;break;case 1:t=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:t=(this.parent.screenWidth-this.parent.screenWorldWidth)/2}return t}calcUnderflowY(){let t;switch(this.underflowY){case-1:t=0;break;case 1:t=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:t=(this.parent.screenHeight-this.parent.screenWorldHeight)/2}return t}oob(){const t=this.options.bounceBox;if(t){const e=void 0===t.x?0:t.x,r=void 0===t.y?0:t.y,n=void 0===t.width?this.parent.worldWidth:t.width,i=void 0===t.height?this.parent.worldHeight:t.height;return{left:this.parent.left<e,right:this.parent.right>n,top:this.parent.top<r,bottom:this.parent.bottom>i,topLeft:new We(e*this.parent.scale.x,r*this.parent.scale.y),bottomRight:new We(n*this.parent.scale.x-this.parent.screenWidth,i*this.parent.scale.y-this.parent.screenHeight)}}return{left:this.parent.left<0,right:this.parent.right>this.parent.worldWidth,top:this.parent.top<0,bottom:this.parent.bottom>this.parent.worldHeight,topLeft:new We(0,0),bottomRight:new We(this.parent.worldWidth*this.parent.scale.x-this.parent.screenWidth,this.parent.worldHeight*this.parent.scale.y-this.parent.screenHeight)}}bounce(){if(this.paused)return;let t,e=this.parent.plugins.get("decelerate",!0);e&&(e.x||e.y)&&(e.x&&e.percentChangeX===Jo([e,"access",t=>t.options,"optionalAccess",t=>t.friction])||e.y&&e.percentChangeY===Jo([e,"access",t=>t.options,"optionalAccess",t=>t.friction]))&&(t=this.oob(),(t.left&&this.left||t.right&&this.right)&&(e.percentChangeX=this.options.friction),(t.top&&this.top||t.bottom&&this.bottom)&&(e.percentChangeY=this.options.friction));const r=this.parent.plugins.get("drag",!0)||{},n=this.parent.plugins.get("pinch",!0)||{};if(e=e||{},!(Jo([r,"optionalAccess",t=>t.active])||Jo([n,"optionalAccess",t=>t.active])||this.toX&&this.toY||e.x&&e.y)){t=t||this.oob();const r=t.topLeft,n=t.bottomRight;if(!this.toX&&!e.x){let e=null;t.left&&this.left?e=this.parent.screenWorldWidth<this.parent.screenWidth?this.calcUnderflowX():-r.x:t.right&&this.right&&(e=this.parent.screenWorldWidth<this.parent.screenWidth?this.calcUnderflowX():-n.x),null!==e&&this.parent.x!==e&&(this.toX={time:0,start:this.parent.x,delta:e-this.parent.x,end:e},this.parent.emit("bounce-x-start",this.parent))}if(!this.toY&&!e.y){let e=null;t.top&&this.top?e=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-r.y:t.bottom&&this.bottom&&(e=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-n.y),null!==e&&this.parent.y!==e&&(this.toY={time:0,start:this.parent.y,delta:e-this.parent.y,end:e},this.parent.emit("bounce-y-start",this.parent))}}}reset(){this.toX=this.toY=null,this.bounce()}}const ts={left:!1,right:!1,top:!1,bottom:!1,direction:null,underflow:"center"};class es extends Yo{constructor(t,e={}){super(t),this.options=Object.assign({},ts,e),this.options.direction&&(this.options.left="x"===this.options.direction||"all"===this.options.direction||null,this.options.right="x"===this.options.direction||"all"===this.options.direction||null,this.options.top="y"===this.options.direction||"all"===this.options.direction||null,this.options.bottom="y"===this.options.direction||"all"===this.options.direction||null),this.parseUnderflow(),this.last={x:null,y:null,scaleX:null,scaleY:null},this.update()}parseUnderflow(){const t=this.options.underflow.toLowerCase();"none"===t?this.noUnderflow=!0:"center"===t?(this.underflowX=this.underflowY=0,this.noUnderflow=!1):(this.underflowX=-1!==t.indexOf("left")?-1:-1!==t.indexOf("right")?1:0,this.underflowY=-1!==t.indexOf("top")?-1:-1!==t.indexOf("bottom")?1:0,this.noUnderflow=!1)}move(){return this.update(),!1}update(){if(this.paused)return;if(this.parent.x===this.last.x&&this.parent.y===this.last.y&&this.parent.scale.x===this.last.scaleX&&this.parent.scale.y===this.last.scaleY)return;const t={x:this.parent.x,y:this.parent.y},e=this.parent.plugins.decelerate||{};if(null!==this.options.left||null!==this.options.right){let r=!1;if(!this.noUnderflow&&this.parent.screenWorldWidth<this.parent.screenWidth)switch(this.underflowX){case-1:0!==this.parent.x&&(this.parent.x=0,r=!0);break;case 1:this.parent.x!==this.parent.screenWidth-this.parent.screenWorldWidth&&(this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth,r=!0);break;default:this.parent.x!==(this.parent.screenWidth-this.parent.screenWorldWidth)/2&&(this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/2,r=!0)}else null!==this.options.left&&this.parent.left<(!0===this.options.left?0:this.options.left)&&(this.parent.x=-(!0===this.options.left?0:this.options.left)*this.parent.scale.x,e.x=0,r=!0),null!==this.options.right&&this.parent.right>(!0===this.options.right?this.parent.worldWidth:this.options.right)&&(this.parent.x=-(!0===this.options.right?this.parent.worldWidth:this.options.right)*this.parent.scale.x+this.parent.screenWidth,e.x=0,r=!0);r&&this.parent.emit("moved",{viewport:this.parent,original:t,type:"clamp-x"})}if(null!==this.options.top||null!==this.options.bottom){let r=!1;if(!this.noUnderflow&&this.parent.screenWorldHeight<this.parent.screenHeight)switch(this.underflowY){case-1:0!==this.parent.y&&(this.parent.y=0,r=!0);break;case 1:this.parent.y!==this.parent.screenHeight-this.parent.screenWorldHeight&&(this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight,r=!0);break;default:this.parent.y!==(this.parent.screenHeight-this.parent.screenWorldHeight)/2&&(this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2,r=!0)}else null!==this.options.top&&this.parent.top<(!0===this.options.top?0:this.options.top)&&(this.parent.y=-(!0===this.options.top?0:this.options.top)*this.parent.scale.y,e.y=0,r=!0),null!==this.options.bottom&&this.parent.bottom>(!0===this.options.bottom?this.parent.worldHeight:this.options.bottom)&&(this.parent.y=-(!0===this.options.bottom?this.parent.worldHeight:this.options.bottom)*this.parent.scale.y+this.parent.screenHeight,e.y=0,r=!0);r&&this.parent.emit("moved",{viewport:this.parent,original:t,type:"clamp-y"})}this.last.x=this.parent.x,this.last.y=this.parent.y,this.last.scaleX=this.parent.scale.x,this.last.scaleY=this.parent.scale.y}reset(){this.update()}}const rs={minWidth:null,minHeight:null,maxWidth:null,maxHeight:null,minScale:null,maxScale:null};class ns extends Yo{constructor(t,e={}){super(t),this.options=Object.assign({},rs,e),this.clamp()}resize(){this.clamp()}clamp(){if(!this.paused)if(this.options.minWidth||this.options.minHeight||this.options.maxWidth||this.options.maxHeight){let t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight;if(null!==this.options.minWidth&&t<this.options.minWidth){const r=this.parent.scale.x;this.parent.fitWidth(this.options.minWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/r,t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(null!==this.options.maxWidth&&t>this.options.maxWidth){const r=this.parent.scale.x;this.parent.fitWidth(this.options.maxWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/r,t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(null!==this.options.minHeight&&e<this.options.minHeight){const r=this.parent.scale.y;this.parent.fitHeight(this.options.minHeight,!1,!1,!0),this.parent.scale.x*=this.parent.scale.y/r,t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(null!==this.options.maxHeight&&e>this.options.maxHeight){const t=this.parent.scale.y;this.parent.fitHeight(this.options.maxHeight,!1,!1,!0),this.parent.scale.x*=this.parent.scale.y/t,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}}else if(this.options.minScale||this.options.maxScale){const t={x:null,y:null},e={x:null,y:null};if("number"==typeof this.options.minScale)t.x=this.options.minScale,t.y=this.options.minScale;else if(null!==this.options.minScale){const e=this.options.minScale;t.x=void 0===e.x?null:e.x,t.y=void 0===e.y?null:e.y}if("number"==typeof this.options.maxScale)e.x=this.options.maxScale,e.y=this.options.maxScale;else if(null!==this.options.maxScale){const t=this.options.maxScale;e.x=void 0===t.x?null:t.x,e.y=void 0===t.y?null:t.y}let r=this.parent.scale.x,n=this.parent.scale.y;null!==t.x&&r<t.x&&(r=t.x),null!==e.x&&r>e.x&&(r=e.x),null!==t.y&&n<t.y&&(n=t.y),null!==e.y&&n>e.y&&(n=e.y),r===this.parent.scale.x&&n===this.parent.scale.y||(this.parent.scale.set(r,n),this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"}))}}reset(){this.clamp()}}const is={friction:.98,bounce:.8,minSpeed:.01},os=16;class ss extends Yo{constructor(t,e={}){super(t),this.options=Object.assign({},is,e),this.saved=[],this.timeSinceRelease=0,this.reset(),this.parent.on("moved",t=>this.moved(t))}down(){return this.saved=[],this.x=this.y=null,!1}isActive(){return!(!this.x&&!this.y)}move(){if(this.paused)return!1;const t=this.parent.input.count();return(1===t||t>1&&!this.parent.plugins.get("pinch",!0))&&(this.saved.push({x:this.parent.x,y:this.parent.y,time:performance.now()}),this.saved.length>60&&this.saved.splice(0,30)),!1}moved(t){if(this.saved.length){const e=this.saved[this.saved.length-1];"clamp-x"===t.type?e.x===t.original.x&&(e.x=this.parent.x):"clamp-y"===t.type&&e.y===t.original.y&&(e.y=this.parent.y)}}up(){if(0===this.parent.input.count()&&this.saved.length){const t=performance.now();for(const e of this.saved)if(e.time>=t-100){const r=t-e.time;this.x=(this.parent.x-e.x)/r,this.y=(this.parent.y-e.y)/r,this.percentChangeX=this.percentChangeY=this.options.friction,this.timeSinceRelease=0;break}}return!1}activate(t){void 0!==(t=t||{}).x&&(this.x=t.x,this.percentChangeX=this.options.friction),void 0!==t.y&&(this.y=t.y,this.percentChangeY=this.options.friction)}update(t){if(this.paused)return;const e=this.x||this.y,r=this.timeSinceRelease,n=this.timeSinceRelease+t;if(this.x){const e=this.percentChangeX,i=Math.log(e);this.parent.x+=this.x*os/i*(Math.pow(e,n/os)-Math.pow(e,r/os)),this.x*=Math.pow(this.percentChangeX,t/os)}if(this.y){const e=this.percentChangeY,i=Math.log(e);this.parent.y+=this.y*os/i*(Math.pow(e,n/os)-Math.pow(e,r/os)),this.y*=Math.pow(this.percentChangeY,t/os)}this.timeSinceRelease+=t,Math.abs(this.x||0)<this.options.minSpeed&&(this.x=0),Math.abs(this.y||0)<this.options.minSpeed&&(this.y=0),e&&this.parent.emit("moved",{viewport:this.parent,type:"decelerate"})}reset(){this.x=this.y=null}}const as={direction:"all",pressDrag:!0,wheel:!0,wheelScroll:1,reverse:!1,clampWheel:!1,underflow:"center",factor:1,mouseButtons:"all",keyToPress:null,ignoreKeyToPressOnTouch:!1,lineHeight:20};class hs extends Yo{constructor(t,e={}){super(t),this.options=Object.assign({},as,e),this.moved=!1,this.reverse=this.options.reverse?1:-1,this.xDirection=!this.options.direction||"all"===this.options.direction||"x"===this.options.direction,this.yDirection=!this.options.direction||"all"===this.options.direction||"y"===this.options.direction,this.keyIsPressed=!1,this.parseUnderflow(),this.mouseButtons(this.options.mouseButtons),this.options.keyToPress&&this.handleKeyPresses(this.options.keyToPress)}handleKeyPresses(t){window.addEventListener("keydown",e=>{t.includes(e.code)&&(this.keyIsPressed=!0)}),window.addEventListener("keyup",e=>{t.includes(e.code)&&(this.keyIsPressed=!1)})}mouseButtons(t){this.mouse=t&&"all"!==t?[-1!==t.indexOf("left"),-1!==t.indexOf("middle"),-1!==t.indexOf("right")]:[!0,!0,!0]}parseUnderflow(){const t=this.options.underflow.toLowerCase();"center"===t?(this.underflowX=0,this.underflowY=0):(t.includes("left")?this.underflowX=-1:t.includes("right")?this.underflowX=1:this.underflowX=0,t.includes("top")?this.underflowY=-1:t.includes("bottom")?this.underflowY=1:this.underflowY=0)}checkButtons(t){const e="mouse"===t.data.pointerType,r=this.parent.input.count();return!(!(1===r||r>1&&!this.parent.plugins.get("pinch",!0))||e&&!this.mouse[t.data.button])}checkKeyPress(t){return!this.options.keyToPress||this.keyIsPressed||this.options.ignoreKeyToPressOnTouch&&"touch"===t.data.pointerType}down(t){return!(this.paused||!this.options.pressDrag)&&(this.checkButtons(t)&&this.checkKeyPress(t)?(this.last={x:t.data.global.x,y:t.data.global.y},this.current=t.data.pointerId,!0):(this.last=null,!1))}get active(){return this.moved}move(t){if(this.paused||!this.options.pressDrag)return!1;if(this.last&&this.current===t.data.pointerId){const e=t.data.global.x,r=t.data.global.y,n=this.parent.input.count();if(1===n||n>1&&!this.parent.plugins.get("pinch",!0)){const n=e-this.last.x,i=r-this.last.y;if(this.moved||this.xDirection&&this.parent.input.checkThreshold(n)||this.yDirection&&this.parent.input.checkThreshold(i)){const n={x:e,y:r};return this.xDirection&&(this.parent.x+=(n.x-this.last.x)*this.options.factor),this.yDirection&&(this.parent.y+=(n.y-this.last.y)*this.options.factor),this.last=n,this.moved||this.parent.emit("drag-start",{event:t,screen:new We(this.last.x,this.last.y),world:this.parent.toWorld(new We(this.last.x,this.last.y)),viewport:this.parent}),this.moved=!0,this.parent.emit("moved",{viewport:this.parent,type:"drag"}),!0}}else this.moved=!1}return!1}up(t){if(this.paused)return!1;const e=this.parent.input.touches;if(1===e.length){const t=e[0];return t.last&&(this.last={x:t.last.x,y:t.last.y},this.current=t.id),this.moved=!1,!0}if(this.last&&this.moved){const e=new We(this.last.x,this.last.y);return this.parent.emit("drag-end",{event:t,screen:e,world:this.parent.toWorld(e),viewport:this.parent}),this.last=null,this.moved=!1,!0}return!1}wheel(t){if(this.paused)return!1;if(this.options.wheel){if(!this.parent.plugins.get("wheel",!0)){const e=t.deltaMode?this.options.lineHeight:1;return this.xDirection&&(this.parent.x+=t.deltaX*e*this.options.wheelScroll*this.reverse),this.yDirection&&(this.parent.y+=t.deltaY*e*this.options.wheelScroll*this.reverse),this.options.clampWheel&&this.clamp(),this.parent.emit("wheel-scroll",this.parent),this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.options.passiveWheel||t.preventDefault(),this.parent.options.stopPropagation&&t.stopPropagation(),!0}}return!1}resume(){this.last=null,this.paused=!1}clamp(){const t=this.parent.plugins.get("decelerate",!0)||{};if("y"!==this.options.clampWheel)if(this.parent.screenWorldWidth<this.parent.screenWidth)switch(this.underflowX){case-1:this.parent.x=0;break;case 1:this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/2}else this.parent.left<0?(this.parent.x=0,t.x=0):this.parent.right>this.parent.worldWidth&&(this.parent.x=-this.parent.worldWidth*this.parent.scale.x+this.parent.screenWidth,t.x=0);if("x"!==this.options.clampWheel)if(this.parent.screenWorldHeight<this.parent.screenHeight)switch(this.underflowY){case-1:this.parent.y=0;break;case 1:this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2}else this.parent.top<0&&(this.parent.y=0,t.y=0),this.parent.bottom>this.parent.worldHeight&&(this.parent.y=-this.parent.worldHeight*this.parent.scale.y+this.parent.screenHeight,t.y=0)}}const us={speed:0,acceleration:null,radius:null};class ls extends Yo{constructor(t,e,r={}){super(t),this.target=e,this.options=Object.assign({},us,r),this.velocity={x:0,y:0}}update(t){if(this.paused)return;const e=this.parent.center;let r=this.target.x,n=this.target.y;if(this.options.radius){if(!(Math.sqrt(Math.pow(this.target.y-e.y,2)+Math.pow(this.target.x-e.x,2))>this.options.radius))return;{const t=Math.atan2(this.target.y-e.y,this.target.x-e.x);r=this.target.x-Math.cos(t)*this.options.radius,n=this.target.y-Math.sin(t)*this.options.radius}}const i=r-e.x,o=n-e.y;if(i||o)if(this.options.speed)if(this.options.acceleration){const s=Math.atan2(n-e.y,r-e.x),a=Math.sqrt(Math.pow(i,2)+Math.pow(o,2));if(a){const h=(Math.pow(this.velocity.x,2)+Math.pow(this.velocity.y,2))/(2*this.options.acceleration);this.velocity=a>h?{x:Math.min(this.velocity.x+this.options.acceleration*t,this.options.speed),y:Math.min(this.velocity.y+this.options.acceleration*t,this.options.speed)}:{x:Math.max(this.velocity.x-this.options.acceleration*this.options.speed,0),y:Math.max(this.velocity.y-this.options.acceleration*this.options.speed,0)};const u=Math.cos(s)*this.velocity.x,l=Math.sin(s)*this.velocity.y,c=Math.abs(u)>Math.abs(i)?r:e.x+u,d=Math.abs(l)>Math.abs(o)?n:e.y+l;this.parent.moveCenter(c,d),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}else{const t=Math.atan2(n-e.y,r-e.x),s=Math.cos(t)*this.options.speed,a=Math.sin(t)*this.options.speed,h=Math.abs(s)>Math.abs(i)?r:e.x+s,u=Math.abs(a)>Math.abs(o)?n:e.y+a;this.parent.moveCenter(h,u),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}else this.parent.moveCenter(r,n),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}const cs={radius:null,distance:null,top:null,bottom:null,left:null,right:null,speed:8,reverse:!1,noDecelerate:!1,linear:!1,allowButtons:!1};class ds extends Yo{constructor(t,e={}){super(t),this.options=Object.assign({},cs,e),this.reverse=this.options.reverse?1:-1,this.radiusSquared="number"==typeof this.options.radius?Math.pow(this.options.radius,2):null,this.resize()}resize(){const t=this.options.distance;null!==t?(this.left=t,this.top=t,this.right=this.parent.worldScreenWidth-t,this.bottom=this.parent.worldScreenHeight-t):this.options.radius||(this.left=this.options.left,this.top=this.options.top,this.right=null===this.options.right?null:this.parent.worldScreenWidth-this.options.right,this.bottom=null===this.options.bottom?null:this.parent.worldScreenHeight-this.options.bottom)}down(){return this.paused||this.options.allowButtons||(this.horizontal=this.vertical=null),!1}move(t){if(this.paused)return!1;if("mouse"!==t.data.pointerType&&1!==t.data.identifier||!this.options.allowButtons&&0!==t.data.buttons)return!1;const e=t.data.global.x,r=t.data.global.y;if(this.radiusSquared){const t=this.parent.toScreen(this.parent.center);if(Math.pow(t.x-e,2)+Math.pow(t.y-r,2)>=this.radiusSquared){const n=Math.atan2(t.y-r,t.x-e);this.options.linear?(this.horizontal=Math.round(Math.cos(n))*this.options.speed*this.reverse*.06,this.vertical=Math.round(Math.sin(n))*this.options.speed*this.reverse*.06):(this.horizontal=Math.cos(n)*this.options.speed*this.reverse*.06,this.vertical=Math.sin(n)*this.options.speed*this.reverse*.06)}else this.horizontal&&this.decelerateHorizontal(),this.vertical&&this.decelerateVertical(),this.horizontal=this.vertical=0}else null!==this.left&&e<this.left?this.horizontal=Number(this.reverse)*this.options.speed*.06:null!==this.right&&e>this.right?this.horizontal=-1*this.reverse*this.options.speed*.06:(this.decelerateHorizontal(),this.horizontal=0),null!==this.top&&r<this.top?this.vertical=Number(this.reverse)*this.options.speed*.06:null!==this.bottom&&r>this.bottom?this.vertical=-1*this.reverse*this.options.speed*.06:(this.decelerateVertical(),this.vertical=0);return!1}decelerateHorizontal(){const t=this.parent.plugins.get("decelerate",!0);this.horizontal&&t&&!this.options.noDecelerate&&t.activate({x:this.horizontal*this.options.speed*this.reverse/(1e3/60)})}decelerateVertical(){const t=this.parent.plugins.get("decelerate",!0);this.vertical&&t&&!this.options.noDecelerate&&t.activate({y:this.vertical*this.options.speed*this.reverse/(1e3/60)})}up(){return this.paused||(this.horizontal&&this.decelerateHorizontal(),this.vertical&&this.decelerateVertical(),this.horizontal=this.vertical=null),!1}update(){if(!this.paused&&(this.horizontal||this.vertical)){const t=this.parent.center;this.horizontal&&(t.x+=this.horizontal*this.options.speed),this.vertical&&(t.y+=this.vertical*this.options.speed),this.parent.moveCenter(t),this.parent.emit("moved",{viewport:this.parent,type:"mouse-edges"})}}}const fs={noDrag:!1,percent:1,center:null,factor:1,axis:"all"};class ps extends Yo{__init(){this.active=!1}__init2(){this.pinching=!1}__init3(){this.moved=!1}constructor(t,e={}){super(t),ps.prototype.__init.call(this),ps.prototype.__init2.call(this),ps.prototype.__init3.call(this),this.options=Object.assign({},fs,e)}down(){return this.parent.input.count()>=2&&(this.active=!0,!0)}isAxisX(){return["all","x"].includes(this.options.axis)}isAxisY(){return["all","y"].includes(this.options.axis)}move(t){if(this.paused||!this.active)return!1;const e=t.data.global.x,r=t.data.global.y,n=this.parent.input.touches;if(n.length>=2){const i=n[0],o=n[1],s=i.last&&o.last?Math.sqrt(Math.pow(o.last.x-i.last.x,2)+Math.pow(o.last.y-i.last.y,2)):null;if(i.id===t.data.pointerId?i.last={x:e,y:r,data:t.data}:o.id===t.data.pointerId&&(o.last={x:e,y:r,data:t.data}),s){let t;const e={x:i.last.x+(o.last.x-i.last.x)/2,y:i.last.y+(o.last.y-i.last.y)/2};this.options.center||(t=this.parent.toLocal(e));let r=Math.sqrt(Math.pow(o.last.x-i.last.x,2)+Math.pow(o.last.y-i.last.y,2));r=0===r?r=1e-10:r;const n=(1-s/r)*this.options.percent*(this.isAxisX()?this.parent.scale.x:this.parent.scale.y);this.isAxisX()&&(this.parent.scale.x+=n),this.isAxisY()&&(this.parent.scale.y+=n),this.parent.emit("zoomed",{viewport:this.parent,type:"pinch",center:e});const a=this.parent.plugins.get("clamp-zoom",!0);if(a&&a.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const r=this.parent.toGlobal(t);this.parent.x+=(e.x-r.x)*this.options.factor,this.parent.y+=(e.y-r.y)*this.options.factor,this.parent.emit("moved",{viewport:this.parent,type:"pinch"})}!this.options.noDrag&&this.lastCenter&&(this.parent.x+=(e.x-this.lastCenter.x)*this.options.factor,this.parent.y+=(e.y-this.lastCenter.y)*this.options.factor,this.parent.emit("moved",{viewport:this.parent,type:"pinch"})),this.lastCenter=e,this.moved=!0}else this.pinching||(this.parent.emit("pinch-start",this.parent),this.pinching=!0);return!0}return!1}up(){return!!(this.pinching&&this.parent.input.touches.length<=1)&&(this.active=!1,this.lastCenter=null,this.pinching=!1,this.moved=!1,this.parent.emit("pinch-end",this.parent),!0)}}const ms={topLeft:!1,friction:.8,time:1e3,ease:"easeInOutSine",interrupt:!0,removeOnComplete:!1,removeOnInterrupt:!1,forceStart:!1};class gs extends Yo{constructor(t,e,r,n={}){super(t),this.options=Object.assign({},ms,n),this.ease=qo(n.ease,"easeInOutSine"),this.x=e,this.y=r,this.options.forceStart&&this.snapStart()}snapStart(){this.percent=0,this.snapping={time:0};const t=this.options.topLeft?this.parent.corner:this.parent.center;this.deltaX=this.x-t.x,this.deltaY=this.y-t.y,this.startX=t.x,this.startY=t.y,this.parent.emit("snap-start",this.parent)}wheel(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("snap"),!1}down(){return this.options.removeOnInterrupt?this.parent.plugins.remove("snap"):this.options.interrupt&&(this.snapping=null),!1}up(){if(0===this.parent.input.count()){const t=this.parent.plugins.get("decelerate",!0);t&&(t.x||t.y)&&(t.percentChangeX=t.percentChangeY=this.options.friction)}return!1}update(t){if(!(this.paused||this.options.interrupt&&0!==this.parent.input.count()))if(this.snapping){const e=this.snapping;let r,n,i;e.time+=t;const o=this.startX,s=this.startY,a=this.deltaX,h=this.deltaY;if(e.time>this.options.time)r=!0,n=o+a,i=s+h;else{const t=this.ease(e.time,0,1,this.options.time);n=o+a*t,i=s+h*t}this.options.topLeft?this.parent.moveCorner(n,i):this.parent.moveCenter(n,i),this.parent.emit("moved",{viewport:this.parent,type:"snap"}),r&&(this.options.removeOnComplete&&this.parent.plugins.remove("snap"),this.parent.emit("snap-end",this.parent),this.snapping=null)}else{const t=this.options.topLeft?this.parent.corner:this.parent.center;t.x===this.x&&t.y===this.y||this.snapStart()}}}const vs={width:0,height:0,time:1e3,ease:"easeInOutSine",center:null,interrupt:!0,removeOnComplete:!1,removeOnInterrupt:!1,forceStart:!1,noMove:!1};class ys extends Yo{constructor(t,e={}){super(t),this.options=Object.assign({},vs,e),this.ease=qo(this.options.ease),this.xIndependent=!1,this.yIndependent=!1,this.xScale=0,this.yScale=0,this.options.width>0&&(this.xScale=t.screenWidth/this.options.width,this.xIndependent=!0),this.options.height>0&&(this.yScale=t.screenHeight/this.options.height,this.yIndependent=!0),this.xScale=this.xIndependent?this.xScale:this.yScale,this.yScale=this.yIndependent?this.yScale:this.xScale,0===this.options.time?(t.container.scale.x=this.xScale,t.container.scale.y=this.yScale,this.options.removeOnComplete&&this.parent.plugins.remove("snap-zoom")):e.forceStart&&this.createSnapping()}createSnapping(){const t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,r=this.parent.screenWidth/this.xScale,n=this.parent.screenHeight/this.yScale;this.snapping={time:0,startX:t,startY:e,deltaX:r-t,deltaY:n-e},this.parent.emit("snap-zoom-start",this.parent)}resize(){this.snapping=null,this.options.width>0&&(this.xScale=this.parent.screenWidth/this.options.width),this.options.height>0&&(this.yScale=this.parent.screenHeight/this.options.height),this.xScale=this.xIndependent?this.xScale:this.yScale,this.yScale=this.yIndependent?this.yScale:this.xScale}wheel(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("snap-zoom"),!1}down(){return this.options.removeOnInterrupt?this.parent.plugins.remove("snap-zoom"):this.options.interrupt&&(this.snapping=null),!1}update(t){if(this.paused)return;if(this.options.interrupt&&0!==this.parent.input.count())return;let e;if(this.options.center||this.options.noMove||(e=this.parent.center),this.snapping){if(this.snapping){const r=this.snapping;if(r.time+=t,r.time>=this.options.time)this.parent.scale.set(this.xScale,this.yScale),this.options.removeOnComplete&&this.parent.plugins.remove("snap-zoom"),this.parent.emit("snap-zoom-end",this.parent),this.snapping=null;else{const t=this.snapping,e=this.ease(t.time,t.startX,t.deltaX,this.options.time),r=this.ease(t.time,t.startY,t.deltaY,this.options.time);this.parent.scale.x=this.parent.screenWidth/e,this.parent.scale.y=this.parent.screenHeight/r}const n=this.parent.plugins.get("clamp-zoom",!0);n&&n.clamp(),this.options.noMove||(this.options.center?this.parent.moveCenter(this.options.center):this.parent.moveCenter(e))}}else this.parent.scale.x===this.xScale&&this.parent.scale.y===this.yScale||this.createSnapping()}resume(){this.snapping=null,super.resume()}}const bs={percent:.1,smooth:!1,interrupt:!0,reverse:!1,center:null,lineHeight:20,axis:"all"};class _s extends Yo{constructor(t,e={}){super(t),this.options=Object.assign({},bs,e)}down(){return this.options.interrupt&&(this.smoothing=null),!1}isAxisX(){return["all","x"].includes(this.options.axis)}isAxisY(){return["all","y"].includes(this.options.axis)}update(){if(this.smoothing){const t=this.smoothingCenter,e=this.smoothing;let r;this.options.center||(r=this.parent.toLocal(t)),this.isAxisX()&&(this.parent.scale.x+=e.x),this.isAxisY()&&(this.parent.scale.y+=e.y),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const n=this.parent.plugins.get("clamp-zoom",!0);if(n&&n.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const e=this.parent.toGlobal(r);this.parent.x+=t.x-e.x,this.parent.y+=t.y-e.y}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.smoothingCount++,this.smoothingCount>=this.options.smooth&&(this.smoothing=null)}}wheel(t){if(this.paused)return;const e=this.parent.input.getPointerPosition(t),r=(this.options.reverse?-1:1)*-t.deltaY*(t.deltaMode?this.options.lineHeight:1)/500,n=Math.pow(2,(1+this.options.percent)*r);if(this.options.smooth){const t={x:this.smoothing?this.smoothing.x*(this.options.smooth-this.smoothingCount):0,y:this.smoothing?this.smoothing.y*(this.options.smooth-this.smoothingCount):0};this.smoothing={x:((this.parent.scale.x+t.x)*n-this.parent.scale.x)/this.options.smooth,y:((this.parent.scale.y+t.y)*n-this.parent.scale.y)/this.options.smooth},this.smoothingCount=0,this.smoothingCenter=e}else{let t;this.options.center||(t=this.parent.toLocal(e)),this.isAxisX()&&(this.parent.scale.x*=n),this.isAxisY()&&(this.parent.scale.y*=n),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const r=this.parent.plugins.get("clamp-zoom",!0);if(r&&r.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const r=this.parent.toGlobal(t);this.parent.x+=e.x-r.x,this.parent.y+=e.y-r.y}}return this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.emit("wheel",{wheel:{dx:t.deltaX,dy:t.deltaY,dz:t.deltaZ},event:t,viewport:this.parent}),!this.parent.options.passiveWheel||void 0}}class Es{constructor(t){this.viewport=t,this.touches=[],this.addListeners()}addListeners(){this.viewport.interactive=!0,this.viewport.forceHitArea||(this.viewport.hitArea=new je(0,0,this.viewport.worldWidth,this.viewport.worldHeight)),this.viewport.on("pointerdown",this.down,this),this.viewport.on("pointermove",this.move,this),this.viewport.on("pointerup",this.up,this),this.viewport.on("pointerupoutside",this.up,this),this.viewport.on("pointercancel",this.up,this),this.viewport.on("pointerout",this.up,this),this.wheelFunction=t=>this.handleWheel(t),this.viewport.options.divWheel.addEventListener("wheel",this.wheelFunction,{passive:this.viewport.options.passiveWheel}),this.isMouseDown=!1}destroy(){this.viewport.options.divWheel.removeEventListener("wheel",this.wheelFunction)}down(t){if(this.viewport.pause||!this.viewport.worldVisible)return;if("mouse"===t.data.pointerType?this.isMouseDown=!0:this.get(t.data.pointerId)||this.touches.push({id:t.data.pointerId,last:null}),1===this.count()){this.last=t.data.global.clone();const e=this.viewport.plugins.get("decelerate",!0),r=this.viewport.plugins.get("bounce",!0);e&&e.isActive()||r&&r.isActive()?this.clickedAvailable=!1:this.clickedAvailable=!0}else this.clickedAvailable=!1;this.viewport.plugins.down(t)&&this.viewport.options.stopPropagation&&t.stopPropagation()}clear(){this.isMouseDown=!1,this.touches=[],this.last=null}checkThreshold(t){return Math.abs(t)>=this.viewport.threshold}move(t){if(this.viewport.pause||!this.viewport.worldVisible)return;const e=this.viewport.plugins.move(t);if(this.clickedAvailable&&this.last){const e=t.data.global.x-this.last.x,r=t.data.global.y-this.last.y;(this.checkThreshold(e)||this.checkThreshold(r))&&(this.clickedAvailable=!1)}e&&this.viewport.options.stopPropagation&&t.stopPropagation()}up(t){if(this.viewport.pause||!this.viewport.worldVisible)return;"mouse"===t.data.pointerType&&(this.isMouseDown=!1),"mouse"!==t.data.pointerType&&this.remove(t.data.pointerId);const e=this.viewport.plugins.up(t);this.clickedAvailable&&0===this.count()&&this.last&&(this.viewport.emit("clicked",{event:t,screen:this.last,world:this.viewport.toWorld(this.last),viewport:this}),this.clickedAvailable=!1),e&&this.viewport.options.stopPropagation&&t.stopPropagation()}getPointerPosition(t){const e=new We;return this.viewport.options.interaction?this.viewport.options.interaction.mapPositionToPoint(e,t.clientX,t.clientY):(e.x=t.clientX,e.y=t.clientY),e}handleWheel(t){if(this.viewport.pause||!this.viewport.worldVisible)return;if(this.viewport.options.interaction&&this.viewport.options.interaction.interactionDOMElement!==t.target)return;const e=this.viewport.toLocal(this.getPointerPosition(t));if(this.viewport.left<=e.x&&e.x<=this.viewport.right&&this.viewport.top<=e.y&&e.y<=this.viewport.bottom){this.viewport.plugins.wheel(t)&&!this.viewport.options.passiveWheel&&t.preventDefault()}}pause(){this.touches=[],this.isMouseDown=!1}get(t){for(const e of this.touches)if(e.id===t)return e;return null}remove(t){for(let e=0;e<this.touches.length;e++)if(this.touches[e].id===t)return void this.touches.splice(e,1)}count(){return(this.isMouseDown?1:0)+this.touches.length}}function xs(t){let e=void 0,r=t[0],n=1;for(;n<t.length;){const i=t[n],o=t[n+1];if(n+=2,("optionalAccess"===i||"optionalCall"===i)&&null==r)return;"access"===i||"optionalAccess"===i?(e=r,r=o(r)):"call"!==i&&"optionalCall"!==i||(r=o((...t)=>r.call(e,...t)),e=void 0)}return r}const Ts=["drag","pinch","wheel","follow","mouse-edges","decelerate","animate","bounce","snap-zoom","clamp-zoom","snap","clamp"];class ws{constructor(t){this.viewport=t,this.list=[],this.plugins={}}add(t,e,r=Ts.length){this.plugins[t]=e;const n=Ts.indexOf(t);-1!==n&&Ts.splice(n,1),Ts.splice(r,0,t),this.sort()}get(t,e){return e&&xs([this,"access",t=>t.plugins,"access",e=>e[t],"optionalAccess",t=>t.paused])?null:this.plugins[t]}update(t){for(const e of this.list)e.update(t)}resize(){for(const t of this.list)t.resize()}reset(){for(const t of this.list)t.reset()}removeAll(){this.plugins={},this.sort()}remove(t){this.plugins[t]&&(delete this.plugins[t],this.viewport.emit(t+"-remove"),this.sort())}pause(t){xs([this,"access",t=>t.plugins,"access",e=>e[t],"optionalAccess",t=>t.pause,"call",t=>t()])}resume(t){xs([this,"access",t=>t.plugins,"access",e=>e[t],"optionalAccess",t=>t.resume,"call",t=>t()])}sort(){this.list=[];for(const t of Ts)this.plugins[t]&&this.list.push(this.plugins[t])}down(t){let e=!1;for(const r of this.list)r.down(t)&&(e=!0);return e}move(t){let e=!1;for(const r of this.viewport.plugins.list)r.move(t)&&(e=!0);return e}up(t){let e=!1;for(const r of this.list)r.up(t)&&(e=!0);return e}wheel(t){let e=!1;for(const r of this.list)r.wheel(t)&&(e=!0);return e}}const As={screenWidth:window.innerWidth,screenHeight:window.innerHeight,worldWidth:null,worldHeight:null,threshold:5,passiveWheel:!0,stopPropagation:!1,forceHitArea:null,noTicker:!1,interaction:null,disableOnContextMenu:!1,ticker:Ue.shared};class Ss extends Oi{constructor(t={}){super(),this.options=Object.assign({},{divWheel:document.body},As,t),this.screenWidth=this.options.screenWidth,this.screenHeight=this.options.screenHeight,this._worldWidth=this.options.worldWidth,this._worldHeight=this.options.worldHeight,this.forceHitArea=this.options.forceHitArea,this.threshold=this.options.threshold,this.options.divWheel=this.options.divWheel||document.body,this.options.disableOnContextMenu&&(this.options.divWheel.oncontextmenu=t=>t.preventDefault()),this.options.noTicker||(this.tickerFunction=()=>this.update(this.options.ticker.elapsedMS),this.options.ticker.add(this.tickerFunction)),this.input=new Es(this),this.plugins=new ws(this)}destroy(t){!this.options.noTicker&&this.tickerFunction&&this.options.ticker.remove(this.tickerFunction),this.input.destroy(),super.destroy(t)}update(t){this.pause||(this.plugins.update(t),this.lastViewport&&(this.lastViewport.x!==this.x||this.lastViewport.y!==this.y?this.moving=!0:this.moving&&(this.emit("moved-end",this),this.moving=!1),this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y?this.zooming=!0:this.zooming&&(this.emit("zoomed-end",this),this.zooming=!1)),this.forceHitArea||(this._hitAreaDefault=new je(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight),this.hitArea=this._hitAreaDefault),this._dirty=this._dirty||!this.lastViewport||this.lastViewport.x!==this.x||this.lastViewport.y!==this.y||this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y,this.lastViewport={x:this.x,y:this.y,scaleX:this.scale.x,scaleY:this.scale.y},this.emit("frame-end",this))}resize(t=window.innerWidth,e=window.innerHeight,r,n){this.screenWidth=t,this.screenHeight=e,void 0!==r&&(this._worldWidth=r),void 0!==n&&(this._worldHeight=n),this.plugins.resize(),this.dirty=!0}get worldWidth(){return this._worldWidth?this._worldWidth:this.width/this.scale.x}set worldWidth(t){this._worldWidth=t,this.plugins.resize()}get worldHeight(){return this._worldHeight?this._worldHeight:this.height/this.scale.y}set worldHeight(t){this._worldHeight=t,this.plugins.resize()}getVisibleBounds(){return new je(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight)}toWorld(t,e){return 2===arguments.length?this.toLocal(new We(t,e)):this.toLocal(t)}toScreen(t,e){return 2===arguments.length?this.toGlobal(new We(t,e)):this.toGlobal(t)}get worldScreenWidth(){return this.screenWidth/this.scale.x}get worldScreenHeight(){return this.screenHeight/this.scale.y}get screenWorldWidth(){return this.worldWidth*this.scale.x}get screenWorldHeight(){return this.worldHeight*this.scale.y}get center(){return new We(this.worldScreenWidth/2-this.x/this.scale.x,this.worldScreenHeight/2-this.y/this.scale.y)}set center(t){this.moveCenter(t)}moveCenter(...t){let e,r;"number"==typeof t[0]?(e=t[0],r=t[1]):(e=t[0].x,r=t[0].y);const n=(this.worldScreenWidth/2-e)*this.scale.x,i=(this.worldScreenHeight/2-r)*this.scale.y;return this.x===n&&this.y===i||(this.position.set(n,i),this.plugins.reset(),this.dirty=!0),this}get corner(){return new We(-this.x/this.scale.x,-this.y/this.scale.y)}set corner(t){this.moveCorner(t)}moveCorner(...t){let e,r;return 1===t.length?(e=-t[0].x*this.scale.x,r=-t[0].y*this.scale.y):(e=-t[0]*this.scale.x,r=-t[1]*this.scale.y),e===this.x&&r===this.y||(this.position.set(e,r),this.plugins.reset(),this.dirty=!0),this}get screenWidthInWorldPixels(){return this.screenWidth/this.scale.x}get screenHeightInWorldPixels(){return this.screenHeight/this.scale.y}findFitWidth(t){return this.screenWidth/t}findFitHeight(t){return this.screenHeight/t}findFit(t,e){const r=this.screenWidth/t,n=this.screenHeight/e;return Math.min(r,n)}findCover(t,e){const r=this.screenWidth/t,n=this.screenHeight/e;return Math.max(r,n)}fitWidth(t=this.worldWidth,e,r=!0,n){let i;e&&(i=this.center),this.scale.x=this.screenWidth/t,r&&(this.scale.y=this.scale.x);const o=this.plugins.get("clamp-zoom",!0);return!n&&o&&o.clamp(),e&&i&&this.moveCenter(i),this}fitHeight(t=this.worldHeight,e,r=!0,n){let i;e&&(i=this.center),this.scale.y=this.screenHeight/t,r&&(this.scale.x=this.scale.y);const o=this.plugins.get("clamp-zoom",!0);return!n&&o&&o.clamp(),e&&i&&this.moveCenter(i),this}fitWorld(t){let e;t&&(e=this.center),this.scale.x=this.screenWidth/this.worldWidth,this.scale.y=this.screenHeight/this.worldHeight,this.scale.x<this.scale.y?this.scale.y=this.scale.x:this.scale.x=this.scale.y;const r=this.plugins.get("clamp-zoom",!0);return r&&r.clamp(),t&&e&&this.moveCenter(e),this}fit(t,e=this.worldWidth,r=this.worldHeight){let n;t&&(n=this.center),this.scale.x=this.screenWidth/e,this.scale.y=this.screenHeight/r,this.scale.x<this.scale.y?this.scale.y=this.scale.x:this.scale.x=this.scale.y;const i=this.plugins.get("clamp-zoom",!0);return i&&i.clamp(),t&&n&&this.moveCenter(n),this}set visible(t){t||this.input.clear(),super.visible=t}setZoom(t,e){let r;e&&(r=this.center),this.scale.set(t);const n=this.plugins.get("clamp-zoom",!0);return n&&n.clamp(),e&&r&&this.moveCenter(r),this}zoomPercent(t,e){return this.setZoom(this.scale.x+this.scale.x*t,e)}zoom(t,e){return this.fitWidth(t+this.worldScreenWidth,e),this}get scaled(){return this.scale.x}set scaled(t){this.setZoom(t,!0)}snapZoom(t){return this.plugins.add("snap-zoom",new ys(this,t)),this}OOB(){return{left:this.left<0,right:this.right>this.worldWidth,top:this.top<0,bottom:this.bottom>this.worldHeight,cornerPoint:new We(this.worldWidth*this.scale.x-this.screenWidth,this.worldHeight*this.scale.y-this.screenHeight)}}get right(){return-this.x/this.scale.x+this.worldScreenWidth}set right(t){this.x=-t*this.scale.x+this.screenWidth,this.plugins.reset()}get left(){return-this.x/this.scale.x}set left(t){this.x=-t*this.scale.x,this.plugins.reset()}get top(){return-this.y/this.scale.y}set top(t){this.y=-t*this.scale.y,this.plugins.reset()}get bottom(){return-this.y/this.scale.y+this.worldScreenHeight}set bottom(t){this.y=-t*this.scale.y+this.screenHeight,this.plugins.reset()}get dirty(){return!!this._dirty}set dirty(t){this._dirty=t}get forceHitArea(){return this._forceHitArea}set forceHitArea(t){t?(this._forceHitArea=t,this.hitArea=t):(this._forceHitArea=null,this.hitArea=new je(0,0,this.worldWidth,this.worldHeight))}drag(t){return this.plugins.add("drag",new hs(this,t)),this}clamp(t){return this.plugins.add("clamp",new es(this,t)),this}decelerate(t){return this.plugins.add("decelerate",new ss(this,t)),this}bounce(t){return this.plugins.add("bounce",new $o(this,t)),this}pinch(t){return this.plugins.add("pinch",new ps(this,t)),this}snap(t,e,r){return this.plugins.add("snap",new gs(this,t,e,r)),this}follow(t,e){return this.plugins.add("follow",new ls(this,t,e)),this}wheel(t){return this.plugins.add("wheel",new _s(this,t)),this}animate(t){return this.plugins.add("animate",new Zo(this,t)),this}clampZoom(t){return this.plugins.add("clamp-zoom",new ns(this,t)),this}mouseEdges(t){return this.plugins.add("mouse-edges",new ds(this,t)),this}get pause(){return!!this._pause}set pause(t){this._pause=t,this.lastViewport=null,this.moving=!1,this.zooming=!1,t&&this.input.pause()}ensureVisible(t,e,r,n,i){i&&(r>this.worldScreenWidth||n>this.worldScreenHeight)&&(this.fit(!0,r,n),this.emit("zoomed",{viewport:this,type:"ensureVisible"}));let o=!1;t<this.left?(this.left=t,o=!0):t+r>this.right&&(this.right=t+r,o=!0),e<this.top?(this.top=e,o=!0):e+n>this.bottom&&(this.bottom=e+n,o=!0),o&&this.emit("moved",{viewport:this,type:"ensureVisible"})}}const Os=new je;class Is{constructor(t={}){this._recursive="boolean"!=typeof t.recursive||t.recursive,this._toggle=t.toggle||"visible",this._targetList=new Set}add(t){return this._targetList.add(t),this}addAll(t){for(let e=0,r=t.length;e<r;e++)this._targetList.add(t[e]);return this}remove(t){return this._targetList.delete(t),this}removeAll(t){for(let e=0,r=t.length;e<r;e++)this._targetList.delete(t[e]);return this}clear(){return this._targetList.clear(),this}cull(t,e=!1){return e||this.uncull(),this._targetList.forEach(r=>{e||r.getBounds(!1,Os),this._recursive?this.cullRecursive(t,r,e):(e&&r._bounds.getRectangle(t),r[this._toggle]=Os.right>t.left&&Os.left<t.right&&Os.bottom>t.top&&Os.top<t.bottom)}),this}uncull(){return this._targetList.forEach(t=>{this._recursive?this.uncullRecursive(t):t[this._toggle]=!1}),this}cullRecursive(t,e,r){const n=r?e._bounds.getRectangle(Os):e.getBounds(!0,Os);e[this._toggle]=n.right>t.left&&n.left<t.right&&n.bottom>t.top&&n.top<t.bottom;if(!(n.left>=t.left&&n.top>=t.top&&n.right<=t.right&&n.bottom<=t.bottom)&&e[this._toggle]&&e.children&&e.children.length){const r=e.children;for(let e=0,n=r.length;e<n;e++)this.cullRecursive(t,r[e])}}uncullRecursive(t){if(t[this._toggle]=!0,t.children&&t.children.length){const e=t.children;for(let t=0,r=e.length;t<r;t++)this.uncullRecursive(e[t])}}}var Rs,Ns="object"==typeof Reflect?Reflect:null,Ls=Ns&&"function"==typeof Ns.apply?Ns.apply:function(t,e,r){return Function.prototype.apply.call(t,e,r)};Rs=Ns&&"function"==typeof Ns.ownKeys?Ns.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var Ms=Number.isNaN||function(t){return t!=t};function Ps(){Ps.init.call(this)}var Cs=Ps,Ds=function(t,e){return new Promise((function(r,n){function i(r){t.removeListener(e,o),n(r)}function o(){"function"==typeof t.removeListener&&t.removeListener("error",i),r([].slice.call(arguments))}Vs(t,e,o,{once:!0}),"error"!==e&&function(t,e,r){"function"==typeof t.on&&Vs(t,"error",e,r)}(t,i,{once:!0})}))};Ps.EventEmitter=Ps,Ps.prototype._events=void 0,Ps.prototype._eventsCount=0,Ps.prototype._maxListeners=void 0;var Us=10;function Bs(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function Fs(t){return void 0===t._maxListeners?Ps.defaultMaxListeners:t._maxListeners}function ks(t,e,r,n){var i,o,s,a;if(Bs(r),void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,r.listener?r.listener:r),o=t._events),s=o[e]),void 0===s)s=o[e]=r,++t._eventsCount;else if("function"==typeof s?s=o[e]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=Fs(t))>0&&s.length>i&&!s.warned){s.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=t,h.type=e,h.count=s.length,a=h,console&&console.warn&&console.warn(a)}return t}function Gs(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function js(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=Gs.bind(n);return i.listener=r,n.wrapFn=i,i}function Hs(t,e,r){var n=t._events;if(void 0===n)return[];var i=n[e];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}(i):zs(i,i.length)}function Xs(t){var e=this._events;if(void 0!==e){var r=e[t];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function zs(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function Vs(t,e,r,n){if("function"==typeof t.on)n.once?t.once(e,r):t.on(e,r);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function i(o){n.once&&t.removeEventListener(e,i),r(o)}))}}Object.defineProperty(Ps,"defaultMaxListeners",{enumerable:!0,get:function(){return Us},set:function(t){if("number"!=typeof t||t<0||Ms(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Us=t}}),Ps.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Ps.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||Ms(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},Ps.prototype.getMaxListeners=function(){return Fs(this)},Ps.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e.push(arguments[r]);var n="error"===t,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var a=i[t];if(void 0===a)return!1;if("function"==typeof a)Ls(a,this,e);else{var h=a.length,u=zs(a,h);for(r=0;r<h;++r)Ls(u[r],this,e)}return!0},Ps.prototype.addListener=function(t,e){return ks(this,t,e,!1)},Ps.prototype.on=Ps.prototype.addListener,Ps.prototype.prependListener=function(t,e){return ks(this,t,e,!0)},Ps.prototype.once=function(t,e){return Bs(e),this.on(t,js(this,t,e)),this},Ps.prototype.prependOnceListener=function(t,e){return Bs(e),this.prependListener(t,js(this,t,e)),this},Ps.prototype.removeListener=function(t,e){var r,n,i,o,s;if(Bs(e),void 0===(n=this._events))return this;if(void 0===(r=n[t]))return this;if(r===e||r.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete n[t],n.removeListener&&this.emit("removeListener",t,r.listener||e));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===e||r[o].listener===e){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(r,i),1===r.length&&(n[t]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",t,s||e)}return this},Ps.prototype.off=Ps.prototype.removeListener,Ps.prototype.removeAllListeners=function(t){var e,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[t]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=r[t]))this.removeListener(t,e);else if(void 0!==e)for(n=e.length-1;n>=0;n--)this.removeListener(t,e[n]);return this},Ps.prototype.listeners=function(t){return Hs(this,t,!0)},Ps.prototype.rawListeners=function(t){return Hs(this,t,!1)},Ps.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):Xs.call(t,e)},Ps.prototype.listenerCount=Xs,Ps.prototype.eventNames=function(){return this._eventsCount>0?Rs(this._events):[]},Cs.once=Ds;var Ws,Ys,qs=Cs.EventEmitter;
/*!
     * @pixi/graphics - v6.1.2
     * Compiled Thu, 12 Aug 2021 17:11:19 UTC
     *
     * @pixi/graphics is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */!function(t){t.MITER="miter",t.BEVEL="bevel",t.ROUND="round"}(Ws||(Ws={})),function(t){t.BUTT="butt",t.ROUND="round",t.SQUARE="square"}(Ys||(Ys={}));var Ks={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(t,e){if(void 0===e&&(e=20),!this.adaptive||!t||isNaN(t))return e;var r=Math.ceil(t/this.maxLength);return r<this.minSegments?r=this.minSegments:r>this.maxSegments&&(r=this.maxSegments),r}},Zs=function(){function t(){this.color=16777215,this.alpha=1,this.texture=Ir.WHITE,this.matrix=null,this.visible=!1,this.reset()}return t.prototype.clone=function(){var e=new t;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e},t.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=Ir.WHITE,this.matrix=null,this.visible=!1},t.prototype.destroy=function(){this.texture=null,this.matrix=null},t}(),Js=function(t,e){return(Js=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function Qs(t,e){function r(){this.constructor=t}Js(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var $s={build:function(t){t.points=t.shape.points.slice()},triangulate:function(t,e){var r=t.points,n=t.holes,i=e.points,o=e.indices;if(r.length>=6){for(var s=[],a=0;a<n.length;a++){var h=n[a];s.push(r.length/2),r=r.concat(h.points)}var u=st(r,s,2);if(!u)return;var l=i.length/2;for(a=0;a<u.length;a+=3)o.push(u[a]+l),o.push(u[a+1]+l),o.push(u[a+2]+l);for(a=0;a<r.length;a++)i.push(r[a])}}},ta={build:function(t){var e,r,n=t.shape,i=t.points,o=n.x,s=n.y;if(i.length=0,t.type===Ce.CIRC)e=n.radius,r=n.radius;else{var a=t.shape;e=a.width,r=a.height}if(0!==e&&0!==r){var h=Math.floor(30*Math.sqrt(n.radius))||Math.floor(15*Math.sqrt(e+r));h/=2.3;for(var u=2*Math.PI/h,l=0;l<h-.5;l++)i.push(o+Math.sin(-u*l)*e,s+Math.cos(-u*l)*r);i.push(i[0],i[1])}},triangulate:function(t,e){var r=t.points,n=e.points,i=e.indices,o=n.length/2,s=o,a=t.shape,h=t.matrix,u=a.x,l=a.y;n.push(t.matrix?h.a*u+h.c*l+h.tx:u,t.matrix?h.b*u+h.d*l+h.ty:l);for(var c=0;c<r.length;c+=2)n.push(r[c],r[c+1]),i.push(o++,s,o)}},ea={build:function(t){var e=t.shape,r=e.x,n=e.y,i=e.width,o=e.height,s=t.points;s.length=0,s.push(r,n,r+i,n,r+i,n+o,r,n+o)},triangulate:function(t,e){var r=t.points,n=e.points,i=n.length/2;n.push(r[0],r[1],r[2],r[3],r[6],r[7],r[4],r[5]),e.indices.push(i,i+1,i+2,i+1,i+2,i+3)}};function ra(t,e,r){return t+(e-t)*r}function na(t,e,r,n,i,o,s){void 0===s&&(s=[]);for(var a=s,h=0,u=0,l=0,c=0,d=0,f=0,p=0,m=0;p<=20;++p)h=ra(t,r,m=p/20),u=ra(e,n,m),l=ra(r,i,m),c=ra(n,o,m),d=ra(h,l,m),f=ra(u,c,m),0===p&&a[a.length-2]===d&&a[a.length-1]===f||a.push(d,f);return a}var ia={build:function(t){var e=t.shape,r=t.points,n=e.x,i=e.y,o=e.width,s=e.height,a=Math.max(0,Math.min(e.radius,Math.min(o,s)/2));r.length=0,a?(na(n,i+a,n,i,n+a,i,r),na(n+o-a,i,n+o,i,n+o,i+a,r),na(n+o,i+s-a,n+o,i+s,n+o-a,i+s,r),na(n+a,i+s,n,i+s,n,i+s-a,r)):r.push(n,i,n+o,i,n+o,i+s,n,i+s)},triangulate:function(t,e){for(var r=t.points,n=e.points,i=e.indices,o=n.length/2,s=st(r,null,2),a=0,h=s.length;a<h;a+=3)i.push(s[a]+o),i.push(s[a+1]+o),i.push(s[a+2]+o);for(a=0,h=r.length;a<h;a++)n.push(r[a],r[++a])}};function oa(t,e,r,n,i,o,s,a){var h,u;s?(h=n,u=-r):(h=-n,u=r);var l=t-r*i+h,c=e-n*i+u,d=t+r*o+h,f=e+n*o+u;return a.push(l,c),a.push(d,f),2}function sa(t,e,r,n,i,o,s,a){var h=r-t,u=n-e,l=Math.atan2(h,u),c=Math.atan2(i-t,o-e);a&&l<c?l+=2*Math.PI:!a&&l>c&&(c+=2*Math.PI);var d=l,f=c-l,p=Math.abs(f),m=Math.sqrt(h*h+u*u),g=1+(15*p*Math.sqrt(m)/Math.PI>>0),v=f/g;if(d+=v,a){s.push(t,e),s.push(r,n);for(var y=1,b=d;y<g;y++,b+=v)s.push(t,e),s.push(t+Math.sin(b)*m,e+Math.cos(b)*m);s.push(t,e),s.push(i,o)}else{s.push(r,n),s.push(t,e);for(y=1,b=d;y<g;y++,b+=v)s.push(t+Math.sin(b)*m,e+Math.cos(b)*m),s.push(t,e);s.push(i,o),s.push(t,e)}return 2*g}function aa(t,e){t.lineStyle.native?function(t,e){var r=0,n=t.shape,i=t.points||n.points,o=n.type!==Ce.POLY||n.closeStroke;if(0!==i.length){var s=e.points,a=e.indices,h=i.length/2,u=s.length/2,l=u;for(s.push(i[0],i[1]),r=1;r<h;r++)s.push(i[2*r],i[2*r+1]),a.push(l,l+1),l++;o&&a.push(l,u)}}(t,e):function(t,e){var r=t.shape,n=t.points||r.points.slice(),i=e.closePointEps;if(0!==n.length){var o=t.lineStyle,s=new We(n[0],n[1]),a=new We(n[n.length-2],n[n.length-1]),h=r.type!==Ce.POLY||r.closeStroke,u=Math.abs(s.x-a.x)<i&&Math.abs(s.y-a.y)<i;if(h){n=n.slice(),u&&(n.pop(),n.pop(),a.set(n[n.length-2],n[n.length-1]));var l=.5*(s.x+a.x),c=.5*(a.y+s.y);n.unshift(l,c),n.push(l,c)}var d=e.points,f=n.length/2,p=n.length,m=d.length/2,g=o.width/2,v=g*g,y=o.miterLimit*o.miterLimit,b=n[0],_=n[1],E=n[2],x=n[3],T=0,w=0,A=-(_-x),S=b-E,O=0,I=0,R=Math.sqrt(A*A+S*S);A/=R,S/=R,A*=g,S*=g;var N=o.alignment,L=2*(1-N),M=2*N;h||(o.cap===Ys.ROUND?p+=sa(b-A*(L-M)*.5,_-S*(L-M)*.5,b-A*L,_-S*L,b+A*M,_+S*M,d,!0)+2:o.cap===Ys.SQUARE&&(p+=oa(b,_,A,S,L,M,!0,d))),d.push(b-A*L,_-S*L),d.push(b+A*M,_+S*M);for(var P=1;P<f-1;++P){b=n[2*(P-1)],_=n[2*(P-1)+1],E=n[2*P],x=n[2*P+1],T=n[2*(P+1)],w=n[2*(P+1)+1],A=-(_-x),S=b-E,A/=R=Math.sqrt(A*A+S*S),S/=R,A*=g,S*=g,O=-(x-w),I=E-T,O/=R=Math.sqrt(O*O+I*I),I/=R,O*=g,I*=g;var C=E-b,D=_-x,U=E-T,B=w-x,F=D*U-B*C,k=F<0;if(Math.abs(F)<.1)d.push(E-A*L,x-S*L),d.push(E+A*M,x+S*M);else{var G=(-A+b)*(-S+x)-(-A+E)*(-S+_),j=(-O+T)*(-I+x)-(-O+E)*(-I+w),H=(C*j-U*G)/F,X=(B*G-D*j)/F,z=(H-E)*(H-E)+(X-x)*(X-x),V=E+(H-E)*L,W=x+(X-x)*L,Y=E-(H-E)*M,q=x-(X-x)*M,K=k?L:M;z<=Math.min(C*C+D*D,U*U+B*B)+K*K*v?o.join===Ws.BEVEL||z/v>y?(k?(d.push(V,W),d.push(E+A*M,x+S*M),d.push(V,W),d.push(E+O*M,x+I*M)):(d.push(E-A*L,x-S*L),d.push(Y,q),d.push(E-O*L,x-I*L),d.push(Y,q)),p+=2):o.join===Ws.ROUND?k?(d.push(V,W),d.push(E+A*M,x+S*M),p+=sa(E,x,E+A*M,x+S*M,E+O*M,x+I*M,d,!0)+4,d.push(V,W),d.push(E+O*M,x+I*M)):(d.push(E-A*L,x-S*L),d.push(Y,q),p+=sa(E,x,E-A*L,x-S*L,E-O*L,x-I*L,d,!1)+4,d.push(E-O*L,x-I*L),d.push(Y,q)):(d.push(V,W),d.push(Y,q)):(d.push(E-A*L,x-S*L),d.push(E+A*M,x+S*M),o.join===Ws.BEVEL||z/v>y||(o.join===Ws.ROUND?p+=k?sa(E,x,E+A*M,x+S*M,E+O*M,x+I*M,d,!0)+2:sa(E,x,E-A*L,x-S*L,E-O*L,x-I*L,d,!1)+2:(k?(d.push(Y,q),d.push(Y,q)):(d.push(V,W),d.push(V,W)),p+=2)),d.push(E-O*L,x-I*L),d.push(E+O*M,x+I*M),p+=2)}}b=n[2*(f-2)],_=n[2*(f-2)+1],E=n[2*(f-1)],A=-(_-(x=n[2*(f-1)+1])),S=b-E,A/=R=Math.sqrt(A*A+S*S),S/=R,A*=g,S*=g,d.push(E-A*L,x-S*L),d.push(E+A*M,x+S*M),h||(o.cap===Ys.ROUND?p+=sa(E-A*(L-M)*.5,x-S*(L-M)*.5,E-A*L,x-S*L,E+A*M,x+S*M,d,!1)+2:o.cap===Ys.SQUARE&&(p+=oa(E,x,A,S,L,M,!1,d)));var Z=e.indices,J=Ks.epsilon*Ks.epsilon;for(P=m;P<p+m-2;++P)b=d[2*P],_=d[2*P+1],E=d[2*(P+1)],x=d[2*(P+1)+1],T=d[2*(P+2)],w=d[2*(P+2)+1],Math.abs(b*(x-w)+E*(w-_)+T*(_-x))<J||Z.push(P,P+1,P+2)}}(t,e)}var ha,ua=function(){function t(){}return t.curveTo=function(t,e,r,n,i,o){var s=o[o.length-2],a=o[o.length-1]-e,h=s-t,u=n-e,l=r-t,c=Math.abs(a*l-h*u);if(c<1e-8||0===i)return o[o.length-2]===t&&o[o.length-1]===e||o.push(t,e),null;var d=a*a+h*h,f=u*u+l*l,p=a*u+h*l,m=i*Math.sqrt(d)/c,g=i*Math.sqrt(f)/c,v=m*p/d,y=g*p/f,b=m*l+g*h,_=m*u+g*a,E=h*(g+v),x=a*(g+v),T=l*(m+y),w=u*(m+y);return{cx:b+t,cy:_+e,radius:i,startAngle:Math.atan2(x-_,E-b),endAngle:Math.atan2(w-_,T-b),anticlockwise:h*u>l*a}},t.arc=function(t,e,r,n,i,o,s,a,h){for(var u=s-o,l=Ks._segmentsCount(Math.abs(u)*i,40*Math.ceil(Math.abs(u)/Fe)),c=u/(2*l),d=2*c,f=Math.cos(c),p=Math.sin(c),m=l-1,g=m%1/m,v=0;v<=m;++v){var y=c+o+d*(v+g*v),b=Math.cos(y),_=-Math.sin(y);h.push((f*b+p*_)*i+r,(f*-_+p*b)*i+n)}},t}(),la=function(){function t(){}return t.curveLength=function(t,e,r,n,i,o,s,a){for(var h=0,u=0,l=0,c=0,d=0,f=0,p=0,m=0,g=0,v=0,y=0,b=t,_=e,E=1;E<=10;++E)v=b-(m=(p=(f=(d=1-(u=E/10))*d)*d)*t+3*f*u*r+3*d*(l=u*u)*i+(c=l*u)*s),y=_-(g=p*e+3*f*u*n+3*d*l*o+c*a),b=m,_=g,h+=Math.sqrt(v*v+y*y);return h},t.curveTo=function(e,r,n,i,o,s,a){var h=a[a.length-2],u=a[a.length-1];a.length-=2;var l=Ks._segmentsCount(t.curveLength(h,u,e,r,n,i,o,s)),c=0,d=0,f=0,p=0,m=0;a.push(h,u);for(var g=1,v=0;g<=l;++g)f=(d=(c=1-(v=g/l))*c)*c,m=(p=v*v)*v,a.push(f*h+3*d*v*e+3*c*p*n+m*o,f*u+3*d*v*r+3*c*p*i+m*s)},t}(),ca=function(){function t(){}return t.curveLength=function(t,e,r,n,i,o){var s=t-2*r+i,a=e-2*n+o,h=2*r-2*t,u=2*n-2*e,l=4*(s*s+a*a),c=4*(s*h+a*u),d=h*h+u*u,f=2*Math.sqrt(l+c+d),p=Math.sqrt(l),m=2*l*p,g=2*Math.sqrt(d),v=c/p;return(m*f+p*c*(f-g)+(4*d*l-c*c)*Math.log((2*p+v+f)/(v+g)))/(4*m)},t.curveTo=function(e,r,n,i,o){for(var s=o[o.length-2],a=o[o.length-1],h=Ks._segmentsCount(t.curveLength(s,a,e,r,n,i)),u=0,l=0,c=1;c<=h;++c){var d=c/h;u=s+(e-s)*d,l=a+(r-a)*d,o.push(u+(e+(n-e)*d-u)*d,l+(r+(i-r)*d-l)*d)}},t}(),da=function(){function t(){this.reset()}return t.prototype.begin=function(t,e,r){this.reset(),this.style=t,this.start=e,this.attribStart=r},t.prototype.end=function(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start},t.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},t}(),fa=((ha={})[Ce.POLY]=$s,ha[Ce.CIRC]=ta,ha[Ce.ELIP]=ta,ha[Ce.RECT]=ea,ha[Ce.RREC]=ia,ha),pa=[],ma=[];function ga(t){for(var e=t.points,r=0,n=0;n<e.length-2;n+=2)r+=(e[n+2]-e[n])*(e[n+3]+e[n+1]);return r>0}var va,ya,ba=function(){function t(t,e,r,n){void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),this.points=[],this.holes=[],this.shape=t,this.lineStyle=r,this.fillStyle=e,this.matrix=n,this.type=t.type}return t.prototype.clone=function(){return new t(this.shape,this.fillStyle,this.lineStyle,this.matrix)},t.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null},t}(),_a=new We,Ea=new Ei,xa=function(t){function e(){var e=t.call(this)||this;return e.closePointEps=1e-4,e.boundsPadding=0,e.uvsFloat32=null,e.indicesUint16=null,e.batchable=!1,e.points=[],e.colors=[],e.uvs=[],e.indices=[],e.textureIds=[],e.graphicsData=[],e.drawCalls=[],e.batchDirty=-1,e.batches=[],e.dirty=0,e.cacheDirty=-1,e.clearDirty=0,e.shapeIndex=0,e._bounds=new Ei,e.boundsDirty=-1,e}return Qs(e,t),Object.defineProperty(e.prototype,"bounds",{get:function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},enumerable:!1,configurable:!0}),e.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),ma.push(this.drawCalls[t]);this.drawCalls.length=0;for(t=0;t<this.batches.length;t++){var e=this.batches[t];e.reset(),pa.push(e)}this.batches.length=0},e.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},e.prototype.drawShape=function(t,e,r,n){void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null);var i=new ba(t,e,r,n);return this.graphicsData.push(i),this.dirty++,this},e.prototype.drawHole=function(t,e){if(void 0===e&&(e=null),!this.graphicsData.length)return null;var r=new ba(t,null,null,e),n=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=n.lineStyle,n.holes.push(r),this.dirty++,this},e.prototype.destroy=function(){t.prototype.destroy.call(this);for(var e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},e.prototype.containsPoint=function(t){for(var e=this.graphicsData,r=0;r<e.length;++r){var n=e[r];if(n.fillStyle.visible&&(n.shape&&(n.matrix?n.matrix.applyInverse(t,_a):_a.copyFrom(t),n.shape.contains(_a.x,_a.y)))){var i=!1;if(n.holes)for(var o=0;o<n.holes.length;o++){if(n.holes[o].shape.contains(_a.x,_a.y)){i=!0;break}}if(!i)return!0}}return!1},e.prototype.updateBatches=function(t){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var e=this.uvs,r=this.graphicsData,n=null,i=null;this.batches.length>0&&(i=(n=this.batches[this.batches.length-1]).style);for(var o=this.shapeIndex;o<r.length;o++){this.shapeIndex++;var s=r[o],a=s.fillStyle,h=s.lineStyle;fa[s.type].build(s),s.matrix&&this.transformPoints(s.points,s.matrix);for(var u=0;u<2;u++){var l=0===u?a:h;if(l.visible){var d=l.texture.baseTexture,f=this.indices.length,p=this.points.length/2;d.wrapMode=c.REPEAT,0===u?this.processFill(s):this.processLine(s);var m=this.points.length/2-p;0!==m&&(n&&!this._compareStyles(i,l)&&(n.end(f,p),n=null),n||((n=pa.pop()||new da).begin(l,f,p),this.batches.push(n),i=l),this.addUvs(this.points,e,l.texture,p,m,l.matrix))}}}var g=this.indices.length,v=this.points.length/2;if(n&&n.end(g,v),0!==this.batches.length){if(this.indicesUint16&&this.indices.length===this.indicesUint16.length)this.indicesUint16.set(this.indices);else{var y=v>65535&&t;this.indicesUint16=y?new Uint32Array(this.indices):new Uint16Array(this.indices)}this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}else this.batchable=!0}}else this.batchable=!0},e.prototype._compareStyles=function(t,e){return!(!t||!e)&&(t.texture.baseTexture===e.texture.baseTexture&&(t.color+t.alpha===e.color+e.alpha&&!!t.native==!!e.native))},e.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var t=0,e=this.graphicsData.length;t<e;t++){var r=this.graphicsData[t],n=r.fillStyle,i=r.lineStyle;if(n&&!n.texture.baseTexture.valid)return!1;if(i&&!i.texture.baseTexture.valid)return!1}return!0},e.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var t=this.batches,e=0,r=t.length;e<r;e++)for(var n=t[e],i=0;i<n.size;i++){var o=n.start+i;this.indicesUint16[o]=this.indicesUint16[o]-n.attribStart}},e.prototype.isBatchable=function(){if(this.points.length>131070)return!1;for(var t=this.batches,r=0;r<t.length;r++)if(t[r].style.native)return!1;return this.points.length<2*e.BATCHABLE_SIZE},e.prototype.buildDrawCalls=function(){for(var t=++dr._globalBatch,e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),ma.push(this.drawCalls[e]);this.drawCalls.length=0;var r=this.colors,n=this.textureIds,i=ma.pop();i||((i=new ai).texArray=new hi),i.texArray.count=0,i.start=0,i.size=0,i.type=o.TRIANGLES;var s=0,a=null,h=0,u=!1,l=o.TRIANGLES,d=0;this.drawCalls.push(i);for(e=0;e<this.batches.length;e++){var f=this.batches[e],p=f.style,m=p.texture.baseTexture;u!==!!p.native&&(l=(u=!!p.native)?o.LINES:o.TRIANGLES,a=null,s=8,t++),a!==m&&(a=m,m._batchEnabled!==t&&(8===s&&(t++,s=0,i.size>0&&((i=ma.pop())||((i=new ai).texArray=new hi),this.drawCalls.push(i)),i.start=d,i.size=0,i.texArray.count=0,i.type=l),m.touched=1,m._batchEnabled=t,m._batchLocation=s,m.wrapMode=c.REPEAT,i.texArray.elements[i.texArray.count++]=m,s++)),i.size+=f.size,d+=f.size,h=m._batchLocation,this.addColors(r,p.color,p.alpha,f.attribSize,f.attribStart),this.addTextureIds(n,h,f.attribSize,f.attribStart)}dr._globalBatch=t,this.packAttributes()},e.prototype.packAttributes=function(){for(var t=this.points,e=this.uvs,r=this.colors,n=this.textureIds,i=new ArrayBuffer(3*t.length*4),o=new Float32Array(i),s=new Uint32Array(i),a=0,h=0;h<t.length/2;h++)o[a++]=t[2*h],o[a++]=t[2*h+1],o[a++]=e[2*h],o[a++]=e[2*h+1],s[a++]=r[h],o[a++]=n[h];this._buffer.update(i),this._indexBuffer.update(this.indicesUint16)},e.prototype.processFill=function(t){t.holes.length?(this.processHoles(t.holes),$s.triangulate(t,this)):fa[t.type].triangulate(t,this)},e.prototype.processLine=function(t){aa(t,this);for(var e=0;e<t.holes.length;e++)aa(t.holes[e],this)},e.prototype.processHoles=function(t){for(var e=0;e<t.length;e++){var r=t[e];fa[r.type].build(r),r.matrix&&this.transformPoints(r.points,r.matrix)}},e.prototype.calculateBounds=function(){var t=this._bounds,e=Ea,r=qe.IDENTITY;this._bounds.clear(),e.clear();for(var n=0;n<this.graphicsData.length;n++){var i=this.graphicsData[n],o=i.shape,s=i.type,a=i.lineStyle,h=i.matrix||qe.IDENTITY,u=0;if(a&&a.visible){var l=a.alignment;u=a.width,s===Ce.POLY?ga(o)?u*=1-l:u*=l:u*=Math.max(0,l)}if(r!==h&&(e.isEmpty()||(t.addBoundsMatrix(e,r),e.clear()),r=h),s===Ce.RECT||s===Ce.RREC){var c=o;e.addFramePad(c.x,c.y,c.x+c.width,c.y+c.height,u,u)}else if(s===Ce.CIRC){var d=o;e.addFramePad(d.x,d.y,d.x,d.y,d.radius+u,d.radius+u)}else if(s===Ce.ELIP){var f=o;e.addFramePad(f.x,f.y,f.x,f.y,f.width+u,f.height+u)}else{var p=o;t.addVerticesMatrix(r,p.points,0,p.points.length,u,u)}}e.isEmpty()||t.addBoundsMatrix(e,r),t.pad(this.boundsPadding,this.boundsPadding)},e.prototype.transformPoints=function(t,e){for(var r=0;r<t.length/2;r++){var n=t[2*r],i=t[2*r+1];t[2*r]=e.a*n+e.c*i+e.tx,t[2*r+1]=e.b*n+e.d*i+e.ty}},e.prototype.addColors=function(t,e,r,n,i){void 0===i&&(i=0);var o=me((e>>16)+(65280&e)+((255&e)<<16),r);t.length=Math.max(t.length,i+n);for(var s=0;s<n;s++)t[i+s]=o},e.prototype.addTextureIds=function(t,e,r,n){void 0===n&&(n=0),t.length=Math.max(t.length,n+r);for(var i=0;i<r;i++)t[n+i]=e},e.prototype.addUvs=function(t,e,r,n,i,o){void 0===o&&(o=null);for(var s=0,a=e.length,h=r.frame;s<i;){var u=t[2*(n+s)],l=t[2*(n+s)+1];if(o){var c=o.a*u+o.c*l+o.tx;l=o.b*u+o.d*l+o.ty,u=c}s++,e.push(u/h.width,l/h.height)}var d=r.baseTexture;(h.width<d.width||h.height<d.height)&&this.adjustUvs(e,r,a,i)},e.prototype.adjustUvs=function(t,e,r,n){for(var i=e.baseTexture,o=1e-6,s=r+2*n,a=e.frame,h=a.width/i.width,u=a.height/i.height,l=a.x/a.width,c=a.y/a.height,d=Math.floor(t[r]+o),f=Math.floor(t[r+1]+o),p=r+2;p<s;p+=2)d=Math.min(d,Math.floor(t[p]+o)),f=Math.min(f,Math.floor(t[p+1]+o));l-=d,c-=f;for(p=r;p<s;p+=2)t[p]=(t[p]+l)*h,t[p+1]=(t[p+1]+c)*u},e.BATCHABLE_SIZE=100,e}(di),Ta=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.width=0,e.alignment=.5,e.native=!1,e.cap=Ys.BUTT,e.join=Ws.MITER,e.miterLimit=10,e}return Qs(e,t),e.prototype.clone=function(){var t=new e;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t},e.prototype.reset=function(){t.prototype.reset.call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1},e}(Zs),wa=new Float32Array(3),Aa={},Sa=function(t){function e(e){void 0===e&&(e=null);var r=t.call(this)||this;return r.shader=null,r.pluginName="batch",r.currentPath=null,r.batches=[],r.batchTint=-1,r.batchDirty=-1,r.vertexData=null,r._fillStyle=new Zs,r._lineStyle=new Ta,r._matrix=null,r._holeMode=!1,r.state=Rn.for2d(),r._geometry=e||new xa,r._geometry.refCount++,r._transformID=-1,r.tint=16777215,r.blendMode=i.NORMAL,r}return Qs(e,t),Object.defineProperty(e.prototype,"geometry",{get:function(){return this._geometry},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return this.finishPoly(),new e(this._geometry)},Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fill",{get:function(){return this._fillStyle},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"line",{get:function(){return this._lineStyle},enumerable:!1,configurable:!0}),e.prototype.lineStyle=function(t,e,r,n,i){return void 0===t&&(t=null),void 0===e&&(e=0),void 0===r&&(r=1),void 0===n&&(n=.5),void 0===i&&(i=!1),"number"==typeof t&&(t={width:t,color:e,alpha:r,alignment:n,native:i}),this.lineTextureStyle(t)},e.prototype.lineTextureStyle=function(t){t=Object.assign({width:0,texture:Ir.WHITE,color:t&&t.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:Ys.BUTT,join:Ws.MITER,miterLimit:10},t),this.currentPath&&this.startPoly();var e=t.width>0&&t.alpha>0;return e?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:e},t)):this._lineStyle.reset(),this},e.prototype.startPoly=function(){if(this.currentPath){var t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new ze,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new ze,this.currentPath.closeStroke=!1},e.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},e.prototype.moveTo=function(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this},e.prototype.lineTo=function(t,e){this.currentPath||this.moveTo(0,0);var r=this.currentPath.points,n=r[r.length-2],i=r[r.length-1];return n===t&&i===e||r.push(t,e),this},e.prototype._initCurve=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e)},e.prototype.quadraticCurveTo=function(t,e,r,n){this._initCurve();var i=this.currentPath.points;return 0===i.length&&this.moveTo(0,0),ca.curveTo(t,e,r,n,i),this},e.prototype.bezierCurveTo=function(t,e,r,n,i,o){return this._initCurve(),la.curveTo(t,e,r,n,i,o,this.currentPath.points),this},e.prototype.arcTo=function(t,e,r,n,i){this._initCurve(t,e);var o=this.currentPath.points,s=ua.curveTo(t,e,r,n,i,o);if(s){var a=s.cx,h=s.cy,u=s.radius,l=s.startAngle,c=s.endAngle,d=s.anticlockwise;this.arc(a,h,u,l,c,d)}return this},e.prototype.arc=function(t,e,r,n,i,o){if(void 0===o&&(o=!1),n===i)return this;if(!o&&i<=n?i+=Fe:o&&n<=i&&(n+=Fe),0===i-n)return this;var s=t+Math.cos(n)*r,a=e+Math.sin(n)*r,h=this._geometry.closePointEps,u=this.currentPath?this.currentPath.points:null;if(u){var l=Math.abs(u[u.length-2]-s),c=Math.abs(u[u.length-1]-a);l<h&&c<h||u.push(s,a)}else this.moveTo(s,a),u=this.currentPath.points;return ua.arc(s,a,t,e,r,n,i,o,u),this},e.prototype.beginFill=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),this.beginTextureFill({texture:Ir.WHITE,color:t,alpha:e})},e.prototype.beginTextureFill=function(t){t=Object.assign({texture:Ir.WHITE,color:16777215,alpha:1,matrix:null},t),this.currentPath&&this.startPoly();var e=t.alpha>0;return e?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:e},t)):this._fillStyle.reset(),this},e.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},e.prototype.drawRect=function(t,e,r,n){return this.drawShape(new je(t,e,r,n))},e.prototype.drawRoundedRect=function(t,e,r,n,i){return this.drawShape(new Ve(t,e,r,n,i))},e.prototype.drawCircle=function(t,e,r){return this.drawShape(new He(t,e,r))},e.prototype.drawEllipse=function(t,e,r,n){return this.drawShape(new Xe(t,e,r,n))},e.prototype.drawPolygon=function(){for(var t,e=arguments,r=[],n=0;n<arguments.length;n++)r[n]=e[n];var i=!0,o=r[0];o.points?(i=o.closeStroke,t=o.points):t=Array.isArray(r[0])?r[0]:r;var s=new ze(t);return s.closeStroke=i,this.drawShape(s),this},e.prototype.drawShape=function(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},e.prototype.clear=function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this},e.prototype.isFastRect=function(){var t=this._geometry.graphicsData;return!(1!==t.length||t[0].shape.type!==Ce.RECT||t[0].holes.length||t[0].lineStyle.visible&&t[0].lineStyle.width)},e.prototype._render=function(t){this.finishPoly();var e=this._geometry,r=t.context.supports.uint32Indices;e.updateBatches(r),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))},e.prototype._populateBatches=function(){var t=this._geometry,e=this.blendMode,r=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=r,this.vertexData=new Float32Array(t.points);for(var n=0;n<r;n++){var i=t.batches[n],o=i.style.color,s=new Float32Array(this.vertexData.buffer,4*i.attribStart*2,2*i.attribSize),a=new Float32Array(t.uvsFloat32.buffer,4*i.attribStart*2,2*i.attribSize),h={vertexData:s,blendMode:e,indices:new Uint16Array(t.indicesUint16.buffer,2*i.start,i.size),uvs:a,_batchRGB:ce(o),_tintRGB:o,_texture:i.style.texture,alpha:i.style.alpha,worldAlpha:1};this.batches[n]=h}},e.prototype._renderBatched=function(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var e=0,r=this.batches.length;e<r;e++){var n=this.batches[e];n.worldAlpha=this.worldAlpha*n.alpha,t.plugins[this.pluginName].render(n)}}},e.prototype._renderDirect=function(t){var e=this._resolveDirectShader(t),r=this._geometry,n=this.tint,i=this.worldAlpha,o=e.uniforms,s=r.drawCalls;o.translationMatrix=this.transform.worldTransform,o.tint[0]=(n>>16&255)/255*i,o.tint[1]=(n>>8&255)/255*i,o.tint[2]=(255&n)/255*i,o.tint[3]=i,t.shader.bind(e),t.geometry.bind(r,e),t.state.set(this.state);for(var a=0,h=s.length;a<h;a++)this._renderDrawCallDirect(t,r.drawCalls[a])},e.prototype._renderDrawCallDirect=function(t,e){for(var r=e.texArray,n=e.type,i=e.size,o=e.start,s=r.count,a=0;a<s;a++)t.texture.bind(r.elements[a],a);t.geometry.draw(n,i,o)},e.prototype._resolveDirectShader=function(t){var e=this.shader,r=this.pluginName;if(!e){if(!Aa[r]){for(var n=t.plugins.batch.MAX_TEXTURES,i=new Int32Array(n),o=0;o<n;o++)i[o]=o;var s={tint:new Float32Array([1,1,1,1]),translationMatrix:new qe,default:Xr.from({uSamplers:i},!0)},a=t.plugins[r]._shader.program;Aa[r]=new In(a,s)}e=Aa[r]}return e},e.prototype._calculateBounds=function(){this.finishPoly();var t=this._geometry;if(t.graphicsData.length){var e=t.bounds,r=e.minX,n=e.minY,i=e.maxX,o=e.maxY;this._bounds.addFrame(this.transform,r,n,i,o)}},e.prototype.containsPoint=function(t){return this.worldTransform.applyInverse(t,e._TEMP_POINT),this._geometry.containsPoint(e._TEMP_POINT)},e.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var t=ce(this.tint,wa),e=0;e<this.batches.length;e++){var r=this.batches[e],n=r._batchRGB,i=(t[0]*n[0]*255<<16)+(t[1]*n[1]*255<<8)+(0|t[2]*n[2]*255);r._tintRGB=(i>>16)+(65280&i)+((255&i)<<16)}}},e.prototype.calculateVertices=function(){var t=this.transform._worldID;if(this._transformID!==t){this._transformID=t;for(var e=this.transform.worldTransform,r=e.a,n=e.b,i=e.c,o=e.d,s=e.tx,a=e.ty,h=this._geometry.points,u=this.vertexData,l=0,c=0;c<h.length;c+=2){var d=h[c],f=h[c+1];u[l++]=r*d+i*f+s,u[l++]=o*f+n*d+a}}},e.prototype.closePath=function(){var t=this.currentPath;return t&&(t.closeStroke=!0,this.finishPoly()),this},e.prototype.setMatrix=function(t){return this._matrix=t,this},e.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},e.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},e.prototype.destroy=function(e){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,t.prototype.destroy.call(this,e)},e._TEMP_POINT=new We,e}(Oi),Oa={buildPoly:$s,buildCircle:ta,buildRectangle:ea,buildRoundedRectangle:ia,buildLine:aa,ArcUtils:ua,BezierUtils:la,QuadraticUtils:ca,BatchPart:da,FILL_COMMANDS:fa,BATCH_POOL:pa,DRAW_CALL_POOL:ma};function Ia(t,e,r=.001){return this===e||Math.abs(t.a-e.a)<r&&Math.abs(t.b-e.b)<r&&Math.abs(t.c-e.c)<r&&Math.abs(t.d-e.d)<r&&Math.abs(t.tx-e.tx)<r&&Math.abs(t.ty-e.ty)<r}class Ra{constructor(){this.textureIds=[],this.matrices=[],this.lines=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.textureIds[t]=null,this.matrices[t]=null;this.count=0}add(t,e,r,n,i,o){const{textureIds:s,matrices:a,lines:h,count:u}=this;t=4*t+i;for(let i=0;i<u;i++)if(h[2*i]===r&&h[2*i+1]===n&&s[i]===t&&Ia(a[i],e))return i;return u>=o.maxStyles?-1:(s[u]=t,a[u]=e,h[2*u]=r,h[2*u+1]=n,this.count++,u)}}class Na{constructor(){this.texArray=new hi,this.styleArray=new Ra,this.shader=null,this.blend=i.NORMAL,this.start=0,this.size=0,this.TICK=0,this.settings=null,this.data=null}clear(){this.texArray.clear(),this.styleArray.clear(),this.settings=null,this.data=null,this.shader=null}begin(t,e){this.TICK=++dr._globalBatch,this.settings=t,this.shader=e,this.start=0,this.size=0,this.data=null,e&&e.settings&&(this.settings=e.settings)}check(t){return 0===this.size?(this.shader=t,!0):this.shader===t}add(t,e,r,n,i){const{texArray:o,TICK:s,styleArray:a,settings:h}=this,{baseTexture:u}=t;if(u._batchEnabled!==s&&o.count===h.maxTextures)return-1;const l=u._batchEnabled!==s?o.count:u._batchLocation,c=a.add(l,e||qe.IDENTITY,r,n,i,h);return c>=0&&u._batchEnabled!==s&&(u._batchEnabled=s,u._batchLocation=o.count,o.elements[o.count++]=u),c}}class La{constructor(){this.reset()}begin(t,e,r){this.reset(),this.style=t,this.start=e,this.attribStart=r,this.jointEnd=0}end(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0,this.styleId=-1,this.rgba=0,this.jointEnd=0}}class Ma{constructor(){this.reset()}toJSON(){return this.copyTo({})}clone(){return this.copyTo(new Ma)}copyTo(t){return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.shader=this.shader,t.visible=this.visible,t.smooth=this.smooth,t.matrixTex=null,t}packLineScale(){return 0}reset(){this.color=16777215,this.alpha=1,this.texture=Ir.WHITE,this.matrix=null,this.shader=null,this.visible=!1,this.smooth=!1,this.matrixTex=null}destroy(){this.texture=null,this.matrix=null,this.matrixTex=null}getTextureMatrix(){const t=this.texture;return this.matrix?t.frame.width===t.baseTexture.width&&t.frame.height===t.baseTexture.height?this.matrix:(this.matrixTex?this.matrixTex.copyFrom(this.matrix):this.matrixTex=this.matrix.clone(),this.matrixTex.translate(Number(t.frame.x),Number(t.frame.y)),this.matrixTex):null}}!function(t){t.NONE="none";t.NORMAL="normal";t.HORIZONTAL="horizontal";t.VERTICAL="vertical"}(va||(va={}));class Pa extends Ma{clone(){return this.copyTo(new Pa)}copyTo(t){return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.shader=this.shader,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t.scaleMode=this.scaleMode,t}packLineScale(){switch(this.scaleMode){case va.NORMAL:return 1;case va.HORIZONTAL:return 2;case va.VERTICAL:return 3;default:return 0}}reset(){super.reset(),this.smooth=!0,this.color=0,this.width=0,this.alignment=.5,this.cap=Ys.BUTT,this.join=Ws.MITER,this.miterLimit=10,this.scaleMode=va.NORMAL}}class Ca{constructor(){Ca.prototype.__init.call(this),Ca.prototype.__init2.call(this),Ca.prototype.__init3.call(this),Ca.prototype.__init4.call(this),Ca.prototype.__init5.call(this)}__init(){this.verts=[]}__init2(){this.joints=[]}__init3(){this.vertexSize=0}__init4(){this.indexSize=0}__init5(){this.closePointEps=1e-4}clear(){this.verts.length=0,this.joints.length=0,this.vertexSize=0,this.indexSize=0}destroy(){this.verts.length=0,this.joints.length=0}}!function(t){t[t.NONE=0]="NONE";t[t.FILL=1]="FILL";t[t.JOINT_BEVEL=4]="JOINT_BEVEL";t[t.JOINT_MITER=8]="JOINT_MITER";t[t.JOINT_ROUND=12]="JOINT_ROUND";t[t.JOINT_CAP_BUTT=16]="JOINT_CAP_BUTT";t[t.JOINT_CAP_SQUARE=18]="JOINT_CAP_SQUARE";t[t.JOINT_CAP_ROUND=20]="JOINT_CAP_ROUND";t[t.FILL_EXPAND=24]="FILL_EXPAND";t[t.CAP_BUTT=32]="CAP_BUTT";t[t.CAP_SQUARE=64]="CAP_SQUARE";t[t.CAP_ROUND=96]="CAP_ROUND";t[t.CAP_BUTT2=128]="CAP_BUTT2"}(ya||(ya={}));class Da{constructor(){Da.prototype.__init.call(this),Da.prototype.__init2.call(this),Da.prototype.__init3.call(this)}static __initStatic(){this.vertsByJoint=[]}__init(){this.strideFloats=12}updateBufferSize(t,e,r,n){const{joints:i}=n;let o=!1,s=0,a=0;for(let r=t;r<t+e;r++){const t=-32&i[r],e=31&i[r];if(e===ya.FILL){o=!0,s++;continue}if(e>=ya.FILL_EXPAND){s+=3,a+=3;continue}const n=Da.vertsByJoint[e]+Da.vertsByJoint[t];n>=4&&(s+=n,a+=6+3*Math.max(n-6,0))}o&&(a+=r),n.vertexSize+=s,n.indexSize+=a}__init2(){this.bufferPos=0}__init3(){this.indexPos=0}beginPack(t,e,r,n,i=0,o=0){this.buildData=t,this.bufFloat=e,this.bufUint=r,this.indices=n,this.bufferPos=i,this.indexPos=o}endPack(){this.buildData=null,this.bufFloat=null,this.bufUint=null,this.indices=null}packInterleavedGeometry(t,e,r,n,i){const{bufFloat:o,bufUint:s,indices:a,buildData:h,strideFloats:u}=this,{joints:l,verts:c}=h;let d,f,p,m,g,v,y,b,_=this.bufferPos,E=this.indexPos,x=this.bufferPos/this.strideFloats,T=!1,w=0;for(let r=t;r<t+e;r++){const t=l[r],e=-32&l[r],h=31&l[r];if(h===ya.FILL){T=!0,d=c[2*r],f=c[2*r+1],o[_]=d,o[_+1]=f,o[_+2]=d,o[_+3]=f,o[_+4]=d,o[_+5]=f,o[_+6]=d,o[_+7]=f,o[_+8]=w,o[_+9]=16*h,o[_+10]=n,s[_+11]=i,_+=u;continue}if(h>=ya.FILL_EXPAND){g=c[2*r],v=c[2*r+1],d=c[2*r+2],f=c[2*r+3],p=c[2*r+4],m=c[2*r+5];const e=r+3;for(let r=0;r<3;r++)o[_]=g,o[_+1]=v,o[_+2]=d,o[_+3]=f,o[_+4]=p,o[_+5]=m,o[_+6]=c[2*(e+r)],o[_+7]=c[2*(e+r)+1],o[_+8]=w,o[_+9]=16*t+r,o[_+10]=n,s[_+11]=i,_+=u;a[E]=x,a[E+1]=x+1,a[E+2]=x+2,E+=3,x+=3;continue}const A=Da.vertsByJoint[h]+Da.vertsByJoint[e];if(0===A)continue;d=c[2*r],f=c[2*r+1],p=c[2*r+2],m=c[2*r+3],g=c[2*r-2],v=c[2*r-1];const S=Math.sqrt((p-d)*(p-d)+(m-f)*(m-f));0===Da.vertsByJoint[h]&&(w-=S),(-3&h)!==ya.JOINT_CAP_BUTT?(y=c[2*r+4],b=c[2*r+5]):(y=d,b=f);for(let e=0;e<A;e++)o[_]=g,o[_+1]=v,o[_+2]=d,o[_+3]=f,o[_+4]=p,o[_+5]=m,o[_+6]=y,o[_+7]=b,o[_+8]=w,o[_+9]=16*t+e,o[_+10]=n,s[_+11]=i,_+=u;w+=S,a[E]=x,a[E+1]=x+1,a[E+2]=x+2,a[E+3]=x,a[E+4]=x+2,a[E+5]=x+3,E+=6;for(let t=5;t+1<A;t++)a[E]=x+4,a[E+1]=x+t,a[E+2]=x+t+1,E+=3;x+=A}if(T){for(let t=0;t<r.length;t++)a[E+t]=r[t]+x;E+=r.length}this.bufferPos=_,this.indexPos=E}}Da.__initStatic();const Ua=Da.vertsByJoint;for(let t=0;t<256;t++)Ua.push(0);Ua[ya.FILL]=1;for(let t=0;t<8;t++)Ua[ya.FILL_EXPAND+t]=3;Ua[ya.JOINT_BEVEL]=9,Ua[ya.JOINT_BEVEL+1]=9,Ua[ya.JOINT_BEVEL+2]=9,Ua[ya.JOINT_BEVEL+3]=9,Ua[ya.JOINT_ROUND]=9,Ua[ya.JOINT_ROUND+1]=9,Ua[ya.JOINT_ROUND+2]=9,Ua[ya.JOINT_ROUND+3]=9,Ua[ya.JOINT_MITER]=9,Ua[ya.JOINT_MITER+1]=9,Ua[ya.JOINT_MITER+2]=4,Ua[ya.JOINT_MITER+3]=4,Ua[ya.JOINT_CAP_BUTT]=4,Ua[ya.JOINT_CAP_BUTT+1]=4,Ua[ya.JOINT_CAP_SQUARE]=4,Ua[ya.JOINT_CAP_SQUARE+1]=4,Ua[ya.JOINT_CAP_ROUND]=9,Ua[ya.JOINT_CAP_ROUND+1]=9,Ua[ya.CAP_ROUND]=4;class Ba{constructor(t,e=null,r=null,n=null){this.shape=t,this.lineStyle=r,this.fillStyle=e,this.matrix=n,this.type=t.type,this.points=[],this.holes=[],this.triangles=[],this.closeStroke=!1,this.clearBuild()}clearPath(){this.points.length=0,this.closeStroke=!0}clearBuild(){this.triangles.length=0,this.fillStart=0,this.fillLen=0,this.strokeStart=0,this.strokeLen=0,this.fillAA=!1}clone(){return new Ba(this.shape,this.fillStyle,this.lineStyle,this.matrix)}capType(){let t;switch(this.lineStyle.cap){case Ys.SQUARE:t=ya.CAP_SQUARE;break;case Ys.ROUND:t=ya.CAP_ROUND;break;default:t=ya.CAP_BUTT}return t}goodJointType(){let t;switch(this.lineStyle.join){case Ws.BEVEL:t=ya.JOINT_BEVEL;break;case Ws.ROUND:t=ya.JOINT_ROUND;break;default:t=ya.JOINT_MITER+3}return t}jointType(){let t;switch(this.lineStyle.join){case Ws.BEVEL:t=ya.JOINT_BEVEL;break;case Ws.ROUND:t=ya.JOINT_ROUND;break;default:t=ya.JOINT_MITER}return t}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null,this.triangles=null}}class Fa{path(t,e){const r=t.points;let n,i,o,s,a,h;if(t.type===Ce.CIRC){const e=t.shape;n=e.x,i=e.y,a=h=e.radius,o=s=0}else if(t.type===Ce.ELIP){const e=t.shape;n=e.x,i=e.y,a=e.width,h=e.height,o=s=0}else{const e=t.shape,r=e.width/2,u=e.height/2;n=e.x+r,i=e.y+u,a=h=Math.max(0,Math.min(e.radius,Math.min(r,u))),o=r-a,s=u-h}if(!(a>=0&&h>=0&&o>=0&&s>=0))return void(r.length=0);const u=Math.ceil(2.3*Math.sqrt(a+h)),l=8*u+(o?4:0)+(s?4:0);if(r.length=l,0===l)return;if(0===u)return r.length=8,r[0]=r[6]=n+o,r[1]=r[3]=i+s,r[2]=r[4]=n-o,void(r[5]=r[7]=i-s);let c=0,d=4*u+(o?2:0)+2,f=d,p=l;{const t=o+a,e=s,h=n+t,u=n-t,l=i+e;if(r[c++]=h,r[c++]=l,r[--d]=l,r[--d]=u,s){const t=i-e;r[f++]=u,r[f++]=t,r[--p]=t,r[--p]=h}}for(let t=1;t<u;t++){const e=Math.PI/2*(t/u),l=o+Math.cos(e)*a,m=s+Math.sin(e)*h,g=n+l,v=n-l,y=i+m,b=i-m;r[c++]=g,r[c++]=y,r[--d]=y,r[--d]=v,r[f++]=v,r[f++]=b,r[--p]=b,r[--p]=g}{const t=s+h,e=n+o,a=n-o,u=i+t,l=i-t;r[c++]=e,r[c++]=u,r[--p]=l,r[--p]=e,o&&(r[c++]=a,r[c++]=u,r[--p]=l,r[--p]=a)}}fill(t,e){const{verts:r,joints:n}=e,{points:i,triangles:o}=t;if(0===i.length)return;let s,a;if(t.type!==Ce.RREC){const e=t.shape;s=e.x,a=e.y}else{const e=t.shape;s=e.x+e.width/2,a=e.y+e.height/2}const h=t.matrix,u=h?h.a*s+h.c*a+h.tx:s,l=h?h.b*s+h.d*a+h.ty:a;let c=1;if(!t.fillAA){r.push(u,l),n.push(ya.FILL),r.push(i[0],i[1]),n.push(ya.FILL);for(let t=2;t<i.length;t+=2)r.push(i[t],i[t+1]),n.push(ya.FILL),o.push(c++,0,c);return void o.push(1,0,c)}const d=i.length;let f=i[d-2],p=i[d-1],m=p-i[d-3],g=i[d-4]-f;const v=Math.sqrt(m*m+g*g);let y,b;m/=v,g/=v;for(let t=0;t<d;t+=2){const e=i[t],o=i[t+1];let s=o-p,a=f-e;const h=Math.sqrt(s*s+a*a);s/=h,a/=h;let c=m+s,d=g+a;const v=s*c+a*d;c/=v,d/=v,t>0?(r.push(c),r.push(d)):(y=c,b=d),r.push(u),r.push(l),r.push(f),r.push(p),r.push(e),r.push(o),r.push(0),r.push(0),r.push(c),r.push(d),n.push(ya.FILL_EXPAND+2),n.push(ya.NONE),n.push(ya.NONE),n.push(ya.NONE),n.push(ya.NONE),n.push(ya.NONE),f=e,p=o,m=s,g=a}r.push(y),r.push(b)}line(t,e){const{verts:r,joints:n}=e,{points:i}=t,o=8===i.length?t.goodJointType():ya.JOINT_MITER+3,s=i.length;if(0!==s){r.push(i[s-2],i[s-1]),n.push(ya.NONE);for(let t=0;t<s;t+=2)r.push(i[t],i[t+1]),n.push(o);r.push(i[0],i[1]),n.push(ya.NONE),r.push(i[2],i[3]),n.push(ya.NONE)}}}const ka=[];function Ga(t,e=!1){const r=t.length;if(r<6)return;let n=0;for(let e=0,i=t[r-2],o=t[r-1];e<r;e+=2){const r=t[e],s=t[e+1];n+=(r-i)*(s+o),i=r,o=s}if(!e&&n>0||e&&n<=0){const e=r/2;for(let n=e+e%2;n<r;n+=2){const e=r-n-2,i=r-n-1,o=n,s=n+1;[t[e],t[o]]=[t[o],t[e]],[t[i],t[s]]=[t[s],t[i]]}}}class ja{path(t,e){const r=t.shape,n=t.points=r.points.slice(),i=e.closePointEps,o=i*i;if(0===n.length)return;const s=new We(n[0],n[1]),a=new We(n[n.length-2],n[n.length-1]),h=t.closeStroke=r.closeStroke;let u=n.length,l=2;for(let t=2;t<u;t+=2){const e=n[t-2],r=n[t-1],o=n[t],s=n[t+1];let a=!0;Math.abs(e-o)<i&&Math.abs(r-s)<i&&(a=!1),a&&(n[l]=n[t],n[l+1]=n[t+1],l+=2)}n.length=u=l,l=2;for(let t=2;t+2<u;t+=2){let e=n[t-2],r=n[t-1];const i=n[t],s=n[t+1];let a=n[t+2],h=n[t+3];e-=i,r-=s,a-=i,h-=s;let u=!0;Math.abs(a*r-h*e)<o&&e*a+r*h<-o&&(u=!1),u&&(n[l]=n[t],n[l+1]=n[t+1],l+=2)}if(n[l]=n[u-2],n[l+1]=n[u-1],l+=2,n.length=u=l,!(u<=2)&&h){Math.abs(s.x-a.x)<i&&Math.abs(s.y-a.y)<i&&(n.pop(),n.pop())}}line(t,e){const{closeStroke:r,points:n}=t,i=n.length;if(i<=2)return;const{verts:o,joints:s}=e,a=t.jointType(),h=t.capType();let u,l,c=0;r?(u=n[i-2],l=n[i-1],s.push(ya.NONE)):(u=n[2],l=n[3],h===ya.CAP_ROUND?(o.push(n[0],n[1]),s.push(ya.NONE),s.push(ya.CAP_ROUND),c=0):(c=h,s.push(ya.NONE))),o.push(u,l);for(let t=0;t<i;t+=2){const e=n[t],d=n[t+1];let f=a;t+2>=i?r||(f=ya.NONE):t+4>=i&&(r||(h===ya.CAP_ROUND&&(f=ya.JOINT_CAP_ROUND),h===ya.CAP_BUTT&&(f=ya.JOINT_CAP_BUTT),h===ya.CAP_SQUARE&&(f=ya.JOINT_CAP_SQUARE))),f+=c,c=0,o.push(e,d),s.push(f),u=e,l=d}r?(o.push(n[0],n[1]),s.push(ya.NONE),o.push(n[2],n[3]),s.push(ya.NONE)):(o.push(n[i-4],n[i-3]),s.push(ya.NONE))}fill(t,e){let r=t.points;const n=t.holes,i=e.closePointEps,{verts:o,joints:s}=e;if(r.length<6)return;const a=[];let h=r.length;Ga(r,!1);for(let t=0;t<n.length;t++){const e=n[t];Ga(e.points,!0),a.push(r.length/2),r=r.concat(e.points)}const u=ka;u.length<r.length&&(u.length=r.length);let l=0;for(let t=0;t<=a.length;t++){let e=h/2;t>0&&(e=t<a.length?a[t]:r.length>>1),u[2*l]=e-1,u[2*(e-1)+1]=l;for(let t=l;t+1<e;t++)u[2*t+1]=t+1,u[2*t+2]=t;l=e}if(t.triangles=st(r,a,2),!t.triangles)return;if(!t.fillAA){for(let t=0;t<r.length;t+=2)o.push(r[t],r[t+1]),s.push(ya.FILL);return}const{triangles:c}=t;h=r.length;for(let t=0;t<c.length;t+=3){let e=0;for(let r=0;r<3;r++){const n=c[t+r],i=c[t+(r+1)%3];u[2*n]!==i&&u[2*n+1]!==i||(e|=1<<r)}s.push(ya.FILL_EXPAND+e),s.push(ya.NONE),s.push(ya.NONE),s.push(ya.NONE),s.push(ya.NONE),s.push(ya.NONE)}for(let t=0;t<h/2;t++){const e=u[2*t],n=u[2*t+1];let o=r[2*n+1]-r[2*t+1],s=-(r[2*n]-r[2*t]),a=r[2*t+1]-r[2*e+1],h=-(r[2*t]-r[2*e]);const l=Math.sqrt(o*o+s*s);o/=l,s/=l;const c=Math.sqrt(a*a+h*h);a/=c,h/=c;let d=o+a,f=s+h;const p=d*o+f*s;Math.abs(p)<i?(d=o,f=s):(d/=p,f/=p),u[2*t]=d,u[2*t+1]=f}for(let t=0;t<c.length;t+=3){const e=c[t],n=c[t+1],i=c[t+2],s=r[2*i+1]-r[2*n+1],a=-(r[2*i]-r[2*n]),h=r[2*n+1]-r[2*e+1];let l=1;s*-(r[2*n]-r[2*e])-h*a>0&&(l=2);for(let e=0;e<3;e++){const n=c[t+e*l%3];o.push(r[2*n],r[2*n+1])}for(let e=0;e<3;e++){const r=c[t+e*l%3];o.push(u[2*r],u[2*r+1])}}}}class Ha{constructor(){Ha.prototype.__init.call(this)}__init(){this._polyBuilder=new ja}path(t,e){const r=t.shape,n=r.x,i=r.y,o=r.width,s=r.height,a=t.points;a.length=0,a.push(n,i,n+o,i,n+o,i+s,n,i+s)}line(t,e){const{verts:r,joints:n}=e,{points:i}=t,o=t.goodJointType(),s=i.length;r.push(i[s-2],i[s-1]),n.push(ya.NONE);for(let t=0;t<s;t+=2)r.push(i[t],i[t+1]),n.push(o);r.push(i[0],i[1]),n.push(ya.NONE),r.push(i[2],i[3]),n.push(ya.NONE)}fill(t,e){const{verts:r,joints:n}=e,{points:i,triangles:o}=t;if(o.length=0,!t.fillAA)return r.push(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]),n.push(ya.FILL,ya.FILL,ya.FILL,ya.FILL),void o.push(0,1,2,0,2,3);this._polyBuilder.fill(t,e)}}function Xa(t,e,r){return t+(e-t)*r}function za(t,e,r,n,i,o,s=[],a=.001){const h=s;let u=0,l=0,c=0,d=0,f=0,p=0;for(let s=0,m=0;s<=20;++s)m=s/20,u=Xa(t,r,m),l=Xa(e,n,m),c=Xa(r,i,m),d=Xa(n,o,m),f=Xa(u,c,m),p=Xa(l,d,m),0===s&&Math.abs(f-h[h.length-2])<a&&Math.abs(p-h[h.length-1])<a||h.push(f,p);return h}class Va{constructor(){Va.prototype.__init.call(this)}__init(){this._circleBuilder=new Fa}path(t,e){if(Sa.nextRoundedRectBehavior)return void this._circleBuilder.path(t,e);const r=t.shape,{points:n}=t,i=r.x,o=r.y,s=r.width,a=r.height,h=Math.max(0,Math.min(r.radius,Math.min(s,a)/2));if(n.length=0,h){const t=e.closePointEps;za(i,o+h,i,o,i+h,o,n,t),za(i+s-h,o,i+s,o,i+s,o+h,n,t),za(i+s,o+a-h,i+s,o+a,i+s-h,o+a,n,t),za(i+h,o+a,i,o+a,i,o+a-h,n,t),n.length>=4&&Math.abs(n[0]-n[n.length-2])<t&&Math.abs(n[1]-n[n.length-1])<t&&(n.pop(),n.pop())}else n.push(i,o,i+s,o,i+s,o+a,i,o+a)}line(t,e){this._circleBuilder.line(t,e)}fill(t,e){this._circleBuilder.fill(t,e)}}const Wa={[Ce.POLY]:new ja,[Ce.CIRC]:new Fa,[Ce.ELIP]:new Fa,[Ce.RECT]:new Ha,[Ce.RREC]:new Va},Ya=[],qa=[],Ka=new We,Za=new Ei;class Ja extends kr{static __initStatic(){this.BATCHABLE_SIZE=100}__init(){this.indicesUint16=null}get points(){return this.buildData.verts}get closePointEps(){return this.buildData.closePointEps}initAttributes(t){this._buffer=new Cr(null,t,!1),this._bufferFloats=new Float32Array,this._bufferUint=new Uint32Array,this._indexBuffer=new Cr(null,t,!0),this.addAttribute("aPrev",this._buffer,2,!1,h.FLOAT).addAttribute("aPoint1",this._buffer,2,!1,h.FLOAT).addAttribute("aPoint2",this._buffer,2,!1,h.FLOAT).addAttribute("aNext",this._buffer,2,!1,h.FLOAT).addAttribute("aTravel",this._buffer,1,!1,h.FLOAT).addAttribute("aVertexJoint",this._buffer,1,!1,h.FLOAT).addAttribute("aStyleId",this._buffer,1,!1,h.FLOAT).addAttribute("aColor",this._buffer,4,!0,h.UNSIGNED_BYTE).addIndex(this._indexBuffer),this.strideFloats=12}constructor(){super(),Ja.prototype.__init.call(this),this.initAttributes(!1),this.buildData=new Ca,this.graphicsData=[],this.dirty=0,this.batchDirty=-1,this.cacheDirty=-1,this.clearDirty=0,this.drawCalls=[],this.batches=[],this.shapeBuildIndex=0,this.shapeBatchIndex=0,this._bounds=new Ei,this.boundsDirty=-1,this.boundsPadding=0,this.batchable=!1,this.indicesUint16=null,this.packer=null,this.packSize=0,this.pack32index=null}checkInstancing(t,e){this.packer||(this.packer=new Da,this.pack32index=e)}get bounds(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeBuildIndex=0,this.shapeBatchIndex=0,this.packSize=0,this.buildData.clear();for(let t=0;t<this.drawCalls.length;t++)this.drawCalls[t].clear(),qa.push(this.drawCalls[t]);this.drawCalls.length=0;for(let t=0;t<this.batches.length;t++){const e=this.batches[t];e.reset(),Ya.push(e)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(t,e=null,r=null,n=null){const i=new Ba(t,e,r,n);return this.graphicsData.push(i),this.dirty++,this}drawHole(t,e=null){if(!this.graphicsData.length)return null;const r=new Ba(t,null,null,e),n=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=n.lineStyle,n.holes.push(r),this.dirty++,this}destroy(){super.destroy();for(let t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();this.buildData.destroy(),this.buildData=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(t){const e=this.graphicsData;for(let r=0;r<e.length;++r){const n=e[r];if(n.fillStyle.visible&&(n.shape&&(n.matrix?n.matrix.applyInverse(t,Ka):Ka.copyFrom(t),n.shape.contains(Ka.x,Ka.y)))){let t=!1;if(n.holes)for(let e=0;e<n.holes.length;e++){if(n.holes[e].shape.contains(Ka.x,Ka.y)){t=!0;break}}if(!t)return!0}}return!1}updatePoints(){}updateBufferSize(){this._buffer.update(new Float32Array)}updateBuild(){const{graphicsData:t,buildData:e}=this,r=t.length;for(let n=this.shapeBuildIndex;n<r;n++){const r=t[n];r.strokeStart=0,r.strokeLen=0,r.fillStart=0,r.fillLen=0;const{fillStyle:i,lineStyle:o,holes:s}=r;if(!i.visible&&!o.visible)continue;const a=Wa[r.type];if(r.clearPath(),a.path(r,e),r.matrix&&this.transformPoints(r.points,r.matrix),r.clearBuild(),!(r.points.length<=2)&&((i.visible||o.visible)&&this.processHoles(s),i.visible&&(r.fillAA=r.fillStyle.smooth&&r.fillStyle.texture===Ir.WHITE&&0===s.length&&!(r.closeStroke&&r.lineStyle.visible&&!r.lineStyle.shader&&r.lineStyle.alpha>=.99&&r.lineStyle.width*Math.min(r.lineStyle.alignment,1-r.lineStyle.alignment)>=.495),r.fillStart=e.joints.length,s.length?Wa[Ce.POLY].fill(r,e):a.fill(r,e),r.fillLen=e.joints.length-r.fillStart),o.visible)){r.strokeStart=e.joints.length,a.line(r,e);for(let t=0;t<s.length;t++){const r=s[t];Wa[r.type].line(r,e)}r.strokeLen=e.joints.length-r.strokeStart}}this.shapeBuildIndex=r}updateBatches(t){if(!this.graphicsData.length)return void(this.batchable=!0);if(this.updateBuild(),!this.validateBatching())return;const{buildData:e,graphicsData:r}=this,n=r.length;this.cacheDirty=this.dirty;let i=null,o=null;this.batches.length>0&&(i=this.batches[this.batches.length-1],o=i.style);for(let t=this.shapeBatchIndex;t<n;t++){const n=r[t],s=n.fillStyle,a=n.lineStyle;if(n.matrix&&this.transformPoints(n.points,n.matrix),s.visible||a.visible)for(let t=0;t<2;t++){const r=0===t?s:a;if(!r.visible)continue;const h=r.texture.baseTexture,u=e.vertexSize,l=e.indexSize;h.wrapMode=c.REPEAT,0===t?this.packer.updateBufferSize(n.fillStart,n.fillLen,n.triangles.length,e):this.packer.updateBufferSize(n.strokeStart,n.strokeLen,n.triangles.length,e);e.vertexSize!==u&&(i&&!this._compareStyles(o,r)&&(i.end(l,u),i=null),i||(i=Ya.pop()||new La,i.begin(r,l,u),this.batches.push(i),o=r),i.jointEnd=0===t?n.fillStart+n.fillLen:n.strokeStart+n.strokeLen)}}this.shapeBatchIndex=n,i&&i.end(e.indexSize,e.vertexSize),0!==this.batches.length?(this.batchable=this.isBatchable(),this.batchable?this.packBatches():(this.buildDrawCalls(t),this.updatePack())):this.batchable=!0}updatePack(){const{vertexSize:t,indexSize:e}=this.buildData;if(this.packSize===t)return;const{strideFloats:r,packer:n,buildData:i,batches:o}=this,s=this._buffer,a=this._indexBuffer,h=t*r;if(s.data.length!==h){const t=new ArrayBuffer(4*h);this._bufferFloats=new Float32Array(t),this._bufferUint=new Uint32Array(t),s.data=this._bufferFloats}a.data.length!==e&&(t>65535&&this.pack32index?a.data=new Uint32Array(e):a.data=new Uint16Array(e)),n.beginPack(i,this._bufferFloats,this._bufferUint,a.data);let u=0;for(let t=0;t<this.graphicsData.length;t++){const e=this.graphicsData[t];if(e.fillLen){for(;o[u].jointEnd<=e.fillStart;)u++;n.packInterleavedGeometry(e.fillStart,e.fillLen,e.triangles,o[u].styleId,o[u].rgba)}if(e.strokeLen){for(;o[u].jointEnd<=e.strokeStart;)u++;n.packInterleavedGeometry(e.strokeStart,e.strokeLen,e.triangles,o[u].styleId,o[u].rgba)}}s.update(),a.update(),this.packSize=t}_compareStyles(t,e){if(!t||!e)return!1;if(t.texture.baseTexture!==e.texture.baseTexture)return!1;if(t.color+t.alpha!==e.color+e.alpha)return!1;if(t.width!==e.width)return!1;if(t.scaleMode!==e.scaleMode)return!1;if(t.alignment!==e.alignment)return!1;return Ia(t.matrix||qe.IDENTITY,e.matrix||qe.IDENTITY)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let t=0,e=this.graphicsData.length;t<e;t++){const e=this.graphicsData[t],r=e.fillStyle,n=e.lineStyle;if(r&&!r.texture.baseTexture.valid)return!1;if(n&&!n.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++;const t=this.batches;for(let e=0,r=t.length;e<r;e++){const r=t[e];for(let t=0;t<r.size;t++){const e=r.start+t;this.indicesUint16[e]=this.indicesUint16[e]-r.attribStart}}}isBatchable(){return!1}buildDrawCalls(t){for(let t=0;t<this.drawCalls.length;t++)this.drawCalls[t].clear(),qa.push(this.drawCalls[t]);this.drawCalls.length=0;let e=qa.pop()||new Na;e.begin(t,null);let r=0;this.drawCalls.push(e);for(let n=0;n<this.batches.length;n++){const i=this.batches[n],o=i.style;if(0===i.attribSize)continue;let s=-1;const a=o.getTextureMatrix();e.check(o.shader)&&(s=e.add(o.texture,a,o.width,o.alignment||0,o.packLineScale())),s<0&&(e=qa.pop()||new Na,this.drawCalls.push(e),e.begin(t,o.shader),e.start=r,s=e.add(o.texture,a,o.width,o.alignment||0,o.packLineScale())),e.size+=i.size,r+=i.size;const{color:h,alpha:u}=o,l=(h>>16)+(65280&h)+((255&h)<<16);i.rgba=me(l,u),i.styleId=s}}processHoles(t){for(let e=0;e<t.length;e++){const r=t[e],n=Wa[r.type];r.clearPath(),n.path(r,this.buildData),r.matrix&&this.transformPoints(r.points,r.matrix)}}calculateBounds(){const t=this._bounds,e=Za;let r=qe.IDENTITY;this._bounds.clear(),e.clear();for(let n=0;n<this.graphicsData.length;n++){const i=this.graphicsData[n],o=i.shape,s=i.type,a=i.lineStyle,h=i.matrix||qe.IDENTITY;let u=0;if(a&&a.visible&&(u=a.width,s!==Ce.POLY||i.fillStyle.visible?u*=Math.max(0,a.alignment):u*=Math.max(a.alignment,1-a.alignment)),r!==h&&(e.isEmpty()||(t.addBoundsMatrix(e,r),e.clear()),r=h),s===Ce.RECT||s===Ce.RREC){const t=o;e.addFramePad(t.x,t.y,t.x+t.width,t.y+t.height,u,u)}else if(s===Ce.CIRC){const t=o;e.addFramePad(t.x,t.y,t.x,t.y,t.radius+u,t.radius+u)}else if(s===Ce.ELIP){const t=o;e.addFramePad(t.x,t.y,t.x,t.y,t.width+u,t.height+u)}else{const e=o;t.addVerticesMatrix(r,e.points,0,e.points.length,u,u)}}e.isEmpty()||t.addBoundsMatrix(e,r),t.pad(this.boundsPadding,this.boundsPadding)}transformPoints(t,e){for(let r=0;r<t.length/2;r++){const n=t[2*r],i=t[2*r+1];t[2*r]=e.a*n+e.c*i+e.tx,t[2*r+1]=e.b*n+e.d*i+e.ty}}}Ja.__initStatic();const Qa="#version 100\nprecision highp float;\nconst float FILL = 1.0;\nconst float BEVEL = 4.0;\nconst float MITER = 8.0;\nconst float ROUND = 12.0;\nconst float JOINT_CAP_BUTT = 16.0;\nconst float JOINT_CAP_SQUARE = 18.0;\nconst float JOINT_CAP_ROUND = 20.0;\n\nconst float FILL_EXPAND = 24.0;\n\nconst float CAP_BUTT = 1.0;\nconst float CAP_SQUARE = 2.0;\nconst float CAP_ROUND = 3.0;\nconst float CAP_BUTT2 = 4.0;\n\nconst float MITER_LIMIT = 10.0;\n\n// === geom ===\nattribute vec2 aPrev;\nattribute vec2 aPoint1;\nattribute vec2 aPoint2;\nattribute vec2 aNext;\nattribute float aVertexJoint;\nattribute float aTravel;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec4 vLine1;\nvarying vec4 vLine2;\nvarying vec4 vArc;\nvarying float vType;\n\nuniform float resolution;\nuniform float expand;\n\n// === style ===\nattribute float aStyleId;\nattribute vec4 aColor;\n\nvarying float vTextureId;\nvarying vec4 vColor;\nvarying vec2 vTextureCoord;\nvarying vec2 vTravel;\n\nuniform vec2 styleLine[%MAX_STYLES%];\nuniform vec3 styleMatrix[2 * %MAX_STYLES%];\nuniform float styleTextureId[%MAX_STYLES%];\nuniform vec2 samplerSize[%MAX_TEXTURES%];\n\nvec2 doBisect(vec2 norm, float len, vec2 norm2, float len2,\n    float dy, float inner) {\n    vec2 bisect = (norm + norm2) / 2.0;\n    bisect /= dot(norm, bisect);\n    vec2 shift = dy * bisect;\n    if (inner > 0.5) {\n        if (len < len2) {\n            if (abs(dy * (bisect.x * norm.y - bisect.y * norm.x)) > len) {\n                return dy * norm;\n            }\n        } else {\n            if (abs(dy * (bisect.x * norm2.y - bisect.y * norm2.x)) > len2) {\n                return dy * norm;\n            }\n        }\n    }\n    return dy * bisect;\n}\n\nvoid main(void){\n    vec2 pointA = (translationMatrix * vec3(aPoint1, 1.0)).xy;\n    vec2 pointB = (translationMatrix * vec3(aPoint2, 1.0)).xy;\n\n    vec2 xBasis = pointB - pointA;\n    float len = length(xBasis);\n    vec2 forward = xBasis / len;\n    vec2 norm = vec2(forward.y, -forward.x);\n\n    float type = floor(aVertexJoint / 16.0);\n    float vertexNum = aVertexJoint - type * 16.0;\n    float dx = 0.0, dy = 1.0;\n\n    float capType = floor(type / 32.0);\n    type -= capType * 32.0;\n\n    int styleId = int(aStyleId + 0.5);\n    float lineWidth = styleLine[styleId].x;\n    vTextureId = floor(styleTextureId[styleId] / 4.0);\n    float scaleMode = styleTextureId[styleId] - vTextureId * 4.0;\n    float avgScale = 1.0;\n    if (scaleMode > 2.5) {\n        avgScale = length(translationMatrix * vec3(1.0, 0.0, 0.0));\n    } else if (scaleMode > 1.5) {\n        avgScale = length(translationMatrix * vec3(0.0, 1.0, 0.0));\n    } else if (scaleMode > 0.5) {\n        vec2 avgDiag = (translationMatrix * vec3(1.0, 1.0, 0.0)).xy;\n        avgScale = sqrt(dot(avgDiag, avgDiag) * 0.5);\n    }\n    lineWidth *= 0.5 * avgScale;\n    float lineAlignment = 2.0 * styleLine[styleId].y - 1.0;\n    vTextureCoord = vec2(0.0);\n\n    vec2 pos;\n\n    if (capType == CAP_ROUND) {\n        vertexNum += 4.0;\n        type = JOINT_CAP_ROUND;\n        capType = 0.0;\n        lineAlignment = -lineAlignment;\n    }\n\n    vLine1 = vec4(0.0, 10.0, 1.0, 0.0);\n    vLine2 = vec4(0.0, 10.0, 1.0, 0.0);\n    vArc = vec4(0.0);\n    if (type == FILL) {\n        pos = pointA;\n        vType = 0.0;\n        vLine2 = vec4(-2.0, -2.0, -2.0, 0.0);\n        vec2 vTexturePixel;\n        vTexturePixel.x = dot(vec3(aPoint1, 1.0), styleMatrix[styleId * 2]);\n        vTexturePixel.y = dot(vec3(aPoint1, 1.0), styleMatrix[styleId * 2 + 1]);\n        vTextureCoord = vTexturePixel / samplerSize[int(vTextureId)];\n    } else if (type >= FILL_EXPAND && type < FILL_EXPAND + 7.5) {\n        // expand vertices\n        float flags = type - FILL_EXPAND;\n        float flag3 = floor(flags / 4.0);\n        float flag2 = floor((flags - flag3 * 4.0) / 2.0);\n        float flag1 = flags - flag3 * 4.0 - flag2 * 2.0;\n\n        vec2 prev = (translationMatrix * vec3(aPrev, 1.0)).xy;\n\n        if (vertexNum < 0.5) {\n            pos = prev;\n        } else if (vertexNum < 1.5) {\n            pos = pointA;\n        } else {\n            pos = pointB;\n        }\n        float len2 = length(aNext);\n        vec2 bisect = (translationMatrix * vec3(aNext, 0.0)).xy;\n        if (len2 > 0.01) {\n            bisect = normalize(bisect) * len2;\n        }\n\n        vec2 n1 = normalize(vec2(pointA.y - prev.y, -(pointA.x - prev.x)));\n        vec2 n2 = normalize(vec2(pointB.y - pointA.y, -(pointB.x - pointA.x)));\n        vec2 n3 = normalize(vec2(prev.y - pointB.y, -(prev.x - pointB.x)));\n\n        if (n1.x * n2.y - n1.y * n2.x < 0.0) {\n            n1 = -n1;\n            n2 = -n2;\n            n3 = -n3;\n        }\n        pos += bisect * expand;\n\n        vLine1 = vec4(16.0, 16.0, 16.0, -1.0);\n        if (flag1 > 0.5) {\n            vLine1.x = -dot(pos - prev, n1);\n        }\n        if (flag2 > 0.5) {\n            vLine1.y = -dot(pos - pointA, n2);\n        }\n        if (flag3 > 0.5) {\n            vLine1.z = -dot(pos - pointB, n3);\n        }\n        vLine1.xyz *= resolution;\n        vType = 2.0;\n    } else if (type >= BEVEL) {\n        float dy = lineWidth + expand;\n        float shift = lineWidth * lineAlignment;\n        float inner = 0.0;\n        if (vertexNum >= 1.5) {\n            dy = -dy;\n            inner = 1.0;\n        }\n\n        vec2 base, next, xBasis2, bisect;\n        float flag = 0.0;\n        float side2 = 1.0;\n        if (vertexNum < 0.5 || vertexNum > 2.5 && vertexNum < 3.5) {\n            next = (translationMatrix * vec3(aPrev, 1.0)).xy;\n            base = pointA;\n            flag = type - floor(type / 2.0) * 2.0;\n            side2 = -1.0;\n        } else {\n            next = (translationMatrix * vec3(aNext, 1.0)).xy;\n            base = pointB;\n            if (type >= MITER && type < MITER + 3.5) {\n                flag = step(MITER + 1.5, type);\n                // check miter limit here?\n            }\n        }\n        xBasis2 = next - base;\n        float len2 = length(xBasis2);\n        vec2 norm2 = vec2(xBasis2.y, -xBasis2.x) / len2;\n        float D = norm.x * norm2.y - norm.y * norm2.x;\n        if (D < 0.0) {\n            inner = 1.0 - inner;\n        }\n\n        norm2 *= side2;\n\n        float collinear = step(0.0, dot(norm, norm2));\n\n        vType = 0.0;\n        float dy2 = -1000.0;\n\n        if (abs(D) < 0.01 && collinear < 0.5) {\n            if (type >= ROUND && type < ROUND + 1.5) {\n                type = JOINT_CAP_ROUND;\n            }\n            //TODO: BUTT here too\n        }\n\n        vLine1 = vec4(0.0, lineWidth, max(abs(norm.x), abs(norm.y)), min(abs(norm.x), abs(norm.y)));\n        vLine2 = vec4(0.0, lineWidth, max(abs(norm2.x), abs(norm2.y)), min(abs(norm2.x), abs(norm2.y)));\n\n        if (vertexNum < 3.5) {\n            if (abs(D) < 0.01 && collinear < 0.5) {\n                pos = (shift + dy) * norm;\n            } else {\n                if (flag < 0.5 && inner < 0.5) {\n                    pos = (shift + dy) * norm;\n                } else {\n                    pos = doBisect(norm, len, norm2, len2, shift + dy, inner);\n                }\n            }\n            vLine2.y = -1000.0;\n            if (capType >= CAP_BUTT && capType < CAP_ROUND) {\n                float extra = step(CAP_SQUARE, capType) * lineWidth;\n                vec2 back = -forward;\n                if (vertexNum < 0.5 || vertexNum > 2.5) {\n                    pos += back * (expand + extra);\n                    dy2 = expand;\n                } else {\n                    dy2 = dot(pos + base - pointA, back) - extra;\n                }\n            }\n            if (type >= JOINT_CAP_BUTT && type < JOINT_CAP_SQUARE + 0.5) {\n                float extra = step(JOINT_CAP_SQUARE, type) * lineWidth;\n                if (vertexNum < 0.5 || vertexNum > 2.5) {\n                    vLine2.y = dot(pos + base - pointB, forward) - extra;\n                } else {\n                    pos += forward * (expand + extra);\n                    vLine2.y = expand;\n                    if (capType >= CAP_BUTT) {\n                        dy2 -= expand + extra;\n                    }\n                }\n            }\n        } else if (type >= JOINT_CAP_ROUND && type < JOINT_CAP_ROUND + 1.5) {\n            base += shift * norm;\n            if (inner > 0.5) {\n                dy = -dy;\n                inner = 0.0;\n            }\n            vec2 d2 = abs(dy) * forward;\n            if (vertexNum < 4.5) {\n                dy = -dy;\n                pos = dy * norm;\n            } else if (vertexNum < 5.5) {\n                pos = dy * norm;\n            } else if (vertexNum < 6.5) {\n                pos = dy * norm + d2;\n                vArc.x = abs(dy);\n            } else {\n                dy = -dy;\n                pos = dy * norm + d2;\n                vArc.x = abs(dy);\n            }\n            vLine2 = vec4(0.0, lineWidth * 2.0 + 10.0, 1.0  , 0.0); // forget about line2 with type=3\n            vArc.y = dy;\n            vArc.z = 0.0;\n            vArc.w = lineWidth;\n            vType = 3.0;\n        } else if (abs(D) < 0.01 && collinear < 0.5) {\n            pos = dy * norm;\n        } else {\n            if (inner > 0.5) {\n                dy = -dy;\n                inner = 0.0;\n            }\n            float side = sign(dy);\n            vec2 norm3 = normalize(norm + norm2);\n\n            if (type >= MITER && type < MITER + 3.5) {\n                vec2 farVertex = doBisect(norm, len, norm2, len2, shift + dy, 0.0);\n                if (length(farVertex) > abs(shift + dy) * MITER_LIMIT) {\n                    type = BEVEL;\n                }\n            }\n\n            if (vertexNum < 4.5) {\n                pos = doBisect(norm, len, norm2, len2, shift - dy, 1.0);\n            } else if (vertexNum < 5.5) {\n                pos = (shift + dy) * norm;\n            } else if (vertexNum > 7.5) {\n                pos = (shift + dy) * norm2;\n            } else {\n                if (type >= ROUND && type < ROUND + 1.5) {\n                    pos = doBisect(norm, len, norm2, len2, shift + dy, 0.0);\n                    float d2 = abs(shift + dy);\n                    if (length(pos) > abs(shift + dy) * 1.5) {\n                        if (vertexNum < 6.5) {\n                            pos.x = (shift + dy) * norm.x - d2 * norm.y;\n                            pos.y = (shift + dy) * norm.y + d2 * norm.x;\n                        } else {\n                            pos.x = (shift + dy) * norm2.x + d2 * norm2.y;\n                            pos.y = (shift + dy) * norm2.y - d2 * norm2.x;\n                        }\n                    }\n                } else if (type >= MITER && type < MITER + 3.5) {\n                    pos = doBisect(norm, len, norm2, len2, shift + dy, 0.0); //farVertex\n                } else if (type >= BEVEL && type < BEVEL + 1.5) {\n                    float d2 = side / resolution;\n                    if (vertexNum < 6.5) {\n                        pos = (shift + dy) * norm + d2 * norm3;\n                    } else {\n                        pos = (shift + dy) * norm2 + d2 * norm3;\n                    }\n                }\n            }\n\n            if (type >= ROUND && type < ROUND + 1.5) {\n                vArc.x = side * dot(pos, norm3);\n                vArc.y = pos.x * norm3.y - pos.y * norm3.x;\n                vArc.z = dot(norm, norm3) * (lineWidth + side * shift);\n                vArc.w = lineWidth + side * shift;\n                vType = 3.0;\n            } else if (type >= MITER && type < MITER + 3.5) {\n                vType = 1.0;\n            } else if (type >= BEVEL && type < BEVEL + 1.5) {\n                vType = 4.0;\n                vArc.z = dot(norm, norm3) * (lineWidth + side * shift) - side * dot(pos, norm3);\n            }\n\n            dy = side * (dot(pos, norm) - shift);\n            dy2 = side * (dot(pos, norm2) - shift);\n        }\n\n        pos += base;\n        vLine1.xy = vec2(dy, vLine1.y) * resolution;\n        vLine2.xy = vec2(dy2, vLine2.y) * resolution;\n        vArc = vArc * resolution;\n        vTravel = vec2(aTravel * avgScale + dot(pos - pointA, vec2(-norm.y, norm.x)), avgScale);\n    }\n\n    gl_Position = vec4((projectionMatrix * vec3(pos, 1.0)).xy, 0.0, 1.0);\n\n    vColor = aColor * tint;\n}",$a="%PRECISION%\nvarying vec4 vColor;\nvarying vec4 vLine1;\nvarying vec4 vLine2;\nvarying vec4 vArc;\nvarying float vType;\nvarying float vTextureId;\nvarying vec2 vTextureCoord;\nvarying vec2 vTravel;\nuniform sampler2D uSamplers[%MAX_TEXTURES%];\n\n%PIXEL_LINE%\n\nvoid main(void){\n    %PIXEL_COVERAGE%\n\n    vec4 texColor;\n    float textureId = floor(vTextureId+0.5);\n    %FOR_LOOP%\n\n    gl_FragColor = vColor * texColor * alpha;\n}\n",th=["\nfloat pixelLine(float x, float A, float B) {\n    return clamp(x + 0.5, 0.0, 1.0);\n}\n","\nfloat pixelLine(float x, float A, float B) {\n    float y = abs(x), s = sign(x);\n    if (y * 2.0 < A - B) {\n        return 0.5 + s * y / A;\n    }\n    y -= (A - B) * 0.5;\n    y = max(1.0 - y / B, 0.0);\n    return (1.0 + s * (1.0 - y * y)) * 0.5;\n    //return clamp(x + 0.5, 0.0, 1.0);\n}\n"];class eh extends In{constructor(t,e=Qa,r=$a,n={}){e=eh.generateVertexSrc(t,e),r=eh.generateFragmentSrc(t,r);const{maxStyles:i,maxTextures:o}=t,s=new Int32Array(o);for(let t=0;t<o;t++)s[t]=t;super(On.from(e,r),Object.assign(n,{styleMatrix:new Float32Array(6*i),styleTextureId:new Float32Array(i),styleLine:new Float32Array(2*i),samplerSize:new Float32Array(2*o),uSamplers:s,tint:new Float32Array([1,1,1,1]),resolution:1,expand:1})),this.settings=t}static generateVertexSrc(t,e=Qa){const{maxStyles:r,maxTextures:n}=t;return e=e.replace(/%MAX_TEXTURES%/gi,""+n).replace(/%MAX_STYLES%/gi,""+r)}static generateFragmentSrc(t,e=$a){const{maxTextures:r,pixelLine:n}=t;return e=e.replace(/%PRECISION%/gi,"#version 100\n#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n#else\n  precision mediump float;\n#endif\n").replace(/%PIXEL_LINE%/gi,th[n]).replace(/%PIXEL_COVERAGE%/gi,"float alpha = 1.0;\nif (vType < 0.5) {\n    float left = pixelLine(-vLine1.y - vLine1.x, vLine1.z, vLine1.w);\n    float right = pixelLine(vLine1.y - vLine1.x, vLine1.z, vLine1.w);\n    float near = vLine2.x - 0.5;\n    float far = min(vLine2.x + 0.5, 0.0);\n    float top = vLine2.y - 0.5;\n    float bottom = min(vLine2.y + 0.5, 0.0);\n    alpha = (right - left) * max(bottom - top, 0.0) * max(far - near, 0.0);\n} else if (vType < 1.5) {\n    float a1 = pixelLine(- vLine1.y - vLine1.x, vLine1.z, vLine1.w);\n    float a2 = pixelLine(vLine1.y - vLine1.x, vLine1.z, vLine1.w);\n    float b1 = pixelLine(- vLine2.y - vLine2.x, vLine2.z, vLine2.w);\n    float b2 = pixelLine(vLine2.y - vLine2.x, vLine2.z, vLine2.w);\n    alpha = a2 * b2 - a1 * b1;\n} else if (vType < 2.5) {\n    alpha *= max(min(vLine1.x + 0.5, 1.0), 0.0);\n    alpha *= max(min(vLine1.y + 0.5, 1.0), 0.0);\n    alpha *= max(min(vLine1.z + 0.5, 1.0), 0.0);\n} else if (vType < 3.5) {\n    float a1 = pixelLine(- vLine1.y - vLine1.x, vLine1.z, vLine1.w);\n    float a2 = pixelLine(vLine1.y - vLine1.x, vLine1.z, vLine1.w);\n    float b1 = pixelLine(- vLine2.y - vLine2.x, vLine2.z, vLine2.w);\n    float b2 = pixelLine(vLine2.y - vLine2.x, vLine2.z, vLine2.w);\n    float alpha_miter = a2 * b2 - a1 * b1;\n    float alpha_plane = clamp(vArc.z - vArc.x + 0.5, 0.0, 1.0);\n    float d = length(vArc.xy);\n    float circle_hor = max(min(vArc.w, d + 0.5) - max(-vArc.w, d - 0.5), 0.0);\n    float circle_vert = min(vArc.w * 2.0, 1.0);\n    float alpha_circle = circle_hor * circle_vert;\n    alpha = min(alpha_miter, max(alpha_circle, alpha_plane));\n} else {\n    float a1 = pixelLine(- vLine1.y - vLine1.x, vLine1.z, vLine1.w);\n    float a2 = pixelLine(vLine1.y - vLine1.x, vLine1.z, vLine1.w);\n    float b1 = pixelLine(- vLine2.y - vLine2.x, vLine2.z, vLine2.w);\n    float b2 = pixelLine(vLine2.y - vLine2.x, vLine2.z, vLine2.w);\n    alpha = a2 * b2 - a1 * b1;\n    alpha *= clamp(vArc.z + 0.5, 0.0, 1.0);\n}\n").replace(/%MAX_TEXTURES%/gi,""+r).replace(/%FOR_LOOP%/gi,this.generateSampleSrc(r))}static generateSampleSrc(t){let e="";e+="\n",e+="\n";for(let r=0;r<t;r++)r>0&&(e+="\nelse "),r<t-1&&(e+=`if(textureId < ${r}.5)`),e+="\n{",e+=`\n\ttexColor = texture2D(uSamplers[${r}], vTextureCoord);`,e+="\n}";return e+="\n",e+="\n",e}}const rh={LINE_SCALE_MODE:va.NORMAL,SHADER_MAX_STYLES:24,SHADER_MAX_TEXTURES:4,PIXEL_LINE:0},nh=Sa,{BezierUtils:ih,QuadraticUtils:oh,ArcUtils:sh}=Oa,ah=new Float32Array(3),hh={};class uh extends Oi{static get nextRoundedRectBehavior(){return nh.nextRoundedRectBehavior}static set nextRoundedRectBehavior(t){nh.nextRoundedRectBehavior=t}static __initStatic(){this._TEMP_POINT=new We}get geometry(){return this._geometry}constructor(t=null){super(),this._geometry=t||new Ja,this._geometry.refCount++,this.shader=null,this.shaderSettings={maxStyles:rh.SHADER_MAX_STYLES,maxTextures:rh.SHADER_MAX_TEXTURES,pixelLine:rh.PIXEL_LINE},this.state=Rn.for2d(),this._fillStyle=new Ma,this._lineStyle=new Pa,this._matrix=null,this._holeMode=!1,this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this.pluginName="smooth",this._transformID=-1,this.tint=16777215,this.blendMode=i.NORMAL}clone(){return this.finishPoly(),new uh(this._geometry)}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}get tint(){return this._tint}set tint(t){this._tint=t}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(t=null,e=0,r=1,n=.5,i=rh.LINE_SCALE_MODE){if("number"==typeof t)"boolean"==typeof i&&(i=i?va.NONE:va.NORMAL),t={width:t,color:e,alpha:r,alignment:n,scaleMode:i};else{const e=t.native;void 0!==e&&(t.scaleMode=e?va.NONE:va.NORMAL)}return this.lineTextureStyle(t)}lineTextureStyle(t){t=Object.assign({width:0,texture:Ir.WHITE,color:t&&t.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:Ys.BUTT,join:Ws.MITER,miterLimit:10,shader:null,scaleMode:rh.LINE_SCALE_MODE},t),this.currentPath&&this.startPoly();const e=t.width>0&&t.alpha>0;return e?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:e},t)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new ze,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new ze,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this}lineTo(t,e){this.currentPath||this.moveTo(0,0);const r=this.currentPath.points,n=r[r.length-2],i=r[r.length-1];return n===t&&i===e||r.push(t,e),this}_initCurve(t=0,e=0){this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e)}quadraticCurveTo(t,e,r,n){this._initCurve();const i=this.currentPath.points;return 0===i.length&&this.moveTo(0,0),oh.curveTo(t,e,r,n,i),this}bezierCurveTo(t,e,r,n,i,o){return this._initCurve(),ih.curveTo(t,e,r,n,i,o,this.currentPath.points),this}arcTo(t,e,r,n,i){this._initCurve(t,e);const o=this.currentPath.points,s=sh.curveTo(t,e,r,n,i,o);if(s){const{cx:t,cy:e,radius:r,startAngle:n,endAngle:i,anticlockwise:o}=s;this.arc(t,e,r,n,i,o)}return this}arc(t,e,r,n,i,o=!1){if(n===i)return this;!o&&i<=n?i+=Fe:o&&n<=i&&(n+=Fe);if(0===i-n)return this;const s=t+Math.cos(n)*r,a=e+Math.sin(n)*r,h=this._geometry.closePointEps;let u=this.currentPath?this.currentPath.points:null;if(u){const t=Math.abs(u[u.length-2]-s),e=Math.abs(u[u.length-1]-a);t<h&&e<h||u.push(s,a)}else this.moveTo(s,a),u=this.currentPath.points;return sh.arc(s,a,t,e,r,n,i,o,u),this}beginFill(t=0,e=1,r=!1){return this.beginTextureFill({texture:Ir.WHITE,color:t,alpha:e,smooth:r})}beginTextureFill(t){t=Object.assign({texture:Ir.WHITE,color:16777215,alpha:1,matrix:null,smooth:!1},t),this.currentPath&&this.startPoly();const e=t.alpha>0;return e?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:e},t)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(t,e,r,n){return this.drawShape(new je(t,e,r,n))}drawRoundedRect(t,e,r,n,i){return this.drawShape(new Ve(t,e,r,n,i))}drawCircle(t,e,r){return this.drawShape(new He(t,e,r))}drawEllipse(t,e,r,n){return this.drawShape(new Xe(t,e,r,n))}drawPolygon(...t){let e,r=!0;const n=t[0];n.points?(r=n.closeStroke,e=n.points):e=Array.isArray(t[0])?t[0]:t;const i=new ze(e);return i.closeStroke=r,this.drawShape(i),this}drawShape(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const t=this._geometry.graphicsData;return!(1!==t.length||t[0].shape.type!==Ce.RECT||t[0].matrix||t[0].holes.length||t[0].lineStyle.visible&&t[0].lineStyle.width)}_renderCanvas(t){nh.prototype._renderCanvas.call(this,t)}_render(t){this.finishPoly();const e=this._geometry,r=t.context.supports.uint32Indices;e.checkInstancing(t.geometry.hasInstance,r),e.updateBatches(this.shaderSettings),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))}_populateBatches(){const t=this._geometry,e=this.blendMode,r=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=r,this.vertexData=new Float32Array(t.points);for(let n=0;n<r;n++){const r=t.batches[n],i=r.style.color,o={vertexData:new Float32Array(this.vertexData.buffer,4*r.attribStart*2,2*r.attribSize),blendMode:e,_batchRGB:ce(i),_tintRGB:i,_texture:r.style.texture,alpha:r.style.alpha,worldAlpha:1};this.batches[n]=o}}_renderBatched(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let e=0,r=this.batches.length;e<r;e++){const r=this.batches[e];r.worldAlpha=this.worldAlpha*r.alpha,t.plugins[this.pluginName].render(r)}}}_renderDirect(t){const e=this._resolveDirectShader(t);let r=e;const n=this._geometry,i=this.tint,s=this.worldAlpha,a=r.uniforms,h=n.drawCalls;a.translationMatrix=this.transform.worldTransform,a.tint[0]=(i>>16&255)/255*s,a.tint[1]=(i>>8&255)/255*s,a.tint[2]=(255&i)/255*s,a.tint[3]=s,a.resolution=t.renderTexture.current?t.renderTexture.current.resolution:t.resolution;const u=t.projection.transform;if(u){const t=Math.sqrt(u.a*u.a+u.b*u.b);a.resolution*=t}a.expand=(t.options.antialias?2:1)/a.resolution,t.shader.bind(r),t.geometry.bind(n,r),t.state.set(this.state),r=null;for(let i=0,s=h.length;i<s;i++){const s=n.drawCalls[i],h=r!==s.shader;h&&(r=s.shader,r&&(r.uniforms.translationMatrix=this.transform.worldTransform,r.uniforms.tint&&(r.uniforms.tint[0]=a.tint[0],r.uniforms.tint[1]=a.tint[1],r.uniforms.tint[2]=a.tint[2],r.uniforms.tint[3]=a.tint[3])));const{texArray:u,styleArray:l,size:c,start:d}=s,f=u.count,p=r||e,m=p.uniforms.styleTextureId,g=p.uniforms.styleMatrix,v=p.uniforms.styleLine;for(let t=0;t<l.count;t++){m[t]=l.textureIds[t],v[2*t]=l.lines[2*t],v[2*t+1]=l.lines[2*t+1];const e=l.matrices[t];g[6*t]=e.a,g[6*t+1]=e.c,g[6*t+2]=e.tx,g[6*t+3]=e.b,g[6*t+4]=e.d,g[6*t+5]=e.ty}const y=p.uniforms.samplerSize;for(let t=0;t<f;t++)y[2*t]=u.elements[t].width,y[2*t+1]=u.elements[t].height;t.shader.bind(p),h&&t.geometry.bind(n);for(let e=0;e<f;e++)t.texture.bind(u.elements[e],e);t.geometry.draw(o.TRIANGLES,c,d)}}_resolveDirectShader(t){let e=this.shader;const r=this.pluginName;return e||(hh[r]||(hh[r]=new eh(this.shaderSettings)),e=hh[r]),e}_calculateBounds(){this.finishPoly();const t=this._geometry;if(!t.graphicsData.length)return;const{minX:e,minY:r,maxX:n,maxY:i}=t.bounds;this._bounds.addFrame(this.transform,e,r,n,i)}containsPoint(t){return this.worldTransform.applyInverse(t,uh._TEMP_POINT),this._geometry.containsPoint(uh._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this.tint;const t=ce(this.tint,ah);for(let e=0;e<this.batches.length;e++){const r=this.batches[e],n=r._batchRGB,i=(t[0]*n[0]*255<<16)+(t[1]*n[1]*255<<8)+(0|t[2]*n[2]*255);r._tintRGB=(i>>16)+(65280&i)+((255&i)<<16)}}}calculateVertices(){const t=this.transform._worldID;if(this._transformID===t)return;this._transformID=t;const e=this.transform.worldTransform,r=e.a,n=e.b,i=e.c,o=e.d,s=e.tx,a=e.ty,h=this._geometry.points,u=this.vertexData;let l=0;for(let t=0;t<h.length;t+=2){const e=h[t],c=h[t+1];u[l++]=r*e+i*c+s,u[l++]=o*c+n*e+a}}closePath(){const t=this.currentPath;return t&&(t.closeStroke=!0),this}setMatrix(t){return this._matrix=t,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(t){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(t)}}uh.__initStatic();class lh{constructor(){this.nodes=[],this.edges=[],this.combos=[],this.comboEdges=[],this.hiddenNodes=[],this.hiddenEdges=[],this.hiddenCombos=[],this.vedges=[],this.positions=[],this.destroyed=!1,this.onLayoutEnd=()=>{}}layout(t){return this.init(t),this.execute(!0)}init(t){this.nodes=t.nodes||[],this.edges=t.edges||[],this.combos=t.combos||[],this.comboEdges=t.comboEdges||[],this.hiddenNodes=t.hiddenNodes||[],this.hiddenEdges=t.hiddenEdges||[],this.hiddenCombos=t.hiddenCombos||[],this.vedges=t.vedges||[]}execute(t){}executeWithWorker(){}getDefaultCfg(){return{}}updateCfg(t){t&&Object.assign(this,t)}getType(){return"base"}destroy(){this.nodes=null,this.edges=null,this.combos=null,this.positions=null,this.destroyed=!0}}const ch=t=>"string"==typeof t,dh=Array.isArray,fh=t=>"number"==typeof t,ph=t=>null!==t&&"object"==typeof t,mh=t=>{if(null===t)return t;if(t instanceof Date)return new Date(t.getTime());if(t instanceof Array){const e=[];return t.forEach(t=>{e.push(t)}),e.map(t=>mh(t))}if("object"==typeof t&&Object.keys(t).length){const e=Object.assign({},t);return Object.keys(e).forEach(t=>{e[t]=mh(e[t])}),e}return t},gh=(t,e)=>{const r=t[e];return ph(r)?r.cell:r},vh=(t,e,r)=>{const n=[];for(let e=0;e<t;e++)n[e]={in:0,out:0,all:0};return r?(r.forEach(t=>{const r=gh(t,"source"),i=gh(t,"target");r&&n[e[r]]&&(n[e[r]].out+=1,n[e[r]].all+=1),i&&n[e[i]]&&(n[e[i]].in+=1,n[e[i]].all+=1)}),n):n},yh=t=>"function"==typeof t,bh=(t,e,r)=>{let n;return n=r||(fh(t)?()=>t:()=>e),n},_h=(t,e,r=!0)=>e||0===e?yh(e)?e:fh(e)?()=>e:dh(e)?()=>{if(r){const r=Math.max(...e);return isNaN(r)?t:r}return e}:ph(e)?()=>{if(r){const r=Math.max(e.width,e.height);return isNaN(r)?t:r}return[e.width,e.height]}:()=>t:e=>e.size?dh(e.size)?e.size[0]>e.size[1]?e.size[0]:e.size[1]:ph(e.size)?e.size.width>e.size.height?e.size.width:e.size.height:e.size:t;class Eh extends lh{constructor(t){super(),this.begin=[0,0],this.preventOverlap=!0,this.preventOverlapPadding=10,this.condense=!1,this.sortBy="degree",this.nodes=[],this.edges=[],this.width=300,this.height=300,this.row=0,this.col=0,this.cellWidth=0,this.cellHeight=0,this.cellUsed={},this.id2manPos={},this.onLayoutEnd=()=>{},this.updateCfg(t)}getDefaultCfg(){return{begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30}}execute(){const t=this,{nodes:e,edges:r,begin:n}=t,i=e.length;if(0===i)return t.onLayoutEnd&&t.onLayoutEnd(),{nodes:e,edges:r};if(1===i)return e[0].x=n[0],e[0].y=n[1],t.onLayoutEnd&&t.onLayoutEnd(),{nodes:e,edges:r};let{sortBy:o,width:s,height:a}=t;const{condense:h,preventOverlapPadding:u,preventOverlap:l,nodeSpacing:c,nodeSize:d}=t,f=[];e.forEach(t=>{f.push(t)});const p={};if(f.forEach((t,e)=>{p[t.id]=e}),("degree"===o||!ch(o)||void 0===f[0][o])&&(o="degree",m=e[0].degree,Number.isNaN(Number(m)))){const t=vh(f.length,p,r);f.forEach((e,r)=>{e.degree=t[r].all})}var m;f.sort((t,e)=>e[o]-t[o]),s||"undefined"==typeof window||(s=window.innerWidth),a||"undefined"==typeof window||(a=window.innerHeight);const g=t.rows,v=null!=t.cols?t.cols:t.columns;if(t.cells=i,null!=g&&null!=v?(t.rows=g,t.cols=v):null!=g&&null==v?(t.rows=g,t.cols=Math.ceil(t.cells/t.rows)):null==g&&null!=v?(t.cols=v,t.rows=Math.ceil(t.cells/t.cols)):(t.splits=Math.sqrt(t.cells*t.height/t.width),t.rows=Math.round(t.splits),t.cols=Math.round(t.width/t.height*t.splits)),t.rows=Math.max(t.rows,1),t.cols=Math.max(t.cols,1),t.cols*t.rows>t.cells){const e=t.small(),r=t.large();(e-1)*r>=t.cells?t.small(e-1):(r-1)*e>=t.cells&&t.large(r-1)}else for(;t.cols*t.rows<t.cells;){const e=t.small(),r=t.large();(r+1)*e>=t.cells?t.large(r+1):t.small(e+1)}if(t.cellWidth=s/t.cols,t.cellHeight=a/t.rows,h&&(t.cellWidth=0,t.cellHeight=0),l||c){const e=_h(10,c),r=_h(30,d,!1);f.forEach(n=>{n.x&&n.y||(n.x=0,n.y=0);const i=r(n)||30;let o,s;dh(i)?(o=i[0],s=i[1]):(o=i,s=i);const a=void 0!==e?e(n):u,h=o+a,l=s+a;t.cellWidth=Math.max(t.cellWidth,h),t.cellHeight=Math.max(t.cellHeight,l)})}t.cellUsed={},t.row=0,t.col=0,t.id2manPos={};for(let e=0;e<f.length;e++){const r=f[e];let n;if(t.position&&(n=t.position(r)),n&&(void 0!==n.row||void 0!==n.col)){const e={row:n.row,col:n.col};if(void 0===e.col)for(e.col=0;t.used(e.row,e.col);)e.col++;else if(void 0===e.row)for(e.row=0;t.used(e.row,e.col);)e.row++;t.id2manPos[r.id]=e,t.use(e.row,e.col)}t.getPos(r)}return t.onLayoutEnd&&t.onLayoutEnd(),{edges:r,nodes:f}}small(t){const e=this;let r;const n=e.rows||5,i=e.cols||5;if(null==t)r=Math.min(n,i);else{Math.min(n,i)===e.rows?e.rows=t:e.cols=t}return r}large(t){const e=this;let r;const n=e.rows||5,i=e.cols||5;if(null==t)r=Math.max(n,i);else{Math.max(n,i)===e.rows?e.rows=t:e.cols=t}return r}used(t,e){return this.cellUsed[`c-${t}-${e}`]||!1}use(t,e){this.cellUsed[`c-${t}-${e}`]=!0}moveToNextCell(){const t=this,e=t.cols||5;t.col++,t.col>=e&&(t.col=0,t.row++)}getPos(t){const e=this,{begin:r,cellWidth:n,cellHeight:i}=e;let o,s;const a=e.id2manPos[t.id];if(a)o=a.col*n+n/2+r[0],s=a.row*i+i/2+r[1];else{for(;e.used(e.row,e.col);)e.moveToNextCell();o=e.col*n+n/2+r[0],s=e.row*i+i/2+r[1],e.use(e.row,e.col),e.moveToNextCell()}t.x=o,t.y=s}getType(){return"grid"}}function xh(t,e){const r=t.degree,n=e.degree;return r<n?-1:r>n?1:0}class Th extends lh{constructor(t){super(),this.radius=null,this.nodeSize=void 0,this.startRadius=null,this.endRadius=null,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0,this.divisions=1,this.ordering=null,this.angleRatio=1,this.nodes=[],this.edges=[],this.nodeMap={},this.degrees=[],this.width=300,this.height=300,this.updateCfg(t)}getDefaultCfg(){return{radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1}}execute(){var t;const e=this,r=e.nodes,n=e.edges,i=r.length;if(0===i)return void(e.onLayoutEnd&&e.onLayoutEnd());e.width||"undefined"==typeof window||(e.width=window.innerWidth),e.height||"undefined"==typeof window||(e.height=window.innerHeight),e.center||(e.center=[e.width/2,e.height/2]);const o=e.center;if(1===i)return r[0].x=o[0],r[0].y=o[1],void(e.onLayoutEnd&&e.onLayoutEnd());let{radius:s,startRadius:a,endRadius:h}=e;const{divisions:u,startAngle:l,endAngle:c,angleRatio:d,ordering:f,clockwise:p,nodeSpacing:m,nodeSize:g}=e,v=(c-l)/i,y={};r.forEach((t,e)=>{y[t.id]=e}),e.nodeMap=y;const b=vh(r.length,y,n);if(e.degrees=b,m){const t=_h(10,m),e=_h(10,g);let n=-1/0;r.forEach(t=>{const r=e(t);n<r&&(n=r)});let i=0;r.forEach((e,r)=>{i+=0===r?n||10:(t(e)||0)+(n||10)}),s=i/(2*Math.PI)}else s||a||h?!a&&h?a=h:a&&!h&&(h=a):s=e.height>e.width?e.width/2:e.height/2;const _=v*d;let E=[];E="topology"===f?e.topologyOrdering():"topology-directed"===f?e.topologyOrdering(!0):"degree"===f?e.degreeOrdering():r;const x=Math.ceil(i/u);for(let t=0;t<i;++t){let e=s;e||null===a||null===h||(e=a+t*(h-a)/(i-1)),e||(e=10+100*t/(i-1));let r=l+t%x*_+2*Math.PI/u*Math.floor(t/x);p||(r=c-t%x*_-2*Math.PI/u*Math.floor(t/x)),E[t].x=o[0]+Math.cos(r)*e,E[t].y=o[1]+Math.sin(r)*e,E[t].weight=b[t].all}return null===(t=e.onLayoutEnd)||void 0===t||t.call(e),{nodes:E,edges:this.edges}}topologyOrdering(t=!1){const e=this,r=e.degrees,n=e.edges,i=e.nodes,o=mh(i),s=e.nodeMap,a=[o[0]],h=[i[0]],u=[],l=i.length;u[0]=!0,function(t,e,r,n){t.forEach((e,r)=>{t[r].children=[],t[r].parent=[]}),n?e.forEach(e=>{const n=gh(e,"source"),i=gh(e,"target");let o=0;n&&(o=r[n]);let s=0;i&&(s=r[i]);const a=t[o].children,h=t[s].parent;a.push(t[s].id),h.push(t[o].id)}):e.forEach(e=>{const n=gh(e,"source"),i=gh(e,"target");let o=0;n&&(o=r[n]);let s=0;i&&(s=r[i]);const a=t[o].children,h=t[s].children;a.push(t[s].id),h.push(t[o].id)})}(o,n,s,t);let c=0;return o.forEach((t,e)=>{if(0!==e)if(e!==l-1&&r[e].all===r[e+1].all&&!function(t,e,r){const n=r.length;for(let i=0;i<n;i++){const n=gh(r[i],"source"),o=gh(r[i],"target");if(t.id===n&&e.id===o||e.id===n&&t.id===o)return!0}return!1}(a[c],t,n)||u[e]){const t=a[c].children;let n=!1;for(let l=0;l<t.length;l++){const c=s[t[l]];if(r[c].all===r[e].all&&!u[c]){a.push(o[c]),h.push(i[s[o[c].id]]),u[c]=!0,n=!0;break}}let d=0;for(;!n&&(u[d]||(a.push(o[d]),h.push(i[s[o[d].id]]),u[d]=!0,n=!0),d++,d!==l););}else a.push(t),h.push(i[s[t.id]]),u[e]=!0,c++}),h}degreeOrdering(){const t=this.nodes,e=[],r=this.degrees;return t.forEach((t,n)=>{t.degree=r[n].all,e.push(t)}),e.sort(xh),e}getType(){return"circular"}}const wh=(t,e)=>{if("next"!==t&&"prev"!==t)return e},Ah=t=>{t.prev.next=t.next,t.next.prev=t.prev,delete t.next,delete t.prev};var Sh;function Oh(t,e){var r=t.get(e)||0;t.set(e,r+1)}function Ih(t,e){var r=t.get(e);void 0!==r&&((r-=1)>0?t.set(e,r):t.delete(e))}function Rh(t,e,r,n){var i=String(e),o=String(r);if(!t&&i>o){var s=i;i=o,o=s}return i+Sh.EDGE_KEY_DELIM+o+Sh.EDGE_KEY_DELIM+(void 0===n?Sh.DEFAULT_EDGE_NAME:n)}function Nh(t,e,r,n){var i=String(e),o=String(r),s={v:e,w:r};if(!t&&i>o){var a=s.v;s.v=s.w,s.w=a}return void 0!==n&&(s.name=n),s}function Lh(t,e){return Rh(t,e.v,e.w,e.name)}function Mh(t){return"function"==typeof t}!function(t){t.DEFAULT_EDGE_NAME="\0",t.GRAPH_NODE="\0",t.EDGE_KEY_DELIM=""}(Sh||(Sh={}));var Ph=function(t){return t.nodes().map((function(e){var r={id:e,value:t.node(e),parent:t.parent(e)};return void 0===r.value&&delete r.value,void 0===r.parent&&delete r.parent,r}))},Ch=function(t){return t.edges().map((function(e){var r=t.edge(e),n={v:e.v,w:e.w,value:r,name:e.name};return void 0===n.name&&delete n.name,void 0===n.value&&delete n.value,n}))},Dh=function(t){var e={options:{directed:t.isDirected(),multigraph:t.isMultigraph(),compound:t.isCompound()},nodes:Ph(t),edges:Ch(t),value:t.graph()};return void 0===e.value&&delete e.value,e};function Uh(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Bh(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Uh(Object(r),!0).forEach((function(e){Fh(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Uh(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Fh(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kh(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Gh(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var jh={compound:!1,multigraph:!1,directed:!0},Hh=function(){function t(){var e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};kh(this,t),this.directed=!0,this.multigraph=!1,this.compound=!1,this.GRAPH_NODE=Sh.GRAPH_NODE,this.label=void 0,this.nodeCountNum=0,this.edgeCountNum=0,this.defaultNodeLabelFn=function(){},this.defaultEdgeLabelFn=function(){},this.parentMap=void 0,this.childrenMap=void 0,this.nodesLabelMap=new Map,this.inEdgesMap=new Map,this.outEdgesMap=new Map,this.predecessorsMap=new Map,this.successorsMap=new Map,this.edgesMap=new Map,this.edgesLabelsMap=new Map,this.isDirected=function(){return e.directed},this.isMultigraph=function(){return e.multigraph},this.isCompound=function(){return e.compound},this.setGraph=function(t){return e.label=t,e},this.graph=function(){return e.label},this.setDefaultNodeLabel=function(t){return Mh(t)?e.defaultNodeLabelFn=t:e.defaultNodeLabelFn=function(){return t},e},this.nodeCount=function(){return e.nodeCountNum},this.node=function(t){return e.nodesLabelMap.get(t)},this.nodes=function(){return Array.from(e.nodesLabelMap.keys())},this.sources=function(){return e.nodes().filter((function(t){var r;return!(null===(r=e.inEdgesMap.get(t))||void 0===r?void 0:r.size)}))},this.sinks=function(){return e.nodes().filter((function(t){var r;return!(null===(r=e.outEdgesMap.get(t))||void 0===r?void 0:r.size)}))},this.setNodes=function(t,r){return t.map((function(t){return e.setNode(t,r)})),e},this.hasNode=function(t){return e.nodesLabelMap.has(t)},this.checkCompound=function(){if(!e.isCompound())throw new Error("Cannot construct parent-children relations in a non-compound graph")},this.parent=function(t){if(e.isCompound()){var r,n=null===(r=e.parentMap)||void 0===r?void 0:r.get(t);if(n!==e.GRAPH_NODE)return n}},this.removeFromParentsChildList=function(t){var r=e.parentMap.get(t);e.childrenMap.get(r).delete(t)},this.setParent=function(t,r){var n,i;e.checkCompound();for(var o=void 0===r?e.GRAPH_NODE:r,s=e.parent(o);s;){if(t===s)throw new Error("Setting "+r+" as parent of "+t+" would create a cycle");s=e.parent(s)}r&&e.setNode(r),e.setNode(t),e.removeFromParentsChildList(t),null===(n=e.parentMap)||void 0===n||n.set(t,o);var a=e.childrenMap.get(o);return a.set(t,!0),null===(i=e.childrenMap)||void 0===i||i.set(o,a),e},this.children=function(t){var r=void 0===t?e.GRAPH_NODE:t;if(e.isCompound()){var n,i=null===(n=e.childrenMap)||void 0===n?void 0:n.get(r);return i?Array.from(i.keys()):void 0}return r===e.GRAPH_NODE?e.nodes():t&&e.hasNode(t)?[]:void 0},this.predecessors=function(t){var r=e.predecessorsMap.get(t);return r?Array.from(r.keys()):void 0},this.successors=function(t){var r=e.successorsMap.get(t);return r?Array.from(r.keys()):void 0},this.neighbors=function(t){var r;if(e.hasNode(t))return Array.from(new Set(null===(r=e.predecessors(t))||void 0===r?void 0:r.concat(e.successors(t))))},this.isLeaf=function(t){var r,n;return e.isDirected()?!(null===(n=e.successors(t))||void 0===n?void 0:n.length):!(null===(r=e.neighbors(t))||void 0===r?void 0:r.length)},this.filterNodes=function(r){var n=e.directed,i=e.multigraph,o=e.compound,s=new t({directed:n,multigraph:i,compound:o});if(s.setGraph(e.graph()),e.nodes().forEach((function(t){r(t)&&s.setNode(t,e.node(t))})),e.edges().forEach((function(t){s.hasNode(t.v)&&s.hasNode(t.w)&&s.setEdgeObj(t,e.edge(t))})),o){s.nodes().forEach((function(t){s.setParent(t,function(t){for(var r=e.parent(t);void 0!==r&&!s.hasNode(r);)r=e.parent(r);return r}(t))}))}return s},this.setDefaultEdgeLabel=function(t){return Mh(t)?e.defaultEdgeLabelFn=t:e.defaultEdgeLabelFn=function(){return t},e},this.edgeCount=function(){return e.edgeCountNum},this.setEdgeObj=function(t,r){return e.setEdge(t.v,t.w,r,t.name)},this.setPath=function(t,r){return t.reduce((function(t,n){return e.setEdge(t,n,r),n})),e},this.edgeFromArgs=function(t,r,n){return e.edge({v:t,w:r,name:n})},this.edge=function(t){return e.edgesLabelsMap.get(Lh(e.isDirected(),t))},this.hasEdge=function(t,r,n){return e.edgesLabelsMap.has(Lh(e.isDirected(),{v:t,w:r,name:n}))},this.removeEdgeObj=function(t){var r=t.v,n=t.w,i=t.name;return e.removeEdge(r,n,i)},this.edges=function(){return Array.from(e.edgesMap.values())},this.inEdges=function(t,r){var n=e.inEdgesMap.get(t);if(n)return Array.from(n.values()).filter((function(t){return!r||t.v===r}))},this.outEdges=function(t,r){var n=e.outEdgesMap.get(t);if(n)return Array.from(n.values()).filter((function(t){return!r||t.w===r}))},this.nodeEdges=function(t,r){var n;if(e.hasNode(t))return null===(n=e.inEdges(t,r))||void 0===n?void 0:n.concat(e.outEdges(t,r))},this.toJSON=function(){return Dh(e)},this.nodeInDegree=function(t){var r=e.inEdgesMap.get(t);return r?r.size:0},this.nodeOutDegree=function(t){var r=e.outEdgesMap.get(t);return r?r.size:0},this.nodeDegree=function(t){return e.nodeInDegree(t)+e.nodeOutDegree(t)},this.source=function(t){return t.v},this.target=function(t){return t.w};var n=Bh(Bh({},jh),r);this.compound=n.compound,this.directed=n.directed,this.multigraph=n.multigraph,this.compound&&(this.parentMap=new Map,this.childrenMap=new Map)}var e,r,n;return e=t,(r=[{key:"setNode",value:function(t,e){var r,n=this.nodesLabelMap,i=this.defaultNodeLabelFn,o=this.isCompound,s=this.parentMap,a=this.childrenMap,h=this.inEdgesMap,u=this.outEdgesMap,l=this.predecessorsMap,c=this.successorsMap;return n.has(t)?(void 0!==e&&n.set(t,e),this):(n.set(t,e||i(t)),o()&&(null==s||s.set(t,this.GRAPH_NODE),null==a||a.set(t,new Map),(null==a?void 0:a.has(this.GRAPH_NODE))||null==a||a.set(this.GRAPH_NODE,new Map),null==a||null===(r=a.get(this.GRAPH_NODE))||void 0===r||r.set(t,!0)),[h,u,l,c].forEach((function(e){return e.set(t,new Map)})),this.nodeCountNum+=1,this)}},{key:"removeNode",value:function(t){var e=this;if(this.hasNode(t)){var r,n,i,o=function(t){e.removeEdge(t.v,t.w,t.name)},s=this.inEdgesMap,a=this.outEdgesMap,h=this.predecessorsMap,u=this.successorsMap,l=this.nodesLabelMap;this.isCompound()&&(this.removeFromParentsChildList(t),null===(r=this.parentMap)||void 0===r||r.delete(t),null===(n=this.children(t))||void 0===n||n.forEach((function(t){return e.setParent(t)})),null===(i=this.childrenMap)||void 0===i||i.delete(t));var c=s.get(t),d=a.get(t);Array.from(c.values()).forEach((function(t){return o(t)})),Array.from(d.values()).forEach((function(t){return o(t)})),l.delete(t),s.delete(t),a.delete(t),h.delete(t),u.delete(t),this.nodeCountNum-=1}return this}},{key:"setEdge",value:function(t,e,r,n){var i,o,s=Nh(this.isDirected(),t,e,n),a=Lh(this.isDirected(),s),h=s.v,u=s.w;if(this.edgesLabelsMap.has(a))return this.edgesLabelsMap.set(a,r),this;if(void 0!==n&&!this.isMultigraph())throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(h),this.setNode(u),this.edgesLabelsMap.set(a,r||this.defaultEdgeLabelFn(h,u,n)),Object.freeze(s),this.edgesMap.set(a,s);var l=this.predecessorsMap.get(u),c=this.successorsMap.get(h);return Oh(l,h),Oh(c,u),null===(i=this.inEdgesMap.get(u))||void 0===i||i.set(a,s),null===(o=this.outEdgesMap.get(h))||void 0===o||o.set(a,s),this.edgeCountNum+=1,this}},{key:"removeEdge",value:function(t,e,r){var n=Rh(this.isDirected(),t,e,r);if(this.edgesMap.get(n)){var i=Nh(this.isDirected(),t,e,r),o=i.v,s=i.w;this.edgesLabelsMap.delete(n),this.edgesMap.delete(n);var a=this.predecessorsMap.get(s),h=this.successorsMap.get(o);Ih(a,o),Ih(h,s),this.inEdgesMap.get(s).delete(n),this.outEdgesMap.get(o).delete(n),this.edgeCountNum-=1}return this}}])&&Gh(e.prototype,r),n&&Gh(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Xh(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function zh(t,e,r){return e&&Xh(t.prototype,e),r&&Xh(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}Hh.fromJSON=function(t){var e=new Hh(t.options);return void 0!==t.value&&e.setGraph(t.value),t.nodes.forEach((function(t){e.setNode(t.id,t.value),t.parent&&e.setParent(t.id,t.parent)})),t.edges.forEach((function(t){e.setEdge(t.v,t.w,t.value,t.name)})),e};var Vh=zh((function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.arr=[],this.keyIndice=new Map,this.size=function(){return e.arr.length},this.keys=function(){return e.arr.map((function(t){return t.key}))},this.has=function(t){return e.keyIndice.has(t)},this.priority=function(t){var r=e.keyIndice.get(t);if(void 0!==r)return e.arr[r].priority},this.swap=function(t,r){var n=e.arr,i=e.keyIndice,o=[n[t],n[r]],s=o[0],a=o[1];n[t]=a,n[r]=s,i.set(s.key,r),i.set(a.key,t)},this.innerDecrease=function(t){for(var r,n=e.arr,i=n[t].priority,o=t;0!==o;){var s;if((null===(s=n[r=o>>1])||void 0===s?void 0:s.priority)<i)break;e.swap(o,r),o=r}},this.heapify=function(t){var r=e.arr,n=t<<1,i=n+1,o=t;n<r.length&&(o=r[n].priority<r[o].priority?n:o,i<r.length&&(o=r[i].priority<r[o].priority?i:o),o!==t&&(e.swap(t,o),e.heapify(o)))},this.min=function(){if(0===e.size())throw new Error("Queue underflow");return e.arr[0].key},this.add=function(t,r){var n=e.keyIndice,i=e.arr;if(!n.has(t)){var o=i.length;return n.set(t,o),i.push({key:t,priority:r}),e.innerDecrease(o),!0}return!1},this.removeMin=function(){e.swap(0,e.arr.length-1);var t=e.arr.pop();return e.keyIndice.delete(t.key),e.heapify(0),t.key},this.decrease=function(t,r){if(!e.has(t))throw new Error("There's no key named ".concat(t));var n=e.keyIndice.get(t);if(r>e.arr[n].priority)throw new Error("New priority is greater than current priority.Key: ".concat(t," Old: + ").concat(e.arr[n].priority," New: ").concat(r));e.arr[n].priority=r,e.innerDecrease(n)}})),Wh=function(t,e,r){var n=Array.isArray(e)?e:[e],i=function(e){return t.isDirected()?t.successors(e):t.neighbors(e)},o=[],s=[];return n.forEach((function(e){if(!t.hasNode(e))throw new Error("Graph does not have node: "+e);!function t(e,r,n,i,o,s){i.includes(r)||(i.push(r),n||s.push(r),o(r).forEach((function(r){return t(e,r,n,i,o,s)})),n&&s.push(r))}(t,e,"post"===r,s,i,o)})),o};function Yh(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,i,o=[],s=!0,a=!1;try{for(r=r.call(t);!(s=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);s=!0);}catch(t){a=!0,i=t}finally{try{s||null==r.return||r.return()}finally{if(a)throw i}}return o}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return qh(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qh(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qh(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var Kh=function(){return 1},Zh=function(t,e,r,n){return Jh(t,e,r||Kh,n||function(e){return t.outEdges(e)})},Jh=function(t,e,r,n){var i,o,s=new Map,a=new Vh,h=function(t){var e=t.v!==i?t.v:t.w,n=s.get(e),h=r(t),u=o.distance+h;if(h<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+t+" Weight: "+h);u<n.distance&&(n.distance=u,n.predecessor=i,a.decrease(e,u))};for(t.nodes().forEach((function(t){var r=t===e?0:Number.POSITIVE_INFINITY;s.set(t,{distance:r}),a.add(t,r)}));a.size()>0&&(i=a.removeMin(),!(o=s.get(i))||o.distance!==Number.POSITIVE_INFINITY);)n(i).forEach(h);var u={};return Array.from(s.entries()).forEach((function(t){var e=Yh(t,2),r=e[0],n=e[1];return u[String(r)]=n,u})),u},Qh=function(t){var e=0,r=[],n=new Map,i=[];return t.nodes().forEach((function(o){n.has(o)||function o(s){var a,h={onStack:!0,lowlink:e,index:e};if(n.set(s,h),e+=1,r.push(s),null===(a=t.successors(s))||void 0===a||a.forEach((function(t){var e;if(n.has(t)){if(null===(e=n.get(t))||void 0===e?void 0:e.onStack){var r=n.get(t);h.lowlink=Math.min(h.lowlink,r.index)}}else{o(t);var i=n.get(t);h.lowlink=Math.min(h.lowlink,i.lowlink)}})),h.lowlink===h.index){var u,l=[];do{u=r.pop(),n.get(u).onStack=!1,l.push(u)}while(s!==u);i.push(l)}}(o)})),i};function $h(t){return($h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function eu(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ru(t,e){if(e&&("object"===$h(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function nu(t){var e="function"==typeof Map?new Map:void 0;return(nu=function(t){if(null===t||!function(t){return-1!==Function.toString.call(t).indexOf("[native code]")}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return iu(t,arguments,au(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),su(r,t)})(t)}function iu(t,e,r){return(iu=ou()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var i=new(Function.bind.apply(t,n));return r&&su(i,r.prototype),i}).apply(null,arguments)}function ou(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function su(t,e){return(su=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function au(t){return(au=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var hu=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&su(t,e)}(a,t);var e,r,n,i,o,s=(e=a,r=ou(),function(){var t,n=au(e);if(r){var i=au(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return ru(this,t)});function a(){return eu(this,a),s.apply(this,arguments)}return n=a,i&&tu(n.prototype,i),o&&tu(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n}(nu(Error));function uu(t){var e=new Set,r=new Set,n=[];if(t.sinks().forEach((function i(o){if(r.has(o))throw new hu;var s;e.has(o)||(r.add(o),e.add(o),null===(s=t.predecessors(o))||void 0===s||s.forEach(i),r.delete(o),n.push(o))})),e.size!==t.nodeCount())throw new hu;return n}var lu=function(){return 1};var cu=Object.freeze({__proto__:null,components:function(t){var e=new Set,r=[];return t.nodes().forEach((function(n){for(var i=[],o=[n];o.length>0;){var s,a,h=o.pop();if(!e.has(h))e.add(h),i.push(h),null===(s=t.successors(h))||void 0===s||s.forEach((function(t){return o.push(t)})),null===(a=t.predecessors(h))||void 0===a||a.forEach((function(t){return o.push(t)}))}i.length&&r.push(i)})),r},dfs:Wh,dijkstra:Zh,dijkstraAll:function(t,e,r){var n={};return t.nodes().forEach((function(i){return n[String(i)]=Zh(t,i,e,r),n})),n},findCycles:function(t){return Qh(t).filter((function(e){return e.length>1||1===e.length&&t.hasEdge(e[0],e[0])}))},tarjan:Qh,isAcyclic:function(t){try{uu(t)}catch(t){if(t instanceof hu)return!1;throw t}return!0},postorder:function(t,e){return Wh(t,e,"post")},preorder:function(t,e){return Wh(t,e,"pre")},prim:function(t,e){var r,n=new Hh,i=new Map,o=new Vh;function s(t){var n=t.v===r?t.w:t.v,s=o.priority(n);if(void 0!==s){var a=e(t);a<s&&(i.set(n,r),o.decrease(n,a))}}if(0===t.nodeCount())return n;t.nodes().forEach((function(t){o.add(t,Number.POSITIVE_INFINITY),n.setNode(t)})),o.decrease(t.nodes()[0],0);for(var a=!1;o.size()>0;){var h;if(r=o.removeMin(),i.has(r))n.setEdge(r,i.get(r));else{if(a)throw new Error("Input graph is not connected: "+t.graph());a=!0}null===(h=t.nodeEdges(r))||void 0===h||h.forEach(s)}return n},topsort:uu,floydWarshall:function(t,e,r){return function(t,e,r){var n={},i=t.nodes();return i.forEach((function(t){var o=String(t);n[o]={},n[o][o]={distance:0},i.forEach((function(e){t!==e&&(n[o][String(e)]={distance:Number.POSITIVE_INFINITY})})),r(t).forEach((function(r){var i=r.v===t?r.w:r.v,s=e(r);n[o][String(i)]={distance:s,predecessor:t}}))})),i.forEach((function(t){var e=String(t),r=n[e];i.forEach((function(t){var o=String(t),s=n[o];i.forEach((function(t){var n=String(t),i=s[e],o=r[n],a=s[n],h=i.distance+o.distance;h<a.distance&&(a.distance=h,a.predecessor=o.predecessor)}))}))})),n}(t,e||lu,r||function(e){return t.outEdges(e)})}});class du extends class{constructor(){const t={};t.prev=t,t.next=t.prev,this.shortcut=t}dequeue(){const t=this.shortcut,e=t.prev;if(e&&e!==t)return Ah(e),e}enqueue(t){const e=this.shortcut;t.prev&&t.next&&Ah(t),t.next=e.next,e.next.prev=t,e.next=t,t.prev=e}toString(){const t=[],e=this.shortcut;let r=e.prev;for(;r!==e;)t.push(JSON.stringify(r,wh)),r=null==r?void 0:r.prev;return`[${t.join(", ")}]`}}{}class fu extends Hh{}const pu=()=>1,mu=(t,e,r)=>{let n=[];const i=e[e.length-1],o=e[0];let s;for(;t.nodeCount();){for(;s=o.dequeue();)gu(t,e,r,s);for(;s=i.dequeue();)gu(t,e,r,s);if(t.nodeCount())for(let i=e.length-2;i>0;--i)if(s=e[i].dequeue(),s){n=n.concat(gu(t,e,r,s,!0));break}}return n},gu=(t,e,r,n,i)=>{var o,s;const a=[];return null===(o=t.inEdges(n.v))||void 0===o||o.forEach(n=>{const o=t.edge(n),s=t.node(n.v);i&&a.push({v:n.v,w:n.w,in:0,out:0}),void 0===s.out&&(s.out=0),s.out-=o,yu(e,r,s)}),null===(s=t.outEdges(n.v))||void 0===s||s.forEach(n=>{const i=t.edge(n),o=n.w,s=t.node(o);void 0===s.in&&(s.in=0),s.in-=i,yu(e,r,s)}),t.removeNode(n.v),i?a:void 0},vu=(t,e)=>{const r=new fu;let n=0,i=0;t.nodes().forEach(t=>{r.setNode(t,{v:t,in:0,out:0})}),t.edges().forEach(t=>{const o=r.edge(t)||0,s=(null==e?void 0:e(t))||1,a=o+s;r.setEdge(t.v,t.w,a),i=Math.max(i,r.node(t.v).out+=s),n=Math.max(n,r.node(t.w).in+=s)});const o=[],s=i+n+3;for(let t=0;t<s;t++)o.push(new du);const a=n+1;return r.nodes().forEach(t=>{yu(o,a,r.node(t))}),{buckets:o,zeroIdx:a,graph:r}},yu=(t,e,r)=>{r.out?r.in?t[r.out-r.in+e].enqueue(r):t[t.length-1].enqueue(r):t[0].enqueue(r)},bu=t=>{const e=[],r={},n={},i=o=>{var s;n[o]||(n[o]=!0,r[o]=!0,null===(s=t.outEdges(o))||void 0===s||s.forEach(t=>{r[t.w]?e.push(t):i(t.w)}),delete r[o])};return t.nodes().forEach(i),e};var _u=t=>{const e="greedy"===t.graph().acyclicer?((t,e)=>{var r;if(t.nodeCount()<=1)return[];const n=vu(t,e||pu);return null===(r=mu(n.graph,n.buckets,n.zeroIdx).map(e=>t.outEdges(e.v,e.w)))||void 0===r?void 0:r.flat()})(t,(t=>e=>{var r;return(null===(r=t.edge(e))||void 0===r?void 0:r.weight)||1})(t)):bu(t);null==e||e.forEach(e=>{const r=t.edge(e);t.removeEdgeObj(e),r.forwardName=e.name,r.reversed=!0,t.setEdge(e.w,e.v,r,"rev-"+Math.random())})},Eu=t=>{t.edges().forEach(e=>{const r=t.edge(e);if(r.reversed){t.removeEdgeObj(e);const n=r.forwardName;delete r.reversed,delete r.forwardName,t.setEdge(e.w,e.v,r,n)}})};class xu extends Hh{}const Tu=(t,e,r,n)=>{let i;do{i=`${n}${Math.random()}`}while(t.hasNode(i));return r.dummy=e,t.setNode(i,r),i},wu=t=>{const e=new xu({multigraph:t.isMultigraph()}).setGraph(t.graph());return t.nodes().forEach(r=>{var n;(null===(n=t.children(r))||void 0===n?void 0:n.length)||e.setNode(r,t.node(r))}),t.edges().forEach(r=>{e.setEdgeObj(r,t.edge(r))}),e},Au=(t,e)=>{const r=Number(t.x),n=Number(t.y),i=Number(e.x)-r,o=Number(e.y)-n;let s,a,h=Number(t.width)/2,u=Number(t.height)/2;return i||o?(Math.abs(o)*h>Math.abs(i)*u?(o<0&&(u=-u),s=u*i/o,a=u):(i<0&&(h=-h),s=h,a=h*o/i),{x:r+s,y:n+a}):{x:0,y:0}},Su=t=>{const e=[],r=Iu(t)+1;for(let t=0;t<r;t++)e.push([]);t.nodes().forEach(r=>{const n=t.node(r);if(!n)return;const i=n.rank;void 0!==i&&e[i]&&e[i].push(r)});for(let n=0;n<r;n++)e[n]=e[n].sort((e,r)=>{var n,i,o,s;return o=null===(n=t.node(e))||void 0===n?void 0:n.order,s=null===(i=t.node(r))||void 0===i?void 0:i.order,Number(o)-Number(s)});return e},Ou=(t,e,r,n)=>{const i={width:0,height:0};return fh(r)&&fh(n)&&(i.rank=r,i.order=n),Tu(t,"border",i,e)},Iu=t=>{let e;return t.nodes().forEach(r=>{var n;const i=null===(n=t.node(r))||void 0===n?void 0:n.rank;void 0!==i&&(void 0===e||i>e)&&(e=i)}),e||(e=0),e},Ru=(t,e)=>{const r=Date.now();try{return e()}finally{console.log(`${t} time: ${Date.now()-r}ms`)}},Nu=(t,e)=>e(),Lu=(t,e)=>t.reduce((t,r)=>e(t)>e(r)?r:t),Mu=(t,e)=>{let r=e.v,n=t.node(r).rank;const i=e.w,o=t.node(i).rank,s=e.name,a=t.edge(e),h=a.labelRank;if(o===n+1)return;t.removeEdgeObj(e);const u=t.graph();let l,c,d;for(d=0,++n;n<o;++d,++n)a.points=[],c={edgeLabel:a,width:0,height:0,edgeObj:e,rank:n},l=Tu(t,"edge",c,"_d"),n===h&&(c.width=a.width,c.height=a.height,c.dummy="edge-label",c.labelpos=a.labelpos),t.setEdge(r,l,{weight:a.weight},s),0===d&&(u.dummyChains||(u.dummyChains=[]),u.dummyChains.push(l)),r=l;t.setEdge(r,i,{weight:a.weight},s)};var Pu=t=>{t.graph().dummyChains=[],t.edges().forEach(e=>Mu(t,e))},Cu=t=>{var e;null===(e=t.graph().dummyChains)||void 0===e||e.forEach(e=>{let r=t.node(e);const n=r.edgeLabel;let i;r.edgeObj&&t.setEdgeObj(r.edgeObj,n);let o=e;for(;r.dummy;)i=t.successors(o)[0],t.removeNode(o),n.points.push({x:r.x,y:r.y}),"edge-label"===r.dummy&&(n.x=r.x,n.y=r.y,n.width=r.width,n.height=r.height),o=i,r=t.node(o)})};const Du=t=>{var e;const r={},n=e=>{var i;const o=t.node(e);if(!o)return 0;if(r[e])return o.rank;let s;return r[e]=!0,null===(i=t.outEdges(e))||void 0===i||i.forEach(e=>{const r=n(e.w)-t.edge(e).minlen;r&&(void 0===s||r<s)&&(s=r)}),s||(s=0),o.rank=s,s};null===(e=t.sources())||void 0===e||e.forEach(t=>n(t))},Uu=(t,e)=>t.node(e.w).rank-t.node(e.v).rank-t.edge(e).minlen,Bu=(t,e)=>{const r=n=>{e.nodeEdges(n).forEach(i=>{const o=i.v,s=n===o?i.w:o;t.hasNode(s)||Uu(e,i)||(t.setNode(s,{}),t.setEdge(n,s,{}),r(s))})};return t.nodes().forEach(r),t.nodeCount()},Fu=(t,e)=>{const r=n=>{var i;null===(i=e.nodeEdges(n))||void 0===i||i.forEach(i=>{const o=i.v,s=n===o?i.w:o;t.hasNode(s)||void 0===e.node(s).layer&&Uu(e,i)||(t.setNode(s,{}),t.setEdge(n,s,{}),r(s))})};return t.nodes().forEach(r),t.nodeCount()},ku=(t,e)=>Lu(e.edges(),r=>t.hasNode(r.v)!==t.hasNode(r.w)?Uu(e,r):1/0),Gu=(t,e,r)=>{t.nodes().forEach(t=>{e.node(t).rank||(e.node(t).rank=0),e.node(t).rank+=r})},{preorder:ju,postorder:Hu}=cu,Xu=t=>{const e=(t=>{const e=(new xu).setGraph(t.graph());return t.nodes().forEach(r=>{e.setNode(r,t.node(r))}),t.edges().forEach(r=>{const n=e.edgeFromArgs(r.v,r.w)||{weight:0,minlen:1},i=t.edge(r);e.setEdge(r.v,r.w,{weight:n.weight+i.weight,minlen:Math.max(n.minlen,i.minlen)})}),e})(t);Du(e);const r=(t=>{const e=new xu({directed:!1}),r=t.nodes()[0],n=t.nodeCount();let i,o;for(e.setNode(r,{});Bu(e,t)<n;)i=ku(e,t),o=e.hasNode(i.v)?Uu(t,i):-Uu(t,i),Gu(e,t,o);return e})(e);let n,i;for(Yu(r),zu(r,e);n=Ku(r);)i=Zu(r,e,n),Ju(r,e,n,i)},zu=(t,e)=>{let r=Hu(t,t.nodes());r=null==r?void 0:r.slice(0,(null==r?void 0:r.length)-1),null==r||r.forEach(r=>{Vu(t,e,r)})},Vu=(t,e,r)=>{const n=t.node(r).parent;t.edgeFromArgs(r,n).cutvalue=Wu(t,e,r)},Wu=(t,e,r)=>{var n;const i=t.node(r).parent;let o=!0,s=e.edgeFromArgs(r,i),a=0;return s||(o=!1,s=e.edgeFromArgs(i,r)),a=s.weight,null===(n=e.nodeEdges(r))||void 0===n||n.forEach(n=>{const s=n.v===r,h=s?n.w:n.v;if(h!==i){const i=s===o,u=e.edge(n).weight;if(a+=i?u:-u,$u(t,r,h)){const e=t.edgeFromArgs(r,h).cutvalue;a+=i?-e:e}}}),a},Yu=(t,e=t.nodes()[0])=>{qu(t,{},1,e)},qu=(t,e,r,n,i)=>{var o;const s=r;let a=r;const h=t.node(n);return e[n]=!0,null===(o=t.neighbors(n))||void 0===o||o.forEach(r=>{e[r]||(a=qu(t,e,a,r,n))}),h.low=s,h.lim=a++,i?h.parent=i:delete h.parent,a},Ku=t=>t.edges().find(e=>t.edge(e).cutvalue<0),Zu=(t,e,r)=>{let n=r.v,i=r.w;e.hasEdge(n,i)||(n=r.w,i=r.v);const o=t.node(n),s=t.node(i);let a=o,h=!1;o.lim>s.lim&&(a=s,h=!0);const u=e.edges().filter(e=>h===tl(t,t.node(e.v),a)&&h!==tl(t,t.node(e.w),a));return Lu(u,t=>Uu(e,t))},Ju=(t,e,r,n)=>{const i=r.v,o=r.w;t.removeEdge(i,o),t.setEdge(n.v,n.w,{}),Yu(t),zu(t,e),Qu(t,e)},Qu=(t,e)=>{const r=t.nodes().find(t=>{var r;return!(null===(r=e.node(t))||void 0===r?void 0:r.parent)});let n=ju(t,r);n=null==n?void 0:n.slice(1),null==n||n.forEach(r=>{const n=t.node(r).parent;let i=e.edgeFromArgs(r,n),o=!1;i||(i=e.edgeFromArgs(n,r),o=!0),e.node(r).rank=e.node(n).rank+(o?i.minlen:-i.minlen)})},$u=(t,e,r)=>t.hasEdge(e,r),tl=(t,e,r)=>r.low<=e.lim&&e.lim<=r.lim,el=Du,rl=t=>{(t=>{var e;const r={};let n;const i=e=>{var o;const s=t.node(e);if(!s)return 0;if(r[e])return s.rank;let a;return r[e]=!0,null===(o=t.outEdges(e))||void 0===o||o.forEach(e=>{const r=i(e.w)-t.edge(e).minlen;r&&(void 0===a||r<a)&&(a=r)}),a||(a=0),(void 0===n||a<n)&&(n=a),s.rank=a,a};null===(e=t.sources())||void 0===e||e.forEach(e=>{t.node(e)&&i(e)}),void 0===n&&(n=0);const o={},s=(e,r)=>{var n;const i=t.node(e),a=isNaN(i.layer)?r:i.layer;(void 0===i.rank||i.rank<a)&&(i.rank=a),o[e]||(o[e]=!0,null===(n=t.outEdges(e))||void 0===n||n.map(e=>{s(e.w,a+t.edge(e).minlen)}))};t.nodes().forEach(e=>{const r=t.node(e);r&&(isNaN(r.layer)?r.rank-=n:s(e,r.layer))})})(t),(t=>{const e=new xu({directed:!1}),r=t.nodes()[0],n=t.nodes().filter(e=>!!t.node(e)).length;let i,o;for(e.setNode(r,{});Fu(e,t)<n;)i=ku(e,t),o=e.hasNode(i.v)?Uu(t,i):-Uu(t,i),Gu(e,t,o)})(t)},nl=t=>{Xu(t)},il=t=>{var e;const r=(t=>{var e;const r={};let n=0;const i=e=>{var o;const s=n;null===(o=t.children(e))||void 0===o||o.forEach(i),r[e]={low:s,lim:n++}};return null===(e=t.children())||void 0===e||e.forEach(i),r})(t);null===(e=t.graph().dummyChains)||void 0===e||e.forEach(e=>{var n,i;let o=e,s=t.node(o);const a=s.edgeObj;if(!a)return;const h=((t,e,r,n)=>{const i=[],o=[],s=Math.min(e[r].low,e[n].low),a=Math.max(e[r].lim,e[n].lim);let h,u;h=r;do{h=t.parent(h),i.push(h)}while(h&&(e[h].low>s||a>e[h].lim));for(u=h,h=n;h&&h!==u;)o.push(h),h=t.parent(h);return{lca:u,path:i.concat(o.reverse())}})(t,r,a.v,a.w),u=h.path,l=h.lca;let c=0,d=u[c],f=!0;for(;o!==a.w;){if(s=t.node(o),f){for(;d!==l&&(null===(n=t.node(d))||void 0===n?void 0:n.maxRank)<s.rank;)c++,d=u[c];d===l&&(f=!1)}if(!f){for(;c<u.length-1&&(null===(i=t.node(u[c+1]))||void 0===i?void 0:i.minRank)<=s.rank;)c++;d=u[c]}t.setParent(o,d),o=t.successors(o)[0]}})},ol=(t,e,r,n,i,o,s)=>{const a=t.children(s);if(!(null==a?void 0:a.length))return void(s!==e&&t.setEdge(e,s,{weight:0,minlen:r}));const h=Ou(t,"_bt"),u=Ou(t,"_bb"),l=t.node(s);t.setParent(h,s),l.borderTop=h,t.setParent(u,s),l.borderBottom=u,null==a||a.forEach(a=>{ol(t,e,r,n,i,o,a);const l=t.node(a),c=l.borderTop?l.borderTop:a,d=l.borderBottom?l.borderBottom:a,f=l.borderTop?n:2*n,p=c!==d?1:i-o[s]+1;t.setEdge(h,c,{minlen:p,weight:f,nestingEdge:!0}),t.setEdge(d,u,{minlen:p,weight:f,nestingEdge:!0})}),t.parent(s)||t.setEdge(e,h,{weight:0,minlen:i+o[s]})},sl=t=>{var e;const r={},n=(e,i)=>{const o=t.children(e);null==o||o.forEach(t=>n(t,i+1)),r[e]=i};return null===(e=t.children())||void 0===e||e.forEach(t=>n(t,1)),r},al=t=>{let e=0;return t.edges().forEach(r=>{e+=t.edge(r).weight}),e};var hl=t=>{var e;const r=Tu(t,"root",{},"_root"),n=sl(t);let i=Math.max(...Object.values(n));Math.abs(i)===1/0&&(i=1);const o=i-1,s=2*o+1;t.graph().nestingRoot=r,t.edges().forEach(e=>{t.edge(e).minlen*=s});const a=al(t)+1;null===(e=t.children())||void 0===e||e.forEach(e=>{ol(t,r,s,a,o,n,e)}),t.graph().nodeRankFactor=s},ul=t=>{const e=t.graph();e.nestingRoot&&t.removeNode(e.nestingRoot),delete e.nestingRoot,t.edges().forEach(e=>{t.edge(e).nestingEdge&&t.removeEdgeObj(e)})};const ll=(t,e,r,n,i,o)=>{const s={rank:o,borderType:e,width:0,height:0},a=i[e][o-1],h=Tu(t,"border",s,r);i[e][o]=h,t.setParent(h,n),a&&t.setEdge(a,h,{weight:1})},cl=t=>{t.nodes().forEach(e=>{dl(t.node(e))}),t.edges().forEach(e=>{dl(t.edge(e))})},dl=t=>{const e=t.width;t.width=t.height,t.height=e},fl=t=>{t.nodes().forEach(e=>{pl(t.node(e))}),t.edges().forEach(e=>{var r;const n=t.edge(e);null===(r=n.points)||void 0===r||r.forEach(t=>pl(t)),n.hasOwnProperty("y")&&pl(n)})},pl=t=>{(null==t?void 0:t.y)&&(t.y=-t.y)},ml=t=>{t.nodes().forEach(e=>{gl(t.node(e))}),t.edges().forEach(e=>{var r;const n=t.edge(e);null===(r=n.points)||void 0===r||r.forEach(t=>gl(t)),n.hasOwnProperty("x")&&gl(n)})},gl=t=>{const e=t.x;t.x=t.y,t.y=e};var vl=t=>{var e;const r=null===(e=t.graph().rankdir)||void 0===e?void 0:e.toLowerCase();"lr"!==r&&"rl"!==r||cl(t)},yl=t=>{var e;const r=null===(e=t.graph().rankdir)||void 0===e?void 0:e.toLowerCase();"bt"!==r&&"rl"!==r||fl(t),"lr"!==r&&"rl"!==r||(ml(t),cl(t))};const bl=t=>{const e={},r=t.nodes().filter(e=>{var r;return!(null===(r=t.children(e))||void 0===r?void 0:r.length)}),n=r.map(e=>t.node(e).rank),i=Math.max(...n),o=[];for(let t=0;t<i+1;t++)o.push([]);const s=r=>{var n;if(e.hasOwnProperty(r))return;e[r]=!0;const i=t.node(r);isNaN(i.rank)||o[i.rank].push(r),null===(n=t.successors(r))||void 0===n||n.forEach(t=>s(t))},a=r.sort((e,r)=>t.node(e).rank-t.node(r).rank),h=a.filter(e=>void 0!==t.node(e).fixorder).sort((e,r)=>t.node(e).fixorder-t.node(r).fixorder);return null==h||h.forEach(r=>{isNaN(t.node(r).rank)||o[t.node(r).rank].push(r),e[r]=!0}),null==a||a.forEach(s),o},_l=(t,e,r)=>{const n=(i=r,o=r.map((t,e)=>e),null==i?void 0:i.reduce((t,e,r)=>(t[e]=o[r],t),{}));var i,o;const s=e.map(e=>{var r;const i=null===(r=t.outEdges(e))||void 0===r?void 0:r.map(e=>({pos:n[e.w]||0,weight:t.edge(e).weight}));return null==i?void 0:i.sort((t,e)=>t.pos-e.pos)}).flat().filter(t=>void 0!==t);let a=1;for(;a<r.length;)a<<=1;const h=2*a-1;a-=1;const u=Array(h).fill(0,0,h);let l=0;return null==s||s.forEach(t=>{if(t){let e=t.pos+a;u[e]+=t.weight;let r=0;for(;e>0;)e%2&&(r+=u[e+1]),e=e-1>>1,u[e]+=t.weight;l+=t.weight*r}}),l},El=(t,e)=>{let r=0;for(let n=1;n<(null==e?void 0:e.length);n+=1)r+=_l(t,e[n-1],e[n]);return r},xl=t=>{let e;for(;t.hasNode(e="_root"+Math.random()););return e},Tl=t=>{var e,r;const n=[];for(;null==t?void 0:t.length;){const i=t.pop();n.push(i),null===(e=i.in.reverse())||void 0===e||e.forEach(t=>{return(e=i,t=>{t.merged||(void 0===t.barycenter||void 0===e.barycenter||t.barycenter>=e.barycenter)&&wl(e,t)})(t);var e}),null===(r=i.out)||void 0===r||r.forEach(e=>{return(r=i,e=>{e.in.push(r),0==--e.indegree&&t.push(e)})(e);var r})}const i=n.filter(t=>!t.merged),o=["vs","i","barycenter","weight"];return i.map(t=>{const e={};return null==o||o.forEach(r=>{void 0!==t[r]&&(e[r]=t[r])}),e})},wl=(t,e)=>{var r;let n=0,i=0;t.weight&&(n+=t.barycenter*t.weight,i+=t.weight),e.weight&&(n+=e.barycenter*e.weight,i+=e.weight),t.vs=null===(r=e.vs)||void 0===r?void 0:r.concat(t.vs),t.barycenter=n/i,t.weight=i,t.i=Math.min(e.i,t.i),e.merged=!0},Al=(t,e,r)=>{let n,i=r;for(;e.length&&(n=e[e.length-1]).i<=i;)e.pop(),null==t||t.push(n.vs),i++;return i},Sl=(t,e)=>(r,n)=>{if(void 0!==r.fixorder&&void 0!==n.fixorder)return r.fixorder-n.fixorder;if(r.barycenter<n.barycenter)return-1;if(r.barycenter>n.barycenter)return 1;if(e&&void 0!==r.order&&void 0!==n.order){if(r.order<n.order)return-1;if(r.order>n.order)return 1}return t?n.i-r.i:r.i-n.i},Ol=(t,e,r,n,i)=>{var o,s,a,h;let u=t.children(e);const l=t.node(e),c=l?l.borderLeft:void 0,d=l?l.borderRight:void 0,f={};c&&(u=null==u?void 0:u.filter(t=>t!==c&&t!==d));const p=((t,e)=>e.map(e=>{const r=t.inEdges(e);if(!(null==r?void 0:r.length))return{v:e};{const n={sum:0,weight:0};return null==r||r.forEach(e=>{const r=t.edge(e),i=t.node(e.v);n.sum+=r.weight*i.order,n.weight+=r.weight}),{v:e,barycenter:n.sum/n.weight,weight:n.weight}}}))(t,u||[]);null==p||p.forEach(e=>{var i;if(null===(i=t.children(e.v))||void 0===i?void 0:i.length){const i=Ol(t,e.v,r,n);f[e.v]=i,i.hasOwnProperty("barycenter")&&Rl(e,i)}});const m=((t,e)=>{var r,n,i;const o={};null==t||t.forEach((t,e)=>{o[t.v]={i:e,indegree:0,in:[],out:[],vs:[t.v]};const r=o[t.v];void 0!==t.barycenter&&(r.barycenter=t.barycenter,r.weight=t.weight)}),null===(r=e.edges())||void 0===r||r.forEach(t=>{const e=o[t.v],r=o[t.w];void 0!==e&&void 0!==r&&(r.indegree++,e.out.push(o[t.w]))});const s=null===(i=(n=Object.values(o)).filter)||void 0===i?void 0:i.call(n,t=>!t.indegree);return Tl(s)})(p,r);Il(m,f),null===(o=m.filter(t=>t.vs.length>0))||void 0===o||o.forEach(e=>{const r=t.node(e.vs[0]);r&&(e.fixorder=r.fixorder,e.order=r.order)});const g=((t,e,r)=>{const n=((t,e)=>{const r={lhs:[],rhs:[]};return null==t||t.forEach(t=>{e(t)?r.lhs.push(t):r.rhs.push(t)}),r})(t,t=>t.hasOwnProperty("fixorder")&&!isNaN(t.fixorder)||t.hasOwnProperty("barycenter")),i=n.lhs,o=n.rhs.sort((t,e)=>-t.i- -e.i),s=[];let a=0,h=0,u=0;null==i||i.sort(Sl(!!e,!!r)),u=Al(s,o,u),null==i||i.forEach(t=>{var e;u+=null===(e=t.vs)||void 0===e?void 0:e.length,s.push(t.vs),a+=t.barycenter*t.weight,h+=t.weight,u=Al(s,o,u)});const l={vs:s.flat()};return h&&(l.barycenter=a/h,l.weight=h),l})(m,n,i);if(c&&(g.vs=[c,g.vs,d].flat(),null===(s=t.predecessors(c))||void 0===s?void 0:s.length)){const e=t.node((null===(a=t.predecessors(c))||void 0===a?void 0:a[0])||""),r=t.node((null===(h=t.predecessors(d))||void 0===h?void 0:h[0])||"");g.hasOwnProperty("barycenter")||(g.barycenter=0,g.weight=0),g.barycenter=(g.barycenter*g.weight+e.order+r.order)/(g.weight+2),g.weight+=2}return g},Il=(t,e)=>{null==t||t.forEach(t=>{var r;const n=null===(r=t.vs)||void 0===r?void 0:r.map(t=>e[t]?e[t].vs:t);t.vs=n.flat()})},Rl=(t,e)=>{void 0!==t.barycenter?(t.barycenter=(t.barycenter*t.weight+e.barycenter*e.weight)/(t.weight+e.weight),t.weight+=e.weight):(t.barycenter=e.barycenter,t.weight=e.weight)},Nl=(t,e,r)=>e.map(e=>((t,e,r)=>{const n=xl(t),i=new xu({compound:!0}).setGraph({root:n}).setDefaultNodeLabel(e=>t.node(e));return t.nodes().forEach(o=>{var s;const a=t.node(o),h=t.parent(o);(a.rank===e||a.minRank<=e&&e<=a.maxRank)&&(i.setNode(o),i.setParent(o,h||n),null===(s=t[r](o))||void 0===s||s.forEach(e=>{const r=e.v===o?e.w:e.v,n=i.edgeFromArgs(r,o),s=void 0!==n?n.weight:0;i.setEdge(r,o,{weight:t.edge(e).weight+s})}),a.hasOwnProperty("minRank")&&i.setNode(o,{borderLeft:a.borderLeft[e],borderRight:a.borderRight[e]}))}),i})(t,e,r)),Ll=(t,e,r)=>{const n=new xu;null==t||t.forEach(t=>{var i;const o=t.graph().root,s=Ol(t,o,n,e,r);for(let e=0;e<(null===(i=s.vs)||void 0===i?void 0:i.length);e++){const r=t.node(s.vs[e]);r&&(r.order=e)}((t,e,r)=>{const n={};let i;null==r||r.forEach(r=>{let o,s,a=t.parent(r);for(;a;){if(o=t.parent(a),o?(s=n[o],n[o]=a):(s=i,i=a),s&&s!==a)return void e.setEdge(s,a);a=o}})})(t,n,s.vs)})},Ml=(t,e)=>{null==e||e.forEach(e=>{null==e||e.forEach((e,r)=>{t.node(e).order=r})})};class Pl extends Hh{}const Cl=(t,e)=>{var r,n;if(null===(r=t.node(e))||void 0===r?void 0:r.dummy)return null===(n=t.predecessors(e))||void 0===n?void 0:n.find(e=>t.node(e).dummy)},Dl=(t,e,r)=>{let n=e,i=r;if(n>i){const t=n;n=i,i=t}let o=t[n];o||(t[n]=o={}),o[i]=!0},Ul=(t,e,r)=>{let n=e,i=r;if(n>r){n=r,i=e}return!!t[n]},Bl=(t,e,r,n)=>{const i=new Pl,o=t.graph(),s=Fl(o.nodesep,o.edgesep,n);return null==e||e.forEach(e=>{let n;null==e||e.forEach(e=>{const o=r[e];if(i.setNode(o),n){const a=r[n],h=i.edgeFromArgs(a,o);i.setEdge(a,o,Math.max(s(t,e,n),h||0))}n=e})}),i};const Fl=(t,e,r)=>(n,i,o)=>{const s=n.node(i),a=n.node(o);let h,u=0;if(u+=s.width/2,s.hasOwnProperty("labelpos"))switch((s.labelpos||"").toLowerCase()){case"l":h=-s.width/2;break;case"r":h=s.width/2}if(h&&(u+=r?h:-h),h=0,u+=(s.dummy?e:t)/2,u+=(a.dummy?e:t)/2,u+=a.width/2,a.labelpos)switch((a.labelpos||"").toLowerCase()){case"l":h=a.width/2;break;case"r":h=-a.width/2}return h&&(u+=r?h:-h),h=0,u},kl=(t,e)=>t.node(e).width||0,Gl=t=>{const e=Su(t),r=Object.assign(((t,e)=>{const r={},n=(e,n)=>{let i=0,o=0;const s=e.length,a=null==n?void 0:n[(null==n?void 0:n.length)-1];return null==n||n.forEach((e,h)=>{var u;const l=Cl(t,e),c=l?t.node(l).order:s;(l||e===a)&&(null===(u=n.slice(o,h+1))||void 0===u||u.forEach(e=>{var n;null===(n=t.predecessors(e))||void 0===n||n.forEach(n=>{var o;const s=t.node(n),a=s.order;!(a<i||c<a)||s.dummy&&(null===(o=t.node(e))||void 0===o?void 0:o.dummy)||Dl(r,n,e)})}),o=h+1,i=c)}),n};return(null==e?void 0:e.length)&&e.reduce(n),r})(t,e),((t,e)=>{const r={},n=(e,n,i,o,s)=>{let a;const h=[];for(let t=n;t<i;t++)h.push(t);h.forEach(n=>{var i,h;a=e[n],(null===(i=t.node(a))||void 0===i?void 0:i.dummy)&&(null===(h=t.predecessors(a))||void 0===h||h.forEach(e=>{const n=t.node(e);n.dummy&&(n.order<o||n.order>s)&&Dl(r,e,a)}))})},i=(e,r)=>{let i,o=-1,s=0;return null==r||r.forEach((a,h)=>{var u;if("border"===(null===(u=t.node(a))||void 0===u?void 0:u.dummy)){const e=t.predecessors(a)||[];e.length&&(i=t.node(e[0]).order,n(r,s,h,o,i),s=h,o=i)}n(r,s,r.length,i,e.length)}),r};return(null==e?void 0:e.length)&&e.reduce(i),r})(t,e)),n={};let i=[];["u","d"].forEach(o=>{i="u"===o?e:Object.values(e).reverse(),["l","r"].forEach(e=>{"r"===e&&(i=i.map(t=>Object.values(t).reverse()));const s=("u"===o?t.predecessors:t.successors).bind(t),a=((t,e,r,n)=>{const i={},o={},s={};return null==e||e.forEach(t=>{null==t||t.forEach((t,e)=>{i[t]=t,o[t]=t,s[t]=e})}),null==e||e.forEach(t=>{let e=-1;null==t||t.forEach(t=>{let a=n(t);if(a.length){a=a.sort((t,e)=>s[t]-s[e]);const n=(a.length-1)/2;for(let h=Math.floor(n),u=Math.ceil(n);h<=u;++h){const n=a[h];o[t]===t&&e<s[n]&&!Ul(r,t,n)&&(o[n]=t,o[t]=i[t]=i[n],e=s[n])}}})}),{root:i,align:o}})(0,i,r,s),h=((t,e,r,n,i)=>{var o;const s={},a=Bl(t,e,r,i),h=i?"borderLeft":"borderRight",u=(t,e)=>{let r=a.nodes(),n=r.pop();const i={};for(;n;)i[n]?t(n):(i[n]=!0,r.push(n),r=r.concat(e(n))),n=r.pop()};return u(t=>{s[t]=(a.inEdges(t)||[]).reduce((t,e)=>Math.max(t,(s[e.v]||0)+a.edge(e)),0)},a.predecessors.bind(a)),u(e=>{const r=(a.outEdges(e)||[]).reduce((t,e)=>Math.min(t,(s[e.w]||0)-a.edge(e)),Number.POSITIVE_INFINITY),n=t.node(e);r!==Number.POSITIVE_INFINITY&&n.borderType!==h&&(s[e]=Math.max(s[e],r))},a.successors.bind(a)),null===(o=Object.values(n))||void 0===o||o.forEach(t=>{s[t]=s[r[t]]}),s})(t,i,a.root,a.align,"r"===e);"r"===e&&Object.keys(h).forEach(t=>h[t]=-h[t]),n[o+e]=h})});const o=((t,e)=>Lu(Object.values(e),e=>{var r;let n=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return null===(r=Object.keys(e))||void 0===r||r.forEach(r=>{const o=e[r],s=kl(t,r)/2;n=Math.max(o+s,n),i=Math.min(o-s,i)}),n-i}))(t,n);return o&&function(t,e){const r=Object.values(e),n=Math.min(...r),i=Math.max(...r);["u","d"].forEach(r=>{["l","r"].forEach(o=>{const s=r+o,a=t[s];let h;if(a===e)return;const u=Object.values(a);h="l"===o?n-Math.min(...u):i-Math.max(...u),h&&(t[s]={},Object.keys(a).forEach(e=>{t[s][e]=a[e]+h}))})})}(n,o),((t,e)=>{const r={};return Object.keys(t.ul).forEach(n=>{if(e)r[n]=t[e.toLowerCase()][n];else{const e=Object.values(t).map(t=>t[n]);r[n]=(e[0]+e[1])/2}}),r})(n,t.graph().align)},jl=t=>{var e;const r=wu(t);(t=>{const e=Su(t),r=t.graph().ranksep;let n=0;null==e||e.forEach(e=>{const i=e.map(e=>t.node(e).height),o=Math.max(...i,0);null==e||e.forEach(e=>{t.node(e).y=n+o/2}),n+=o+r})})(r);const n=Gl(r);null===(e=Object.keys(n))||void 0===e||e.forEach(t=>{r.node(t).x=n[t]})},Hl=(t,e,r)=>{e("    removeSelfEdges",()=>{uc(t)}),e("    acyclic",()=>{_u(t)}),e("    nestingGraph.run",()=>{hl(t)}),e("    rank",()=>{(t=>{switch(t.graph().ranker){case"network-simplex":nl(t);break;case"tight-tree":rl(t);break;case"longest-path":el(t);break;default:rl(t)}})(wu(t))}),e("    injectEdgeLabelProxies",()=>{ec(t)}),e("    removeEmptyRanks",()=>{(t=>{const e=t.nodes(),r=e.filter(e=>{var r;return void 0!==(null===(r=t.node(e))||void 0===r?void 0:r.rank)}).map(e=>t.node(e).rank),n=Math.min(...r),i=[];e.forEach(e=>{var r;const o=((null===(r=t.node(e))||void 0===r?void 0:r.rank)||0)-n;i[o]||(i[o]=[]),i[o].push(e)});let o=0;const s=t.graph().nodeRankFactor||0;for(let e=0;e<i.length;e++){const r=i[e];void 0===r?e%s!=0&&(o-=1):o&&(null==r||r.forEach(e=>{const r=t.node(e);r&&(r.rank=r.rank||0,r.rank+=o)}))}})(t)}),e("    nestingGraph.cleanup",()=>{ul(t)}),e("    normalizeRanks",()=>{(t=>{const e=t.nodes().filter(e=>{var r;return void 0!==(null===(r=t.node(e))||void 0===r?void 0:r.rank)}).map(e=>t.node(e).rank),r=Math.min(...e);t.nodes().forEach(e=>{const n=t.node(e);n.hasOwnProperty("rank")&&r!==1/0&&(n.rank-=r)})})(t)}),e("    assignRankMinMax",()=>{rc(t)}),e("    removeEdgeLabelProxies",()=>{nc(t)}),e("    normalize.run",()=>{Pu(t)}),e("    parentDummyChains",()=>{il(t)}),e("    addBorderSegments",()=>{(t=>{var e;const r=e=>{const n=t.children(e),i=t.node(e);if((null==n?void 0:n.length)&&n.forEach(t=>r(t)),i.hasOwnProperty("minRank")){i.borderLeft=[],i.borderRight=[];for(let r=i.minRank,n=i.maxRank+1;r<n;r+=1)ll(t,"borderLeft","_bl",e,i,r),ll(t,"borderRight","_br",e,i,r)}};null===(e=t.children())||void 0===e||e.forEach(t=>r(t))})(t)}),r&&r.keepNodeOrder&&e("    initDataOrder",()=>{((t,e)=>{const r=t.nodes().filter(e=>{var r;return!(null===(r=t.children(e))||void 0===r?void 0:r.length)}).map(e=>t.node(e).rank),n=Math.max(...r),i=Array(n+1).fill([]);null==e||e.forEach(e=>{const r=t.node(e);r&&!(null==r?void 0:r.dummy)&&(isNaN(r.rank)||(r.fixorder=i[r.rank].length,i[r.rank].push(e)))})})(t,r.nodeOrder)}),e("    order",()=>{(t=>{const e=Iu(t),r=[],n=[];for(let t=1;t<e+1;t++)r.push(t);for(let t=e-1;t>-1;t--)n.push(t);const i=Nl(t,r,"inEdges"),o=Nl(t,n,"outEdges");let s=bl(t);Ml(t,s);let a,h=Number.POSITIVE_INFINITY;for(let e=0,r=0;r<4;++e,++r){Ll(e%2?i:o,e%4>=2),s=Su(t);const n=El(t,s);n<h&&(r=0,a=mh(s),h=n)}s=bl(t),Ml(t,s);for(let e=0,r=0;r<4;++e,++r){Ll(e%2?i:o,e%4>=2,!0),s=Su(t);const n=El(t,s);n<h&&(r=0,a=mh(s),h=n)}Ml(t,a)})(t)}),e("    insertSelfEdges",()=>{lc(t)}),e("    adjustCoordinateSystem",()=>{vl(t)}),e("    position",()=>{jl(t)}),e("    positionSelfEdges",()=>{cc(t)}),e("    removeBorderNodes",()=>{hc(t)}),e("    normalize.undo",()=>{Cu(t)}),e("    fixupEdgeLabelCoords",()=>{sc(t)}),e("    undoCoordinateSystem",()=>{yl(t)}),e("    translateGraph",()=>{ic(t)}),e("    assignNodeIntersects",()=>{oc(t)}),e("    reversePoints",()=>{ac(t)}),e("    acyclic.undo",()=>{Eu(t)})},Xl=(t,e)=>{t.nodes().forEach(r=>{const n=t.node(r),i=e.node(r);void 0!==i?(n.fixorder=i._order,delete i._order):delete n.fixorder})},zl=(t,e)=>{t.nodes().forEach(r=>{var n;const i=t.node(r);if(i){const t=e.node(r);i.x=t.x,i.y=t.y,i._order=t.order,i._rank=t.rank,(null===(n=e.children(r))||void 0===n?void 0:n.length)&&(i.width=t.width,i.height=t.height)}}),t.edges().forEach(r=>{const n=t.edge(r),i=e.edge(r);n.points=i?i.points:[],i&&i.hasOwnProperty("x")&&(n.x=i.x,n.y=i.y)}),t.graph().width=e.graph().width,t.graph().height=e.graph().height},Vl=["nodesep","edgesep","ranksep","marginx","marginy"],Wl={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},Yl=["acyclicer","ranker","rankdir","align"],ql=["width","height","layer","fixorder"],Kl={width:0,height:0},Zl=["minlen","weight","width","height","labeloffset"],Jl={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},Ql=["labelpos"],$l=t=>{const e=new xu({multigraph:!0,compound:!0}),r=fc(t.graph()),n={};return null==Yl||Yl.forEach(t=>{void 0!==r[t]&&(n[t]=r[t])}),e.setGraph(Object.assign({},Wl,dc(r,Vl),n)),t.nodes().forEach(r=>{const n=fc(t.node(r)),i=Object.assign(Object.assign({},Kl),n),o=dc(i,ql);e.setNode(r,o),e.setParent(r,t.parent(r))}),t.edges().forEach(r=>{const n=fc(t.edge(r)),i={};null==Ql||Ql.forEach(t=>{void 0!==n[t]&&(i[t]=n[t])}),e.setEdgeObj(r,Object.assign({},Jl,dc(n,Zl),i))}),e},tc=t=>{const e=t.graph();e.ranksep||(e.ranksep=0),e.ranksep/=2,t.nodes().forEach(e=>{const r=t.node(e);isNaN(r.layer)||r.layer||(r.layer=0)}),t.edges().forEach(r=>{var n;const i=t.edge(r);i.minlen*=2,"c"!==(null===(n=i.labelpos)||void 0===n?void 0:n.toLowerCase())&&("TB"===e.rankdir||"BT"===e.rankdir?i.width+=i.labeloffset:i.height+=i.labeloffset)})},ec=t=>{t.edges().forEach(e=>{const r=t.edge(e);if(r.width&&r.height){const r=t.node(e.v),n={e:e,rank:(t.node(e.w).rank-r.rank)/2+r.rank};Tu(t,"edge-proxy",n,"_ep")}})},rc=t=>{let e=0;t.nodes().forEach(r=>{var n,i;const o=t.node(r);o.borderTop&&(o.minRank=null===(n=t.node(o.borderTop))||void 0===n?void 0:n.rank,o.maxRank=null===(i=t.node(o.borderBottom))||void 0===i?void 0:i.rank,e=Math.max(e,o.maxRank||-1/0))}),t.graph().maxRank=e},nc=t=>{t.nodes().forEach(e=>{const r=t.node(e);"edge-proxy"===r.dummy&&(t.edge(r.e).labelRank=r.rank,t.removeNode(e))})},ic=t=>{let e,r,n=0,i=0;const o=t.graph(),s=o.marginx||0,a=o.marginy||0,h=t=>{if(!t)return;const o=t.x,s=t.y,a=t.width,h=t.height;isNaN(o)||isNaN(a)||(void 0===e&&(e=o-a/2),e=Math.min(e,o-a/2),n=Math.max(n,o+a/2)),isNaN(s)||isNaN(h)||(void 0===r&&(r=s-h/2),r=Math.min(r,s-h/2),i=Math.max(i,s+h/2))};t.nodes().forEach(e=>{h(t.node(e))}),t.edges().forEach(e=>{const r=t.edge(e);(null==r?void 0:r.hasOwnProperty("x"))&&h(r)}),e-=s,r-=a,t.nodes().forEach(n=>{const i=t.node(n);i&&(i.x-=e,i.y-=r)}),t.edges().forEach(n=>{var i;const o=t.edge(n);null===(i=o.points)||void 0===i||i.forEach(t=>{t.x-=e,t.y-=r}),o.hasOwnProperty("x")&&(o.x-=e),o.hasOwnProperty("y")&&(o.y-=r)}),o.width=n-e+s,o.height=i-r+a},oc=t=>{t.edges().forEach(e=>{const r=t.edge(e),n=t.node(e.v),i=t.node(e.w);let o,s;r.points?(o=r.points[0],s=r.points[r.points.length-1]):(r.points=[],o=i,s=n),r.points.unshift(Au(n,o)),r.points.push(Au(i,s))})},sc=t=>{t.edges().forEach(e=>{const r=t.edge(e);if(null==r?void 0:r.hasOwnProperty("x"))switch("l"!==r.labelpos&&"r"!==r.labelpos||(r.width-=r.labeloffset),r.labelpos){case"l":r.x-=r.width/2+r.labeloffset;break;case"r":r.x+=r.width/2+r.labeloffset}})},ac=t=>{t.edges().forEach(e=>{var r;const n=t.edge(e);n.reversed&&(null===(r=n.points)||void 0===r||r.reverse())})},hc=t=>{t.nodes().forEach(e=>{var r,n,i;if(null===(r=t.children(e))||void 0===r?void 0:r.length){const r=t.node(e),o=t.node(r.borderTop),s=t.node(r.borderBottom),a=t.node(r.borderLeft[(null===(n=r.borderLeft)||void 0===n?void 0:n.length)-1]),h=t.node(r.borderRight[(null===(i=r.borderRight)||void 0===i?void 0:i.length)-1]);r.width=Math.abs((null==h?void 0:h.x)-(null==a?void 0:a.x))||10,r.height=Math.abs((null==s?void 0:s.y)-(null==o?void 0:o.y))||10,r.x=((null==a?void 0:a.x)||0)+r.width/2,r.y=((null==o?void 0:o.y)||0)+r.height/2}}),t.nodes().forEach(e=>{var r;"border"===(null===(r=t.node(e))||void 0===r?void 0:r.dummy)&&t.removeNode(e)})},uc=t=>{t.edges().forEach(e=>{if(e.v===e.w){const r=t.node(e.v);r.selfEdges||(r.selfEdges=[]),r.selfEdges.push({e:e,label:t.edge(e)}),t.removeEdgeObj(e)}})},lc=t=>{const e=Su(t);null==e||e.forEach(e=>{let r=0;null==e||e.forEach((e,n)=>{var i;const o=t.node(e);o.order=n+r,null===(i=o.selfEdges)||void 0===i||i.forEach(e=>{Tu(t,"selfedge",{width:e.label.width,height:e.label.height,rank:o.rank,order:n+ ++r,e:e.e,label:e.label},"_se")}),delete o.selfEdges})})},cc=t=>{t.nodes().forEach(e=>{const r=t.node(e);if("selfedge"===r.dummy){const n=t.node(r.e.v),i=n.x+n.width/2,o=n.y,s=r.x-i,a=n.height/2;t.setEdgeObj(r.e,r.label),t.removeNode(e),r.label.points=[{x:i+2*s/3,y:o-a},{x:i+5*s/6,y:o-a},{y:o,x:i+s},{x:i+5*s/6,y:o+a},{x:i+2*s/3,y:o+a}],r.label.x=r.x,r.label.y=r.y}})},dc=(t,e)=>{const r={};return null==e||e.forEach(e=>{void 0!==t[e]&&(r[e]=+t[e])}),r},fc=(t={})=>{const e={};return Object.keys(t).forEach(r=>{e[r.toLowerCase()]=t[r]}),e};var pc,mc,gc,vc,yc,bc=(t,e)=>{const r=e&&e.debugTiming?Ru:Nu;r("layout",()=>{e&&!e.keepNodeOrder&&e.prevGraph&&r("  inheritOrder",()=>{Xl(t,e.prevGraph)});const n=r("  buildLayoutGraph",()=>$l(t));e&&!1===e.edgeLabelSpace||r("  makeSpaceForEdgeLabels",()=>{tc(n)});try{r("  runLayout",()=>{Hl(n,r,e)})}catch(t){if("Not possible to find intersection inside of the rectangle"===t.message)return void console.error("The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:\n",t);throw t}r("  updateInputGraph",()=>{zl(t,n)})})};class _c extends lh{constructor(t){super(),this.rankdir="TB",this.nodesep=50,this.ranksep=50,this.controlPoints=!1,this.sortByCombo=!1,this.edgeLabelSpace=!0,this.radial=!1,this.nodes=[],this.edges=[],this.onLayoutEnd=()=>{},this.layoutNode=t=>{const{nodes:e}=this,r=e.find(e=>e.id===t);if(r){return!1!==r.layout}return!0},this.updateCfg(t)}getDefaultCfg(){return{rankdir:"TB",align:void 0,nodeSize:void 0,nodesepFunc:void 0,ranksepFunc:void 0,nodesep:50,ranksep:50,controlPoints:!1,radial:!1,focusNode:null}}execute(){var t,e,r;const n=this,{nodes:i,nodeSize:o,rankdir:s,combos:a,begin:h,radial:u,comboEdges:l=[],vedges:c=[]}=n;if(!i)return;const d=n.edges||[],f=new xu({multigraph:!0,compound:!0}),p={};let m;i.forEach(t=>{t.comboId&&(p[t.comboId]=p[t.comboId]||[],p[t.comboId].push(t.id))}),m=o?dh(o)?()=>o:()=>[o,o]:t=>t.size?dh(t.size)?t.size:ph(t.size)?[t.size.width||40,t.size.height||40]:[t.size,t.size]:[40,40];const g=bh(n.ranksep,50,n.ranksepFunc),v=bh(n.nodesep,50,n.nodesepFunc);let y=v,b=g;"LR"!==s&&"RL"!==s||(y=g,b=v),f.setDefaultEdgeLabel(()=>({})),f.setGraph(n);const _={};this.sortByCombo&&a&&a.forEach(t=>{if(_[t.id]=t,t.collapsed){const e=m(t),r=b(t),n=y(t),i=e[0]+2*n,o=e[1]+2*r;f.setNode(t.id,{width:i,height:o})}t.parentId&&(_[t.parentId]||f.setNode(t.parentId,{}),f.setParent(t.id,t.parentId))}),i.filter(t=>!1!==t.layout).forEach(t=>{const e=m(t),r=b(t),n=y(t),i=e[0]+2*n,o=e[1]+2*r,s=t.layer;fh(s)?f.setNode(t.id,{width:i,height:o,layer:s}):f.setNode(t.id,{width:i,height:o}),this.sortByCombo&&t.comboId&&(_[t.comboId]||(_[t.comboId]={id:t.comboId},f.setNode(t.comboId,{})),f.setParent(t.id,t.comboId))}),d.forEach(t=>{const e=gh(t,"source"),r=gh(t,"target");this.layoutNode(e)&&this.layoutNode(r)&&f.setEdge(e,r,{weight:t.weight||1})}),null===(t=null==l?void 0:l.concat(c||[]))||void 0===t||t.forEach(t=>{var e,r;const{source:n,target:i}=t,o=(null===(e=_[n])||void 0===e?void 0:e.collapsed)?[n]:p[n]||[n],s=(null===(r=_[i])||void 0===r?void 0:r.collapsed)?[i]:p[i]||[i];o.forEach(e=>{s.forEach(r=>{f.setEdge(e,r,{weight:t.weight||1})})})});let E=void 0;(null===(e=n.preset)||void 0===e?void 0:e.nodes)&&(E=new xu({multigraph:!0,compound:!0}),n.preset.nodes.forEach(t=>{null==E||E.setNode(t.id,t)})),bc(f,{prevGraph:E,edgeLabelSpace:n.edgeLabelSpace,keepNodeOrder:Boolean(!!n.nodeOrder),nodeOrder:n.nodeOrder});const x=[0,0];if(h){let t=1/0,e=1/0;f.nodes().forEach(r=>{const n=f.node(r);t>n.x&&(t=n.x),e>n.y&&(e=n.y)}),f.edges().forEach(r=>{var n;null===(n=f.edge(r).points)||void 0===n||n.forEach(r=>{t>r.x&&(t=r.x),e>r.y&&(e=r.y)})}),x[0]=h[0]-t,x[1]=h[1]-e}if(u){const{focusNode:t,ranksep:e,getRadialPos:o}=this,a=ch(t)?t:null==t?void 0:t.id,h=a?null===(r=f.node(a))||void 0===r?void 0:r._rank:0,u=[],l="LR"===s||"RL"===s,c=l?"y":"x",p=l?"height":"width";let m=1/0,y=-1/0;f.nodes().forEach(t=>{const e=f.node(t),r=i.findIndex(e=>e.id===t);if(!i[r])return;const n=v(i[r]);if(0===h)u[e._rank]||(u[e._rank]={nodes:[],totalWidth:0,maxSize:-1/0}),u[e._rank].nodes.push(t),u[e._rank].totalWidth+=2*n+e[p],u[e._rank].maxSize<Math.max(e.width,e.height)&&(u[e._rank].maxSize=Math.max(e.width,e.height));else{const r=e._rank-h;if(0===r)u[r]||(u[r]={nodes:[],totalWidth:0,maxSize:-1/0}),u[r].nodes.push(t),u[r].totalWidth+=2*n+e[p],u[r].maxSize<Math.max(e.width,e.height)&&(u[r].maxSize=Math.max(e.width,e.height));else{const i=Math.abs(r);u[i]||(u[i]={left:[],right:[],totalWidth:0,maxSize:-1/0}),u[i].totalWidth+=2*n+e[p],u[i].maxSize<Math.max(e.width,e.height)&&(u[i].maxSize=Math.max(e.width,e.height)),r<0?u[i].left.push(t):u[i].right.push(t)}}const o=e[c]-e[p]/2-n,s=e[c]+e[p]/2+n;o<m&&(m=o),s>y&&(y=s)});let b=e||50;const _={},E=(y-m)/.9,T=[.5*(m+y-E),.5*(m+y+E)],w=(t,e,r=-1/0,n=[0,1])=>{let s=r;return t.forEach(t=>{const r=f.node(t);_[t]=e;const{x:a,y:h}=o(r[c],T,E,e,n),u=i.findIndex(e=>e.id===t);if(!i[u])return;i[u].x=a+x[0],i[u].y=h+x[1],i[u]._order=r._order;const l=g(i[u]);s<l&&(s=l)}),s};let A=!0;u.forEach(t=>{var e,r,n,o,s,a,u;if(!(null===(e=null==t?void 0:t.nodes)||void 0===e?void 0:e.length)&&!(null===(r=null==t?void 0:t.left)||void 0===r?void 0:r.length)&&!(null===(n=null==t?void 0:t.right)||void 0===n?void 0:n.length))return;if(A&&1===t.nodes.length){const e=i.findIndex(e=>e.id===t.nodes[0]);if(e<=-1)return;return i[e].x=x[0],i[e].y=x[1],_[t.nodes[0]]=0,b=g(i[e]),void(A=!1)}b=Math.max(b,t.totalWidth/(2*Math.PI));let l=-1/0;if(0===h||(null===(o=t.nodes)||void 0===o?void 0:o.length))l=w(t.nodes,b,l,[0,1]);else{const e=(null===(s=t.left)||void 0===s?void 0:s.length)/((null===(a=t.left)||void 0===a?void 0:a.length)+(null===(u=t.right)||void 0===u?void 0:u.length));l=w(t.left,b,l,[0,e]),l=w(t.right,b,l,[e+.05,1])}b+=l,A=!1,t.maxSize}),f.edges().forEach(t=>{var e,r,i;const s=f.edge(t),a=d.findIndex(e=>{const r=gh(e,"source"),n=gh(e,"target");return r===t.v&&n===t.w});if(!(a<=-1)&&n.edgeLabelSpace&&n.controlPoints&&"loop"!==d[a].type){const n="x"===c?"y":"x",h=null===(e=null==s?void 0:s.points)||void 0===e?void 0:e.slice(1,s.points.length-1),u=[],l=null===(r=f.node(t.v))||void 0===r?void 0:r[n],p=l-(null===(i=f.node(t.w))||void 0===i?void 0:i[n]),m=_[t.v],g=m-_[t.w];null==h||h.forEach(t=>{const e=(t[n]-l)/p*g+m,r=o(t[c],T,E,e);u.push({x:r.x+x[0],y:r.y+x[1]})}),d[a].controlPoints=u}})}else f.nodes().forEach(t=>{const e=f.node(t);if(!e)return;let r=i.find(e=>e.id===t);r||(r=null==a?void 0:a.find(e=>e.id===t)),r&&(r.x=e.x+x[0],r.y=e.y+x[1],r._order=e._order)}),f.edges().forEach(t=>{var e;const r=f.edge(t),i=d.findIndex(e=>{const r=gh(e,"source"),n=gh(e,"target");return r===t.v&&n===t.w});i<=-1||n.edgeLabelSpace&&n.controlPoints&&"loop"!==d[i].type&&(d[i].controlPoints=null===(e=null==r?void 0:r.points)||void 0===e?void 0:e.slice(1,r.points.length-1),d[i].controlPoints.forEach(t=>{t.x+=x[0],t.y+=x[1]}))});return n.onLayoutEnd&&n.onLayoutEnd(),{nodes:i,edges:d}}getRadialPos(t,e,r,n,i=[0,1]){let o=(t-e[0])/r;o=o*(i[1]-i[0])+i[0];const s=2*o*Math.PI;return{x:Math.cos(s)*n,y:Math.sin(s)*n}}getType(){return"dagre"}}(yc=pc||(pc={}))[yc.META=0]="META",yc[yc.NODE=1]="NODE",yc[yc.BRIDGE=2]="BRIDGE",function(t){t[t.INCLUDE=0]="INCLUDE",t[t.EXCLUDE=1]="EXCLUDE",t[t.UNSPECIFIED=2]="UNSPECIFIED"}(mc||(mc={})),function(t){t[t.META=0]="META",t[t.CORE=1]="CORE",t[t.BRIDGE=2]="BRIDGE"}(gc||(gc={})),function(t){t[t.META=0]="META",t[t.OP=1]="OP",t[t.SERIES=2]="SERIES"}(vc||(vc={}));var Ec="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function xc(t,e){return t(e={exports:{}},e.exports),e.exports}var Tc=function(t,e){return t===e||t!=t&&e!=e},wc=function(t,e){for(var r=t.length;r--;)if(Tc(t[r][0],e))return r;return-1},Ac=Array.prototype.splice;function Sc(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Sc.prototype.clear=function(){this.__data__=[],this.size=0},Sc.prototype.delete=function(t){var e=this.__data__,r=wc(e,t);return!(r<0||(r==e.length-1?e.pop():Ac.call(e,r,1),--this.size,0))},Sc.prototype.get=function(t){var e=this.__data__,r=wc(e,t);return r<0?void 0:e[r][1]},Sc.prototype.has=function(t){return wc(this.__data__,t)>-1},Sc.prototype.set=function(t,e){var r=this.__data__,n=wc(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};var Oc,Ic=Sc,Rc="object"==typeof Ec&&Ec&&Ec.Object===Object&&Ec,Nc="object"==typeof self&&self&&self.Object===Object&&self,Lc=Rc||Nc||Function("return this")(),Mc=Lc.Symbol,Pc=Object.prototype,Cc=Pc.hasOwnProperty,Dc=Pc.toString,Uc=Mc?Mc.toStringTag:void 0,Bc=Object.prototype.toString,Fc=Mc?Mc.toStringTag:void 0,kc=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":Fc&&Fc in Object(t)?function(t){var e=Cc.call(t,Uc),r=t[Uc];try{t[Uc]=void 0;var n=!0}catch(t){}var i=Dc.call(t);return n&&(e?t[Uc]=r:delete t[Uc]),i}(t):function(t){return Bc.call(t)}(t)},Gc=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},jc=function(t){if(!Gc(t))return!1;var e=kc(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},Hc=Lc["__core-js_shared__"],Xc=(Oc=/[^.]+$/.exec(Hc&&Hc.keys&&Hc.keys.IE_PROTO||""))?"Symbol(src)_1."+Oc:"",zc=Function.prototype.toString,Vc=function(t){if(null!=t){try{return zc.call(t)}catch(t){}try{return t+""}catch(t){}}return""},Wc=/^\[object .+?Constructor\]$/,Yc=Function.prototype,qc=Object.prototype,Kc=Yc.toString,Zc=qc.hasOwnProperty,Jc=RegExp("^"+Kc.call(Zc).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Qc=function(t){return!(!Gc(t)||function(t){return!!Xc&&Xc in t}(t))&&(jc(t)?Jc:Wc).test(Vc(t))},$c=function(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return Qc(r)?r:void 0},td=$c(Lc,"Map"),ed=$c(Object,"create"),rd=Object.prototype.hasOwnProperty,nd=Object.prototype.hasOwnProperty;function id(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}id.prototype.clear=function(){this.__data__=ed?ed(null):{},this.size=0},id.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},id.prototype.get=function(t){var e=this.__data__;if(ed){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return rd.call(e,t)?e[t]:void 0},id.prototype.has=function(t){var e=this.__data__;return ed?void 0!==e[t]:nd.call(e,t)},id.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=ed&&void 0===e?"__lodash_hash_undefined__":e,this};var od=id,sd=function(t,e){var r=t.__data__;return function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}(e)?r["string"==typeof e?"string":"hash"]:r.map};function ad(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}ad.prototype.clear=function(){this.size=0,this.__data__={hash:new od,map:new(td||Ic),string:new od}},ad.prototype.delete=function(t){var e=sd(this,t).delete(t);return this.size-=e?1:0,e},ad.prototype.get=function(t){return sd(this,t).get(t)},ad.prototype.has=function(t){return sd(this,t).has(t)},ad.prototype.set=function(t,e){var r=sd(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};var hd=ad;function ud(t){var e=this.__data__=new Ic(t);this.size=e.size}ud.prototype.clear=function(){this.__data__=new Ic,this.size=0},ud.prototype.delete=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},ud.prototype.get=function(t){return this.__data__.get(t)},ud.prototype.has=function(t){return this.__data__.has(t)},ud.prototype.set=function(t,e){var r=this.__data__;if(r instanceof Ic){var n=r.__data__;if(!td||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new hd(n)}return r.set(t,e),this.size=r.size,this};var ld=ud,cd=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t},dd=function(){try{var t=$c(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),fd=function(t,e,r){"__proto__"==e&&dd?dd(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r},pd=Object.prototype.hasOwnProperty,md=function(t,e,r){var n=t[e];pd.call(t,e)&&Tc(n,r)&&(void 0!==r||e in t)||fd(t,e,r)},gd=function(t,e,r,n){var i=!r;r||(r={});for(var o=-1,s=e.length;++o<s;){var a=e[o],h=n?n(r[a],t[a],a,r,t):void 0;void 0===h&&(h=t[a]),i?fd(r,a,h):md(r,a,h)}return r},vd=function(t){return null!=t&&"object"==typeof t},yd=function(t){return vd(t)&&"[object Arguments]"==kc(t)},bd=Object.prototype,_d=bd.hasOwnProperty,Ed=bd.propertyIsEnumerable,xd=yd(function(){return arguments}())?yd:function(t){return vd(t)&&_d.call(t,"callee")&&!Ed.call(t,"callee")},Td=Array.isArray,wd=function(){return!1},Ad=xc((function(t,e){var r=e&&!e.nodeType&&e,n=r&&t&&!t.nodeType&&t,i=n&&n.exports===r?Lc.Buffer:void 0,o=(i?i.isBuffer:void 0)||wd;t.exports=o})),Sd=/^(?:0|[1-9]\d*)$/,Od=function(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&Sd.test(t))&&t>-1&&t%1==0&&t<e},Id=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991},Rd={};Rd["[object Float32Array]"]=Rd["[object Float64Array]"]=Rd["[object Int8Array]"]=Rd["[object Int16Array]"]=Rd["[object Int32Array]"]=Rd["[object Uint8Array]"]=Rd["[object Uint8ClampedArray]"]=Rd["[object Uint16Array]"]=Rd["[object Uint32Array]"]=!0,Rd["[object Arguments]"]=Rd["[object Array]"]=Rd["[object ArrayBuffer]"]=Rd["[object Boolean]"]=Rd["[object DataView]"]=Rd["[object Date]"]=Rd["[object Error]"]=Rd["[object Function]"]=Rd["[object Map]"]=Rd["[object Number]"]=Rd["[object Object]"]=Rd["[object RegExp]"]=Rd["[object Set]"]=Rd["[object String]"]=Rd["[object WeakMap]"]=!1;var Nd=function(t){return function(e){return t(e)}},Ld=xc((function(t,e){var r=e&&!e.nodeType&&e,n=r&&t&&!t.nodeType&&t,i=n&&n.exports===r&&Rc.process,o=function(){try{return n&&n.require&&n.require("util").types||i&&i.binding&&i.binding("util")}catch(t){}}();t.exports=o})),Md=Ld&&Ld.isTypedArray,Pd=Md?Nd(Md):function(t){return vd(t)&&Id(t.length)&&!!Rd[kc(t)]},Cd=Object.prototype.hasOwnProperty,Dd=function(t,e){var r=Td(t),n=!r&&xd(t),i=!r&&!n&&Ad(t),o=!r&&!n&&!i&&Pd(t),s=r||n||i||o,a=s?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],h=a.length;for(var u in t)!e&&!Cd.call(t,u)||s&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Od(u,h))||a.push(u);return a},Ud=Object.prototype,Bd=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Ud)},Fd=function(t,e){return function(r){return t(e(r))}},kd=Fd(Object.keys,Object),Gd=Object.prototype.hasOwnProperty,jd=function(t){if(!Bd(t))return kd(t);var e=[];for(var r in Object(t))Gd.call(t,r)&&"constructor"!=r&&e.push(r);return e},Hd=function(t){return null!=t&&Id(t.length)&&!jc(t)},Xd=function(t){return Hd(t)?Dd(t):jd(t)},zd=Object.prototype.hasOwnProperty,Vd=function(t){if(!Gc(t))return function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e}(t);var e=Bd(t),r=[];for(var n in t)("constructor"!=n||!e&&zd.call(t,n))&&r.push(n);return r},Wd=function(t){return Hd(t)?Dd(t,!0):Vd(t)},Yd=xc((function(t,e){var r=e&&!e.nodeType&&e,n=r&&t&&!t.nodeType&&t,i=n&&n.exports===r?Lc.Buffer:void 0,o=i?i.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var r=t.length,n=o?o(r):new t.constructor(r);return t.copy(n),n}})),qd=function(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e},Kd=function(t,e){for(var r=-1,n=null==t?0:t.length,i=0,o=[];++r<n;){var s=t[r];e(s,r,t)&&(o[i++]=s)}return o},Zd=function(){return[]},Jd=Object.prototype.propertyIsEnumerable,Qd=Object.getOwnPropertySymbols,$d=Qd?function(t){return null==t?[]:(t=Object(t),Kd(Qd(t),(function(e){return Jd.call(t,e)})))}:Zd,tf=function(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t},ef=Fd(Object.getPrototypeOf,Object),rf=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)tf(e,$d(t)),t=ef(t);return e}:Zd,nf=function(t,e,r){var n=e(t);return Td(t)?n:tf(n,r(t))},of=function(t){return nf(t,Xd,$d)},sf=function(t){return nf(t,Wd,rf)},af=$c(Lc,"DataView"),hf=$c(Lc,"Promise"),uf=$c(Lc,"Set"),lf=$c(Lc,"WeakMap"),cf=Vc(af),df=Vc(td),ff=Vc(hf),pf=Vc(uf),mf=Vc(lf),gf=kc;(af&&"[object DataView]"!=gf(new af(new ArrayBuffer(1)))||td&&"[object Map]"!=gf(new td)||hf&&"[object Promise]"!=gf(hf.resolve())||uf&&"[object Set]"!=gf(new uf)||lf&&"[object WeakMap]"!=gf(new lf))&&(gf=function(t){var e=kc(t),r="[object Object]"==e?t.constructor:void 0,n=r?Vc(r):"";if(n)switch(n){case cf:return"[object DataView]";case df:return"[object Map]";case ff:return"[object Promise]";case pf:return"[object Set]";case mf:return"[object WeakMap]"}return e});var vf=gf,yf=Object.prototype.hasOwnProperty,bf=Lc.Uint8Array,_f=function(t){var e=new t.constructor(t.byteLength);return new bf(e).set(new bf(t)),e},Ef=/\w*$/,xf=Mc?Mc.prototype:void 0,Tf=xf?xf.valueOf:void 0,wf=function(t,e){var r=e?_f(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)},Af=function(t,e,r){var n=t.constructor;switch(e){case"[object ArrayBuffer]":return _f(t);case"[object Boolean]":case"[object Date]":return new n(+t);case"[object DataView]":return function(t,e){var r=e?_f(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}(t,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return wf(t,r);case"[object Map]":return new n;case"[object Number]":case"[object String]":return new n(t);case"[object RegExp]":return function(t){var e=new t.constructor(t.source,Ef.exec(t));return e.lastIndex=t.lastIndex,e}(t);case"[object Set]":return new n;case"[object Symbol]":return function(t){return Tf?Object(Tf.call(t)):{}}(t)}},Sf=Object.create,Of=function(){function t(){}return function(e){if(!Gc(e))return{};if(Sf)return Sf(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}(),If=function(t){return"function"!=typeof t.constructor||Bd(t)?{}:Of(ef(t))},Rf=Ld&&Ld.isMap,Nf=Rf?Nd(Rf):function(t){return vd(t)&&"[object Map]"==vf(t)},Lf=Ld&&Ld.isSet,Mf=Lf?Nd(Lf):function(t){return vd(t)&&"[object Set]"==vf(t)},Pf={};Pf["[object Arguments]"]=Pf["[object Array]"]=Pf["[object ArrayBuffer]"]=Pf["[object DataView]"]=Pf["[object Boolean]"]=Pf["[object Date]"]=Pf["[object Float32Array]"]=Pf["[object Float64Array]"]=Pf["[object Int8Array]"]=Pf["[object Int16Array]"]=Pf["[object Int32Array]"]=Pf["[object Map]"]=Pf["[object Number]"]=Pf["[object Object]"]=Pf["[object RegExp]"]=Pf["[object Set]"]=Pf["[object String]"]=Pf["[object Symbol]"]=Pf["[object Uint8Array]"]=Pf["[object Uint8ClampedArray]"]=Pf["[object Uint16Array]"]=Pf["[object Uint32Array]"]=!0,Pf["[object Error]"]=Pf["[object Function]"]=Pf["[object WeakMap]"]=!1;var Cf=function t(e,r,n,i,o,s){var a,h=1&r,u=2&r,l=4&r;if(n&&(a=o?n(e,i,o,s):n(e)),void 0!==a)return a;if(!Gc(e))return e;var c=Td(e);if(c){if(a=function(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&yf.call(t,"index")&&(r.index=t.index,r.input=t.input),r}(e),!h)return qd(e,a)}else{var d=vf(e),f="[object Function]"==d||"[object GeneratorFunction]"==d;if(Ad(e))return Yd(e,h);if("[object Object]"==d||"[object Arguments]"==d||f&&!o){if(a=u||f?{}:If(e),!h)return u?function(t,e){return gd(t,rf(t),e)}(e,function(t,e){return t&&gd(e,Wd(e),t)}(a,e)):function(t,e){return gd(t,$d(t),e)}(e,function(t,e){return t&&gd(e,Xd(e),t)}(a,e))}else{if(!Pf[d])return o?e:{};a=Af(e,d,h)}}s||(s=new ld);var p=s.get(e);if(p)return p;s.set(e,a),Mf(e)?e.forEach((function(i){a.add(t(i,r,n,i,e,s))})):Nf(e)&&e.forEach((function(i,o){a.set(o,t(i,r,n,o,e,s))}));var m=c?void 0:(l?u?sf:of:u?Wd:Xd)(e);return cd(m||e,(function(i,o){m&&(i=e[o=i]),md(a,o,t(i,r,n,o,e,s))})),a},Df=function(t){return function(){return t}},Uf=function(t,e,r){for(var n=-1,i=Object(t),o=r(t),s=o.length;s--;){var a=o[++n];if(!1===e(i[a],a,i))break}return t},Bf=function(t,e){return t&&Uf(t,e,Xd)},Ff=function(t,e){return function(e,r){if(null==e)return e;if(!Hd(e))return t(e,r);for(var n=e.length,i=-1,o=Object(e);++i<n&&!1!==r(o[i],i,o););return e}}(Bf),kf=function(t){return t},Gf=function(t){return"function"==typeof t?t:kf},jf=function(t,e){return(Td(t)?cd:Ff)(t,Gf(e))},Hf=jf,Xf=function(t,e){var r=[];return Ff(t,(function(t,n,i){e(t,n,i)&&r.push(t)})),r};function zf(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new hd;++e<r;)this.add(t[e])}zf.prototype.add=zf.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},zf.prototype.has=function(t){return this.__data__.has(t)};var Vf=zf,Wf=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1},Yf=function(t,e){return t.has(e)},qf=function(t,e,r,n,i,o){var s=1&r,a=t.length,h=e.length;if(a!=h&&!(s&&h>a))return!1;var u=o.get(t),l=o.get(e);if(u&&l)return u==e&&l==t;var c=-1,d=!0,f=2&r?new Vf:void 0;for(o.set(t,e),o.set(e,t);++c<a;){var p=t[c],m=e[c];if(n)var g=s?n(m,p,c,e,t,o):n(p,m,c,t,e,o);if(void 0!==g){if(g)continue;d=!1;break}if(f){if(!Wf(e,(function(t,e){if(!Yf(f,e)&&(p===t||i(p,t,r,n,o)))return f.push(e)}))){d=!1;break}}else if(p!==m&&!i(p,m,r,n,o)){d=!1;break}}return o.delete(t),o.delete(e),d},Kf=function(t){var e=-1,r=Array(t.size);return t.forEach((function(t,n){r[++e]=[n,t]})),r},Zf=function(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r},Jf=Mc?Mc.prototype:void 0,Qf=Jf?Jf.valueOf:void 0,$f=function(t,e,r,n,i,o,s){switch(r){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!o(new bf(t),new bf(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Tc(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var a=Kf;case"[object Set]":var h=1&n;if(a||(a=Zf),t.size!=e.size&&!h)return!1;var u=s.get(t);if(u)return u==e;n|=2,s.set(t,e);var l=qf(a(t),a(e),n,i,o,s);return s.delete(t),l;case"[object Symbol]":if(Qf)return Qf.call(t)==Qf.call(e)}return!1},tp=Object.prototype.hasOwnProperty,ep=Object.prototype.hasOwnProperty,rp=function(t,e,r,n,i,o){var s=Td(t),a=Td(e),h=s?"[object Array]":vf(t),u=a?"[object Array]":vf(e),l="[object Object]"==(h="[object Arguments]"==h?"[object Object]":h),c="[object Object]"==(u="[object Arguments]"==u?"[object Object]":u),d=h==u;if(d&&Ad(t)){if(!Ad(e))return!1;s=!0,l=!1}if(d&&!l)return o||(o=new ld),s||Pd(t)?qf(t,e,r,n,i,o):$f(t,e,h,r,n,i,o);if(!(1&r)){var f=l&&ep.call(t,"__wrapped__"),p=c&&ep.call(e,"__wrapped__");if(f||p){var m=f?t.value():t,g=p?e.value():e;return o||(o=new ld),i(m,g,r,n,o)}}return!!d&&(o||(o=new ld),function(t,e,r,n,i,o){var s=1&r,a=of(t),h=a.length;if(h!=of(e).length&&!s)return!1;for(var u=h;u--;){var l=a[u];if(!(s?l in e:tp.call(e,l)))return!1}var c=o.get(t),d=o.get(e);if(c&&d)return c==e&&d==t;var f=!0;o.set(t,e),o.set(e,t);for(var p=s;++u<h;){var m=t[l=a[u]],g=e[l];if(n)var v=s?n(g,m,l,e,t,o):n(m,g,l,t,e,o);if(!(void 0===v?m===g||i(m,g,r,n,o):v)){f=!1;break}p||(p="constructor"==l)}if(f&&!p){var y=t.constructor,b=e.constructor;y==b||!("constructor"in t)||!("constructor"in e)||"function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b||(f=!1)}return o.delete(t),o.delete(e),f}(t,e,r,n,i,o))},np=function t(e,r,n,i,o){return e===r||(null==e||null==r||!vd(e)&&!vd(r)?e!=e&&r!=r:rp(e,r,n,i,t,o))},ip=function(t){return t==t&&!Gc(t)},op=function(t,e){return function(r){return null!=r&&r[t]===e&&(void 0!==e||t in Object(r))}},sp=function(t){var e=function(t){for(var e=Xd(t),r=e.length;r--;){var n=e[r],i=t[n];e[r]=[n,i,ip(i)]}return e}(t);return 1==e.length&&e[0][2]?op(e[0][0],e[0][1]):function(r){return r===t||function(t,e,r,n){var i=r.length,o=i,s=!n;if(null==t)return!o;for(t=Object(t);i--;){var a=r[i];if(s&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++i<o;){var h=(a=r[i])[0],u=t[h],l=a[1];if(s&&a[2]){if(void 0===u&&!(h in t))return!1}else{var c=new ld;if(n)var d=n(u,l,h,t,e,c);if(!(void 0===d?np(l,u,3,n,c):d))return!1}}return!0}(r,t,e)}},ap=function(t){return"symbol"==typeof t||vd(t)&&"[object Symbol]"==kc(t)},hp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,up=/^\w*$/,lp=function(t,e){if(Td(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!ap(t))||up.test(t)||!hp.test(t)||null!=e&&t in Object(e)};function cp(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var s=t.apply(this,n);return r.cache=o.set(i,s)||o,s};return r.cache=new(cp.Cache||hd),r}cp.Cache=hd;var dp,fp,pp,mp=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,gp=/\\(\\)?/g,vp=(dp=cp((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(mp,(function(t,r,n,i){e.push(n?i.replace(gp,"$1"):r||t)})),e}),(function(t){return 500===fp.size&&fp.clear(),t})),fp=dp.cache,dp),yp=function(t,e){for(var r=-1,n=null==t?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i},bp=Mc?Mc.prototype:void 0,_p=bp?bp.toString:void 0,Ep=function(t){return null==t?"":function t(e){if("string"==typeof e)return e;if(Td(e))return yp(e,t)+"";if(ap(e))return _p?_p.call(e):"";var r=e+"";return"0"==r&&1/e==-1/0?"-0":r}(t)},xp=function(t,e){return Td(t)?t:lp(t,e)?[t]:vp(Ep(t))},Tp=function(t){if("string"==typeof t||ap(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e},wp=function(t,e){for(var r=0,n=(e=xp(e,t)).length;null!=t&&r<n;)t=t[Tp(e[r++])];return r&&r==n?t:void 0},Ap=function(t,e){return null!=t&&e in Object(t)},Sp=function(t,e,r){for(var n=-1,i=(e=xp(e,t)).length,o=!1;++n<i;){var s=Tp(e[n]);if(!(o=null!=t&&r(t,s)))break;t=t[s]}return o||++n!=i?o:!!(i=null==t?0:t.length)&&Id(i)&&Od(s,i)&&(Td(t)||xd(t))},Op=function(t,e){return null!=t&&Sp(t,e,Ap)},Ip=function(t,e){return lp(t)&&ip(e)?op(Tp(t),e):function(r){var n=function(t,e,r){var n=null==t?void 0:wp(t,e);return void 0===n?r:n}(r,t);return void 0===n&&n===e?Op(r,t):np(e,n,3)}},Rp=function(t){return function(e){return null==e?void 0:e[t]}},Np=function(t){return lp(t)?Rp(Tp(t)):function(t){return function(e){return wp(e,t)}}(t)},Lp=function(t){return"function"==typeof t?t:null==t?kf:"object"==typeof t?Td(t)?Ip(t[0],t[1]):sp(t):Np(t)},Mp=function(t,e){return(Td(t)?Kd:Xf)(t,Lp(e))},Pp=Object.prototype.hasOwnProperty,Cp=function(t,e){return null!=t&&Pp.call(t,e)},Dp=function(t,e){return null!=t&&Sp(t,e,Cp)},Up=Object.prototype.hasOwnProperty,Bp=function(t){return void 0===t},Fp=function(t,e){var r=-1,n=Hd(t)?Array(t.length):[];return Ff(t,(function(t,i,o){n[++r]=e(t,i,o)})),n},kp=function(t,e){return(Td(t)?yp:Fp)(t,Lp(e))},Gp=function(t,e,r,n){var i=-1,o=null==t?0:t.length;for(n&&o&&(r=t[++i]);++i<o;)r=e(r,t[i],i,t);return r},jp=function(t,e,r,n,i){return i(t,(function(t,i,o){r=n?(n=!1,t):e(r,t,i,o)})),r},Hp=function(t,e,r){var n=Td(t)?Gp:jp,i=arguments.length<3;return n(t,Lp(e),r,i,Ff)},Xp=Rp("length"),zp=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]"),Vp="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Wp="\\ud83c[\\udffb-\\udfff]",Yp="[^\\ud800-\\udfff]",qp="(?:\\ud83c[\\udde6-\\uddff]){2}",Kp="[\\ud800-\\udbff][\\udc00-\\udfff]",Zp="(?:"+Vp+"|"+Wp+")?",Jp="[\\ufe0e\\ufe0f]?"+Zp+"(?:\\u200d(?:"+[Yp,qp,Kp].join("|")+")[\\ufe0e\\ufe0f]?"+Zp+")*",Qp="(?:"+[Yp+Vp+"?",Vp,qp,Kp,"[\\ud800-\\udfff]"].join("|")+")",$p=RegExp(Wp+"(?="+Wp+")|"+Qp+Jp,"g"),tm=function(t){return function(t){return zp.test(t)}(t)?function(t){for(var e=$p.lastIndex=0;$p.test(t);)++e;return e}(t):Xp(t)},em=Mc?Mc.isConcatSpreadable:void 0,rm=function(t){return Td(t)||xd(t)||!!(em&&t&&t[em])},nm=function t(e,r,n,i,o){var s=-1,a=e.length;for(n||(n=rm),o||(o=[]);++s<a;){var h=e[s];r>0&&n(h)?r>1?t(h,r-1,n,i,o):tf(o,h):i||(o[o.length]=h)}return o},im=function(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)},om=Math.max,sm=function(t,e,r){return e=om(void 0===e?t.length-1:e,0),function(){for(var n=arguments,i=-1,o=om(n.length-e,0),s=Array(o);++i<o;)s[i]=n[e+i];i=-1;for(var a=Array(e+1);++i<e;)a[i]=n[i];return a[e]=r(s),im(t,this,a)}},am=dd?function(t,e){return dd(t,"toString",{configurable:!0,enumerable:!1,value:Df(e),writable:!0})}:kf,hm=Date.now,um=function(t){var e=0,r=0;return function(){var n=hm(),i=16-(n-r);if(r=n,i>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(am),lm=function(t,e){return um(sm(t,e,kf),t+"")},cm=function(t,e,r,n){for(var i=t.length,o=r+(n?1:-1);n?o--:++o<i;)if(e(t[o],o,t))return o;return-1},dm=function(t){return t!=t},fm=function(t,e){return!(null==t||!t.length)&&function(t,e,r){return e==e?function(t,e,r){for(var n=r-1,i=t.length;++n<i;)if(t[n]===e)return n;return-1}(t,e,r):cm(t,dm,r)}(t,e,0)>-1},pm=function(t,e,r){for(var n=-1,i=null==t?0:t.length;++n<i;)if(r(e,t[n]))return!0;return!1},mm=uf&&1/Zf(new uf([,-0]))[1]==1/0?function(t){return new uf(t)}:function(){},gm=function(t){return vd(t)&&Hd(t)},vm=lm((function(t){return function(t,e,r){var n=-1,i=fm,o=t.length,s=!0,a=[],h=a;if(r)s=!1,i=pm;else if(o>=200){var u=e?null:mm(t);if(u)return Zf(u);s=!1,i=Yf,h=new Vf}else h=e?[]:a;t:for(;++n<o;){var l=t[n],c=e?e(l):l;if(l=r||0!==l?l:0,s&&c==c){for(var d=h.length;d--;)if(h[d]===c)continue t;e&&h.push(c),a.push(l)}else i(h,c,r)||(h!==a&&h.push(c),a.push(l))}return a}(nm(t,1,gm,!0))})),ym=function(t){return null==t?[]:function(t,e){return yp(e,(function(e){return t[e]}))}(t,Xd(t))};try{pp={clone:function(t){return Cf(t,4)},constant:Df,each:Hf,filter:Mp,has:Dp,isArray:Td,isEmpty:function(t){if(null==t)return!0;if(Hd(t)&&(Td(t)||"string"==typeof t||"function"==typeof t.splice||Ad(t)||Pd(t)||xd(t)))return!t.length;var e=vf(t);if("[object Map]"==e||"[object Set]"==e)return!t.size;if(Bd(t))return!jd(t).length;for(var r in t)if(Up.call(t,r))return!1;return!0},isFunction:jc,isUndefined:Bp,keys:Xd,map:kp,reduce:Hp,size:function(t){if(null==t)return 0;if(Hd(t))return function(t){return"string"==typeof t||!Td(t)&&vd(t)&&"[object String]"==kc(t)}(t)?tm(t):t.length;var e=vf(t);return"[object Map]"==e||"[object Set]"==e?t.size:jd(t).length},transform:function(t,e,r){var n=Td(t),i=n||Ad(t)||Pd(t);if(e=Lp(e),null==r){var o=t&&t.constructor;r=i?n?new o:[]:Gc(t)&&jc(o)?Of(ef(t)):{}}return(i?cd:Bf)(t,(function(t,n,i){return e(r,t,n,i)})),r},union:vm,values:ym}}catch(yc){}pp||(pp=window._);var bm=pp,_m=Em;function Em(t){this._isDirected=!bm.has(t,"directed")||t.directed,this._isMultigraph=!!bm.has(t,"multigraph")&&t.multigraph,this._isCompound=!!bm.has(t,"compound")&&t.compound,this._label=void 0,this._defaultNodeLabelFn=bm.constant(void 0),this._defaultEdgeLabelFn=bm.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children["\0"]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function xm(t,e){t[e]?t[e]++:t[e]=1}function Tm(t,e){--t[e]||delete t[e]}function wm(t,e,r,n){var i=""+e,o=""+r;if(!t&&i>o){var s=i;i=o,o=s}return i+""+o+""+(bm.isUndefined(n)?"\0":n)}function Am(t,e,r,n){var i=""+e,o=""+r;if(!t&&i>o){var s=i;i=o,o=s}var a={v:i,w:o};return n&&(a.name=n),a}function Sm(t,e){return wm(t,e.v,e.w,e.name)}Em.prototype._nodeCount=0,Em.prototype._edgeCount=0,Em.prototype.isDirected=function(){return this._isDirected},Em.prototype.isMultigraph=function(){return this._isMultigraph},Em.prototype.isCompound=function(){return this._isCompound},Em.prototype.setGraph=function(t){return this._label=t,this},Em.prototype.graph=function(){return this._label},Em.prototype.setDefaultNodeLabel=function(t){return bm.isFunction(t)||(t=bm.constant(t)),this._defaultNodeLabelFn=t,this},Em.prototype.nodeCount=function(){return this._nodeCount},Em.prototype.nodes=function(){return bm.keys(this._nodes)},Em.prototype.sources=function(){var t=this;return bm.filter(this.nodes(),(function(e){return bm.isEmpty(t._in[e])}))},Em.prototype.sinks=function(){var t=this;return bm.filter(this.nodes(),(function(e){return bm.isEmpty(t._out[e])}))},Em.prototype.setNodes=function(t,e){var r=arguments,n=this;return bm.each(t,(function(t){r.length>1?n.setNode(t,e):n.setNode(t)})),this},Em.prototype.setNode=function(t,e){return bm.has(this._nodes,t)?(arguments.length>1&&(this._nodes[t]=e),this):(this._nodes[t]=arguments.length>1?e:this._defaultNodeLabelFn(t),this._isCompound&&(this._parent[t]="\0",this._children[t]={},this._children["\0"][t]=!0),this._in[t]={},this._preds[t]={},this._out[t]={},this._sucs[t]={},++this._nodeCount,this)},Em.prototype.node=function(t){return this._nodes[t]},Em.prototype.hasNode=function(t){return bm.has(this._nodes,t)},Em.prototype.removeNode=function(t){var e=this;if(bm.has(this._nodes,t)){var r=function(t){e.removeEdge(e._edgeObjs[t])};delete this._nodes[t],this._isCompound&&(this._removeFromParentsChildList(t),delete this._parent[t],bm.each(this.children(t),(function(t){e.setParent(t)})),delete this._children[t]),bm.each(bm.keys(this._in[t]),r),delete this._in[t],delete this._preds[t],bm.each(bm.keys(this._out[t]),r),delete this._out[t],delete this._sucs[t],--this._nodeCount}return this},Em.prototype.setParent=function(t,e){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(bm.isUndefined(e))e="\0";else{for(var r=e+="";!bm.isUndefined(r);r=this.parent(r))if(r===t)throw new Error("Setting "+e+" as parent of "+t+" would create a cycle");this.setNode(e)}return this.setNode(t),this._removeFromParentsChildList(t),this._parent[t]=e,this._children[e][t]=!0,this},Em.prototype._removeFromParentsChildList=function(t){delete this._children[this._parent[t]][t]},Em.prototype.parent=function(t){if(this._isCompound){var e=this._parent[t];if("\0"!==e)return e}},Em.prototype.children=function(t){if(bm.isUndefined(t)&&(t="\0"),this._isCompound){var e=this._children[t];if(e)return bm.keys(e)}else{if("\0"===t)return this.nodes();if(this.hasNode(t))return[]}},Em.prototype.predecessors=function(t){var e=this._preds[t];if(e)return bm.keys(e)},Em.prototype.successors=function(t){var e=this._sucs[t];if(e)return bm.keys(e)},Em.prototype.neighbors=function(t){var e=this.predecessors(t);if(e)return bm.union(e,this.successors(t))},Em.prototype.isLeaf=function(t){return 0===(this.isDirected()?this.successors(t):this.neighbors(t)).length},Em.prototype.filterNodes=function(t){var e=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});e.setGraph(this.graph());var r=this;bm.each(this._nodes,(function(r,n){t(n)&&e.setNode(n,r)})),bm.each(this._edgeObjs,(function(t){e.hasNode(t.v)&&e.hasNode(t.w)&&e.setEdge(t,r.edge(t))}));var n={};return this._isCompound&&bm.each(e.nodes(),(function(t){e.setParent(t,function t(i){var o=r.parent(i);return void 0===o||e.hasNode(o)?(n[i]=o,o):o in n?n[o]:t(o)}(t))})),e},Em.prototype.setDefaultEdgeLabel=function(t){return bm.isFunction(t)||(t=bm.constant(t)),this._defaultEdgeLabelFn=t,this},Em.prototype.edgeCount=function(){return this._edgeCount},Em.prototype.edges=function(){return bm.values(this._edgeObjs)},Em.prototype.setPath=function(t,e){var r=this,n=arguments;return bm.reduce(t,(function(t,i){return n.length>1?r.setEdge(t,i,e):r.setEdge(t,i),i})),this},Em.prototype.setEdge=function(){var t,e,r,n,i=!1,o=arguments[0];"object"==typeof o&&null!==o&&"v"in o?(t=o.v,e=o.w,r=o.name,2===arguments.length&&(n=arguments[1],i=!0)):(t=o,e=arguments[1],r=arguments[3],arguments.length>2&&(n=arguments[2],i=!0)),t=""+t,e=""+e,bm.isUndefined(r)||(r=""+r);var s=wm(this._isDirected,t,e,r);if(bm.has(this._edgeLabels,s))return i&&(this._edgeLabels[s]=n),this;if(!bm.isUndefined(r)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(t),this.setNode(e),this._edgeLabels[s]=i?n:this._defaultEdgeLabelFn(t,e,r);var a=Am(this._isDirected,t,e,r);return t=a.v,e=a.w,Object.freeze(a),this._edgeObjs[s]=a,xm(this._preds[e],t),xm(this._sucs[t],e),this._in[e][s]=a,this._out[t][s]=a,this._edgeCount++,this},Em.prototype.edge=function(t,e,r){var n=1===arguments.length?Sm(this._isDirected,arguments[0]):wm(this._isDirected,t,e,r);return this._edgeLabels[n]},Em.prototype.hasEdge=function(t,e,r){var n=1===arguments.length?Sm(this._isDirected,arguments[0]):wm(this._isDirected,t,e,r);return bm.has(this._edgeLabels,n)},Em.prototype.removeEdge=function(t,e,r){var n=1===arguments.length?Sm(this._isDirected,arguments[0]):wm(this._isDirected,t,e,r),i=this._edgeObjs[n];return i&&(t=i.v,e=i.w,delete this._edgeLabels[n],delete this._edgeObjs[n],Tm(this._preds[e],t),Tm(this._sucs[t],e),delete this._in[e][n],delete this._out[t][n],this._edgeCount--),this},Em.prototype.inEdges=function(t,e){var r=this._in[t];if(r){var n=bm.values(r);return e?bm.filter(n,(function(t){return t.v===e})):n}},Em.prototype.outEdges=function(t,e){var r=this._out[t];if(r){var n=bm.values(r);return e?bm.filter(n,(function(t){return t.w===e})):n}},Em.prototype.nodeEdges=function(t,e){var r=this.inEdges(t,e);if(r)return r.concat(this.outEdges(t,e))};var Om={Graph:_m,version:"2.1.8"},Im={write:function(t){var e={options:{directed:t.isDirected(),multigraph:t.isMultigraph(),compound:t.isCompound()},nodes:Rm(t),edges:Nm(t)};return bm.isUndefined(t.graph())||(e.value=bm.clone(t.graph())),e},read:function(t){var e=new _m(t.options).setGraph(t.value);return bm.each(t.nodes,(function(t){e.setNode(t.v,t.value),t.parent&&e.setParent(t.v,t.parent)})),bm.each(t.edges,(function(t){e.setEdge({v:t.v,w:t.w,name:t.name},t.value)})),e}};function Rm(t){return bm.map(t.nodes(),(function(e){var r=t.node(e),n=t.parent(e),i={v:e};return bm.isUndefined(r)||(i.value=r),bm.isUndefined(n)||(i.parent=n),i}))}function Nm(t){return bm.map(t.edges(),(function(e){var r=t.edge(e),n={v:e.v,w:e.w};return bm.isUndefined(e.name)||(n.name=e.name),bm.isUndefined(r)||(n.value=r),n}))}var Lm=Mm;function Mm(){this._arr=[],this._keyIndices={}}Mm.prototype.size=function(){return this._arr.length},Mm.prototype.keys=function(){return this._arr.map((function(t){return t.key}))},Mm.prototype.has=function(t){return bm.has(this._keyIndices,t)},Mm.prototype.priority=function(t){var e=this._keyIndices[t];if(void 0!==e)return this._arr[e].priority},Mm.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},Mm.prototype.add=function(t,e){var r=this._keyIndices;if(t=String(t),!bm.has(r,t)){var n=this._arr,i=n.length;return r[t]=i,n.push({key:t,priority:e}),this._decrease(i),!0}return!1},Mm.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var t=this._arr.pop();return delete this._keyIndices[t.key],this._heapify(0),t.key},Mm.prototype.decrease=function(t,e){var r=this._keyIndices[t];if(e>this._arr[r].priority)throw new Error("New priority is greater than current priority. Key: "+t+" Old: "+this._arr[r].priority+" New: "+e);this._arr[r].priority=e,this._decrease(r)},Mm.prototype._heapify=function(t){var e=this._arr,r=2*t,n=r+1,i=t;r<e.length&&(i=e[r].priority<e[i].priority?r:i,n<e.length&&(i=e[n].priority<e[i].priority?n:i),i!==t&&(this._swap(t,i),this._heapify(i)))},Mm.prototype._decrease=function(t){for(var e,r=this._arr,n=r[t].priority;0!==t&&!(r[e=t>>1].priority<n);)this._swap(t,e),t=e},Mm.prototype._swap=function(t,e){var r=this._arr,n=this._keyIndices,i=r[t],o=r[e];r[t]=o,r[e]=i,n[o.key]=t,n[i.key]=e};var Pm=function(t,e,r,n){return function(t,e,r,n){var i,o,s={},a=new Lm,h=function(t){var e=t.v!==i?t.v:t.w,n=s[e],h=r(t),u=o.distance+h;if(h<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+t+" Weight: "+h);u<n.distance&&(n.distance=u,n.predecessor=i,a.decrease(e,u))};for(t.nodes().forEach((function(t){var r=t===e?0:Number.POSITIVE_INFINITY;s[t]={distance:r},a.add(t,r)}));a.size()>0&&(i=a.removeMin(),(o=s[i]).distance!==Number.POSITIVE_INFINITY);)n(i).forEach(h);return s}(t,String(e),r||Cm,n||function(e){return t.outEdges(e)})},Cm=bm.constant(1),Dm=function(t){var e=0,r=[],n={},i=[];function o(s){var a=n[s]={onStack:!0,lowlink:e,index:e++};if(r.push(s),t.successors(s).forEach((function(t){bm.has(n,t)?n[t].onStack&&(a.lowlink=Math.min(a.lowlink,n[t].index)):(o(t),a.lowlink=Math.min(a.lowlink,n[t].lowlink))})),a.lowlink===a.index){var h,u=[];do{h=r.pop(),n[h].onStack=!1,u.push(h)}while(s!==h);i.push(u)}}return t.nodes().forEach((function(t){bm.has(n,t)||o(t)})),i},Um=bm.constant(1),Bm=Fm;function Fm(t){var e={},r={},n=[];if(bm.each(t.sinks(),(function i(o){if(bm.has(r,o))throw new km;bm.has(e,o)||(r[o]=!0,e[o]=!0,bm.each(t.predecessors(o),i),delete r[o],n.push(o))})),bm.size(e)!==t.nodeCount())throw new km;return n}function km(){}Fm.CycleException=km,km.prototype=new Error;var Gm=function(t,e,r){bm.isArray(e)||(e=[e]);var n=(t.isDirected()?t.successors:t.neighbors).bind(t),i=[],o={};return bm.each(e,(function(e){if(!t.hasNode(e))throw new Error("Graph does not have node: "+e);!function t(e,r,n,i,o,s){bm.has(i,r)||(i[r]=!0,n||s.push(r),bm.each(o(r),(function(r){t(e,r,n,i,o,s)})),n&&s.push(r))}(t,e,"post"===r,o,n,i)})),i};var jm,Hm={Graph:Om.Graph,json:Im,alg:{components:function(t){var e,r={},n=[];function i(n){bm.has(r,n)||(r[n]=!0,e.push(n),bm.each(t.successors(n),i),bm.each(t.predecessors(n),i))}return bm.each(t.nodes(),(function(t){e=[],i(t),e.length&&n.push(e)})),n},dijkstra:Pm,dijkstraAll:function(t,e,r){return bm.transform(t.nodes(),(function(n,i){n[i]=Pm(t,i,e,r)}),{})},findCycles:function(t){return bm.filter(Dm(t),(function(e){return e.length>1||1===e.length&&t.hasEdge(e[0],e[0])}))},floydWarshall:function(t,e,r){return function(t,e,r){var n={},i=t.nodes();return i.forEach((function(t){n[t]={},n[t][t]={distance:0},i.forEach((function(e){t!==e&&(n[t][e]={distance:Number.POSITIVE_INFINITY})})),r(t).forEach((function(r){var i=r.v===t?r.w:r.v,o=e(r);n[t][i]={distance:o,predecessor:t}}))})),i.forEach((function(t){var e=n[t];i.forEach((function(r){var o=n[r];i.forEach((function(r){var n=o[t],i=e[r],s=o[r],a=n.distance+i.distance;a<s.distance&&(s.distance=a,s.predecessor=i.predecessor)}))}))})),n}(t,e||Um,r||function(e){return t.outEdges(e)})},isAcyclic:function(t){try{Bm(t)}catch(t){if(t instanceof Bm.CycleException)return!1;throw t}return!0},postorder:function(t,e){return Gm(t,e,"post")},preorder:function(t,e){return Gm(t,e,"pre")},prim:function(t,e){var r,n=new _m,i={},o=new Lm;function s(t){var n=t.v===r?t.w:t.v,s=o.priority(n);if(void 0!==s){var a=e(t);a<s&&(i[n]=r,o.decrease(n,a))}}if(0===t.nodeCount())return n;bm.each(t.nodes(),(function(t){o.add(t,Number.POSITIVE_INFINITY),n.setNode(t)})),o.decrease(t.nodes()[0],0);for(var a=!1;o.size()>0;){if(r=o.removeMin(),bm.has(i,r))n.setEdge(r,i[r]);else{if(a)throw new Error("Input graph is not connected: "+t);a=!0}t.nodeEdges(r).forEach(s)}return n},tarjan:Dm,topsort:Bm},version:Om.version};try{jm=Hm}catch(yc){}jm||(jm=window.graphlib);var Xm,zm=jm,Vm=function(t,e,r){if(!Gc(r))return!1;var n=typeof e;return!!("number"==n?Hd(r)&&Od(e,r.length):"string"==n&&e in r)&&Tc(r[e],t)},Wm=Object.prototype,Ym=Wm.hasOwnProperty,qm=lm((function(t,e){t=Object(t);var r=-1,n=e.length,i=n>2?e[2]:void 0;for(i&&Vm(e[0],e[1],i)&&(n=1);++r<n;)for(var o=e[r],s=Wd(o),a=-1,h=s.length;++a<h;){var u=s[a],l=t[u];(void 0===l||Tc(l,Wm[u])&&!Ym.call(t,u))&&(t[u]=o[u])}return t})),Km=/^\s+|\s+$/g,Zm=/^[-+]0x[0-9a-f]+$/i,Jm=/^0b[01]+$/i,Qm=/^0o[0-7]+$/i,$m=parseInt,tg=function(t){return t?1/0===(t=function(t){if("number"==typeof t)return t;if(ap(t))return NaN;if(Gc(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Gc(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(Km,"");var r=Jm.test(t);return r||Qm.test(t)?$m(t.slice(2),r?2:8):Zm.test(t)?NaN:+t}(t))||-1/0===t?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0},eg=Math.max,rg=function(t){return function(e,r,n){var i=Object(e);if(!Hd(e)){var o=Lp(r);e=Xd(e),r=function(t){return o(i[t],t,i)}}var s=t(e,r,n);return s>-1?i[o?e[s]:s]:void 0}}((function(t,e,r){var n=null==t?0:t.length;if(!n)return-1;var i=null==r?0:function(t){var e=tg(t),r=e%1;return e==e?r?e-r:e:0}(r);return i<0&&(i=eg(n+i,0)),cm(t,Lp(e),i)})),ng=function(t){return null!=t&&t.length?nm(t,1):[]},ig=function(t,e,r){for(var n=-1,i=t.length;++n<i;){var o=t[n],s=e(o);if(null!=s&&(void 0===a?s==s&&!ap(s):r(s,a)))var a=s,h=o}return h},og=function(t,e){return t>e},sg=function(t,e,r){(void 0!==r&&!Tc(t[e],r)||void 0===r&&!(e in t))&&fd(t,e,r)},ag=Function.prototype,hg=Object.prototype,ug=ag.toString,lg=hg.hasOwnProperty,cg=ug.call(Object),dg=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]},fg=function(t,e,r,n,i,o,s){var a=dg(t,r),h=dg(e,r),u=s.get(h);if(u)sg(t,r,u);else{var l=o?o(a,h,r+"",t,e,s):void 0,c=void 0===l;if(c){var d=Td(h),f=!d&&Ad(h),p=!d&&!f&&Pd(h);l=h,d||f||p?Td(a)?l=a:gm(a)?l=qd(a):f?(c=!1,l=Yd(h,!0)):p?(c=!1,l=wf(h,!0)):l=[]:function(t){if(!vd(t)||"[object Object]"!=kc(t))return!1;var e=ef(t);if(null===e)return!0;var r=lg.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&ug.call(r)==cg}(h)||xd(h)?(l=a,xd(a)?l=function(t){return gd(t,Wd(t))}(a):Gc(a)&&!jc(a)||(l=If(h))):c=!1}c&&(s.set(h,l),i(l,h,n,o,s),s.delete(h)),sg(t,r,l)}},pg=function(t){return lm((function(e,r){var n=-1,i=r.length,o=i>1?r[i-1]:void 0,s=i>2?r[2]:void 0;for(o=t.length>3&&"function"==typeof o?(i--,o):void 0,s&&Vm(r[0],r[1],s)&&(o=i<3?void 0:o,i=1),e=Object(e);++n<i;){var a=r[n];a&&t(e,a,n)}return e}))}((function(t,e,r){!function t(e,r,n,i,o){e!==r&&Uf(r,(function(s,a){if(o||(o=new ld),Gc(s))fg(e,r,a,n,t,i,o);else{var h=i?i(dg(e,a),s,a+"",e,r,o):void 0;void 0===h&&(h=s),sg(e,a,h)}}),Wd)}(t,e,r)})),mg=function(t,e){return t<e},gg=function(t,e,r,n){if(!Gc(t))return t;for(var i=-1,o=(e=xp(e,t)).length,s=o-1,a=t;null!=a&&++i<o;){var h=Tp(e[i]),u=r;if("__proto__"===h||"constructor"===h||"prototype"===h)return t;if(i!=s){var l=a[h];void 0===(u=n?n(l,h,a):void 0)&&(u=Gc(l)?l:Od(e[i+1])?[]:{})}md(a,h,u),a=a[h]}return t},vg=function(t,e){return function(t,e,r){for(var n=-1,i=e.length,o={};++n<i;){var s=e[n],a=wp(t,s);r(a,s)&&gg(o,xp(s,t),a)}return o}(t,e,(function(e,r){return Op(t,r)}))},yg=function(t){return um(sm(t,void 0,ng),t+"")}((function(t,e){return null==t?{}:vg(t,e)})),bg=Math.ceil,_g=Math.max,Eg=function(t,e,r){return r&&"number"!=typeof r&&Vm(t,e,r)&&(e=r=void 0),t=tg(t),void 0===e?(e=t,t=0):e=tg(e),function(t,e,r,n){for(var i=-1,o=_g(bg((e-t)/(r||1)),0),s=Array(o);o--;)s[n?o:++i]=t,t+=r;return s}(t,e,r=void 0===r?t<e?1:-1:tg(r),void 0)},xg=function(t,e){if(t!==e){var r=void 0!==t,n=null===t,i=t==t,o=ap(t),s=void 0!==e,a=null===e,h=e==e,u=ap(e);if(!a&&!u&&!o&&t>e||o&&s&&h&&!a&&!u||n&&s&&h||!r&&h||!i)return 1;if(!n&&!o&&!u&&t<e||u&&r&&i&&!n&&!o||a&&r&&i||!s&&i||!h)return-1}return 0},Tg=function(t,e,r){e=e.length?yp(e,(function(t){return Td(t)?function(e){return wp(e,1===t.length?t[0]:t)}:t})):[kf];var n=-1;return e=yp(e,Nd(Lp)),function(t,e){var r=t.length;for(t.sort(e);r--;)t[r]=t[r].value;return t}(Fp(t,(function(t,r,i){return{criteria:yp(e,(function(e){return e(t)})),index:++n,value:t}})),(function(t,e){return function(t,e,r){for(var n=-1,i=t.criteria,o=e.criteria,s=i.length,a=r.length;++n<s;){var h=xg(i[n],o[n]);if(h)return n>=a?h:h*("desc"==r[n]?-1:1)}return t.index-e.index}(t,e,r)}))},wg=lm((function(t,e){if(null==t)return[];var r=e.length;return r>1&&Vm(t,e[0],e[1])?e=[]:r>2&&Vm(e[0],e[1],e[2])&&(e=[e[0]]),Tg(t,nm(e,1),[])})),Ag=0;try{Xm={cloneDeep:function(t){return Cf(t,5)},constant:Df,defaults:qm,each:Hf,filter:Mp,find:rg,flatten:ng,forEach:jf,forIn:function(t,e){return null==t?t:Uf(t,Gf(e),Wd)},has:Dp,isUndefined:Bp,last:function(t){var e=null==t?0:t.length;return e?t[e-1]:void 0},map:kp,mapValues:function(t,e){var r={};return e=Lp(e),Bf(t,(function(t,n,i){fd(r,n,e(t,n,i))})),r},max:function(t){return t&&t.length?ig(t,kf,og):void 0},merge:pg,min:function(t){return t&&t.length?ig(t,kf,mg):void 0},minBy:function(t,e){return t&&t.length?ig(t,Lp(e),mg):void 0},now:function(){return Lc.Date.now()},pick:yg,range:Eg,reduce:Hp,sortBy:wg,uniqueId:function(t){var e=++Ag;return Ep(t)+e},values:ym,zipObject:function(t,e){return function(t,e,r){for(var n=-1,i=t.length,o=e.length,s={};++n<i;){var a=n<o?e[n]:void 0;r(s,t[n],a)}return s}(t||[],e||[],md)}}}catch(yc){}Xm||(Xm=window._);var Sg=Xm;zm.Graph,Sg.constant(1),zm.Graph,zm.Graph,zm.alg.preorder,zm.alg.postorder,zm.Graph,zm.Graph,zm.Graph,zm.Graph,zm.Graph;class Og extends lh{constructor(t){super(),this.nodeSize=30,this.minNodeSpacing=10,this.nodeSpacing=10,this.preventOverlap=!1,this.equidistant=!1,this.startAngle=1.5*Math.PI,this.clockwise=!0,this.sortBy="degree",this.nodes=[],this.edges=[],this.width=300,this.height=300,this.onLayoutEnd=()=>{},this.updateCfg(t)}getDefaultCfg(){return{nodeSize:30,minNodeSpacing:10,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:1.5*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"}}execute(){var t,e;const r=this,{nodes:n,edges:i}=r,o=n.length;if(0===o)return void(null===(t=r.onLayoutEnd)||void 0===t||t.call(r));r.width||"undefined"==typeof window||(r.width=window.innerWidth),r.height||"undefined"==typeof window||(r.height=window.innerHeight),r.center||(r.center=[r.width/2,r.height/2]);const s=r.center;if(1===o)return n[0].x=s[0],n[0].y=s[1],void(null===(e=r.onLayoutEnd)||void 0===e||e.call(r));const{nodeSize:a,nodeSpacing:h}=r,u=[];let l,c=0;l=dh(a)?Math.max(a[0],a[1]):a,dh(h)?c=Math.max(h[0],h[1]):fh(h)&&(c=h),n.forEach(t=>{u.push(t);let e=l;dh(t.size)?e=Math.max(t.size[0],t.size[1]):fh(t.size)?e=t.size:ph(t.size)&&(e=Math.max(t.size.width,t.size.height)),l=Math.max(l,e),yh(h)&&(c=Math.max(h(t),c))}),r.clockwise=void 0!==r.counterclockwise?!r.counterclockwise:r.clockwise;const d={},f={};if(u.forEach((t,e)=>{d[t.id]=t,f[t.id]=e}),!("degree"!==r.sortBy&&ch(r.sortBy)&&void 0!==u[0][r.sortBy]||(r.sortBy="degree",fh(n[0].degree)))){const t=vh(n.length,f,i);u.forEach((e,r)=>{e.degree=t[r].all})}u.sort((t,e)=>e[r.sortBy]-t[r.sortBy]),r.maxValueNode=u[0],r.maxLevelDiff=r.maxLevelDiff||r.maxValueNode[r.sortBy]/4;const p=[[]];let m=p[0];u.forEach(t=>{if(m.length>0){const e=Math.abs(m[0][r.sortBy]-t[r.sortBy]);r.maxLevelDiff&&e>=r.maxLevelDiff&&(m=[],p.push(m))}m.push(t)});let g=l+(c||r.minNodeSpacing);if(!r.preventOverlap){const t=p.length>0&&p[0].length>1,e=(Math.min(r.width,r.height)/2-g)/(p.length+(t?1:0));g=Math.min(g,e)}let v=0;if(p.forEach(t=>{let e=r.sweep;void 0===e&&(e=2*Math.PI-2*Math.PI/t.length);const n=t.dTheta=e/Math.max(1,t.length-1);if(t.length>1&&r.preventOverlap){const t=Math.cos(n)-Math.cos(0),e=Math.sin(n)-Math.sin(0),r=Math.sqrt(g*g/(t*t+e*e));v=Math.max(r,v)}t.r=v,v+=g}),r.equidistant){let t=0,e=0;for(let r=0;r<p.length;r++){const n=p[r].r-e;t=Math.max(t,n)}e=0,p.forEach((r,n)=>{0===n&&(e=r.r),r.r=e,e+=t})}return p.forEach(t=>{const e=t.dTheta,n=t.r;t.forEach((t,i)=>{const o=r.startAngle+(r.clockwise?1:-1)*e*i;t.x=s[0]+n*Math.cos(o),t.y=s[1]+n*Math.sin(o)})}),r.onLayoutEnd&&r.onLayoutEnd(),{nodes:n,edges:i}}getType(){return"concentric"}}function Ig(t){return(Ig="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rg(t){var e=function(t,e){if("object"!==Ig(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Ig(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===Ig(e)?e:String(e)}function Ng(t,e,r){return(e=Rg(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Lg="object"==typeof nt&&nt&&nt.Object===Object&&nt,Mg="object"==typeof self&&self&&self.Object===Object&&self,Pg=(Lg||Mg||Function("return this")()).Symbol;Pg&&Pg.toStringTag,Pg&&Pg.toStringTag;var Cg=it((function(t,e){var r=e&&!e.nodeType&&e,n=r&&t&&!t.nodeType&&t,i=n&&n.exports===r&&Lg.process,o=function(){try{var t=n&&n.require&&n.require("util").types;return t||i&&i.binding&&i.binding("util")}catch(t){}}();t.exports=o}));Cg&&Cg.isTypedArray;var Dg,Ug,Bg,Fg,kg,Gg,jg,Hg,Xg,zg,Vg,Wg,Yg,qg,Kg,Zg,Jg,Qg,$g,tv=it((function(t){function e(r){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})),ev=it((function(t){var e=tv.default;function r(){t.exports=r=function(){return n},t.exports.__esModule=!0,t.exports.default=t.exports;var n={},i=Object.prototype,o=i.hasOwnProperty,s=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},h=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function d(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,o=Object.create(i.prototype),a=new I(n||[]);return s(o,"_invoke",{value:w(t,r,a)}),o}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}n.wrap=d;var p={};function m(){}function g(){}function v(){}var y={};c(y,h,(function(){return this}));var b=Object.getPrototypeOf,_=b&&b(b(R([])));_&&_!==i&&o.call(_,h)&&(y=_);var E=v.prototype=m.prototype=Object.create(y);function x(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,r){var n;s(this,"_invoke",{value:function(i,s){function a(){return new r((function(n,a){!function n(i,s,a,h){var u=f(t[i],t,s);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==e(c)&&o.call(c,"__await")?r.resolve(c.__await).then((function(t){n("next",t,a,h)}),(function(t){n("throw",t,a,h)})):r.resolve(c).then((function(t){l.value=t,a(l)}),(function(t){return n("throw",t,a,h)}))}h(u.arg)}(i,s,n,a)}))}return n=n?n.then(a,a):a()}})}function w(t,e,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return N()}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=A(s,r);if(a){if(a===p)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var h=f(t,e,r);if("normal"===h.type){if(n=r.done?"completed":"suspendedYield",h.arg===p)continue;return{value:h.arg,done:r.done}}"throw"===h.type&&(n="completed",r.method="throw",r.arg=h.arg)}}}function A(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,A(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var i=f(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,p;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,p):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function R(t){if(t){var e=t[h];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,n=function e(){for(;++r<t.length;)if(o.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return n.next=n}}return{next:N}}function N(){return{value:void 0,done:!0}}return g.prototype=v,s(E,"constructor",{value:v,configurable:!0}),s(v,"constructor",{value:g,configurable:!0}),g.displayName=c(v,l,"GeneratorFunction"),n.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},n.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,c(t,l,"GeneratorFunction")),t.prototype=Object.create(E),t},n.awrap=function(t){return{__await:t}},x(T.prototype),c(T.prototype,u,(function(){return this})),n.AsyncIterator=T,n.async=function(t,e,r,i,o){void 0===o&&(o=Promise);var s=new T(d(t,e,r,i),o);return n.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},x(E),c(E,l,"Generator"),c(E,h,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),n.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},n.values=R,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!t)for(var e in this)"t"===e.charAt(0)&&o.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,n){return s.type="throw",s.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],s=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var a=o.call(i,"catchLoc"),h=o.call(i,"finallyLoc");if(a&&h){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!h)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=t,s.arg=e,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:R(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),p}},n}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}))();try{regeneratorRuntime=ev}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=ev:Function("r","regeneratorRuntime = r")(ev)}!function(t){t[t.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",t[t.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",t[t.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t[t.ZERO=0]="ZERO",t[t.ONE=1]="ONE",t[t.SRC_COLOR=768]="SRC_COLOR",t[t.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",t[t.SRC_ALPHA=770]="SRC_ALPHA",t[t.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",t[t.DST_ALPHA=772]="DST_ALPHA",t[t.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",t[t.DST_COLOR=774]="DST_COLOR",t[t.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",t[t.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",t[t.FUNC_ADD=32774]="FUNC_ADD",t[t.BLEND_EQUATION=32777]="BLEND_EQUATION",t[t.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",t[t.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",t[t.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",t[t.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",t[t.MAX_EXT=32776]="MAX_EXT",t[t.MIN_EXT=32775]="MIN_EXT",t[t.BLEND_DST_RGB=32968]="BLEND_DST_RGB",t[t.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",t[t.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",t[t.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",t[t.CONSTANT_COLOR=32769]="CONSTANT_COLOR",t[t.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",t[t.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",t[t.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",t[t.BLEND_COLOR=32773]="BLEND_COLOR",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",t[t.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",t[t.STREAM_DRAW=35040]="STREAM_DRAW",t[t.STATIC_DRAW=35044]="STATIC_DRAW",t[t.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",t[t.BUFFER_SIZE=34660]="BUFFER_SIZE",t[t.BUFFER_USAGE=34661]="BUFFER_USAGE",t[t.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",t[t.FRONT=1028]="FRONT",t[t.BACK=1029]="BACK",t[t.FRONT_AND_BACK=1032]="FRONT_AND_BACK",t[t.CULL_FACE=2884]="CULL_FACE",t[t.BLEND=3042]="BLEND",t[t.DITHER=3024]="DITHER",t[t.STENCIL_TEST=2960]="STENCIL_TEST",t[t.DEPTH_TEST=2929]="DEPTH_TEST",t[t.SCISSOR_TEST=3089]="SCISSOR_TEST",t[t.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",t[t.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",t[t.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",t[t.NO_ERROR=0]="NO_ERROR",t[t.INVALID_ENUM=1280]="INVALID_ENUM",t[t.INVALID_VALUE=1281]="INVALID_VALUE",t[t.INVALID_OPERATION=1282]="INVALID_OPERATION",t[t.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",t[t.CW=2304]="CW",t[t.CCW=2305]="CCW",t[t.LINE_WIDTH=2849]="LINE_WIDTH",t[t.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",t[t.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",t[t.CULL_FACE_MODE=2885]="CULL_FACE_MODE",t[t.FRONT_FACE=2886]="FRONT_FACE",t[t.DEPTH_RANGE=2928]="DEPTH_RANGE",t[t.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",t[t.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",t[t.DEPTH_FUNC=2932]="DEPTH_FUNC",t[t.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",t[t.STENCIL_FUNC=2962]="STENCIL_FUNC",t[t.STENCIL_FAIL=2964]="STENCIL_FAIL",t[t.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",t[t.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",t[t.STENCIL_REF=2967]="STENCIL_REF",t[t.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",t[t.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",t[t.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",t[t.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",t[t.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",t[t.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",t[t.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",t[t.VIEWPORT=2978]="VIEWPORT",t[t.SCISSOR_BOX=3088]="SCISSOR_BOX",t[t.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",t[t.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",t[t.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",t[t.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",t[t.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",t[t.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",t[t.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",t[t.RED_BITS=3410]="RED_BITS",t[t.GREEN_BITS=3411]="GREEN_BITS",t[t.BLUE_BITS=3412]="BLUE_BITS",t[t.ALPHA_BITS=3413]="ALPHA_BITS",t[t.DEPTH_BITS=3414]="DEPTH_BITS",t[t.STENCIL_BITS=3415]="STENCIL_BITS",t[t.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",t[t.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",t[t.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",t[t.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",t[t.SAMPLES=32937]="SAMPLES",t[t.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",t[t.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",t[t.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",t[t.DONT_CARE=4352]="DONT_CARE",t[t.FASTEST=4353]="FASTEST",t[t.NICEST=4354]="NICEST",t[t.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.INT=5124]="INT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.FLOAT=5126]="FLOAT",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.ALPHA=6406]="ALPHA",t[t.RGB=6407]="RGB",t[t.RGBA=6408]="RGBA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",t[t.VERTEX_SHADER=35633]="VERTEX_SHADER",t[t.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",t[t.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",t[t.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",t[t.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",t[t.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",t[t.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",t[t.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",t[t.SHADER_TYPE=35663]="SHADER_TYPE",t[t.DELETE_STATUS=35712]="DELETE_STATUS",t[t.LINK_STATUS=35714]="LINK_STATUS",t[t.VALIDATE_STATUS=35715]="VALIDATE_STATUS",t[t.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",t[t.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",t[t.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",t[t.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",t[t.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",t[t.NEVER=512]="NEVER",t[t.LESS=513]="LESS",t[t.EQUAL=514]="EQUAL",t[t.LEQUAL=515]="LEQUAL",t[t.GREATER=516]="GREATER",t[t.NOTEQUAL=517]="NOTEQUAL",t[t.GEQUAL=518]="GEQUAL",t[t.ALWAYS=519]="ALWAYS",t[t.KEEP=7680]="KEEP",t[t.REPLACE=7681]="REPLACE",t[t.INCR=7682]="INCR",t[t.DECR=7683]="DECR",t[t.INVERT=5386]="INVERT",t[t.INCR_WRAP=34055]="INCR_WRAP",t[t.DECR_WRAP=34056]="DECR_WRAP",t[t.VENDOR=7936]="VENDOR",t[t.RENDERER=7937]="RENDERER",t[t.VERSION=7938]="VERSION",t[t.NEAREST=9728]="NEAREST",t[t.LINEAR=9729]="LINEAR",t[t.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",t[t.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",t[t.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",t[t.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",t[t.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",t[t.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",t[t.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",t[t.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE=5890]="TEXTURE",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t[t.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",t[t.TEXTURE0=33984]="TEXTURE0",t[t.TEXTURE1=33985]="TEXTURE1",t[t.TEXTURE2=33986]="TEXTURE2",t[t.TEXTURE3=33987]="TEXTURE3",t[t.TEXTURE4=33988]="TEXTURE4",t[t.TEXTURE5=33989]="TEXTURE5",t[t.TEXTURE6=33990]="TEXTURE6",t[t.TEXTURE7=33991]="TEXTURE7",t[t.TEXTURE8=33992]="TEXTURE8",t[t.TEXTURE9=33993]="TEXTURE9",t[t.TEXTURE10=33994]="TEXTURE10",t[t.TEXTURE11=33995]="TEXTURE11",t[t.TEXTURE12=33996]="TEXTURE12",t[t.TEXTURE13=33997]="TEXTURE13",t[t.TEXTURE14=33998]="TEXTURE14",t[t.TEXTURE15=33999]="TEXTURE15",t[t.TEXTURE16=34e3]="TEXTURE16",t[t.TEXTURE17=34001]="TEXTURE17",t[t.TEXTURE18=34002]="TEXTURE18",t[t.TEXTURE19=34003]="TEXTURE19",t[t.TEXTURE20=34004]="TEXTURE20",t[t.TEXTURE21=34005]="TEXTURE21",t[t.TEXTURE22=34006]="TEXTURE22",t[t.TEXTURE23=34007]="TEXTURE23",t[t.TEXTURE24=34008]="TEXTURE24",t[t.TEXTURE25=34009]="TEXTURE25",t[t.TEXTURE26=34010]="TEXTURE26",t[t.TEXTURE27=34011]="TEXTURE27",t[t.TEXTURE28=34012]="TEXTURE28",t[t.TEXTURE29=34013]="TEXTURE29",t[t.TEXTURE30=34014]="TEXTURE30",t[t.TEXTURE31=34015]="TEXTURE31",t[t.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",t[t.REPEAT=10497]="REPEAT",t[t.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t[t.FLOAT_VEC2=35664]="FLOAT_VEC2",t[t.FLOAT_VEC3=35665]="FLOAT_VEC3",t[t.FLOAT_VEC4=35666]="FLOAT_VEC4",t[t.INT_VEC2=35667]="INT_VEC2",t[t.INT_VEC3=35668]="INT_VEC3",t[t.INT_VEC4=35669]="INT_VEC4",t[t.BOOL=35670]="BOOL",t[t.BOOL_VEC2=35671]="BOOL_VEC2",t[t.BOOL_VEC3=35672]="BOOL_VEC3",t[t.BOOL_VEC4=35673]="BOOL_VEC4",t[t.FLOAT_MAT2=35674]="FLOAT_MAT2",t[t.FLOAT_MAT3=35675]="FLOAT_MAT3",t[t.FLOAT_MAT4=35676]="FLOAT_MAT4",t[t.SAMPLER_2D=35678]="SAMPLER_2D",t[t.SAMPLER_CUBE=35680]="SAMPLER_CUBE",t[t.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",t[t.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",t[t.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",t[t.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",t[t.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",t[t.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",t[t.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",t[t.COMPILE_STATUS=35713]="COMPILE_STATUS",t[t.LOW_FLOAT=36336]="LOW_FLOAT",t[t.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",t[t.HIGH_FLOAT=36338]="HIGH_FLOAT",t[t.LOW_INT=36339]="LOW_INT",t[t.MEDIUM_INT=36340]="MEDIUM_INT",t[t.HIGH_INT=36341]="HIGH_INT",t[t.FRAMEBUFFER=36160]="FRAMEBUFFER",t[t.RENDERBUFFER=36161]="RENDERBUFFER",t[t.RGBA4=32854]="RGBA4",t[t.RGB5_A1=32855]="RGB5_A1",t[t.RGB565=36194]="RGB565",t[t.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",t[t.STENCIL_INDEX=6401]="STENCIL_INDEX",t[t.STENCIL_INDEX8=36168]="STENCIL_INDEX8",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t[t.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",t[t.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",t[t.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",t[t.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",t[t.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",t[t.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",t[t.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",t[t.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",t[t.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",t[t.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",t[t.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",t[t.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",t[t.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",t[t.NONE=0]="NONE",t[t.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",t[t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",t[t.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",t[t.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",t[t.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",t[t.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",t[t.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",t[t.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",t[t.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",t[t.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",t[t.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",t[t.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",t[t.COPY_SRC=1]="COPY_SRC",t[t.COPY_DST=2]="COPY_DST",t[t.SAMPLED=4]="SAMPLED",t[t.STORAGE=8]="STORAGE",t[t.RENDER_ATTACHMENT=16]="RENDER_ATTACHMENT"}(Dg||(Dg={})),"undefined"!=typeof navigator&&/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),function(t){t.Void="Void",t.Boolean="Boolean",t.Float="Float",t.Uint32="Uint32",t.Int32="Int32",t.Vector="Vector",t.Vector2Float="vec2<f32>",t.Vector3Float="vec3<f32>",t.Vector4Float="vec4<f32>",t.Vector2Boolean="vec2<bool>",t.Vector3Boolean="vec3<bool>",t.Vector4Boolean="vec4<bool>",t.Vector2Uint="vec2<u32>",t.Vector3Uint="vec3<u32>",t.Vector4Uint="vec4<u32>",t.Vector2Int="vec2<i32>",t.Vector3Int="vec3<i32>",t.Vector4Int="vec4<i32>",t.Matrix="Matrix",t.Matrix3x3Float="mat3x3<f32>",t.Matrix4x4Float="mat4x4<i32>",t.Struct="Struct",t.FloatArray="Float[]",t.Vector4FloatArray="vec4<f32>[]"}(Ug||(Ug={})),function(t){t.Program="Program",t.Identifier="Identifier",t.VariableDeclaration="VariableDeclaration",t.BlockStatement="BlockStatement",t.ReturnStatement="ReturnStatement",t.FunctionDeclaration="FunctionDeclaration",t.VariableDeclarator="VariableDeclarator",t.AssignmentExpression="AssignmentExpression",t.LogicalExpression="LogicalExpression",t.BinaryExpression="BinaryExpression",t.ArrayExpression="ArrayExpression",t.UnaryExpression="UnaryExpression",t.UpdateExpression="UpdateExpression",t.FunctionExpression="FunctionExpression",t.MemberExpression="MemberExpression",t.ConditionalExpression="ConditionalExpression",t.ExpressionStatement="ExpressionStatement",t.CallExpression="CallExpression",t.NumThreadStatement="NumThreadStatement",t.StorageStatement="StorageStatement",t.DoWhileStatement="DoWhileStatement",t.WhileStatement="WhileStatement",t.ForStatement="ForStatement",t.BreakStatement="BreakStatement",t.ContinueStatement="ContinueStatement",t.IfStatement="IfStatement",t.ImportedFunctionStatement="ImportedFunctionStatement"}(Bg||(Bg={})),function(t){t.Input="Input",t.Output="Output",t.Uniform="Uniform",t.Workgroup="Workgroup",t.UniformConstant="UniformConstant",t.Image="Image",t.StorageBuffer="StorageBuffer",t.Private="Private",t.Function="Function"}(Fg||(Fg={})),function(t){t.GLSL100="GLSL100",t.GLSL450="GLSL450",t.WGSL="WGSL"}(kg||(kg={})),it((function(t,e){t.exports=function(){var t=function(t){return t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof Float32Array||t instanceof Float64Array||t instanceof Uint8ClampedArray},e=function(t,e){for(var r=Object.keys(e),n=0;n<r.length;++n)t[r[n]]=e[r[n]];return t},r="\n";function n(t){return"undefined"!=typeof atob?atob(t):"base64:"+t}function i(t){var e=new Error("(regl) "+t);throw console.error(e),e}function o(t,e){t||i(e)}function s(t){return t?": "+t:""}function a(t,e,r){t in e||i("unknown parameter ("+t+")"+s(r)+". possible values: "+Object.keys(e).join())}function h(e,r){t(e)||i("invalid parameter type"+s(r)+". must be a typed array")}function u(t,e){switch(e){case"number":return"number"==typeof t;case"object":return"object"==typeof t;case"string":return"string"==typeof t;case"boolean":return"boolean"==typeof t;case"function":return"function"==typeof t;case"undefined":return void 0===t;case"symbol":return"symbol"==typeof t}}function l(t,e,r){u(t,e)||i("invalid parameter type"+s(r)+". expected "+e+", got "+typeof t)}function c(t,e){t>=0&&(0|t)===t||i("invalid parameter type, ("+t+")"+s(e)+". must be a nonnegative integer")}function d(t,e,r){e.indexOf(t)<0&&i("invalid value"+s(r)+". must be one of: "+e)}var f=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function p(t){Object.keys(t).forEach((function(t){f.indexOf(t)<0&&i('invalid regl constructor argument "'+t+'". must be one of '+f)}))}function m(t,e){for(t+="";t.length<e;)t=" "+t;return t}function g(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function v(t,e){this.number=t,this.line=e,this.errors=[]}function y(t,e,r){this.file=t,this.line=e,this.message=r}function b(){var t=new Error,e=(t.stack||t).toString(),r=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(e);if(r)return r[1];var n=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(e);return n?n[1]:"unknown"}function _(){var t=new Error,e=(t.stack||t).toString(),r=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(e);if(r)return r[1];var n=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(e);return n?n[1]:"unknown"}function E(t,e){var r=t.split("\n"),i=1,o=0,s={unknown:new g,0:new g};s.unknown.name=s[0].name=e||b(),s.unknown.lines.push(new v(0,""));for(var a=0;a<r.length;++a){var h=r[a],u=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(h);if(u)switch(u[1]){case"line":var l=/(\d+)(\s+\d+)?/.exec(u[2]);l&&(i=0|l[1],l[2]&&((o=0|l[2])in s||(s[o]=new g)));break;case"define":var c=/SHADER_NAME(_B64)?\s+(.*)$/.exec(u[2]);c&&(s[o].name=c[1]?n(c[2]):c[2])}s[o].lines.push(new v(i++,h))}return Object.keys(s).forEach((function(t){var e=s[t];e.lines.forEach((function(t){e.index[t.number]=t}))})),s}function x(t){var e=[];return t.split("\n").forEach((function(t){if(!(t.length<5)){var r=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(t);r?e.push(new y(0|r[1],0|r[2],r[3].trim())):t.length>0&&e.push(new y("unknown",0,t))}})),e}function T(t,e){e.forEach((function(e){var r=t[e.file];if(r){var n=r.index[e.line];if(n)return n.errors.push(e),void(r.hasErrors=!0)}t.unknown.hasErrors=!0,t.unknown.lines[0].errors.push(e)}))}function w(t,e,n,i,s){if(!t.getShaderParameter(e,t.COMPILE_STATUS)){var a=t.getShaderInfoLog(e),h=i===t.FRAGMENT_SHADER?"fragment":"vertex";L(n,"string",h+" shader source must be a string",s);var u=E(n,s),l=x(a);T(u,l),Object.keys(u).forEach((function(t){var e=u[t];if(e.hasErrors){var n=[""],i=[""];o("file number "+t+": "+e.name+"\n","color:red;text-decoration:underline;font-weight:bold"),e.lines.forEach((function(t){if(t.errors.length>0){o(m(t.number,4)+"|  ","background-color:yellow; font-weight:bold"),o(t.line+r,"color:red; background-color:yellow; font-weight:bold");var e=0;t.errors.forEach((function(n){var i=n.message,s=/^\s*'(.*)'\s*:\s*(.*)$/.exec(i);if(s){var a=s[1];switch(i=s[2],a){case"assign":a="="}e=Math.max(t.line.indexOf(a,e),0)}else e=0;o(m("| ",6)),o(m("^^^",e+3)+r,"font-weight:bold"),o(m("| ",6)),o(i+r,"font-weight:bold")})),o(m("| ",6)+r)}else o(m(t.number,4)+"|  "),o(t.line+r,"color:red")})),"undefined"==typeof document||window.chrome?console.log(n.join("")):(i[0]=n.join("%c"),console.log.apply(console,i))}function o(t,e){n.push(t),i.push(e||"")}})),o.raise("Error compiling "+h+" shader, "+u[0].name)}}function A(t,e,n,i,s){if(!t.getProgramParameter(e,t.LINK_STATUS)){var a=t.getProgramInfoLog(e),h=E(n,s),u='Error linking program with vertex shader, "'+E(i,s)[0].name+'", and fragment shader "'+h[0].name+'"';"undefined"!=typeof document?console.log("%c"+u+r+"%c"+a,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(u+r+a),o.raise(u)}}function S(t){t._commandRef=b()}function O(t,e,r,n){function i(t){return t?n.id(t):0}function o(t,e){Object.keys(e).forEach((function(e){t[n.id(e)]=!0}))}S(t),t._fragId=i(t.static.frag),t._vertId=i(t.static.vert);var s=t._uniformSet={};o(s,e.static),o(s,e.dynamic);var a=t._attributeSet={};o(a,r.static),o(a,r.dynamic),t._hasCount="count"in t.static||"count"in t.dynamic||"elements"in t.static||"elements"in t.dynamic}function I(t,e){var r=_();i(t+" in command "+(e||b())+("unknown"===r?"":" called from "+r))}function R(t,e,r){t||I(e,r||b())}function N(t,e,r,n){t in e||I("unknown parameter ("+t+")"+s(r)+". possible values: "+Object.keys(e).join(),n||b())}function L(t,e,r,n){u(t,e)||I("invalid parameter type"+s(r)+". expected "+e+", got "+typeof t,n||b())}function M(t){t()}function P(t,e,r){t.texture?d(t.texture._texture.internalformat,e,"unsupported texture format for attachment"):d(t.renderbuffer._renderbuffer.format,r,"unsupported renderbuffer format for attachment")}var C=33071,D=9728,U=9984,B=9985,F=9986,k=9987,G=5121,j=5122,H=5123,X=5124,z=5125,V=5126,W=32819,Y=32820,q=33635,K=34042,Z=36193,J={};function Q(t,e){return t===Y||t===W||t===q?2:t===K?4:J[t]*e}function $(t){return!(t&t-1||!t)}function tt(t,e,r){var n,i=e.width,s=e.height,a=e.channels;o(i>0&&i<=r.maxTextureSize&&s>0&&s<=r.maxTextureSize,"invalid texture shape"),t.wrapS===C&&t.wrapT===C||o($(i)&&$(s),"incompatible wrap mode for texture, both width and height must be power of 2"),1===e.mipmask?1!==i&&1!==s&&o(t.minFilter!==U&&t.minFilter!==F&&t.minFilter!==B&&t.minFilter!==k,"min filter requires mipmap"):(o($(i)&&$(s),"texture must be a square power of 2 to support mipmapping"),o(e.mipmask===(i<<1)-1,"missing or incomplete mipmap data")),e.type===V&&(r.extensions.indexOf("oes_texture_float_linear")<0&&o(t.minFilter===D&&t.magFilter===D,"filter not supported, must enable oes_texture_float_linear"),o(!t.genMipmaps,"mipmap generation not supported with float textures"));var h=e.images;for(n=0;n<16;++n)if(h[n]){var u=i>>n,l=s>>n;o(e.mipmask&1<<n,"missing mipmap data");var c=h[n];if(o(c.width===u&&c.height===l,"invalid shape for mip images"),o(c.format===e.format&&c.internalformat===e.internalformat&&c.type===e.type,"incompatible type for mip image"),c.compressed);else if(c.data){var d=Math.ceil(Q(c.type,a)*u/c.unpackAlignment)*c.unpackAlignment;o(c.data.byteLength===d*l,"invalid data for image, buffer size is inconsistent with image format")}else c.element||c.copy}else t.genMipmaps||o(0==(e.mipmask&1<<n),"extra mipmap data");e.compressed&&o(!t.genMipmaps,"mipmap generation for compressed images not supported")}function et(t,e,r,n){var i=t.width,s=t.height,a=t.channels;o(i>0&&i<=n.maxTextureSize&&s>0&&s<=n.maxTextureSize,"invalid texture shape"),o(i===s,"cube map must be square"),o(e.wrapS===C&&e.wrapT===C,"wrap mode not supported by cube map");for(var h=0;h<r.length;++h){var u=r[h];o(u.width===i&&u.height===s,"inconsistent cube map face shape"),e.genMipmaps&&(o(!u.compressed,"can not generate mipmap for compressed textures"),o(1===u.mipmask,"can not specify mipmaps and generate mipmaps"));for(var l=u.images,c=0;c<16;++c){var d=l[c];if(d){var f=i>>c,p=s>>c;o(u.mipmask&1<<c,"missing mipmap data"),o(d.width===f&&d.height===p,"invalid shape for mip images"),o(d.format===t.format&&d.internalformat===t.internalformat&&d.type===t.type,"incompatible type for mip image"),d.compressed||(d.data?o(d.data.byteLength===f*p*Math.max(Q(d.type,a),d.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):d.element||d.copy)}}}}J[5120]=J[G]=1,J[j]=J[H]=J[Z]=J[q]=J[W]=J[Y]=2,J[X]=J[z]=J[V]=J[K]=4;var rt=e(o,{optional:M,raise:i,commandRaise:I,command:R,parameter:a,commandParameter:N,constructor:p,type:l,commandType:L,isTypedArray:h,nni:c,oneOf:d,shaderError:w,linkError:A,callSite:_,saveCommandRef:S,saveDrawInfo:O,framebufferFormat:P,guessCommand:b,texture2D:tt,textureCube:et}),nt=0,it=0,ot=5,st=6;function at(t,e){this.id=nt++,this.type=t,this.data=e}function ht(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function ut(t){if(0===t.length)return[];var e=t.charAt(0),r=t.charAt(t.length-1);if(t.length>1&&e===r&&('"'===e||"'"===e))return['"'+ht(t.substr(1,t.length-2))+'"'];var n=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(t);if(n)return ut(t.substr(0,n.index)).concat(ut(n[1])).concat(ut(t.substr(n.index+n[0].length)));var i=t.split(".");if(1===i.length)return['"'+ht(t)+'"'];for(var o=[],s=0;s<i.length;++s)o=o.concat(ut(i[s]));return o}function lt(t){return"["+ut(t).join("][")+"]"}function ct(t,e){return new at(t,lt(e+""))}function dt(t){return"function"==typeof t&&!t._reglType||t instanceof at}function ft(t,e){return"function"==typeof t?new at(it,t):"number"==typeof t||"boolean"==typeof t?new at(ot,t):Array.isArray(t)?new at(st,t.map((t,r)=>ft(t,e+"["+r+"]"))):t instanceof at?t:void rt(!1,"invalid option type in uniform "+e)}var pt={DynamicVariable:at,define:ct,isDynamic:dt,unbox:ft,accessor:lt},mt={next:"function"==typeof requestAnimationFrame?function(t){return requestAnimationFrame(t)}:function(t){return setTimeout(t,16)},cancel:"function"==typeof cancelAnimationFrame?function(t){return cancelAnimationFrame(t)}:clearTimeout},gt="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date};function vt(){var t={"":0},e=[""];return{id:function(r){var n=t[r];return n||(n=t[r]=e.length,e.push(r),n)},str:function(t){return e[t]}}}function yt(t,r,n){var i,o=document.createElement("canvas");function s(){var r=window.innerWidth,i=window.innerHeight;if(t!==document.body){var s=t.getBoundingClientRect();r=s.right-s.left,i=s.bottom-s.top}o.width=n*r,o.height=n*i,e(o.style,{width:r+"px",height:i+"px"})}function a(){i?i.disconnect():window.removeEventListener("resize",s),t.removeChild(o)}return e(o.style,{border:0,margin:0,padding:0,top:0,left:0}),t.appendChild(o),t===document.body&&(o.style.position="absolute",e(t.style,{margin:0,padding:0})),t!==document.body&&"function"==typeof ResizeObserver?(i=new ResizeObserver((function(){setTimeout(s)}))).observe(t):window.addEventListener("resize",s,!1),s(),{canvas:o,onDestroy:a}}function bt(t,e){function r(r){try{return t.getContext(r,e)}catch(t){return null}}return r("webgl")||r("experimental-webgl")||r("webgl-experimental")}function _t(t){return"string"==typeof t.nodeName&&"function"==typeof t.appendChild&&"function"==typeof t.getBoundingClientRect}function Et(t){return"function"==typeof t.drawArrays||"function"==typeof t.drawElements}function xt(t){return"string"==typeof t?t.split():(rt(Array.isArray(t),"invalid extension array"),t)}function Tt(t){return"string"==typeof t?(rt("undefined"!=typeof document,"not supported outside of DOM"),document.querySelector(t)):t}function wt(t){var e,r,n,i,o=t||{},s={},a=[],h=[],u="undefined"==typeof window?1:window.devicePixelRatio,l=!1,c=function(t){t&&rt.raise(t)},d=function(){};if("string"==typeof o?(rt("undefined"!=typeof document,"selector queries only supported in DOM enviroments"),e=document.querySelector(o),rt(e,"invalid query string for element")):"object"==typeof o?_t(o)?e=o:Et(o)?n=(i=o).canvas:(rt.constructor(o),"gl"in o?i=o.gl:"canvas"in o?n=Tt(o.canvas):"container"in o&&(r=Tt(o.container)),"attributes"in o&&(s=o.attributes,rt.type(s,"object","invalid context attributes")),"extensions"in o&&(a=xt(o.extensions)),"optionalExtensions"in o&&(h=xt(o.optionalExtensions)),"onDone"in o&&(rt.type(o.onDone,"function","invalid or missing onDone callback"),c=o.onDone),"profile"in o&&(l=!!o.profile),"pixelRatio"in o&&(u=+o.pixelRatio,rt(u>0,"invalid pixel ratio"))):rt.raise("invalid arguments to regl"),e&&("canvas"===e.nodeName.toLowerCase()?n=e:r=e),!i){if(!n){rt("undefined"!=typeof document,"must manually specify webgl context outside of DOM environments");var f=yt(r||document.body,c,u);if(!f)return null;n=f.canvas,d=f.onDestroy}void 0===s.premultipliedAlpha&&(s.premultipliedAlpha=!0),i=bt(n,s)}return i?{gl:i,canvas:n,container:r,extensions:a,optionalExtensions:h,pixelRatio:u,profile:l,onDone:c,onDestroy:d}:(d(),c("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function At(t,e){var r={};function n(e){rt.type(e,"string","extension name must be string");var n,i=e.toLowerCase();try{n=r[i]=t.getExtension(i)}catch(t){}return!!n}for(var i=0;i<e.extensions.length;++i){var o=e.extensions[i];if(!n(o))return e.onDestroy(),e.onDone('"'+o+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return e.optionalExtensions.forEach(n),{extensions:r,restore:function(){Object.keys(r).forEach((function(t){if(r[t]&&!n(t))throw new Error("(regl): error restoring extension "+t)}))}}}function St(t,e){for(var r=Array(t),n=0;n<t;++n)r[n]=e(n);return r}var Ot=5120,It=5121,Rt=5122,Nt=5123,Lt=5124,Mt=5125,Pt=5126;function Ct(t){for(var e=16;e<=1<<28;e*=16)if(t<=e)return e;return 0}function Dt(t){var e,r;return e=(t>65535)<<4,e|=r=((t>>>=e)>255)<<3,e|=r=((t>>>=r)>15)<<2,(e|=r=((t>>>=r)>3)<<1)|(t>>>=r)>>1}function Ut(){var t=St(8,(function(){return[]}));function e(e){var r=Ct(e),n=t[Dt(r)>>2];return n.length>0?n.pop():new ArrayBuffer(r)}function r(e){t[Dt(e.byteLength)>>2].push(e)}function n(t,r){var n=null;switch(t){case Ot:n=new Int8Array(e(r),0,r);break;case It:n=new Uint8Array(e(r),0,r);break;case Rt:n=new Int16Array(e(2*r),0,r);break;case Nt:n=new Uint16Array(e(2*r),0,r);break;case Lt:n=new Int32Array(e(4*r),0,r);break;case Mt:n=new Uint32Array(e(4*r),0,r);break;case Pt:n=new Float32Array(e(4*r),0,r);break;default:return null}return n.length!==r?n.subarray(0,r):n}function i(t){r(t.buffer)}return{alloc:e,free:r,allocType:n,freeType:i}}var Bt=Ut();Bt.zero=Ut();var Ft=3408,kt=3410,Gt=3411,jt=3412,Ht=3413,Xt=3414,zt=3415,Vt=33901,Wt=33902,Yt=3379,qt=3386,Kt=34921,Zt=36347,Jt=36348,Qt=35661,$t=35660,te=34930,ee=36349,re=34076,ne=34024,ie=7936,oe=7937,se=7938,ae=35724,he=34047,ue=36063,le=34852,ce=3553,de=34067,fe=34069,pe=33984,me=6408,ge=5126,ve=5121,ye=36160,be=36053,_e=36064,Ee=16384,xe=function(t,e){var r=1;e.ext_texture_filter_anisotropic&&(r=t.getParameter(he));var n=1,i=1;e.webgl_draw_buffers&&(n=t.getParameter(le),i=t.getParameter(ue));var o=!!e.oes_texture_float;if(o){var s=t.createTexture();t.bindTexture(ce,s),t.texImage2D(ce,0,me,1,1,0,me,ge,null);var a=t.createFramebuffer();if(t.bindFramebuffer(ye,a),t.framebufferTexture2D(ye,_e,ce,s,0),t.bindTexture(ce,null),t.checkFramebufferStatus(ye)!==be)o=!1;else{t.viewport(0,0,1,1),t.clearColor(1,0,0,1),t.clear(Ee);var h=Bt.allocType(ge,4);t.readPixels(0,0,1,1,me,ge,h),t.getError()?o=!1:(t.deleteFramebuffer(a),t.deleteTexture(s),o=1===h[0]),Bt.freeType(h)}}var u=!0;if("undefined"==typeof navigator||!(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))){var l=t.createTexture(),c=Bt.allocType(ve,36);t.activeTexture(pe),t.bindTexture(de,l),t.texImage2D(fe,0,me,3,3,0,me,ve,c),Bt.freeType(c),t.bindTexture(de,null),t.deleteTexture(l),u=!t.getError()}return{colorBits:[t.getParameter(kt),t.getParameter(Gt),t.getParameter(jt),t.getParameter(Ht)],depthBits:t.getParameter(Xt),stencilBits:t.getParameter(zt),subpixelBits:t.getParameter(Ft),extensions:Object.keys(e).filter((function(t){return!!e[t]})),maxAnisotropic:r,maxDrawbuffers:n,maxColorAttachments:i,pointSizeDims:t.getParameter(Vt),lineWidthDims:t.getParameter(Wt),maxViewportDims:t.getParameter(qt),maxCombinedTextureUnits:t.getParameter(Qt),maxCubeMapSize:t.getParameter(re),maxRenderbufferSize:t.getParameter(ne),maxTextureUnits:t.getParameter(te),maxTextureSize:t.getParameter(Yt),maxAttributes:t.getParameter(Kt),maxVertexUniforms:t.getParameter(Zt),maxVertexTextureUnits:t.getParameter($t),maxVaryingVectors:t.getParameter(Jt),maxFragmentUniforms:t.getParameter(ee),glsl:t.getParameter(ae),renderer:t.getParameter(oe),vendor:t.getParameter(ie),version:t.getParameter(se),readFloat:o,npotTextureCube:u}};function Te(e){return!!e&&"object"==typeof e&&Array.isArray(e.shape)&&Array.isArray(e.stride)&&"number"==typeof e.offset&&e.shape.length===e.stride.length&&(Array.isArray(e.data)||t(e.data))}var we=function(t){return Object.keys(t).map((function(e){return t[e]}))},Ae={shape:Le,flatten:Ne};function Se(t,e,r){for(var n=0;n<e;++n)r[n]=t[n]}function Oe(t,e,r,n){for(var i=0,o=0;o<e;++o)for(var s=t[o],a=0;a<r;++a)n[i++]=s[a]}function Ie(t,e,r,n,i,o){for(var s=o,a=0;a<e;++a)for(var h=t[a],u=0;u<r;++u)for(var l=h[u],c=0;c<n;++c)i[s++]=l[c]}function Re(t,e,r,n,i){for(var o=1,s=r+1;s<e.length;++s)o*=e[s];var a=e[r];if(e.length-r==4){var h=e[r+1],u=e[r+2],l=e[r+3];for(s=0;s<a;++s)Ie(t[s],h,u,l,n,i),i+=o}else for(s=0;s<a;++s)Re(t[s],e,r+1,n,i),i+=o}function Ne(t,e,r,n){var i=1;if(e.length)for(var o=0;o<e.length;++o)i*=e[o];else i=0;var s=n||Bt.allocType(r,i);switch(e.length){case 0:break;case 1:Se(t,e[0],s);break;case 2:Oe(t,e[0],e[1],s);break;case 3:Ie(t,e[0],e[1],e[2],s,0);break;default:Re(t,e,0,s,0)}return s}function Le(t){for(var e=[],r=t;r.length;r=r[0])e.push(r.length);return e}var Me={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Pe={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},Ce={dynamic:35048,stream:35040,static:35044},De=Ae.flatten,Ue=Ae.shape,Be=35044,Fe=35040,ke=5121,Ge=5126,je=[];function He(t){return 0|Me[Object.prototype.toString.call(t)]}function Xe(t,e){for(var r=0;r<e.length;++r)t[r]=e[r]}function ze(t,e,r,n,i,o,s){for(var a=0,h=0;h<r;++h)for(var u=0;u<n;++u)t[a++]=e[i*h+o*u+s]}function Ve(e,r,n,i){var o=0,s={};function a(t){this.id=o++,this.buffer=e.createBuffer(),this.type=t,this.usage=Be,this.byteLength=0,this.dimension=1,this.dtype=ke,this.persistentData=null,n.profile&&(this.stats={size:0})}a.prototype.bind=function(){e.bindBuffer(this.type,this.buffer)},a.prototype.destroy=function(){f(this)};var h=[];function u(t,e){var r=h.pop();return r||(r=new a(t)),r.bind(),d(r,e,Fe,0,1,!1),r}function l(t){h.push(t)}function c(t,r,n){t.byteLength=r.byteLength,e.bufferData(t.type,r,n)}function d(e,r,n,i,o,s){var a,h;if(e.usage=n,Array.isArray(r)){if(e.dtype=i||Ge,r.length>0)if(Array.isArray(r[0])){a=Ue(r);for(var u=1,l=1;l<a.length;++l)u*=a[l];e.dimension=u,c(e,h=De(r,a,e.dtype),n),s?e.persistentData=h:Bt.freeType(h)}else if("number"==typeof r[0]){e.dimension=o;var d=Bt.allocType(e.dtype,r.length);Xe(d,r),c(e,d,n),s?e.persistentData=d:Bt.freeType(d)}else t(r[0])?(e.dimension=r[0].length,e.dtype=i||He(r[0])||Ge,c(e,h=De(r,[r.length,r[0].length],e.dtype),n),s?e.persistentData=h:Bt.freeType(h)):rt.raise("invalid buffer data")}else if(t(r))e.dtype=i||He(r),e.dimension=o,c(e,r,n),s&&(e.persistentData=new Uint8Array(new Uint8Array(r.buffer)));else if(Te(r)){a=r.shape;var f=r.stride,p=r.offset,m=0,g=0,v=0,y=0;1===a.length?(m=a[0],g=1,v=f[0],y=0):2===a.length?(m=a[0],g=a[1],v=f[0],y=f[1]):rt.raise("invalid shape"),e.dtype=i||He(r.data)||Ge,e.dimension=g;var b=Bt.allocType(e.dtype,m*g);ze(b,r.data,m,g,v,y,p),c(e,b,n),s?e.persistentData=b:Bt.freeType(b)}else r instanceof ArrayBuffer?(e.dtype=ke,e.dimension=o,c(e,r,n),s&&(e.persistentData=new Uint8Array(new Uint8Array(r)))):rt.raise("invalid buffer data")}function f(t){r.bufferCount--,i(t);var n=t.buffer;rt(n,"buffer must not be deleted already"),e.deleteBuffer(n),t.buffer=null,delete s[t.id]}function p(i,o,h,u){r.bufferCount++;var l=new a(o);function c(r){var i=Be,o=null,s=0,a=0,h=1;return Array.isArray(r)||t(r)||Te(r)||r instanceof ArrayBuffer?o=r:"number"==typeof r?s=0|r:r&&(rt.type(r,"object","buffer arguments must be an object, a number or an array"),"data"in r&&(rt(null===o||Array.isArray(o)||t(o)||Te(o),"invalid data for buffer"),o=r.data),"usage"in r&&(rt.parameter(r.usage,Ce,"invalid buffer usage"),i=Ce[r.usage]),"type"in r&&(rt.parameter(r.type,Pe,"invalid buffer type"),a=Pe[r.type]),"dimension"in r&&(rt.type(r.dimension,"number","invalid dimension"),h=0|r.dimension),"length"in r&&(rt.nni(s,"buffer length must be a nonnegative integer"),s=0|r.length)),l.bind(),o?d(l,o,i,a,h,u):(s&&e.bufferData(l.type,s,i),l.dtype=a||ke,l.usage=i,l.dimension=h,l.byteLength=s),n.profile&&(l.stats.size=l.byteLength*je[l.dtype]),c}function p(t,r){rt(r+t.byteLength<=l.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+t.byteLength+" starting from offset "+r+" to a buffer of size "+l.byteLength),e.bufferSubData(l.type,r,t)}function m(e,r){var n,i=0|(r||0);if(l.bind(),t(e)||e instanceof ArrayBuffer)p(e,i);else if(Array.isArray(e)){if(e.length>0)if("number"==typeof e[0]){var o=Bt.allocType(l.dtype,e.length);Xe(o,e),p(o,i),Bt.freeType(o)}else if(Array.isArray(e[0])||t(e[0])){n=Ue(e);var s=De(e,n,l.dtype);p(s,i),Bt.freeType(s)}else rt.raise("invalid buffer data")}else if(Te(e)){n=e.shape;var a=e.stride,h=0,u=0,d=0,f=0;1===n.length?(h=n[0],u=1,d=a[0],f=0):2===n.length?(h=n[0],u=n[1],d=a[0],f=a[1]):rt.raise("invalid shape");var m=Array.isArray(e.data)?l.dtype:He(e.data),g=Bt.allocType(m,h*u);ze(g,e.data,h,u,d,f,e.offset),p(g,i),Bt.freeType(g)}else rt.raise("invalid data for buffer subdata");return c}return s[l.id]=l,h||c(i),c._reglType="buffer",c._buffer=l,c.subdata=m,n.profile&&(c.stats=l.stats),c.destroy=function(){f(l)},c}function m(){we(s).forEach((function(t){t.buffer=e.createBuffer(),e.bindBuffer(t.type,t.buffer),e.bufferData(t.type,t.persistentData||t.byteLength,t.usage)}))}return n.profile&&(r.getTotalBufferSize=function(){var t=0;return Object.keys(s).forEach((function(e){t+=s[e].stats.size})),t}),{create:p,createStream:u,destroyStream:l,clear:function(){we(s).forEach(f),h.forEach(f)},getBuffer:function(t){return t&&t._buffer instanceof a?t._buffer:null},restore:m,_initBuffer:d}}je[5120]=1,je[5122]=2,je[5124]=4,je[5121]=1,je[5123]=2,je[5125]=4,je[5126]=4;var We={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Ye=0,qe=1,Ke=4,Ze=5120,Je=5121,Qe=5122,$e=5123,tr=5124,er=5125,rr=34963,nr=35040,ir=35044;function or(e,r,n,i){var o={},s=0,a={uint8:Je,uint16:$e};function h(t){this.id=s++,o[this.id]=this,this.buffer=t,this.primType=Ke,this.vertCount=0,this.type=0}r.oes_element_index_uint&&(a.uint32=er),h.prototype.bind=function(){this.buffer.bind()};var u=[];function l(t){var e=u.pop();return e||(e=new h(n.create(null,rr,!0,!1)._buffer)),d(e,t,nr,-1,-1,0,0),e}function c(t){u.push(t)}function d(i,o,s,a,h,u,l){var c;if(i.buffer.bind(),o){var d=l;l||t(o)&&(!Te(o)||t(o.data))||(d=r.oes_element_index_uint?er:$e),n._initBuffer(i.buffer,o,s,d,3)}else e.bufferData(rr,u,s),i.buffer.dtype=c||Je,i.buffer.usage=s,i.buffer.dimension=3,i.buffer.byteLength=u;if(c=l,!l){switch(i.buffer.dtype){case Je:case Ze:c=Je;break;case $e:case Qe:c=$e;break;case er:case tr:c=er;break;default:rt.raise("unsupported type for element array")}i.buffer.dtype=c}i.type=c,rt(c!==er||!!r.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var f=h;f<0&&(f=i.buffer.byteLength,c===$e?f>>=1:c===er&&(f>>=2)),i.vertCount=f;var p=a;if(a<0){p=Ke;var m=i.buffer.dimension;1===m&&(p=Ye),2===m&&(p=qe),3===m&&(p=Ke)}i.primType=p}function f(t){i.elementsCount--,rt(null!==t.buffer,"must not double destroy elements"),delete o[t.id],t.buffer.destroy(),t.buffer=null}function p(e,r){var o=n.create(null,rr,!0),s=new h(o._buffer);function u(e){if(e)if("number"==typeof e)o(e),s.primType=Ke,s.vertCount=0|e,s.type=Je;else{var r=null,n=ir,i=-1,h=-1,l=0,c=0;Array.isArray(e)||t(e)||Te(e)?r=e:(rt.type(e,"object","invalid arguments for elements"),"data"in e&&(r=e.data,rt(Array.isArray(r)||t(r)||Te(r),"invalid data for element buffer")),"usage"in e&&(rt.parameter(e.usage,Ce,"invalid element buffer usage"),n=Ce[e.usage]),"primitive"in e&&(rt.parameter(e.primitive,We,"invalid element buffer primitive"),i=We[e.primitive]),"count"in e&&(rt("number"==typeof e.count&&e.count>=0,"invalid vertex count for elements"),h=0|e.count),"type"in e&&(rt.parameter(e.type,a,"invalid buffer type"),c=a[e.type]),"length"in e?l=0|e.length:(l=h,c===$e||c===Qe?l*=2:c!==er&&c!==tr||(l*=4))),d(s,r,n,i,h,l,c)}else o(),s.primType=Ke,s.vertCount=0,s.type=Je;return u}return i.elementsCount++,u(e),u._reglType="elements",u._elements=s,u.subdata=function(t,e){return o.subdata(t,e),u},u.destroy=function(){f(s)},u}return{create:p,createStream:l,destroyStream:c,getElements:function(t){return"function"==typeof t&&t._elements instanceof h?t._elements:null},clear:function(){we(o).forEach(f)}}}var sr=new Float32Array(1),ar=new Uint32Array(sr.buffer),hr=5123;function ur(t){for(var e=Bt.allocType(hr,t.length),r=0;r<t.length;++r)if(isNaN(t[r]))e[r]=65535;else if(t[r]===1/0)e[r]=31744;else if(t[r]===-1/0)e[r]=64512;else{sr[0]=t[r];var n=ar[0],i=n>>>31<<15,o=(n<<1>>>24)-127,s=n>>13&1023;if(o<-24)e[r]=i;else if(o<-14){var a=-14-o;e[r]=i+(s+1024>>a)}else e[r]=o>15?i+31744:i+(o+15<<10)+s}return e}function lr(e){return Array.isArray(e)||t(e)}var cr=function(t){return!(t&t-1||!t)},dr=34467,fr=3553,pr=34067,mr=34069,gr=6408,vr=6406,yr=6407,br=6409,_r=6410,Er=32854,xr=32855,Tr=36194,wr=32819,Ar=32820,Sr=33635,Or=34042,Ir=6402,Rr=34041,Nr=35904,Lr=35906,Mr=36193,Pr=33776,Cr=33777,Dr=33778,Ur=33779,Br=35986,Fr=35987,kr=34798,Gr=35840,jr=35841,Hr=35842,Xr=35843,zr=36196,Vr=5121,Wr=5123,Yr=5125,qr=5126,Kr=10242,Zr=10243,Jr=10497,Qr=33071,$r=33648,tn=10240,en=10241,rn=9728,nn=9729,on=9984,sn=9985,an=9986,hn=9987,un=33170,ln=4352,cn=4353,dn=4354,fn=34046,pn=3317,mn=37440,gn=37441,vn=37443,yn=37444,bn=33984,_n=[on,an,sn,hn],En=[0,br,_r,yr,gr],xn={};function Tn(t){return"[object "+t+"]"}xn[br]=xn[vr]=xn[Ir]=1,xn[Rr]=xn[_r]=2,xn[yr]=xn[Nr]=3,xn[gr]=xn[Lr]=4;var wn=Tn("HTMLCanvasElement"),An=Tn("OffscreenCanvas"),Sn=Tn("CanvasRenderingContext2D"),On=Tn("ImageBitmap"),In=Tn("HTMLImageElement"),Rn=Tn("HTMLVideoElement"),Nn=Object.keys(Me).concat([wn,An,Sn,On,In,Rn]),Ln=[];Ln[Vr]=1,Ln[qr]=4,Ln[Mr]=2,Ln[Wr]=2,Ln[Yr]=4;var Mn=[];function Pn(t){return Array.isArray(t)&&(0===t.length||"number"==typeof t[0])}function Cn(t){return!!Array.isArray(t)&&!(0===t.length||!lr(t[0]))}function Dn(t){return Object.prototype.toString.call(t)}function Un(t){return Dn(t)===wn}function Bn(t){return Dn(t)===An}function Fn(t){return Dn(t)===Sn}function kn(t){return Dn(t)===On}function Gn(t){return Dn(t)===In}function jn(t){return Dn(t)===Rn}function Hn(t){if(!t)return!1;var e=Dn(t);return Nn.indexOf(e)>=0||Pn(t)||Cn(t)||Te(t)}function Xn(t){return 0|Me[Object.prototype.toString.call(t)]}function zn(t,e){var r=e.length;switch(t.type){case Vr:case Wr:case Yr:case qr:var n=Bt.allocType(t.type,r);n.set(e),t.data=n;break;case Mr:t.data=ur(e);break;default:rt.raise("unsupported texture type, must specify a typed array")}}function Vn(t,e){return Bt.allocType(t.type===Mr?qr:t.type,e)}function Wn(t,e){t.type===Mr?(t.data=ur(e),Bt.freeType(e)):t.data=e}function Yn(t,e,r,n,i,o){for(var s=t.width,a=t.height,h=t.channels,u=Vn(t,s*a*h),l=0,c=0;c<a;++c)for(var d=0;d<s;++d)for(var f=0;f<h;++f)u[l++]=e[r*d+n*c+i*f+o];Wn(t,u)}function qn(t,e,r,n,i,o){var s;if(s=void 0!==Mn[t]?Mn[t]:xn[t]*Ln[e],o&&(s*=6),i){for(var a=0,h=r;h>=1;)a+=s*h*h,h/=2;return a}return s*r*n}function Kn(r,n,i,o,s,a,h){var u={"don't care":ln,"dont care":ln,nice:dn,fast:cn},l={repeat:Jr,clamp:Qr,mirror:$r},c={nearest:rn,linear:nn},d=e({mipmap:hn,"nearest mipmap nearest":on,"linear mipmap nearest":sn,"nearest mipmap linear":an,"linear mipmap linear":hn},c),f={none:0,browser:yn},p={uint8:Vr,rgba4:wr,rgb565:Sr,"rgb5 a1":Ar},m={alpha:vr,luminance:br,"luminance alpha":_r,rgb:yr,rgba:gr,rgba4:Er,"rgb5 a1":xr,rgb565:Tr},g={};n.ext_srgb&&(m.srgb=Nr,m.srgba=Lr),n.oes_texture_float&&(p.float32=p.float=qr),n.oes_texture_half_float&&(p.float16=p["half float"]=Mr),n.webgl_depth_texture&&(e(m,{depth:Ir,"depth stencil":Rr}),e(p,{uint16:Wr,uint32:Yr,"depth stencil":Or})),n.webgl_compressed_texture_s3tc&&e(g,{"rgb s3tc dxt1":Pr,"rgba s3tc dxt1":Cr,"rgba s3tc dxt3":Dr,"rgba s3tc dxt5":Ur}),n.webgl_compressed_texture_atc&&e(g,{"rgb atc":Br,"rgba atc explicit alpha":Fr,"rgba atc interpolated alpha":kr}),n.webgl_compressed_texture_pvrtc&&e(g,{"rgb pvrtc 4bppv1":Gr,"rgb pvrtc 2bppv1":jr,"rgba pvrtc 4bppv1":Hr,"rgba pvrtc 2bppv1":Xr}),n.webgl_compressed_texture_etc1&&(g["rgb etc1"]=zr);var v=Array.prototype.slice.call(r.getParameter(dr));Object.keys(g).forEach((function(t){var e=g[t];v.indexOf(e)>=0&&(m[t]=e)}));var y=Object.keys(m);i.textureFormats=y;var b=[];Object.keys(m).forEach((function(t){var e=m[t];b[e]=t}));var _=[];Object.keys(p).forEach((function(t){var e=p[t];_[e]=t}));var E=[];Object.keys(c).forEach((function(t){var e=c[t];E[e]=t}));var x=[];Object.keys(d).forEach((function(t){var e=d[t];x[e]=t}));var T=[];Object.keys(l).forEach((function(t){var e=l[t];T[e]=t}));var w=y.reduce((function(t,e){var r=m[e];return r===br||r===vr||r===br||r===_r||r===Ir||r===Rr||n.ext_srgb&&(r===Nr||r===Lr)?t[r]=r:r===xr||e.indexOf("rgba")>=0?t[r]=gr:t[r]=yr,t}),{});function A(){this.internalformat=gr,this.format=gr,this.type=Vr,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=yn,this.width=0,this.height=0,this.channels=0}function S(t,e){t.internalformat=e.internalformat,t.format=e.format,t.type=e.type,t.compressed=e.compressed,t.premultiplyAlpha=e.premultiplyAlpha,t.flipY=e.flipY,t.unpackAlignment=e.unpackAlignment,t.colorSpace=e.colorSpace,t.width=e.width,t.height=e.height,t.channels=e.channels}function O(t,e){if("object"==typeof e&&e){if("premultiplyAlpha"in e&&(rt.type(e.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),t.premultiplyAlpha=e.premultiplyAlpha),"flipY"in e&&(rt.type(e.flipY,"boolean","invalid texture flip"),t.flipY=e.flipY),"alignment"in e&&(rt.oneOf(e.alignment,[1,2,4,8],"invalid texture unpack alignment"),t.unpackAlignment=e.alignment),"colorSpace"in e&&(rt.parameter(e.colorSpace,f,"invalid colorSpace"),t.colorSpace=f[e.colorSpace]),"type"in e){var r=e.type;rt(n.oes_texture_float||!("float"===r||"float32"===r),"you must enable the OES_texture_float extension in order to use floating point textures."),rt(n.oes_texture_half_float||!("half float"===r||"float16"===r),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),rt(n.webgl_depth_texture||!("uint16"===r||"uint32"===r||"depth stencil"===r),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),rt.parameter(r,p,"invalid texture type"),t.type=p[r]}var o=t.width,s=t.height,a=t.channels,h=!1;"shape"in e?(rt(Array.isArray(e.shape)&&e.shape.length>=2,"shape must be an array"),o=e.shape[0],s=e.shape[1],3===e.shape.length&&(a=e.shape[2],rt(a>0&&a<=4,"invalid number of channels"),h=!0),rt(o>=0&&o<=i.maxTextureSize,"invalid width"),rt(s>=0&&s<=i.maxTextureSize,"invalid height")):("radius"in e&&(o=s=e.radius,rt(o>=0&&o<=i.maxTextureSize,"invalid radius")),"width"in e&&(o=e.width,rt(o>=0&&o<=i.maxTextureSize,"invalid width")),"height"in e&&(s=e.height,rt(s>=0&&s<=i.maxTextureSize,"invalid height")),"channels"in e&&(a=e.channels,rt(a>0&&a<=4,"invalid number of channels"),h=!0)),t.width=0|o,t.height=0|s,t.channels=0|a;var u=!1;if("format"in e){var l=e.format;rt(n.webgl_depth_texture||!("depth"===l||"depth stencil"===l),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),rt.parameter(l,m,"invalid texture format");var c=t.internalformat=m[l];t.format=w[c],l in p&&("type"in e||(t.type=p[l])),l in g&&(t.compressed=!0),u=!0}!h&&u?t.channels=xn[t.format]:h&&!u?t.channels!==En[t.format]&&(t.format=t.internalformat=En[t.channels]):u&&h&&rt(t.channels===xn[t.format],"number of channels inconsistent with specified format")}}function I(t){r.pixelStorei(mn,t.flipY),r.pixelStorei(gn,t.premultiplyAlpha),r.pixelStorei(vn,t.colorSpace),r.pixelStorei(pn,t.unpackAlignment)}function R(){A.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function N(e,r){var n=null;if(Hn(r)?n=r:r&&(rt.type(r,"object","invalid pixel data type"),O(e,r),"x"in r&&(e.xOffset=0|r.x),"y"in r&&(e.yOffset=0|r.y),Hn(r.data)&&(n=r.data)),rt(!e.compressed||n instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),r.copy){rt(!n,"can not specify copy and data field for the same texture");var o=s.viewportWidth,a=s.viewportHeight;e.width=e.width||o-e.xOffset,e.height=e.height||a-e.yOffset,e.needsCopy=!0,rt(e.xOffset>=0&&e.xOffset<o&&e.yOffset>=0&&e.yOffset<a&&e.width>0&&e.width<=o&&e.height>0&&e.height<=a,"copy texture read out of bounds")}else if(n){if(t(n))e.channels=e.channels||4,e.data=n,"type"in r||e.type!==Vr||(e.type=Xn(n));else if(Pn(n))e.channels=e.channels||4,zn(e,n),e.alignment=1,e.needsFree=!0;else if(Te(n)){var h=n.data;Array.isArray(h)||e.type!==Vr||(e.type=Xn(h));var u,l,c,d,f,p,m=n.shape,g=n.stride;3===m.length?(c=m[2],p=g[2]):(rt(2===m.length,"invalid ndarray pixel data, must be 2 or 3D"),c=1,p=1),u=m[0],l=m[1],d=g[0],f=g[1],e.alignment=1,e.width=u,e.height=l,e.channels=c,e.format=e.internalformat=En[c],e.needsFree=!0,Yn(e,h,d,f,p,n.offset)}else if(Un(n)||Bn(n)||Fn(n))Un(n)||Bn(n)?e.element=n:e.element=n.canvas,e.width=e.element.width,e.height=e.element.height,e.channels=4;else if(kn(n))e.element=n,e.width=n.width,e.height=n.height,e.channels=4;else if(Gn(n))e.element=n,e.width=n.naturalWidth,e.height=n.naturalHeight,e.channels=4;else if(jn(n))e.element=n,e.width=n.videoWidth,e.height=n.videoHeight,e.channels=4;else if(Cn(n)){var v=e.width||n[0].length,y=e.height||n.length,b=e.channels;b=lr(n[0][0])?b||n[0][0].length:b||1;for(var _=Ae.shape(n),E=1,x=0;x<_.length;++x)E*=_[x];var T=Vn(e,E);Ae.flatten(n,_,"",T),Wn(e,T),e.alignment=1,e.width=v,e.height=y,e.channels=b,e.format=e.internalformat=En[b],e.needsFree=!0}}else e.width=e.width||1,e.height=e.height||1,e.channels=e.channels||4;e.type===qr?rt(i.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):e.type===Mr&&rt(i.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function L(t,e,n){var i=t.element,s=t.data,a=t.internalformat,h=t.format,u=t.type,l=t.width,c=t.height;I(t),i?r.texImage2D(e,n,h,h,u,i):t.compressed?r.compressedTexImage2D(e,n,a,l,c,0,s):t.needsCopy?(o(),r.copyTexImage2D(e,n,h,t.xOffset,t.yOffset,l,c,0)):r.texImage2D(e,n,h,l,c,0,h,u,s||null)}function M(t,e,n,i,s){var a=t.element,h=t.data,u=t.internalformat,l=t.format,c=t.type,d=t.width,f=t.height;I(t),a?r.texSubImage2D(e,s,n,i,l,c,a):t.compressed?r.compressedTexSubImage2D(e,s,n,i,u,d,f,h):t.needsCopy?(o(),r.copyTexSubImage2D(e,s,n,i,t.xOffset,t.yOffset,d,f)):r.texSubImage2D(e,s,n,i,d,f,l,c,h)}var P=[];function C(){return P.pop()||new R}function D(t){t.needsFree&&Bt.freeType(t.data),R.call(t),P.push(t)}function U(){A.call(this),this.genMipmaps=!1,this.mipmapHint=ln,this.mipmask=0,this.images=Array(16)}function B(t,e,r){var n=t.images[0]=C();t.mipmask=1,n.width=t.width=e,n.height=t.height=r,n.channels=t.channels=4}function F(t,e){var r=null;if(Hn(e))S(r=t.images[0]=C(),t),N(r,e),t.mipmask=1;else if(O(t,e),Array.isArray(e.mipmap))for(var n=e.mipmap,i=0;i<n.length;++i)S(r=t.images[i]=C(),t),r.width>>=i,r.height>>=i,N(r,n[i]),t.mipmask|=1<<i;else S(r=t.images[0]=C(),t),N(r,e),t.mipmask=1;S(t,t.images[0]),!t.compressed||t.internalformat!==Pr&&t.internalformat!==Cr&&t.internalformat!==Dr&&t.internalformat!==Ur||rt(t.width%4==0&&t.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function k(t,e){for(var r=t.images,n=0;n<r.length;++n){if(!r[n])return;L(r[n],e,n)}}var G=[];function j(){var t=G.pop()||new U;A.call(t),t.mipmask=0;for(var e=0;e<16;++e)t.images[e]=null;return t}function H(t){for(var e=t.images,r=0;r<e.length;++r)e[r]&&D(e[r]),e[r]=null;G.push(t)}function X(){this.minFilter=rn,this.magFilter=rn,this.wrapS=Qr,this.wrapT=Qr,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=ln}function z(t,e){if("min"in e){var r=e.min;rt.parameter(r,d),t.minFilter=d[r],_n.indexOf(t.minFilter)>=0&&!("faces"in e)&&(t.genMipmaps=!0)}if("mag"in e){var n=e.mag;rt.parameter(n,c),t.magFilter=c[n]}var o=t.wrapS,s=t.wrapT;if("wrap"in e){var a=e.wrap;"string"==typeof a?(rt.parameter(a,l),o=s=l[a]):Array.isArray(a)&&(rt.parameter(a[0],l),rt.parameter(a[1],l),o=l[a[0]],s=l[a[1]])}else{if("wrapS"in e){var h=e.wrapS;rt.parameter(h,l),o=l[h]}if("wrapT"in e){var f=e.wrapT;rt.parameter(f,l),s=l[f]}}if(t.wrapS=o,t.wrapT=s,"anisotropic"in e){var p=e.anisotropic;rt("number"==typeof p&&p>=1&&p<=i.maxAnisotropic,"aniso samples must be between 1 and "),t.anisotropic=e.anisotropic}if("mipmap"in e){var m=!1;switch(typeof e.mipmap){case"string":rt.parameter(e.mipmap,u,"invalid mipmap hint"),t.mipmapHint=u[e.mipmap],t.genMipmaps=!0,m=!0;break;case"boolean":m=t.genMipmaps=e.mipmap;break;case"object":rt(Array.isArray(e.mipmap),"invalid mipmap type"),t.genMipmaps=!1,m=!0;break;default:rt.raise("invalid mipmap type")}m&&!("min"in e)&&(t.minFilter=on)}}function V(t,e){r.texParameteri(e,en,t.minFilter),r.texParameteri(e,tn,t.magFilter),r.texParameteri(e,Kr,t.wrapS),r.texParameteri(e,Zr,t.wrapT),n.ext_texture_filter_anisotropic&&r.texParameteri(e,fn,t.anisotropic),t.genMipmaps&&(r.hint(un,t.mipmapHint),r.generateMipmap(e))}var W=0,Y={},q=i.maxTextureUnits,K=Array(q).map((function(){return null}));function Z(t){A.call(this),this.mipmask=0,this.internalformat=gr,this.id=W++,this.refCount=1,this.target=t,this.texture=r.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new X,h.profile&&(this.stats={size:0})}function J(t){r.activeTexture(bn),r.bindTexture(t.target,t.texture)}function Q(){var t=K[0];t?r.bindTexture(t.target,t.texture):r.bindTexture(fr,null)}function $(t){var e=t.texture;rt(e,"must not double destroy texture");var n=t.unit,i=t.target;n>=0&&(r.activeTexture(bn+n),r.bindTexture(i,null),K[n]=null),r.deleteTexture(e),t.texture=null,t.params=null,t.pixels=null,t.refCount=0,delete Y[t.id],a.textureCount--}function tt(t,e){var n=new Z(fr);function o(t,e){var r=n.texInfo;X.call(r);var s=j();return"number"==typeof t?B(s,0|t,"number"==typeof e?0|e:0|t):t?(rt.type(t,"object","invalid arguments to regl.texture"),z(r,t),F(s,t)):B(s,1,1),r.genMipmaps&&(s.mipmask=(s.width<<1)-1),n.mipmask=s.mipmask,S(n,s),rt.texture2D(r,s,i),n.internalformat=s.internalformat,o.width=s.width,o.height=s.height,J(n),k(s,fr),V(r,fr),Q(),H(s),h.profile&&(n.stats.size=qn(n.internalformat,n.type,s.width,s.height,r.genMipmaps,!1)),o.format=b[n.internalformat],o.type=_[n.type],o.mag=E[r.magFilter],o.min=x[r.minFilter],o.wrapS=T[r.wrapS],o.wrapT=T[r.wrapT],o}function s(t,e,r,i){rt(!!t,"must specify image data");var s=0|e,a=0|r,h=0|i,u=C();return S(u,n),u.width=0,u.height=0,N(u,t),u.width=u.width||(n.width>>h)-s,u.height=u.height||(n.height>>h)-a,rt(n.type===u.type&&n.format===u.format&&n.internalformat===u.internalformat,"incompatible format for texture.subimage"),rt(s>=0&&a>=0&&s+u.width<=n.width&&a+u.height<=n.height,"texture.subimage write out of bounds"),rt(n.mipmask&1<<h,"missing mipmap data"),rt(u.data||u.element||u.needsCopy,"missing image data"),J(n),M(u,fr,s,a,h),Q(),D(u),o}function u(t,e){var i=0|t,s=0|e||i;if(i===n.width&&s===n.height)return o;o.width=n.width=i,o.height=n.height=s,J(n);for(var a=0;n.mipmask>>a;++a){var u=i>>a,l=s>>a;if(!u||!l)break;r.texImage2D(fr,a,n.format,u,l,0,n.format,n.type,null)}return Q(),h.profile&&(n.stats.size=qn(n.internalformat,n.type,i,s,!1,!1)),o}return Y[n.id]=n,a.textureCount++,o(t,e),o.subimage=s,o.resize=u,o._reglType="texture2d",o._texture=n,h.profile&&(o.stats=n.stats),o.destroy=function(){n.decRef()},o}function et(t,e,n,o,s,u){var l=new Z(pr);Y[l.id]=l,a.cubeCount++;var c=new Array(6);function d(t,e,r,n,o,s){var a,u=l.texInfo;for(X.call(u),a=0;a<6;++a)c[a]=j();if("number"!=typeof t&&t)if("object"==typeof t)if(e)F(c[0],t),F(c[1],e),F(c[2],r),F(c[3],n),F(c[4],o),F(c[5],s);else if(z(u,t),O(l,t),"faces"in t){var f=t.faces;for(rt(Array.isArray(f)&&6===f.length,"cube faces must be a length 6 array"),a=0;a<6;++a)rt("object"==typeof f[a]&&!!f[a],"invalid input for cube map face"),S(c[a],l),F(c[a],f[a])}else for(a=0;a<6;++a)F(c[a],t);else rt.raise("invalid arguments to cube map");else{var p=0|t||1;for(a=0;a<6;++a)B(c[a],p,p)}for(S(l,c[0]),i.npotTextureCube||rt(cr(l.width)&&cr(l.height),"your browser does not support non power or two texture dimensions"),u.genMipmaps?l.mipmask=(c[0].width<<1)-1:l.mipmask=c[0].mipmask,rt.textureCube(l,u,c,i),l.internalformat=c[0].internalformat,d.width=c[0].width,d.height=c[0].height,J(l),a=0;a<6;++a)k(c[a],mr+a);for(V(u,pr),Q(),h.profile&&(l.stats.size=qn(l.internalformat,l.type,d.width,d.height,u.genMipmaps,!0)),d.format=b[l.internalformat],d.type=_[l.type],d.mag=E[u.magFilter],d.min=x[u.minFilter],d.wrapS=T[u.wrapS],d.wrapT=T[u.wrapT],a=0;a<6;++a)H(c[a]);return d}function f(t,e,r,n,i){rt(!!e,"must specify image data"),rt("number"==typeof t&&t===(0|t)&&t>=0&&t<6,"invalid face");var o=0|r,s=0|n,a=0|i,h=C();return S(h,l),h.width=0,h.height=0,N(h,e),h.width=h.width||(l.width>>a)-o,h.height=h.height||(l.height>>a)-s,rt(l.type===h.type&&l.format===h.format&&l.internalformat===h.internalformat,"incompatible format for texture.subimage"),rt(o>=0&&s>=0&&o+h.width<=l.width&&s+h.height<=l.height,"texture.subimage write out of bounds"),rt(l.mipmask&1<<a,"missing mipmap data"),rt(h.data||h.element||h.needsCopy,"missing image data"),J(l),M(h,mr+t,o,s,a),Q(),D(h),d}function p(t){var e=0|t;if(e!==l.width){d.width=l.width=e,d.height=l.height=e,J(l);for(var n=0;n<6;++n)for(var i=0;l.mipmask>>i;++i)r.texImage2D(mr+n,i,l.format,e>>i,e>>i,0,l.format,l.type,null);return Q(),h.profile&&(l.stats.size=qn(l.internalformat,l.type,d.width,d.height,!1,!0)),d}}return d(t,e,n,o,s,u),d.subimage=f,d.resize=p,d._reglType="textureCube",d._texture=l,h.profile&&(d.stats=l.stats),d.destroy=function(){l.decRef()},d}function nt(){for(var t=0;t<q;++t)r.activeTexture(bn+t),r.bindTexture(fr,null),K[t]=null;we(Y).forEach($),a.cubeCount=0,a.textureCount=0}function it(){for(var t=0;t<q;++t){var e=K[t];e&&(e.bindCount=0,e.unit=-1,K[t]=null)}we(Y).forEach((function(t){t.texture=r.createTexture(),r.bindTexture(t.target,t.texture);for(var e=0;e<32;++e)if(0!=(t.mipmask&1<<e))if(t.target===fr)r.texImage2D(fr,e,t.internalformat,t.width>>e,t.height>>e,0,t.internalformat,t.type,null);else for(var n=0;n<6;++n)r.texImage2D(mr+n,e,t.internalformat,t.width>>e,t.height>>e,0,t.internalformat,t.type,null);V(t.texInfo,t.target)}))}function ot(){for(var t=0;t<q;++t){var e=K[t];e&&(e.bindCount=0,e.unit=-1,K[t]=null),r.activeTexture(bn+t),r.bindTexture(fr,null),r.bindTexture(pr,null)}}return e(Z.prototype,{bind:function(){var t=this;t.bindCount+=1;var e=t.unit;if(e<0){for(var n=0;n<q;++n){var i=K[n];if(i){if(i.bindCount>0)continue;i.unit=-1}K[n]=t,e=n;break}e>=q&&rt.raise("insufficient number of texture units"),h.profile&&a.maxTextureUnits<e+1&&(a.maxTextureUnits=e+1),t.unit=e,r.activeTexture(bn+e),r.bindTexture(t.target,t.texture)}return e},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&$(this)}}),h.profile&&(a.getTotalTextureSize=function(){var t=0;return Object.keys(Y).forEach((function(e){t+=Y[e].stats.size})),t}),{create2D:tt,createCube:et,clear:nt,getTexture:function(t){return null},restore:it,refresh:ot}}Mn[Er]=2,Mn[xr]=2,Mn[Tr]=2,Mn[Rr]=4,Mn[Pr]=.5,Mn[Cr]=.5,Mn[Dr]=1,Mn[Ur]=1,Mn[Br]=.5,Mn[Fr]=1,Mn[kr]=1,Mn[Gr]=.5,Mn[jr]=.25,Mn[Hr]=.5,Mn[Xr]=.25,Mn[zr]=.5;var Zn=36161,Jn=32854,Qn=32855,$n=36194,ti=33189,ei=36168,ri=34041,ni=35907,ii=34836,oi=34842,si=34843,ai=[];function hi(t,e,r){return ai[t]*e*r}ai[Jn]=2,ai[Qn]=2,ai[$n]=2,ai[ti]=2,ai[ei]=1,ai[ri]=4,ai[ni]=4,ai[ii]=16,ai[oi]=8,ai[si]=6;var ui=function(t,e,r,n,i){var o={rgba4:Jn,rgb565:$n,"rgb5 a1":Qn,depth:ti,stencil:ei,"depth stencil":ri};e.ext_srgb&&(o.srgba=ni),e.ext_color_buffer_half_float&&(o.rgba16f=oi,o.rgb16f=si),e.webgl_color_buffer_float&&(o.rgba32f=ii);var s=[];Object.keys(o).forEach((function(t){var e=o[t];s[e]=t}));var a=0,h={};function u(t){this.id=a++,this.refCount=1,this.renderbuffer=t,this.format=Jn,this.width=0,this.height=0,i.profile&&(this.stats={size:0})}function l(e){var r=e.renderbuffer;rt(r,"must not double destroy renderbuffer"),t.bindRenderbuffer(Zn,null),t.deleteRenderbuffer(r),e.renderbuffer=null,e.refCount=0,delete h[e.id],n.renderbufferCount--}function c(e,a){var l=new u(t.createRenderbuffer());function c(e,n){var a=0,h=0,u=Jn;if("object"==typeof e&&e){var d=e;if("shape"in d){var f=d.shape;rt(Array.isArray(f)&&f.length>=2,"invalid renderbuffer shape"),a=0|f[0],h=0|f[1]}else"radius"in d&&(a=h=0|d.radius),"width"in d&&(a=0|d.width),"height"in d&&(h=0|d.height);"format"in d&&(rt.parameter(d.format,o,"invalid renderbuffer format"),u=o[d.format])}else"number"==typeof e?(a=0|e,h="number"==typeof n?0|n:a):e?rt.raise("invalid arguments to renderbuffer constructor"):a=h=1;if(rt(a>0&&h>0&&a<=r.maxRenderbufferSize&&h<=r.maxRenderbufferSize,"invalid renderbuffer size"),a!==l.width||h!==l.height||u!==l.format)return c.width=l.width=a,c.height=l.height=h,l.format=u,t.bindRenderbuffer(Zn,l.renderbuffer),t.renderbufferStorage(Zn,u,a,h),rt(0===t.getError(),"invalid render buffer format"),i.profile&&(l.stats.size=hi(l.format,l.width,l.height)),c.format=s[l.format],c}function d(e,n){var o=0|e,s=0|n||o;return o===l.width&&s===l.height||(rt(o>0&&s>0&&o<=r.maxRenderbufferSize&&s<=r.maxRenderbufferSize,"invalid renderbuffer size"),c.width=l.width=o,c.height=l.height=s,t.bindRenderbuffer(Zn,l.renderbuffer),t.renderbufferStorage(Zn,l.format,o,s),rt(0===t.getError(),"invalid render buffer format"),i.profile&&(l.stats.size=hi(l.format,l.width,l.height))),c}return h[l.id]=l,n.renderbufferCount++,c(e,a),c.resize=d,c._reglType="renderbuffer",c._renderbuffer=l,i.profile&&(c.stats=l.stats),c.destroy=function(){l.decRef()},c}function d(){we(h).forEach((function(e){e.renderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(Zn,e.renderbuffer),t.renderbufferStorage(Zn,e.format,e.width,e.height)})),t.bindRenderbuffer(Zn,null)}return u.prototype.decRef=function(){--this.refCount<=0&&l(this)},i.profile&&(n.getTotalRenderbufferSize=function(){var t=0;return Object.keys(h).forEach((function(e){t+=h[e].stats.size})),t}),{create:c,clear:function(){we(h).forEach(l)},restore:d}},li=36160,ci=36161,di=3553,fi=34069,pi=36064,mi=36096,gi=36128,vi=33306,yi=36053,bi=36054,_i=36055,Ei=36057,xi=36061,Ti=36193,wi=5121,Ai=5126,Si=6407,Oi=6408,Ii=6402,Ri=[Si,Oi],Ni=[];Ni[Oi]=4,Ni[Si]=3;var Li=[];Li[wi]=1,Li[Ai]=4,Li[Ti]=2;var Mi=33189,Pi=36168,Ci=34041,Di=[32854,32855,36194,35907,34842,34843,34836],Ui={};function Bi(t,r,n,i,o,s){var a={cur:null,next:null,dirty:!1,setFBO:null},h=["rgba"],u=["rgba4","rgb565","rgb5 a1"];r.ext_srgb&&u.push("srgba"),r.ext_color_buffer_half_float&&u.push("rgba16f","rgb16f"),r.webgl_color_buffer_float&&u.push("rgba32f");var l=["uint8"];function c(t,e,r){this.target=t,this.texture=e,this.renderbuffer=r;var n=0,i=0;e?(n=e.width,i=e.height):r&&(n=r.width,i=r.height),this.width=n,this.height=i}function d(t){t&&(t.texture&&t.texture._texture.decRef(),t.renderbuffer&&t.renderbuffer._renderbuffer.decRef())}function f(t,e,r){if(t)if(t.texture){var n=t.texture._texture,i=Math.max(1,n.width),o=Math.max(1,n.height);rt(i===e&&o===r,"inconsistent width/height for supplied texture"),n.refCount+=1}else{var s=t.renderbuffer._renderbuffer;rt(s.width===e&&s.height===r,"inconsistent width/height for renderbuffer"),s.refCount+=1}}function p(e,r){r&&(r.texture?t.framebufferTexture2D(li,e,r.target,r.texture._texture.texture,0):t.framebufferRenderbuffer(li,e,ci,r.renderbuffer._renderbuffer.renderbuffer))}function m(t){var e=di,r=null,n=null,i=t;"object"==typeof t&&(i=t.data,"target"in t&&(e=0|t.target)),rt.type(i,"function","invalid attachment data");var o=i._reglType;return"texture2d"===o?(r=i,rt(e===di)):"textureCube"===o?(r=i,rt(e>=fi&&e<fi+6,"invalid cube map target")):"renderbuffer"===o?(n=i,e=ci):rt.raise("invalid regl object for attachment"),new c(e,r,n)}function g(t,e,r,n,s){if(r){var a=i.create2D({width:t,height:e,format:n,type:s});return a._texture.refCount=0,new c(di,a,null)}var h=o.create({width:t,height:e,format:n});return h._renderbuffer.refCount=0,new c(ci,null,h)}function v(t){return t&&(t.texture||t.renderbuffer)}function y(t,e,r){t&&(t.texture?t.texture.resize(e,r):t.renderbuffer&&t.renderbuffer.resize(e,r),t.width=e,t.height=r)}r.oes_texture_half_float&&l.push("half float","float16"),r.oes_texture_float&&l.push("float","float32");var b=0,_={};function E(){this.id=b++,_[this.id]=this,this.framebuffer=t.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function x(t){t.colorAttachments.forEach(d),d(t.depthAttachment),d(t.stencilAttachment),d(t.depthStencilAttachment)}function T(e){var r=e.framebuffer;rt(r,"must not double destroy framebuffer"),t.deleteFramebuffer(r),e.framebuffer=null,s.framebufferCount--,delete _[e.id]}function w(e){var r;t.bindFramebuffer(li,e.framebuffer);var i=e.colorAttachments;for(r=0;r<i.length;++r)p(pi+r,i[r]);for(r=i.length;r<n.maxColorAttachments;++r)t.framebufferTexture2D(li,pi+r,di,null,0);t.framebufferTexture2D(li,vi,di,null,0),t.framebufferTexture2D(li,mi,di,null,0),t.framebufferTexture2D(li,gi,di,null,0),p(mi,e.depthAttachment),p(gi,e.stencilAttachment),p(vi,e.depthStencilAttachment);var o=t.checkFramebufferStatus(li);t.isContextLost()||o===yi||rt.raise("framebuffer configuration not supported, status = "+Ui[o]),t.bindFramebuffer(li,a.next?a.next.framebuffer:null),a.cur=a.next,t.getError()}function A(t,i){var o=new E;function c(t,e){var i;rt(a.next!==o,"can not update framebuffer which is currently in use");var s=0,d=0,p=!0,y=!0,b=null,_=!0,E="rgba",T="uint8",A=1,S=null,O=null,I=null,R=!1;if("number"==typeof t)s=0|t,d=0|e||s;else if(t){rt.type(t,"object","invalid arguments for framebuffer");var N=t;if("shape"in N){var L=N.shape;rt(Array.isArray(L)&&L.length>=2,"invalid shape for framebuffer"),s=L[0],d=L[1]}else"radius"in N&&(s=d=N.radius),"width"in N&&(s=N.width),"height"in N&&(d=N.height);("color"in N||"colors"in N)&&(b=N.color||N.colors,Array.isArray(b)&&rt(1===b.length||r.webgl_draw_buffers,"multiple render targets not supported")),b||("colorCount"in N&&(A=0|N.colorCount,rt(A>0,"invalid color buffer count")),"colorTexture"in N&&(_=!!N.colorTexture,E="rgba4"),"colorType"in N&&(T=N.colorType,_?(rt(r.oes_texture_float||!("float"===T||"float32"===T),"you must enable OES_texture_float in order to use floating point framebuffer objects"),rt(r.oes_texture_half_float||!("half float"===T||"float16"===T),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):"half float"===T||"float16"===T?(rt(r.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),E="rgba16f"):"float"!==T&&"float32"!==T||(rt(r.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),E="rgba32f"),rt.oneOf(T,l,"invalid color type")),"colorFormat"in N&&(E=N.colorFormat,h.indexOf(E)>=0?_=!0:u.indexOf(E)>=0?_=!1:_?rt.oneOf(N.colorFormat,h,"invalid color format for texture"):rt.oneOf(N.colorFormat,u,"invalid color format for renderbuffer"))),("depthTexture"in N||"depthStencilTexture"in N)&&(R=!(!N.depthTexture&&!N.depthStencilTexture),rt(!R||r.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in N&&("boolean"==typeof N.depth?p=N.depth:(S=N.depth,y=!1)),"stencil"in N&&("boolean"==typeof N.stencil?y=N.stencil:(O=N.stencil,p=!1)),"depthStencil"in N&&("boolean"==typeof N.depthStencil?p=y=N.depthStencil:(I=N.depthStencil,p=!1,y=!1))}else s=d=1;var M=null,P=null,C=null,D=null;if(Array.isArray(b))M=b.map(m);else if(b)M=[m(b)];else for(M=new Array(A),i=0;i<A;++i)M[i]=g(s,d,_,E,T);rt(r.webgl_draw_buffers||M.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),rt(M.length<=n.maxColorAttachments,"too many color attachments, not supported"),s=s||M[0].width,d=d||M[0].height,S?P=m(S):p&&!y&&(P=g(s,d,R,"depth","uint32")),O?C=m(O):y&&!p&&(C=g(s,d,!1,"stencil","uint8")),I?D=m(I):!S&&!O&&y&&p&&(D=g(s,d,R,"depth stencil","depth stencil")),rt(!!S+!!O+!!I<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var U=null;for(i=0;i<M.length;++i)if(f(M[i],s,d),rt(!M[i]||M[i].texture&&Ri.indexOf(M[i].texture._texture.format)>=0||M[i].renderbuffer&&Di.indexOf(M[i].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+i+" is invalid"),M[i]&&M[i].texture){var B=Ni[M[i].texture._texture.format]*Li[M[i].texture._texture.type];null===U?U=B:rt(U===B,"all color attachments much have the same number of bits per pixel.")}return f(P,s,d),rt(!P||P.texture&&P.texture._texture.format===Ii||P.renderbuffer&&P.renderbuffer._renderbuffer.format===Mi,"invalid depth attachment for framebuffer object"),f(C,s,d),rt(!C||C.renderbuffer&&C.renderbuffer._renderbuffer.format===Pi,"invalid stencil attachment for framebuffer object"),f(D,s,d),rt(!D||D.texture&&D.texture._texture.format===Ci||D.renderbuffer&&D.renderbuffer._renderbuffer.format===Ci,"invalid depth-stencil attachment for framebuffer object"),x(o),o.width=s,o.height=d,o.colorAttachments=M,o.depthAttachment=P,o.stencilAttachment=C,o.depthStencilAttachment=D,c.color=M.map(v),c.depth=v(P),c.stencil=v(C),c.depthStencil=v(D),c.width=o.width,c.height=o.height,w(o),c}function d(t,e){rt(a.next!==o,"can not resize a framebuffer which is currently in use");var r=Math.max(0|t,1),n=Math.max(0|e||r,1);if(r===o.width&&n===o.height)return c;for(var i=o.colorAttachments,s=0;s<i.length;++s)y(i[s],r,n);return y(o.depthAttachment,r,n),y(o.stencilAttachment,r,n),y(o.depthStencilAttachment,r,n),o.width=c.width=r,o.height=c.height=n,w(o),c}return s.framebufferCount++,c(t,i),e(c,{resize:d,_reglType:"framebuffer",_framebuffer:o,destroy:function(){T(o),x(o)},use:function(t){a.setFBO({framebuffer:c},t)}})}function S(t){var o=Array(6);function s(t){var n;rt(o.indexOf(a.next)<0,"can not update framebuffer which is currently in use");var u,c={color:null},d=0,f=null,p="rgba",m="uint8",g=1;if("number"==typeof t)d=0|t;else if(t){rt.type(t,"object","invalid arguments for framebuffer");var v=t;if("shape"in v){var y=v.shape;rt(Array.isArray(y)&&y.length>=2,"invalid shape for framebuffer"),rt(y[0]===y[1],"cube framebuffer must be square"),d=y[0]}else"radius"in v&&(d=0|v.radius),"width"in v?(d=0|v.width,"height"in v&&rt(v.height===d,"must be square")):"height"in v&&(d=0|v.height);("color"in v||"colors"in v)&&(f=v.color||v.colors,Array.isArray(f)&&rt(1===f.length||r.webgl_draw_buffers,"multiple render targets not supported")),f||("colorCount"in v&&(g=0|v.colorCount,rt(g>0,"invalid color buffer count")),"colorType"in v&&(rt.oneOf(v.colorType,l,"invalid color type"),m=v.colorType),"colorFormat"in v&&(p=v.colorFormat,rt.oneOf(v.colorFormat,h,"invalid color format for texture"))),"depth"in v&&(c.depth=v.depth),"stencil"in v&&(c.stencil=v.stencil),"depthStencil"in v&&(c.depthStencil=v.depthStencil)}else d=1;if(f)if(Array.isArray(f))for(u=[],n=0;n<f.length;++n)u[n]=f[n];else u=[f];else{u=Array(g);var b={radius:d,format:p,type:m};for(n=0;n<g;++n)u[n]=i.createCube(b)}for(c.color=Array(u.length),n=0;n<u.length;++n){var _=u[n];rt("function"==typeof _&&"textureCube"===_._reglType,"invalid cube map"),d=d||_.width,rt(_.width===d&&_.height===d,"invalid cube map shape"),c.color[n]={target:fi,data:u[n]}}for(n=0;n<6;++n){for(var E=0;E<u.length;++E)c.color[E].target=fi+n;n>0&&(c.depth=o[0].depth,c.stencil=o[0].stencil,c.depthStencil=o[0].depthStencil),o[n]?o[n](c):o[n]=A(c)}return e(s,{width:d,height:d,color:u})}function u(t){var e,r=0|t;if(rt(r>0&&r<=n.maxCubeMapSize,"invalid radius for cube fbo"),r===s.width)return s;var i=s.color;for(e=0;e<i.length;++e)i[e].resize(r);for(e=0;e<6;++e)o[e].resize(r);return s.width=s.height=r,s}return s(t),e(s,{faces:o,resize:u,_reglType:"framebufferCube",destroy:function(){o.forEach((function(t){t.destroy()}))}})}function O(){a.cur=null,a.next=null,a.dirty=!0,we(_).forEach((function(e){e.framebuffer=t.createFramebuffer(),w(e)}))}return e(a,{getFramebuffer:function(t){if("function"==typeof t&&"framebuffer"===t._reglType){var e=t._framebuffer;if(e instanceof E)return e}return null},create:A,createCube:S,clear:function(){we(_).forEach(T)},restore:O})}Ui[yi]="complete",Ui[bi]="incomplete attachment",Ui[Ei]="incomplete dimensions",Ui[_i]="incomplete, missing attachment",Ui[xi]="unsupported";var Fi=5126,ki=34962;function Gi(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=Fi,this.offset=0,this.stride=0,this.divisor=0}function ji(e,r,n,i,o){for(var s=n.maxAttributes,a=new Array(s),h=0;h<s;++h)a[h]=new Gi;var u=0,l={},c={Record:Gi,scope:{},state:a,currentVAO:null,targetVAO:null,restore:f()?_:function(){},createVAO:E,getVAO:m,destroyBuffer:d,setVAO:f()?g:v,clear:f()?y:function(){}};function d(t){for(var r=0;r<a.length;++r){var n=a[r];n.buffer===t&&(e.disableVertexAttribArray(r),n.buffer=null)}}function f(){return r.oes_vertex_array_object}function p(){return r.angle_instanced_arrays}function m(t){return"function"==typeof t&&t._vao?t._vao:null}function g(t){if(t!==c.currentVAO){var e=f();t?e.bindVertexArrayOES(t.vao):e.bindVertexArrayOES(null),c.currentVAO=t}}function v(t){if(t!==c.currentVAO){if(t)t.bindAttrs();else for(var r=p(),n=0;n<a.length;++n){var i=a[n];i.buffer?(e.enableVertexAttribArray(n),e.vertexAttribPointer(n,i.size,i.type,i.normalized,i.stride,i.offfset),r&&i.divisor&&r.vertexAttribDivisorANGLE(n,i.divisor)):(e.disableVertexAttribArray(n),e.vertexAttrib4f(n,i.x,i.y,i.z,i.w))}c.currentVAO=t}}function y(){we(l).forEach((function(t){t.destroy()}))}function b(){this.id=++u,this.attributes=[];var t=f();this.vao=t?t.createVertexArrayOES():null,l[this.id]=this,this.buffers=[]}function _(){f()&&we(l).forEach((function(t){t.refresh()}))}function E(e){var n=new b;function a(e){rt(Array.isArray(e),"arguments to vertex array constructor must be an array"),rt(e.length<s,"too many attributes"),rt(e.length>0,"must specify at least one attribute");var i={},h=n.attributes;h.length=e.length;for(var u=0;u<e.length;++u){var l,c=e[u],d=h[u]=new Gi,f=c.data||c;Array.isArray(f)||t(f)||Te(f)?(n.buffers[u]&&(l=n.buffers[u],t(f)&&l._buffer.byteLength>=f.byteLength?l.subdata(f):(l.destroy(),n.buffers[u]=null)),n.buffers[u]||(l=n.buffers[u]=o.create(c,ki,!1,!0)),d.buffer=o.getBuffer(l),d.size=0|d.buffer.dimension,d.normalized=!1,d.type=d.buffer.dtype,d.offset=0,d.stride=0,d.divisor=0,d.state=1,i[u]=1):o.getBuffer(c)?(d.buffer=o.getBuffer(c),d.size=0|d.buffer.dimension,d.normalized=!1,d.type=d.buffer.dtype,d.offset=0,d.stride=0,d.divisor=0,d.state=1):o.getBuffer(c.buffer)?(d.buffer=o.getBuffer(c.buffer),d.size=0|(+c.size||d.buffer.dimension),d.normalized=!!c.normalized||!1,"type"in c?(rt.parameter(c.type,Pe,"invalid buffer type"),d.type=Pe[c.type]):d.type=d.buffer.dtype,d.offset=0|(c.offset||0),d.stride=0|(c.stride||0),d.divisor=0|(c.divisor||0),d.state=1,rt(d.size>=1&&d.size<=4,"size must be between 1 and 4"),rt(d.offset>=0,"invalid offset"),rt(d.stride>=0&&d.stride<=255,"stride must be between 0 and 255"),rt(d.divisor>=0,"divisor must be positive"),rt(!d.divisor||!!r.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in c?(rt(u>0,"first attribute must not be a constant"),d.x=+c.x||0,d.y=+c.y||0,d.z=+c.z||0,d.w=+c.w||0,d.state=2):rt(!1,"invalid attribute spec for location "+u)}for(var p=0;p<n.buffers.length;++p)!i[p]&&n.buffers[p]&&(n.buffers[p].destroy(),n.buffers[p]=null);return n.refresh(),a}return i.vaoCount+=1,a.destroy=function(){for(var t=0;t<n.buffers.length;++t)n.buffers[t]&&n.buffers[t].destroy();n.buffers.length=0,n.destroy()},a._vao=n,a._reglType="vao",a(e)}return b.prototype.bindAttrs=function(){for(var t=p(),r=this.attributes,n=0;n<r.length;++n){var i=r[n];i.buffer?(e.enableVertexAttribArray(n),e.bindBuffer(ki,i.buffer.buffer),e.vertexAttribPointer(n,i.size,i.type,i.normalized,i.stride,i.offset),t&&i.divisor&&t.vertexAttribDivisorANGLE(n,i.divisor)):(e.disableVertexAttribArray(n),e.vertexAttrib4f(n,i.x,i.y,i.z,i.w))}for(var o=r.length;o<s;++o)e.disableVertexAttribArray(o)},b.prototype.refresh=function(){var t=f();t&&(t.bindVertexArrayOES(this.vao),this.bindAttrs(),c.currentVAO=this)},b.prototype.destroy=function(){if(this.vao){var t=f();this===c.currentVAO&&(c.currentVAO=null,t.bindVertexArrayOES(null)),t.deleteVertexArrayOES(this.vao),this.vao=null}l[this.id]&&(delete l[this.id],i.vaoCount-=1)},c}var Hi=35632,Xi=35633,zi=35718,Vi=35721;function Wi(t,r,n,i){var o={},s={};function a(t,e,r,n){this.name=t,this.id=e,this.location=r,this.info=n}function h(t,e){for(var r=0;r<t.length;++r)if(t[r].id===e.id)return void(t[r].location=e.location);t.push(e)}function u(e,n,i){var a=e===Hi?o:s,h=a[n];if(!h){var u=r.str(n);h=t.createShader(e),t.shaderSource(h,u),t.compileShader(h),rt.shaderError(t,h,u,e,i),a[n]=h}return h}var l={},c=[],d=0;function f(t,e){this.id=d++,this.fragId=t,this.vertId=e,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,i.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function p(e,n,o){var s,l,c=u(Hi,e.fragId),d=u(Xi,e.vertId),f=e.program=t.createProgram();if(t.attachShader(f,c),t.attachShader(f,d),o)for(s=0;s<o.length;++s){var p=o[s];t.bindAttribLocation(f,p[0],p[1])}t.linkProgram(f),rt.linkError(t,f,r.str(e.fragId),r.str(e.vertId),n);var m=t.getProgramParameter(f,zi);i.profile&&(e.stats.uniformsCount=m);var g=e.uniforms;for(s=0;s<m;++s)if(l=t.getActiveUniform(f,s))if(l.size>1)for(var v=0;v<l.size;++v){var y=l.name.replace("[0]","["+v+"]");h(g,new a(y,r.id(y),t.getUniformLocation(f,y),l))}else h(g,new a(l.name,r.id(l.name),t.getUniformLocation(f,l.name),l));var b=t.getProgramParameter(f,Vi);i.profile&&(e.stats.attributesCount=b);var _=e.attributes;for(s=0;s<b;++s)(l=t.getActiveAttrib(f,s))&&h(_,new a(l.name,r.id(l.name),t.getAttribLocation(f,l.name),l))}function m(){o={},s={};for(var t=0;t<c.length;++t)p(c[t],null,c[t].attributes.map((function(t){return[t.location,t.name]})))}return i.profile&&(n.getMaxUniformsCount=function(){var t=0;return c.forEach((function(e){e.stats.uniformsCount>t&&(t=e.stats.uniformsCount)})),t},n.getMaxAttributesCount=function(){var t=0;return c.forEach((function(e){e.stats.attributesCount>t&&(t=e.stats.attributesCount)})),t}),{clear:function(){var e=t.deleteShader.bind(t);we(o).forEach(e),o={},we(s).forEach(e),s={},c.forEach((function(e){t.deleteProgram(e.program)})),c.length=0,l={},n.shaderCount=0},program:function(r,i,a,h){rt.command(r>=0,"missing vertex shader",a),rt.command(i>=0,"missing fragment shader",a);var u=l[i];u||(u=l[i]={});var d=u[r];if(d&&(d.refCount++,!h))return d;var m=new f(i,r);return n.shaderCount++,p(m,a,h),d||(u[r]=m),c.push(m),e(m,{destroy:function(){if(m.refCount--,m.refCount<=0){t.deleteProgram(m.program);var e=c.indexOf(m);c.splice(e,1),n.shaderCount--}u[m.vertId].refCount<=0&&(t.deleteShader(s[m.vertId]),delete s[m.vertId],delete l[m.fragId][m.vertId]),Object.keys(l[m.fragId]).length||(t.deleteShader(o[m.fragId]),delete o[m.fragId],delete l[m.fragId])}})},restore:m,shader:u,frag:-1,vert:-1}}var Yi=6408,qi=5121,Ki=3333,Zi=5126;function Ji(e,r,n,i,o,s,a){function h(h){var u;null===r.next?(rt(o.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),u=qi):(rt(null!==r.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),u=r.next.colorAttachments[0].texture._texture.type,s.oes_texture_float?(rt(u===qi||u===Zi,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),u===Zi&&rt(a.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):rt(u===qi,"Reading from a framebuffer is only allowed for the type 'uint8'"));var l=0,c=0,d=i.framebufferWidth,f=i.framebufferHeight,p=null;t(h)?p=h:h&&(rt.type(h,"object","invalid arguments to regl.read()"),l=0|h.x,c=0|h.y,rt(l>=0&&l<i.framebufferWidth,"invalid x offset for regl.read"),rt(c>=0&&c<i.framebufferHeight,"invalid y offset for regl.read"),d=0|(h.width||i.framebufferWidth-l),f=0|(h.height||i.framebufferHeight-c),p=h.data||null),p&&(u===qi?rt(p instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):u===Zi&&rt(p instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),rt(d>0&&d+l<=i.framebufferWidth,"invalid width for read pixels"),rt(f>0&&f+c<=i.framebufferHeight,"invalid height for read pixels"),n();var m=d*f*4;return p||(u===qi?p=new Uint8Array(m):u===Zi&&(p=p||new Float32Array(m))),rt.isTypedArray(p,"data buffer for regl.read() must be a typedarray"),rt(p.byteLength>=m,"data buffer for regl.read() too small"),e.pixelStorei(Ki,4),e.readPixels(l,c,d,f,Yi,u,p),p}function u(t){var e;return r.setFBO({framebuffer:t.framebuffer},(function(){e=h(t)})),e}function l(t){return t&&"framebuffer"in t?u(t):h(t)}return l}function Qi(t){return Array.prototype.slice.call(t)}function $i(t){return Qi(t).join("")}function to(){var t=0,r=[],n=[];function i(e){for(var i=0;i<n.length;++i)if(n[i]===e)return r[i];var o="g"+t++;return r.push(o),n.push(e),o}function o(){var r=[];function n(){r.push.apply(r,Qi(arguments))}var i=[];function o(){var e="v"+t++;return i.push(e),arguments.length>0&&(r.push(e,"="),r.push.apply(r,Qi(arguments)),r.push(";")),e}return e(n,{def:o,toString:function(){return $i([i.length>0?"var "+i.join(",")+";":"",$i(r)])}})}function s(){var t=o(),r=o(),n=t.toString,i=r.toString;function s(e,n){r(e,n,"=",t.def(e,n),";")}return e((function(){t.apply(t,Qi(arguments))}),{def:t.def,entry:t,exit:r,save:s,set:function(e,r,n){s(e,r),t(e,r,"=",n,";")},toString:function(){return n()+i()}})}function a(){var t=$i(arguments),r=s(),n=s(),i=r.toString,o=n.toString;return e(r,{then:function(){return r.apply(r,Qi(arguments)),this},else:function(){return n.apply(n,Qi(arguments)),this},toString:function(){var e=o();return e&&(e="else{"+e+"}"),$i(["if(",t,"){",i(),"}",e])}})}var h=o(),u={};function l(t,r){var n=[];function i(){var t="a"+n.length;return n.push(t),t}r=r||0;for(var o=0;o<r;++o)i();var a=s(),h=a.toString;return u[t]=e(a,{arg:i,toString:function(){return $i(["function(",n.join(),"){",h(),"}"])}})}function c(){var t=['"use strict";',h,"return {"];Object.keys(u).forEach((function(e){t.push('"',e,'":',u[e].toString(),",")})),t.push("}");var e=$i(t).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,r.concat(e)).apply(null,n)}return{global:h,link:i,block:o,proc:l,scope:s,cond:a,compile:c}}var eo="xyzw".split(""),ro=5121,no=1,io=2,oo=0,so=1,ao=2,ho=3,uo=4,lo=5,co=6,fo="dither",po="blend.enable",mo="blend.color",go="blend.equation",vo="blend.func",yo="depth.enable",bo="depth.func",_o="depth.range",Eo="depth.mask",xo="colorMask",To="cull.enable",wo="cull.face",Ao="frontFace",So="lineWidth",Oo="polygonOffset.enable",Io="polygonOffset.offset",Ro="sample.alpha",No="sample.enable",Lo="sample.coverage",Mo="stencil.enable",Po="stencil.mask",Co="stencil.func",Do="stencil.opFront",Uo="stencil.opBack",Bo="scissor.enable",Fo="scissor.box",ko="viewport",Go="profile",jo="framebuffer",Ho="vert",Xo="frag",zo="elements",Vo="primitive",Wo="count",Yo="offset",qo="instances",Ko="vao",Zo="Width",Jo="Height",Qo=jo+Zo,$o=jo+Jo,ts=ko+Zo,es=ko+Jo,rs="drawingBuffer",ns=rs+Zo,is=rs+Jo,os=[vo,go,Co,Do,Uo,Lo,ko,Fo,Io],ss=34962,as=34963,hs=3553,us=34067,ls=2884,cs=3042,ds=3024,fs=2960,ps=2929,ms=3089,gs=32823,vs=32926,ys=32928,bs=5126,_s=35664,Es=35665,xs=35666,Ts=5124,ws=35667,As=35668,Ss=35669,Os=35670,Is=35671,Rs=35672,Ns=35673,Ls=35674,Ms=35675,Ps=35676,Cs=35678,Ds=35680,Us=4,Bs=1028,Fs=1029,ks=2304,Gs=2305,js=32775,Hs=32776,Xs=519,zs=7680,Vs=0,Ws=1,Ys=32774,qs=513,Ks=36160,Zs=36064,Js={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Qs=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],$s={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},ta={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},ea={frag:35632,vert:35633},ra={cw:ks,ccw:Gs};function na(e){return Array.isArray(e)||t(e)||Te(e)}function ia(t){return t.sort((function(t,e){return t===ko?-1:e===ko?1:t<e?-1:1}))}function oa(t,e,r,n){this.thisDep=t,this.contextDep=e,this.propDep=r,this.append=n}function sa(t){return t&&!(t.thisDep||t.contextDep||t.propDep)}function aa(t){return new oa(!1,!1,!1,t)}function ha(t,e){var r=t.type;if(r===oo){var n=t.data.length;return new oa(!0,n>=1,n>=2,e)}if(r===uo){var i=t.data;return new oa(i.thisDep,i.contextDep,i.propDep,e)}if(r===lo)return new oa(!1,!1,!1,e);if(r===co){for(var o=!1,s=!1,a=!1,h=0;h<t.data.length;++h){var u=t.data[h];if(u.type===so)a=!0;else if(u.type===ao)s=!0;else if(u.type===ho)o=!0;else if(u.type===oo){o=!0;var l=u.data;l>=1&&(s=!0),l>=2&&(a=!0)}else u.type===uo&&(o=o||u.data.thisDep,s=s||u.data.contextDep,a=a||u.data.propDep)}return new oa(o,s,a,e)}return new oa(r===ho,r===ao,r===so,e)}var ua=new oa(!1,!1,!1,(function(){}));function la(t,r,n,i,o,s,a,h,u,l,c,d,f,p,m){var g=l.Record,v={add:32774,subtract:32778,"reverse subtract":32779};n.ext_blend_minmax&&(v.min=js,v.max=Hs);var y=n.angle_instanced_arrays,b=n.webgl_draw_buffers,_={dirty:!0,profile:m.profile},E={},x=[],T={},w={};function A(t){return t.replace(".","_")}function S(t,e,r){var n=A(t);x.push(t),E[n]=_[n]=!!r,T[n]=e}function O(t,e,r){var n=A(t);x.push(t),Array.isArray(r)?(_[n]=r.slice(),E[n]=r.slice()):_[n]=E[n]=r,w[n]=e}S(fo,ds),S(po,cs),O(mo,"blendColor",[0,0,0,0]),O(go,"blendEquationSeparate",[Ys,Ys]),O(vo,"blendFuncSeparate",[Ws,Vs,Ws,Vs]),S(yo,ps,!0),O(bo,"depthFunc",qs),O(_o,"depthRange",[0,1]),O(Eo,"depthMask",!0),O(xo,xo,[!0,!0,!0,!0]),S(To,ls),O(wo,"cullFace",Fs),O(Ao,Ao,Gs),O(So,So,1),S(Oo,gs),O(Io,"polygonOffset",[0,0]),S(Ro,vs),S(No,ys),O(Lo,"sampleCoverage",[1,!1]),S(Mo,fs),O(Po,"stencilMask",-1),O(Co,"stencilFunc",[Xs,0,-1]),O(Do,"stencilOpSeparate",[Bs,zs,zs,zs]),O(Uo,"stencilOpSeparate",[Fs,zs,zs,zs]),S(Bo,ms),O(Fo,"scissor",[0,0,t.drawingBufferWidth,t.drawingBufferHeight]),O(ko,ko,[0,0,t.drawingBufferWidth,t.drawingBufferHeight]);var I={gl:t,context:f,strings:r,next:E,current:_,draw:d,elements:s,buffer:o,shader:c,attributes:l.state,vao:l,uniforms:u,framebuffer:h,extensions:n,timer:p,isBufferArgs:na},R={primTypes:We,compareFuncs:$s,blendFuncs:Js,blendEquations:v,stencilOps:ta,glTypes:Pe,orientationType:ra};rt.optional((function(){I.isArrayLike=lr})),b&&(R.backBuffer=[Fs],R.drawBuffer=St(i.maxDrawbuffers,(function(t){return 0===t?[0]:St(t,(function(t){return Zs+t}))})));var N=0;function L(){var t=to(),e=t.link,n=t.global;t.id=N++,t.batchId="0";var i=e(I),o=t.shared={props:"a0"};Object.keys(I).forEach((function(t){o[t]=n.def(i,".",t)})),rt.optional((function(){t.CHECK=e(rt),t.commandStr=rt.guessCommand(),t.command=e(t.commandStr),t.assert=function(t,r,n){t("if(!(",r,"))",this.CHECK,".commandRaise(",e(n),",",this.command,");")},R.invalidBlendCombinations=Qs}));var s=t.next={},a=t.current={};Object.keys(w).forEach((function(t){Array.isArray(_[t])&&(s[t]=n.def(o.next,".",t),a[t]=n.def(o.current,".",t))}));var h=t.constants={};Object.keys(R).forEach((function(t){h[t]=n.def(JSON.stringify(R[t]))})),t.invoke=function(r,n){switch(n.type){case oo:var i=["this",o.context,o.props,t.batchId];return r.def(e(n.data),".call(",i.slice(0,Math.max(n.data.length+1,4)),")");case so:return r.def(o.props,n.data);case ao:return r.def(o.context,n.data);case ho:return r.def("this",n.data);case uo:return n.data.append(t,r),n.data.ref;case lo:return n.data.toString();case co:return n.data.map((function(e){return t.invoke(r,e)}))}},t.attribCache={};var u={};return t.scopeAttrib=function(t){var n=r.id(t);if(n in u)return u[n];var i=l.scope[n];return i||(i=l.scope[n]=new g),u[n]=e(i)},t}function M(t){var e,r=t.static,n=t.dynamic;if(Go in r){var i=!!r[Go];(e=aa((function(t,e){return i}))).enable=i}else if(Go in n){var o=n[Go];e=ha(o,(function(t,e){return t.invoke(e,o)}))}return e}function P(t,e){var r=t.static,n=t.dynamic;if(jo in r){var i=r[jo];return i?(i=h.getFramebuffer(i),rt.command(i,"invalid framebuffer object"),aa((function(t,e){var r=t.link(i),n=t.shared;e.set(n.framebuffer,".next",r);var o=n.context;return e.set(o,"."+Qo,r+".width"),e.set(o,"."+$o,r+".height"),r}))):aa((function(t,e){var r=t.shared;e.set(r.framebuffer,".next","null");var n=r.context;return e.set(n,"."+Qo,n+"."+ns),e.set(n,"."+$o,n+"."+is),"null"}))}if(jo in n){var o=n[jo];return ha(o,(function(t,e){var r=t.invoke(e,o),n=t.shared,i=n.framebuffer,s=e.def(i,".getFramebuffer(",r,")");rt.optional((function(){t.assert(e,"!"+r+"||"+s,"invalid framebuffer object")})),e.set(i,".next",s);var a=n.context;return e.set(a,"."+Qo,s+"?"+s+".width:"+a+"."+ns),e.set(a,"."+$o,s+"?"+s+".height:"+a+"."+is),s}))}return null}function C(t,e,r){var n=t.static,i=t.dynamic;function o(t){if(t in n){var o=n[t];rt.commandType(o,"object","invalid "+t,r.commandStr);var s,a,h=!0,u=0|o.x,l=0|o.y;return"width"in o?(s=0|o.width,rt.command(s>=0,"invalid "+t,r.commandStr)):h=!1,"height"in o?(a=0|o.height,rt.command(a>=0,"invalid "+t,r.commandStr)):h=!1,new oa(!h&&e&&e.thisDep,!h&&e&&e.contextDep,!h&&e&&e.propDep,(function(t,e){var r=t.shared.context,n=s;"width"in o||(n=e.def(r,".",Qo,"-",u));var i=a;return"height"in o||(i=e.def(r,".",$o,"-",l)),[u,l,n,i]}))}if(t in i){var c=i[t],d=ha(c,(function(e,r){var n=e.invoke(r,c);rt.optional((function(){e.assert(r,n+"&&typeof "+n+'==="object"',"invalid "+t)}));var i=e.shared.context,o=r.def(n,".x|0"),s=r.def(n,".y|0"),a=r.def('"width" in ',n,"?",n,".width|0:","(",i,".",Qo,"-",o,")"),h=r.def('"height" in ',n,"?",n,".height|0:","(",i,".",$o,"-",s,")");return rt.optional((function(){e.assert(r,a+">=0&&"+h+">=0","invalid "+t)})),[o,s,a,h]}));return e&&(d.thisDep=d.thisDep||e.thisDep,d.contextDep=d.contextDep||e.contextDep,d.propDep=d.propDep||e.propDep),d}return e?new oa(e.thisDep,e.contextDep,e.propDep,(function(t,e){var r=t.shared.context;return[0,0,e.def(r,".",Qo),e.def(r,".",$o)]})):null}var s=o(ko);if(s){var a=s;s=new oa(s.thisDep,s.contextDep,s.propDep,(function(t,e){var r=a.append(t,e),n=t.shared.context;return e.set(n,"."+ts,r[2]),e.set(n,"."+es,r[3]),r}))}return{viewport:s,scissor_box:o(Fo)}}function D(t,e){var r=t.static;if("string"==typeof r[Xo]&&"string"==typeof r[Ho]){if(Object.keys(e.dynamic).length>0)return null;var n=e.static,i=Object.keys(n);if(i.length>0&&"number"==typeof n[i[0]]){for(var o=[],s=0;s<i.length;++s)rt("number"==typeof n[i[s]],"must specify all vertex attribute locations when using vaos"),o.push([0|n[i[s]],i[s]]);return o}}return null}function U(t,e,n){var i=t.static,o=t.dynamic;function s(t){if(t in i){var e=r.id(i[t]);rt.optional((function(){c.shader(ea[t],e,rt.guessCommand())}));var n=aa((function(){return e}));return n.id=e,n}if(t in o){var s=o[t];return ha(s,(function(e,r){var n=e.invoke(r,s),i=r.def(e.shared.strings,".id(",n,")");return rt.optional((function(){r(e.shared.shader,".shader(",ea[t],",",i,",",e.command,");")})),i}))}return null}var a,h=s(Xo),u=s(Ho),l=null;return sa(h)&&sa(u)?(l=c.program(u.id,h.id,null,n),a=aa((function(t,e){return t.link(l)}))):a=new oa(h&&h.thisDep||u&&u.thisDep,h&&h.contextDep||u&&u.contextDep,h&&h.propDep||u&&u.propDep,(function(t,e){var r,n=t.shared.shader;r=h?h.append(t,e):e.def(n,".",Xo);var i=n+".program("+(u?u.append(t,e):e.def(n,".",Ho))+","+r;return rt.optional((function(){i+=","+t.command})),e.def(i+")")})),{frag:h,vert:u,progVar:a,program:l}}function B(t,e){var r=t.static,n=t.dynamic;function i(){if(zo in r){var t=r[zo];na(t)?t=s.getElements(s.create(t,!0)):t&&(t=s.getElements(t),rt.command(t,"invalid elements",e.commandStr));var i=aa((function(e,r){if(t){var n=e.link(t);return e.ELEMENTS=n,n}return e.ELEMENTS=null,null}));return i.value=t,i}if(zo in n){var o=n[zo];return ha(o,(function(t,e){var r=t.shared,n=r.isBufferArgs,i=r.elements,s=t.invoke(e,o),a=e.def("null"),h=e.def(n,"(",s,")"),u=t.cond(h).then(a,"=",i,".createStream(",s,");").else(a,"=",i,".getElements(",s,");");return rt.optional((function(){t.assert(u.else,"!"+s+"||"+a,"invalid elements")})),e.entry(u),e.exit(t.cond(h).then(i,".destroyStream(",a,");")),t.ELEMENTS=a,a}))}return null}var o=i();function a(){if(Vo in r){var t=r[Vo];return rt.commandParameter(t,We,"invalid primitve",e.commandStr),aa((function(e,r){return We[t]}))}if(Vo in n){var i=n[Vo];return ha(i,(function(t,e){var r=t.constants.primTypes,n=t.invoke(e,i);return rt.optional((function(){t.assert(e,n+" in "+r,"invalid primitive, must be one of "+Object.keys(We))})),e.def(r,"[",n,"]")}))}return o?sa(o)?o.value?aa((function(t,e){return e.def(t.ELEMENTS,".primType")})):aa((function(){return Us})):new oa(o.thisDep,o.contextDep,o.propDep,(function(t,e){var r=t.ELEMENTS;return e.def(r,"?",r,".primType:",Us)})):null}function h(t,i){if(t in r){var s=0|r[t];return rt.command(!i||s>=0,"invalid "+t,e.commandStr),aa((function(t,e){return i&&(t.OFFSET=s),s}))}if(t in n){var a=n[t];return ha(a,(function(e,r){var n=e.invoke(r,a);return i&&(e.OFFSET=n,rt.optional((function(){e.assert(r,n+">=0","invalid "+t)}))),n}))}return i&&o?aa((function(t,e){return t.OFFSET="0",0})):null}var u=h(Yo,!0);function l(){if(Wo in r){var t=0|r[Wo];return rt.command("number"==typeof t&&t>=0,"invalid vertex count",e.commandStr),aa((function(){return t}))}if(Wo in n){var i=n[Wo];return ha(i,(function(t,e){var r=t.invoke(e,i);return rt.optional((function(){t.assert(e,"typeof "+r+'==="number"&&'+r+">=0&&"+r+"===("+r+"|0)","invalid vertex count")})),r}))}if(o){if(sa(o)){if(o)return u?new oa(u.thisDep,u.contextDep,u.propDep,(function(t,e){var r=e.def(t.ELEMENTS,".vertCount-",t.OFFSET);return rt.optional((function(){t.assert(e,r+">=0","invalid vertex offset/element buffer too small")})),r})):aa((function(t,e){return e.def(t.ELEMENTS,".vertCount")}));var s=aa((function(){return-1}));return rt.optional((function(){s.MISSING=!0})),s}var a=new oa(o.thisDep||u.thisDep,o.contextDep||u.contextDep,o.propDep||u.propDep,(function(t,e){var r=t.ELEMENTS;return t.OFFSET?e.def(r,"?",r,".vertCount-",t.OFFSET,":-1"):e.def(r,"?",r,".vertCount:-1")}));return rt.optional((function(){a.DYNAMIC=!0})),a}return null}return{elements:o,primitive:a(),count:l(),instances:h(qo,!1),offset:u}}function F(t,e){var r=t.static,n=t.dynamic,o={};return x.forEach((function(t){var s=A(t);function a(e,i){if(t in r){var a=e(r[t]);o[s]=aa((function(){return a}))}else if(t in n){var h=n[t];o[s]=ha(h,(function(t,e){return i(t,e,t.invoke(e,h))}))}}switch(t){case To:case po:case fo:case Mo:case yo:case Bo:case Oo:case Ro:case No:case Eo:return a((function(r){return rt.commandType(r,"boolean",t,e.commandStr),r}),(function(e,r,n){return rt.optional((function(){e.assert(r,"typeof "+n+'==="boolean"',"invalid flag "+t,e.commandStr)})),n}));case bo:return a((function(r){return rt.commandParameter(r,$s,"invalid "+t,e.commandStr),$s[r]}),(function(e,r,n){var i=e.constants.compareFuncs;return rt.optional((function(){e.assert(r,n+" in "+i,"invalid "+t+", must be one of "+Object.keys($s))})),r.def(i,"[",n,"]")}));case _o:return a((function(t){return rt.command(lr(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&t[0]<=t[1],"depth range is 2d array",e.commandStr),t}),(function(t,e,r){return rt.optional((function(){t.assert(e,t.shared.isArrayLike+"("+r+")&&"+r+".length===2&&typeof "+r+'[0]==="number"&&typeof '+r+'[1]==="number"&&'+r+"[0]<="+r+"[1]","depth range must be a 2d array")})),[e.def("+",r,"[0]"),e.def("+",r,"[1]")]}));case vo:return a((function(t){rt.commandType(t,"object","blend.func",e.commandStr);var r="srcRGB"in t?t.srcRGB:t.src,n="srcAlpha"in t?t.srcAlpha:t.src,i="dstRGB"in t?t.dstRGB:t.dst,o="dstAlpha"in t?t.dstAlpha:t.dst;return rt.commandParameter(r,Js,s+".srcRGB",e.commandStr),rt.commandParameter(n,Js,s+".srcAlpha",e.commandStr),rt.commandParameter(i,Js,s+".dstRGB",e.commandStr),rt.commandParameter(o,Js,s+".dstAlpha",e.commandStr),rt.command(-1===Qs.indexOf(r+", "+i),"unallowed blending combination (srcRGB, dstRGB) = ("+r+", "+i+")",e.commandStr),[Js[r],Js[i],Js[n],Js[o]]}),(function(e,r,n){var i=e.constants.blendFuncs;function o(o,s){var a=r.def('"',o,s,'" in ',n,"?",n,".",o,s,":",n,".",o);return rt.optional((function(){e.assert(r,a+" in "+i,"invalid "+t+"."+o+s+", must be one of "+Object.keys(Js))})),a}rt.optional((function(){e.assert(r,n+"&&typeof "+n+'==="object"',"invalid blend func, must be an object")}));var s=o("src","RGB"),a=o("dst","RGB");rt.optional((function(){var t=e.constants.invalidBlendCombinations;e.assert(r,t+".indexOf("+s+'+", "+'+a+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")}));var h=r.def(i,"[",s,"]"),u=r.def(i,"[",o("src","Alpha"),"]");return[h,r.def(i,"[",a,"]"),u,r.def(i,"[",o("dst","Alpha"),"]")]}));case go:return a((function(r){return"string"==typeof r?(rt.commandParameter(r,v,"invalid "+t,e.commandStr),[v[r],v[r]]):"object"==typeof r?(rt.commandParameter(r.rgb,v,t+".rgb",e.commandStr),rt.commandParameter(r.alpha,v,t+".alpha",e.commandStr),[v[r.rgb],v[r.alpha]]):void rt.commandRaise("invalid blend.equation",e.commandStr)}),(function(e,r,n){var i=e.constants.blendEquations,o=r.def(),s=r.def(),a=e.cond("typeof ",n,'==="string"');return rt.optional((function(){function r(t,r,n){e.assert(t,n+" in "+i,"invalid "+r+", must be one of "+Object.keys(v))}r(a.then,t,n),e.assert(a.else,n+"&&typeof "+n+'==="object"',"invalid "+t),r(a.else,t+".rgb",n+".rgb"),r(a.else,t+".alpha",n+".alpha")})),a.then(o,"=",s,"=",i,"[",n,"];"),a.else(o,"=",i,"[",n,".rgb];",s,"=",i,"[",n,".alpha];"),r(a),[o,s]}));case mo:return a((function(t){return rt.command(lr(t)&&4===t.length,"blend.color must be a 4d array",e.commandStr),St(4,(function(e){return+t[e]}))}),(function(t,e,r){return rt.optional((function(){t.assert(e,t.shared.isArrayLike+"("+r+")&&"+r+".length===4","blend.color must be a 4d array")})),St(4,(function(t){return e.def("+",r,"[",t,"]")}))}));case Po:return a((function(t){return rt.commandType(t,"number",s,e.commandStr),0|t}),(function(t,e,r){return rt.optional((function(){t.assert(e,"typeof "+r+'==="number"',"invalid stencil.mask")})),e.def(r,"|0")}));case Co:return a((function(r){rt.commandType(r,"object",s,e.commandStr);var n=r.cmp||"keep",i=r.ref||0,o="mask"in r?r.mask:-1;return rt.commandParameter(n,$s,t+".cmp",e.commandStr),rt.commandType(i,"number",t+".ref",e.commandStr),rt.commandType(o,"number",t+".mask",e.commandStr),[$s[n],i,o]}),(function(t,e,r){var n=t.constants.compareFuncs;return rt.optional((function(){function i(){t.assert(e,Array.prototype.join.call(arguments,""),"invalid stencil.func")}i(r+"&&typeof ",r,'==="object"'),i('!("cmp" in ',r,")||(",r,".cmp in ",n,")")})),[e.def('"cmp" in ',r,"?",n,"[",r,".cmp]",":",zs),e.def(r,".ref|0"),e.def('"mask" in ',r,"?",r,".mask|0:-1")]}));case Do:case Uo:return a((function(r){rt.commandType(r,"object",s,e.commandStr);var n=r.fail||"keep",i=r.zfail||"keep",o=r.zpass||"keep";return rt.commandParameter(n,ta,t+".fail",e.commandStr),rt.commandParameter(i,ta,t+".zfail",e.commandStr),rt.commandParameter(o,ta,t+".zpass",e.commandStr),[t===Uo?Fs:Bs,ta[n],ta[i],ta[o]]}),(function(e,r,n){var i=e.constants.stencilOps;function o(o){return rt.optional((function(){e.assert(r,'!("'+o+'" in '+n+")||("+n+"."+o+" in "+i+")","invalid "+t+"."+o+", must be one of "+Object.keys(ta))})),r.def('"',o,'" in ',n,"?",i,"[",n,".",o,"]:",zs)}return rt.optional((function(){e.assert(r,n+"&&typeof "+n+'==="object"',"invalid "+t)})),[t===Uo?Fs:Bs,o("fail"),o("zfail"),o("zpass")]}));case Io:return a((function(t){rt.commandType(t,"object",s,e.commandStr);var r=0|t.factor,n=0|t.units;return rt.commandType(r,"number",s+".factor",e.commandStr),rt.commandType(n,"number",s+".units",e.commandStr),[r,n]}),(function(e,r,n){return rt.optional((function(){e.assert(r,n+"&&typeof "+n+'==="object"',"invalid "+t)})),[r.def(n,".factor|0"),r.def(n,".units|0")]}));case wo:return a((function(t){var r=0;return"front"===t?r=Bs:"back"===t&&(r=Fs),rt.command(!!r,s,e.commandStr),r}),(function(t,e,r){return rt.optional((function(){t.assert(e,r+'==="front"||'+r+'==="back"',"invalid cull.face")})),e.def(r,'==="front"?',Bs,":",Fs)}));case So:return a((function(t){return rt.command("number"==typeof t&&t>=i.lineWidthDims[0]&&t<=i.lineWidthDims[1],"invalid line width, must be a positive number between "+i.lineWidthDims[0]+" and "+i.lineWidthDims[1],e.commandStr),t}),(function(t,e,r){return rt.optional((function(){t.assert(e,"typeof "+r+'==="number"&&'+r+">="+i.lineWidthDims[0]+"&&"+r+"<="+i.lineWidthDims[1],"invalid line width")})),r}));case Ao:return a((function(t){return rt.commandParameter(t,ra,s,e.commandStr),ra[t]}),(function(t,e,r){return rt.optional((function(){t.assert(e,r+'==="cw"||'+r+'==="ccw"',"invalid frontFace, must be one of cw,ccw")})),e.def(r+'==="cw"?'+ks+":"+Gs)}));case xo:return a((function(t){return rt.command(lr(t)&&4===t.length,"color.mask must be length 4 array",e.commandStr),t.map((function(t){return!!t}))}),(function(t,e,r){return rt.optional((function(){t.assert(e,t.shared.isArrayLike+"("+r+")&&"+r+".length===4","invalid color.mask")})),St(4,(function(t){return"!!"+r+"["+t+"]"}))}));case Lo:return a((function(t){rt.command("object"==typeof t&&t,s,e.commandStr);var r="value"in t?t.value:1,n=!!t.invert;return rt.command("number"==typeof r&&r>=0&&r<=1,"sample.coverage.value must be a number between 0 and 1",e.commandStr),[r,n]}),(function(t,e,r){return rt.optional((function(){t.assert(e,r+"&&typeof "+r+'==="object"',"invalid sample.coverage")})),[e.def('"value" in ',r,"?+",r,".value:1"),e.def("!!",r,".invert")]}))}})),o}function k(t,e){var r=t.static,n=t.dynamic,i={};return Object.keys(r).forEach((function(t){var n,o=r[t];if("number"==typeof o||"boolean"==typeof o)n=aa((function(){return o}));else if("function"==typeof o){var s=o._reglType;"texture2d"===s||"textureCube"===s?n=aa((function(t){return t.link(o)})):"framebuffer"===s||"framebufferCube"===s?(rt.command(o.color.length>0,'missing color attachment for framebuffer sent to uniform "'+t+'"',e.commandStr),n=aa((function(t){return t.link(o.color[0])}))):rt.commandRaise('invalid data for uniform "'+t+'"',e.commandStr)}else lr(o)?n=aa((function(e){return e.global.def("[",St(o.length,(function(r){return rt.command("number"==typeof o[r]||"boolean"==typeof o[r],"invalid uniform "+t,e.commandStr),o[r]})),"]")})):rt.commandRaise('invalid or missing data for uniform "'+t+'"',e.commandStr);n.value=o,i[t]=n})),Object.keys(n).forEach((function(t){var e=n[t];i[t]=ha(e,(function(t,r){return t.invoke(r,e)}))})),i}function G(t,e){var n=t.static,i=t.dynamic,s={};return Object.keys(n).forEach((function(t){var i=n[t],a=r.id(t),h=new g;if(na(i))h.state=no,h.buffer=o.getBuffer(o.create(i,ss,!1,!0)),h.type=0;else{var u=o.getBuffer(i);if(u)h.state=no,h.buffer=u,h.type=0;else if(rt.command("object"==typeof i&&i,"invalid data for attribute "+t,e.commandStr),"constant"in i){var l=i.constant;h.buffer="null",h.state=io,"number"==typeof l?h.x=l:(rt.command(lr(l)&&l.length>0&&l.length<=4,"invalid constant for attribute "+t,e.commandStr),eo.forEach((function(t,e){e<l.length&&(h[t]=l[e])})))}else{u=na(i.buffer)?o.getBuffer(o.create(i.buffer,ss,!1,!0)):o.getBuffer(i.buffer),rt.command(!!u,'missing buffer for attribute "'+t+'"',e.commandStr);var c=0|i.offset;rt.command(c>=0,'invalid offset for attribute "'+t+'"',e.commandStr);var d=0|i.stride;rt.command(d>=0&&d<256,'invalid stride for attribute "'+t+'", must be integer betweeen [0, 255]',e.commandStr);var f=0|i.size;rt.command(!("size"in i)||f>0&&f<=4,'invalid size for attribute "'+t+'", must be 1,2,3,4',e.commandStr);var p=!!i.normalized,m=0;"type"in i&&(rt.commandParameter(i.type,Pe,"invalid type for attribute "+t,e.commandStr),m=Pe[i.type]);var v=0|i.divisor;"divisor"in i&&(rt.command(0===v||y,'cannot specify divisor for attribute "'+t+'", instancing not supported',e.commandStr),rt.command(v>=0,'invalid divisor for attribute "'+t+'"',e.commandStr)),rt.optional((function(){var r=e.commandStr,n=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(i).forEach((function(e){rt.command(n.indexOf(e)>=0,'unknown parameter "'+e+'" for attribute pointer "'+t+'" (valid parameters are '+n+")",r)}))})),h.buffer=u,h.state=no,h.size=f,h.normalized=p,h.type=m||u.dtype,h.offset=c,h.stride=d,h.divisor=v}}s[t]=aa((function(t,e){var r=t.attribCache;if(a in r)return r[a];var n={isStream:!1};return Object.keys(h).forEach((function(t){n[t]=h[t]})),h.buffer&&(n.buffer=t.link(h.buffer),n.type=n.type||n.buffer+".dtype"),r[a]=n,n}))})),Object.keys(i).forEach((function(t){var e=i[t];function r(r,n){var i=r.invoke(n,e),o=r.shared,s=r.constants,a=o.isBufferArgs,h=o.buffer;rt.optional((function(){r.assert(n,i+"&&(typeof "+i+'==="object"||typeof '+i+'==="function")&&('+a+"("+i+")||"+h+".getBuffer("+i+")||"+h+".getBuffer("+i+".buffer)||"+a+"("+i+'.buffer)||("constant" in '+i+"&&(typeof "+i+'.constant==="number"||'+o.isArrayLike+"("+i+".constant))))",'invalid dynamic attribute "'+t+'"')}));var u={isStream:n.def(!1)},l=new g;l.state=no,Object.keys(l).forEach((function(t){u[t]=n.def(""+l[t])}));var c=u.buffer,d=u.type;function f(t){n(u[t],"=",i,".",t,"|0;")}return n("if(",a,"(",i,")){",u.isStream,"=true;",c,"=",h,".createStream(",ss,",",i,");",d,"=",c,".dtype;","}else{",c,"=",h,".getBuffer(",i,");","if(",c,"){",d,"=",c,".dtype;",'}else if("constant" in ',i,"){",u.state,"=",io,";","if(typeof "+i+'.constant === "number"){',u[eo[0]],"=",i,".constant;",eo.slice(1).map((function(t){return u[t]})).join("="),"=0;","}else{",eo.map((function(t,e){return u[t]+"="+i+".constant.length>"+e+"?"+i+".constant["+e+"]:0;"})).join(""),"}}else{","if(",a,"(",i,".buffer)){",c,"=",h,".createStream(",ss,",",i,".buffer);","}else{",c,"=",h,".getBuffer(",i,".buffer);","}",d,'="type" in ',i,"?",s.glTypes,"[",i,".type]:",c,".dtype;",u.normalized,"=!!",i,".normalized;"),f("size"),f("offset"),f("stride"),f("divisor"),n("}}"),n.exit("if(",u.isStream,"){",h,".destroyStream(",c,");","}"),u}s[t]=ha(e,r)})),s}function j(t,e){var r=t.static,n=t.dynamic;if(Ko in r){var i=r[Ko];return null!==i&&null===l.getVAO(i)&&(i=l.createVAO(i)),aa((function(t){return t.link(l.getVAO(i))}))}if(Ko in n){var o=n[Ko];return ha(o,(function(t,e){var r=t.invoke(e,o);return e.def(t.shared.vao+".getVAO("+r+")")}))}return null}function H(t){var e=t.static,r=t.dynamic,n={};return Object.keys(e).forEach((function(t){var r=e[t];n[t]=aa((function(t,e){return"number"==typeof r||"boolean"==typeof r?""+r:t.link(r)}))})),Object.keys(r).forEach((function(t){var e=r[t];n[t]=ha(e,(function(t,r){return t.invoke(r,e)}))})),n}function X(t,e,r,i,o){var s=t.static,a=t.dynamic;rt.optional((function(){var t=[jo,Ho,Xo,zo,Vo,Yo,Wo,qo,Go,Ko].concat(x);function e(e){Object.keys(e).forEach((function(e){rt.command(t.indexOf(e)>=0,'unknown parameter "'+e+'"',o.commandStr)}))}e(s),e(a)}));var h=D(t,e),u=P(t),c=C(t,u,o),d=B(t,o),f=F(t,o),p=U(t,o,h);function m(t){var e=c[t];e&&(f[t]=e)}m(ko),m(A(Fo));var g=Object.keys(f).length>0,v={framebuffer:u,draw:d,shader:p,state:f,dirty:g,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(v.profile=M(t),v.uniforms=k(r,o),v.drawVAO=v.scopeVAO=j(t),!v.drawVAO&&p.program&&!h&&n.angle_instanced_arrays){var y=!0,b=p.program.attributes.map((function(t){var r=e.static[t];return y=y&&!!r,r}));if(y&&b.length>0){var _=l.getVAO(l.createVAO(b));v.drawVAO=new oa(null,null,null,(function(t,e){return t.link(_)})),v.useVAO=!0}}return h?v.useVAO=!0:v.attributes=G(e,o),v.context=H(i),v}function z(t,e,r){var n=t.shared.context,i=t.scope();Object.keys(r).forEach((function(o){e.save(n,"."+o);var s=r[o].append(t,e);Array.isArray(s)?i(n,".",o,"=[",s.join(),"];"):i(n,".",o,"=",s,";")})),e(i)}function V(t,e,r,n){var i,o=t.shared,s=o.gl,a=o.framebuffer;b&&(i=e.def(o.extensions,".webgl_draw_buffers"));var h,u=t.constants,l=u.drawBuffer,c=u.backBuffer;h=r?r.append(t,e):e.def(a,".next"),n||e("if(",h,"!==",a,".cur){"),e("if(",h,"){",s,".bindFramebuffer(",Ks,",",h,".framebuffer);"),b&&e(i,".drawBuffersWEBGL(",l,"[",h,".colorAttachments.length]);"),e("}else{",s,".bindFramebuffer(",Ks,",null);"),b&&e(i,".drawBuffersWEBGL(",c,");"),e("}",a,".cur=",h,";"),n||e("}")}function W(t,e,r){var n=t.shared,i=n.gl,o=t.current,s=t.next,a=n.current,h=n.next,u=t.cond(a,".dirty");x.forEach((function(e){var n,l,c=A(e);if(!(c in r.state))if(c in s){n=s[c],l=o[c];var d=St(_[c].length,(function(t){return u.def(n,"[",t,"]")}));u(t.cond(d.map((function(t,e){return t+"!=="+l+"["+e+"]"})).join("||")).then(i,".",w[c],"(",d,");",d.map((function(t,e){return l+"["+e+"]="+t})).join(";"),";"))}else{n=u.def(h,".",c);var f=t.cond(n,"!==",a,".",c);u(f),c in T?f(t.cond(n).then(i,".enable(",T[c],");").else(i,".disable(",T[c],");"),a,".",c,"=",n,";"):f(i,".",w[c],"(",n,");",a,".",c,"=",n,";")}})),0===Object.keys(r.state).length&&u(a,".dirty=false;"),e(u)}function Y(t,e,r,n){var i=t.shared,o=t.current,s=i.current,a=i.gl;ia(Object.keys(r)).forEach((function(i){var h=r[i];if(!n||n(h)){var u=h.append(t,e);if(T[i]){var l=T[i];sa(h)?e(a,u?".enable(":".disable(",l,");"):e(t.cond(u).then(a,".enable(",l,");").else(a,".disable(",l,");")),e(s,".",i,"=",u,";")}else if(lr(u)){var c=o[i];e(a,".",w[i],"(",u,");",u.map((function(t,e){return c+"["+e+"]="+t})).join(";"),";")}else e(a,".",w[i],"(",u,");",s,".",i,"=",u,";")}}))}function q(t,e){y&&(t.instancing=e.def(t.shared.extensions,".angle_instanced_arrays"))}function K(t,e,r,n,i){var o,s,a,h=t.shared,u=t.stats,l=h.current,c=h.timer,d=r.profile;function f(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function m(t){t(o=e.def(),"=",f(),";"),"string"==typeof i?t(u,".count+=",i,";"):t(u,".count++;"),p&&(n?t(s=e.def(),"=",c,".getNumPendingQueries();"):t(c,".beginQuery(",u,");"))}function g(t){t(u,".cpuTime+=",f(),"-",o,";"),p&&(n?t(c,".pushScopeStats(",s,",",c,".getNumPendingQueries(),",u,");"):t(c,".endQuery();"))}function v(t){var r=e.def(l,".profile");e(l,".profile=",t,";"),e.exit(l,".profile=",r,";")}if(d){if(sa(d))return void(d.enable?(m(e),g(e.exit),v("true")):v("false"));v(a=d.append(t,e))}else a=e.def(l,".profile");var y=t.block();m(y),e("if(",a,"){",y,"}");var b=t.block();g(b),e.exit("if(",a,"){",b,"}")}function Z(t,e,r,n,i){var o=t.shared;function s(t){switch(t){case _s:case ws:case Is:return 2;case Es:case As:case Rs:return 3;case xs:case Ss:case Ns:return 4;default:return 1}}function a(r,n,i){var s=o.gl,a=e.def(r,".location"),h=e.def(o.attributes,"[",a,"]"),u=i.state,l=i.buffer,c=[i.x,i.y,i.z,i.w],d=["buffer","normalized","offset","stride"];function f(){e("if(!",h,".buffer){",s,".enableVertexAttribArray(",a,");}");var r,o=i.type;if(r=i.size?e.def(i.size,"||",n):n,e("if(",h,".type!==",o,"||",h,".size!==",r,"||",d.map((function(t){return h+"."+t+"!=="+i[t]})).join("||"),"){",s,".bindBuffer(",ss,",",l,".buffer);",s,".vertexAttribPointer(",[a,r,o,i.normalized,i.stride,i.offset],");",h,".type=",o,";",h,".size=",r,";",d.map((function(t){return h+"."+t+"="+i[t]+";"})).join(""),"}"),y){var u=i.divisor;e("if(",h,".divisor!==",u,"){",t.instancing,".vertexAttribDivisorANGLE(",[a,u],");",h,".divisor=",u,";}")}}function p(){e("if(",h,".buffer){",s,".disableVertexAttribArray(",a,");",h,".buffer=null;","}if(",eo.map((function(t,e){return h+"."+t+"!=="+c[e]})).join("||"),"){",s,".vertexAttrib4f(",a,",",c,");",eo.map((function(t,e){return h+"."+t+"="+c[e]+";"})).join(""),"}")}u===no?f():u===io?p():(e("if(",u,"===",no,"){"),f(),e("}else{"),p(),e("}"))}n.forEach((function(n){var o,h=n.name,u=r.attributes[h];if(u){if(!i(u))return;o=u.append(t,e)}else{if(!i(ua))return;var l=t.scopeAttrib(h);rt.optional((function(){t.assert(e,l+".state","missing attribute "+h)})),o={},Object.keys(new g).forEach((function(t){o[t]=e.def(l,".",t)}))}a(t.link(n),s(n.info.type),o)}))}function J(t,e,n,i,o){for(var s,a=t.shared,h=a.gl,u=0;u<i.length;++u){var l,c=i[u],d=c.name,f=c.info.type,p=n.uniforms[d],m=t.link(c)+".location";if(p){if(!o(p))continue;if(sa(p)){var g=p.value;if(rt.command(null!=g,'missing uniform "'+d+'"',t.commandStr),f===Cs||f===Ds){rt.command("function"==typeof g&&(f===Cs&&("texture2d"===g._reglType||"framebuffer"===g._reglType)||f===Ds&&("textureCube"===g._reglType||"framebufferCube"===g._reglType)),"invalid texture for uniform "+d,t.commandStr);var v=t.link(g._texture||g.color[0]._texture);e(h,".uniform1i(",m,",",v+".bind());"),e.exit(v,".unbind();")}else if(f===Ls||f===Ms||f===Ps){rt.optional((function(){rt.command(lr(g),"invalid matrix for uniform "+d,t.commandStr),rt.command(f===Ls&&4===g.length||f===Ms&&9===g.length||f===Ps&&16===g.length,"invalid length for matrix uniform "+d,t.commandStr)}));var y=t.global.def("new Float32Array(["+Array.prototype.slice.call(g)+"])"),b=2;f===Ms?b=3:f===Ps&&(b=4),e(h,".uniformMatrix",b,"fv(",m,",false,",y,");")}else{switch(f){case bs:rt.commandType(g,"number","uniform "+d,t.commandStr),s="1f";break;case _s:rt.command(lr(g)&&2===g.length,"uniform "+d,t.commandStr),s="2f";break;case Es:rt.command(lr(g)&&3===g.length,"uniform "+d,t.commandStr),s="3f";break;case xs:rt.command(lr(g)&&4===g.length,"uniform "+d,t.commandStr),s="4f";break;case Os:rt.commandType(g,"boolean","uniform "+d,t.commandStr),s="1i";break;case Ts:rt.commandType(g,"number","uniform "+d,t.commandStr),s="1i";break;case Is:case ws:rt.command(lr(g)&&2===g.length,"uniform "+d,t.commandStr),s="2i";break;case Rs:case As:rt.command(lr(g)&&3===g.length,"uniform "+d,t.commandStr),s="3i";break;case Ns:case Ss:rt.command(lr(g)&&4===g.length,"uniform "+d,t.commandStr),s="4i"}e(h,".uniform",s,"(",m,",",lr(g)?Array.prototype.slice.call(g):g,");")}continue}l=p.append(t,e)}else{if(!o(ua))continue;l=e.def(a.uniforms,"[",r.id(d),"]")}f===Cs?(rt(!Array.isArray(l),"must specify a scalar prop for textures"),e("if(",l,"&&",l,'._reglType==="framebuffer"){',l,"=",l,".color[0];","}")):f===Ds&&(rt(!Array.isArray(l),"must specify a scalar prop for cube maps"),e("if(",l,"&&",l,'._reglType==="framebufferCube"){',l,"=",l,".color[0];","}")),rt.optional((function(){function r(r,n){t.assert(e,r,'bad data or missing for uniform "'+d+'".  '+n)}function n(t){rt(!Array.isArray(l),"must not specify an array type for uniform"),r("typeof "+l+'==="'+t+'"',"invalid type, expected "+t)}function i(e,n){Array.isArray(l)?rt(l.length===e,"must have length "+e):r(a.isArrayLike+"("+l+")&&"+l+".length==="+e,"invalid vector, should have length "+e,t.commandStr)}function o(e){rt(!Array.isArray(l),"must not specify a value type"),r("typeof "+l+'==="function"&&'+l+'._reglType==="texture'+(e===hs?"2d":"Cube")+'"',"invalid texture type",t.commandStr)}switch(f){case Ts:n("number");break;case ws:i(2);break;case As:i(3);break;case Ss:i(4);break;case bs:n("number");break;case _s:i(2);break;case Es:i(3);break;case xs:i(4);break;case Os:n("boolean");break;case Is:i(2);break;case Rs:i(3);break;case Ns:case Ls:i(4);break;case Ms:i(9);break;case Ps:i(16);break;case Cs:o(hs);break;case Ds:o(us)}}));var _=1;switch(f){case Cs:case Ds:var E=e.def(l,"._texture");e(h,".uniform1i(",m,",",E,".bind());"),e.exit(E,".unbind();");continue;case Ts:case Os:s="1i";break;case ws:case Is:s="2i",_=2;break;case As:case Rs:s="3i",_=3;break;case Ss:case Ns:s="4i",_=4;break;case bs:s="1f";break;case _s:s="2f",_=2;break;case Es:s="3f",_=3;break;case xs:s="4f",_=4;break;case Ls:s="Matrix2fv";break;case Ms:s="Matrix3fv";break;case Ps:s="Matrix4fv"}if(e(h,".uniform",s,"(",m,","),"M"===s.charAt(0)){var x=Math.pow(f-Ls+2,2),T=t.global.def("new Float32Array(",x,")");Array.isArray(l)?e("false,(",St(x,(function(t){return T+"["+t+"]="+l[t]})),",",T,")"):e("false,(Array.isArray(",l,")||",l," instanceof Float32Array)?",l,":(",St(x,(function(t){return T+"["+t+"]="+l+"["+t+"]"})),",",T,")")}else _>1?e(St(_,(function(t){return Array.isArray(l)?l[t]:l+"["+t+"]"}))):(rt(!Array.isArray(l),"uniform value must not be an array"),e(l));e(");")}}function Q(t,e,r,n){var i=t.shared,o=i.gl,s=i.draw,a=n.draw;function h(){var i,h=a.elements,u=e;return h?((h.contextDep&&n.contextDynamic||h.propDep)&&(u=r),i=h.append(t,u)):i=u.def(s,".",zo),i&&u("if("+i+")"+o+".bindBuffer("+as+","+i+".buffer.buffer);"),i}function u(){var i,o=a.count,h=e;return o?((o.contextDep&&n.contextDynamic||o.propDep)&&(h=r),i=o.append(t,h),rt.optional((function(){o.MISSING&&t.assert(e,"false","missing vertex count"),o.DYNAMIC&&t.assert(h,i+">=0","missing vertex count")}))):(i=h.def(s,".",Wo),rt.optional((function(){t.assert(h,i+">=0","missing vertex count")}))),i}var l=h();function c(i){var o=a[i];return o?o.contextDep&&n.contextDynamic||o.propDep?o.append(t,r):o.append(t,e):e.def(s,".",i)}var d,f,p=c(Vo),m=c(Yo),g=u();if("number"==typeof g){if(0===g)return}else r("if(",g,"){"),r.exit("}");y&&(d=c(qo),f=t.instancing);var v=l+".type",b=a.elements&&sa(a.elements);function _(){function t(){r(f,".drawElementsInstancedANGLE(",[p,g,v,m+"<<(("+v+"-"+ro+")>>1)",d],");")}function e(){r(f,".drawArraysInstancedANGLE(",[p,m,g,d],");")}l?b?t():(r("if(",l,"){"),t(),r("}else{"),e(),r("}")):e()}function E(){function t(){r(o+".drawElements("+[p,g,v,m+"<<(("+v+"-"+ro+")>>1)"]+");")}function e(){r(o+".drawArrays("+[p,m,g]+");")}l?b?t():(r("if(",l,"){"),t(),r("}else{"),e(),r("}")):e()}y&&("number"!=typeof d||d>=0)?"string"==typeof d?(r("if(",d,">0){"),_(),r("}else if(",d,"<0){"),E(),r("}")):_():E()}function $(t,e,r,n,i){var o=L(),s=o.proc("body",i);return rt.optional((function(){o.commandStr=e.commandStr,o.command=o.link(e.commandStr)})),y&&(o.instancing=s.def(o.shared.extensions,".angle_instanced_arrays")),t(o,s,r,n),o.compile().body}function tt(t,e,r,n){q(t,e),r.useVAO?r.drawVAO?e(t.shared.vao,".setVAO(",r.drawVAO.append(t,e),");"):e(t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"):(e(t.shared.vao,".setVAO(null);"),Z(t,e,r,n.attributes,(function(){return!0}))),J(t,e,r,n.uniforms,(function(){return!0})),Q(t,e,e,r)}function et(t,e){var r=t.proc("draw",1);q(t,r),z(t,r,e.context),V(t,r,e.framebuffer),W(t,r,e),Y(t,r,e.state),K(t,r,e,!1,!0);var n=e.shader.progVar.append(t,r);if(r(t.shared.gl,".useProgram(",n,".program);"),e.shader.program)tt(t,r,e,e.shader.program);else{r(t.shared.vao,".setVAO(null);");var i=t.global.def("{}"),o=r.def(n,".id"),s=r.def(i,"[",o,"]");r(t.cond(s).then(s,".call(this,a0);").else(s,"=",i,"[",o,"]=",t.link((function(r){return $(tt,t,e,r,1)})),"(",n,");",s,".call(this,a0);"))}Object.keys(e.state).length>0&&r(t.shared.current,".dirty=true;")}function nt(t,e,r,n){function i(){return!0}t.batchId="a1",q(t,e),Z(t,e,r,n.attributes,i),J(t,e,r,n.uniforms,i),Q(t,e,e,r)}function it(t,e,r,n){q(t,e);var i=r.contextDep,o=e.def(),s="a0",a="a1",h=e.def();t.shared.props=h,t.batchId=o;var u=t.scope(),l=t.scope();function c(t){return t.contextDep&&i||t.propDep}function d(t){return!c(t)}if(e(u.entry,"for(",o,"=0;",o,"<",a,";++",o,"){",h,"=",s,"[",o,"];",l,"}",u.exit),r.needsContext&&z(t,l,r.context),r.needsFramebuffer&&V(t,l,r.framebuffer),Y(t,l,r.state,c),r.profile&&c(r.profile)&&K(t,l,r,!1,!0),n)r.useVAO?r.drawVAO?c(r.drawVAO)?l(t.shared.vao,".setVAO(",r.drawVAO.append(t,l),");"):u(t.shared.vao,".setVAO(",r.drawVAO.append(t,u),");"):u(t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"):(u(t.shared.vao,".setVAO(null);"),Z(t,u,r,n.attributes,d),Z(t,l,r,n.attributes,c)),J(t,u,r,n.uniforms,d),J(t,l,r,n.uniforms,c),Q(t,u,l,r);else{var f=t.global.def("{}"),p=r.shader.progVar.append(t,l),m=l.def(p,".id"),g=l.def(f,"[",m,"]");l(t.shared.gl,".useProgram(",p,".program);","if(!",g,"){",g,"=",f,"[",m,"]=",t.link((function(e){return $(nt,t,r,e,2)})),"(",p,");}",g,".call(this,a0[",o,"],",o,");")}}function ot(t,e){var r=t.proc("batch",2);t.batchId="0",q(t,r);var n=!1,i=!0;Object.keys(e.context).forEach((function(t){n=n||e.context[t].propDep})),n||(z(t,r,e.context),i=!1);var o=e.framebuffer,s=!1;function a(t){return t.contextDep&&n||t.propDep}o?(o.propDep?n=s=!0:o.contextDep&&n&&(s=!0),s||V(t,r,o)):V(t,r,null),e.state.viewport&&e.state.viewport.propDep&&(n=!0),W(t,r,e),Y(t,r,e.state,(function(t){return!a(t)})),e.profile&&a(e.profile)||K(t,r,e,!1,"a1"),e.contextDep=n,e.needsContext=i,e.needsFramebuffer=s;var h=e.shader.progVar;if(h.contextDep&&n||h.propDep)it(t,r,e,null);else{var u=h.append(t,r);if(r(t.shared.gl,".useProgram(",u,".program);"),e.shader.program)it(t,r,e,e.shader.program);else{r(t.shared.vao,".setVAO(null);");var l=t.global.def("{}"),c=r.def(u,".id"),d=r.def(l,"[",c,"]");r(t.cond(d).then(d,".call(this,a0,a1);").else(d,"=",l,"[",c,"]=",t.link((function(r){return $(it,t,e,r,2)})),"(",u,");",d,".call(this,a0,a1);"))}}Object.keys(e.state).length>0&&r(t.shared.current,".dirty=true;")}function st(t,e){var n=t.proc("scope",3);t.batchId="a2";var i=t.shared,o=i.current;function s(r){var o=e.shader[r];o&&n.set(i.shader,"."+r,o.append(t,n))}z(t,n,e.context),e.framebuffer&&e.framebuffer.append(t,n),ia(Object.keys(e.state)).forEach((function(r){var o=e.state[r].append(t,n);lr(o)?o.forEach((function(e,i){n.set(t.next[r],"["+i+"]",e)})):n.set(i.next,"."+r,o)})),K(t,n,e,!0,!0),[zo,Yo,Wo,qo,Vo].forEach((function(r){var o=e.draw[r];o&&n.set(i.draw,"."+r,""+o.append(t,n))})),Object.keys(e.uniforms).forEach((function(o){var s=e.uniforms[o].append(t,n);Array.isArray(s)&&(s="["+s.join()+"]"),n.set(i.uniforms,"["+r.id(o)+"]",s)})),Object.keys(e.attributes).forEach((function(r){var i=e.attributes[r].append(t,n),o=t.scopeAttrib(r);Object.keys(new g).forEach((function(t){n.set(o,"."+t,i[t])}))})),e.scopeVAO&&n.set(i.vao,".targetVAO",e.scopeVAO.append(t,n)),s(Ho),s(Xo),Object.keys(e.state).length>0&&(n(o,".dirty=true;"),n.exit(o,".dirty=true;")),n("a1(",t.shared.context,",a0,",t.batchId,");")}function at(t){if("object"==typeof t&&!lr(t)){for(var e=Object.keys(t),r=0;r<e.length;++r)if(pt.isDynamic(t[e[r]]))return!0;return!1}}function ht(t,e,r){var n=e.static[r];if(n&&at(n)){var i=t.global,o=Object.keys(n),s=!1,a=!1,h=!1,u=t.global.def("{}");o.forEach((function(e){var r=n[e];if(pt.isDynamic(r)){"function"==typeof r&&(r=n[e]=pt.unbox(r));var o=ha(r,null);s=s||o.thisDep,h=h||o.propDep,a=a||o.contextDep}else{switch(i(u,".",e,"="),typeof r){case"number":i(r);break;case"string":i('"',r,'"');break;case"object":Array.isArray(r)&&i("[",r.join(),"]");break;default:i(t.link(r))}i(";")}})),e.dynamic[r]=new pt.DynamicVariable(uo,{thisDep:s,contextDep:a,propDep:h,ref:u,append:l}),delete e.static[r]}function l(t,e){o.forEach((function(r){var i=n[r];if(pt.isDynamic(i)){var o=t.invoke(e,i);e(u,".",r,"=",o,";")}}))}}function ut(t,r,n,i,o){var s=L();s.stats=s.link(o),Object.keys(r.static).forEach((function(t){ht(s,r,t)})),os.forEach((function(e){ht(s,t,e)}));var a=X(t,r,n,i,s);return et(s,a),st(s,a),ot(s,a),e(s.compile(),{destroy:function(){a.shader.program.destroy()}})}return{next:E,current:_,procs:function(){var t=L(),e=t.proc("poll"),r=t.proc("refresh"),o=t.block();e(o),r(o);var s,a=t.shared,h=a.gl,u=a.next,l=a.current;o(l,".dirty=false;"),V(t,e),V(t,r,null,!0),y&&(s=t.link(y)),n.oes_vertex_array_object&&r(t.link(n.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var c=0;c<i.maxAttributes;++c){var d=r.def(a.attributes,"[",c,"]"),f=t.cond(d,".buffer");f.then(h,".enableVertexAttribArray(",c,");",h,".bindBuffer(",ss,",",d,".buffer.buffer);",h,".vertexAttribPointer(",c,",",d,".size,",d,".type,",d,".normalized,",d,".stride,",d,".offset);").else(h,".disableVertexAttribArray(",c,");",h,".vertexAttrib4f(",c,",",d,".x,",d,".y,",d,".z,",d,".w);",d,".buffer=null;"),r(f),y&&r(s,".vertexAttribDivisorANGLE(",c,",",d,".divisor);")}return r(t.shared.vao,".currentVAO=null;",t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"),Object.keys(T).forEach((function(n){var i=T[n],s=o.def(u,".",n),a=t.block();a("if(",s,"){",h,".enable(",i,")}else{",h,".disable(",i,")}",l,".",n,"=",s,";"),r(a),e("if(",s,"!==",l,".",n,"){",a,"}")})),Object.keys(w).forEach((function(n){var i,s,a=w[n],c=_[n],d=t.block();if(d(h,".",a,"("),lr(c)){var f=c.length;i=t.global.def(u,".",n),s=t.global.def(l,".",n),d(St(f,(function(t){return i+"["+t+"]"})),");",St(f,(function(t){return s+"["+t+"]="+i+"["+t+"];"})).join("")),e("if(",St(f,(function(t){return i+"["+t+"]!=="+s+"["+t+"]"})).join("||"),"){",d,"}")}else i=o.def(u,".",n),s=o.def(l,".",n),d(i,");",l,".",n,"=",i,";"),e("if(",i,"!==",s,"){",d,"}");r(d)})),t.compile()}(),compile:ut}}function ca(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var da=34918,fa=34919,pa=35007,ma=function(t,e){if(!e.ext_disjoint_timer_query)return null;var r=[];function n(){return r.pop()||e.ext_disjoint_timer_query.createQueryEXT()}function i(t){r.push(t)}var o=[];function s(t){var r=n();e.ext_disjoint_timer_query.beginQueryEXT(pa,r),o.push(r),f(o.length-1,o.length,t)}function a(){e.ext_disjoint_timer_query.endQueryEXT(pa)}function h(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var u=[];function l(){return u.pop()||new h}function c(t){u.push(t)}var d=[];function f(t,e,r){var n=l();n.startQueryIndex=t,n.endQueryIndex=e,n.sum=0,n.stats=r,d.push(n)}var p=[],m=[];function g(){var t,r,n=o.length;if(0!==n){m.length=Math.max(m.length,n+1),p.length=Math.max(p.length,n+1),p[0]=0,m[0]=0;var s=0;for(t=0,r=0;r<o.length;++r){var a=o[r];e.ext_disjoint_timer_query.getQueryObjectEXT(a,fa)?(s+=e.ext_disjoint_timer_query.getQueryObjectEXT(a,da),i(a)):o[t++]=a,p[r+1]=s,m[r+1]=t}for(o.length=t,t=0,r=0;r<d.length;++r){var h=d[r],u=h.startQueryIndex,l=h.endQueryIndex;h.sum+=p[l]-p[u];var f=m[u],g=m[l];g===f?(h.stats.gpuTime+=h.sum/1e6,c(h)):(h.startQueryIndex=f,h.endQueryIndex=g,d[t++]=h)}d.length=t}}return{beginQuery:s,endQuery:a,pushScopeStats:f,update:g,getNumPendingQueries:function(){return o.length},clear:function(){r.push.apply(r,o);for(var t=0;t<r.length;t++)e.ext_disjoint_timer_query.deleteQueryEXT(r[t]);o.length=0,r.length=0},restore:function(){o.length=0,r.length=0}}},ga=16384,va=256,ya=1024,ba=34962,_a="webglcontextlost",Ea="webglcontextrestored",xa=1,Ta=2,wa=3;function Aa(t,e){for(var r=0;r<t.length;++r)if(t[r]===e)return r;return-1}function Sa(t){var r=wt(t);if(!r)return null;var n=r.gl,i=n.getContextAttributes(),o=n.isContextLost(),s=At(n,r);if(!s)return null;var a=vt(),h=ca(),u=s.extensions,l=ma(n,u),c=gt(),d=n.drawingBufferWidth,f=n.drawingBufferHeight,p={tick:0,time:0,viewportWidth:d,viewportHeight:f,framebufferWidth:d,framebufferHeight:f,drawingBufferWidth:d,drawingBufferHeight:f,pixelRatio:r.pixelRatio},m={},g={elements:null,primitive:4,count:-1,offset:0,instances:-1},v=xe(n,u),y=Ve(n,h,r,_),b=ji(n,u,v,h,y);function _(t){return b.destroyBuffer(t)}var E=or(n,u,y,h),x=Wi(n,a,h,r),T=Kn(n,u,v,(function(){S.procs.poll()}),p,h,r),w=ui(n,u,v,h,r),A=Bi(n,u,v,T,w,h),S=la(n,a,u,v,y,E,T,A,m,b,x,g,p,l,r),O=Ji(n,A,S.procs.poll,p,i,u,v),I=S.next,R=n.canvas,N=[],L=[],M=[],P=[r.onDestroy],C=null;function D(){if(0===N.length)return l&&l.update(),void(C=null);C=mt.next(D),Y();for(var t=N.length-1;t>=0;--t){var e=N[t];e&&e(p,null,0)}n.flush(),l&&l.update()}function U(){!C&&N.length>0&&(C=mt.next(D))}function B(){C&&(mt.cancel(D),C=null)}function F(t){t.preventDefault(),o=!0,B(),L.forEach((function(t){t()}))}function k(t){n.getError(),o=!1,s.restore(),x.restore(),y.restore(),T.restore(),w.restore(),A.restore(),b.restore(),l&&l.restore(),S.procs.refresh(),U(),M.forEach((function(t){t()}))}function G(){N.length=0,B(),R&&(R.removeEventListener(_a,F),R.removeEventListener(Ea,k)),x.clear(),A.clear(),w.clear(),T.clear(),E.clear(),y.clear(),b.clear(),l&&l.clear(),P.forEach((function(t){t()}))}function j(t){function r(t){var r=e({},t);function n(t){if(t in r){var e=r[t];delete r[t],Object.keys(e).forEach((function(n){r[t+"."+n]=e[n]}))}}return delete r.uniforms,delete r.attributes,delete r.context,delete r.vao,"stencil"in r&&r.stencil.op&&(r.stencil.opBack=r.stencil.opFront=r.stencil.op,delete r.stencil.op),n("blend"),n("depth"),n("cull"),n("stencil"),n("polygonOffset"),n("scissor"),n("sample"),"vao"in t&&(r.vao=t.vao),r}function n(t,e){var r={},n={};return Object.keys(t).forEach((function(i){var o=t[i];if(pt.isDynamic(o))n[i]=pt.unbox(o,i);else{if(e&&Array.isArray(o))for(var s=0;s<o.length;++s)if(pt.isDynamic(o[s]))return void(n[i]=pt.unbox(o,i));r[i]=o}})),{dynamic:n,static:r}}rt(!!t,"invalid args to regl({...})"),rt.type(t,"object","invalid args to regl({...})");var i=n(t.context||{},!0),s=n(t.uniforms||{},!0),a=n(t.attributes||{},!1),h=n(r(t),!1),u={gpuTime:0,cpuTime:0,count:0},l=S.compile(h,a,s,i,u),c=l.draw,d=l.batch,f=l.scope,p=[];function m(t){for(;p.length<t;)p.push(null);return p}function g(t,e){var r;if(o&&rt.raise("context lost"),"function"==typeof t)return f.call(this,null,t,0);if("function"==typeof e)if("number"==typeof t)for(r=0;r<t;++r)f.call(this,null,e,r);else{if(!Array.isArray(t))return f.call(this,t,e,0);for(r=0;r<t.length;++r)f.call(this,t[r],e,r)}else if("number"==typeof t){if(t>0)return d.call(this,m(0|t),0|t)}else{if(!Array.isArray(t))return c.call(this,t);if(t.length)return d.call(this,t,t.length)}}return e(g,{stats:u,destroy:function(){l.destroy()}})}R&&(R.addEventListener(_a,F,!1),R.addEventListener(Ea,k,!1));var H=A.setFBO=j({framebuffer:pt.define.call(null,xa,"framebuffer")});function X(t,e){var r=0;S.procs.poll();var i=e.color;i&&(n.clearColor(+i[0]||0,+i[1]||0,+i[2]||0,+i[3]||0),r|=ga),"depth"in e&&(n.clearDepth(+e.depth),r|=va),"stencil"in e&&(n.clearStencil(0|e.stencil),r|=ya),rt(!!r,"called regl.clear with no buffer specified"),n.clear(r)}function z(t){if(rt("object"==typeof t&&t,"regl.clear() takes an object as input"),"framebuffer"in t)if(t.framebuffer&&"framebufferCube"===t.framebuffer_reglType)for(var r=0;r<6;++r)H(e({framebuffer:t.framebuffer.faces[r]},t),X);else H(t,X);else X(null,t)}function V(t){function e(){var e=Aa(N,t);function r(){var t=Aa(N,r);N[t]=N[N.length-1],N.length-=1,N.length<=0&&B()}rt(e>=0,"cannot cancel a frame twice"),N[e]=r}return rt.type(t,"function","regl.frame() callback must be a function"),N.push(t),U(),{cancel:e}}function W(){var t=I.viewport,e=I.scissor_box;t[0]=t[1]=e[0]=e[1]=0,p.viewportWidth=p.framebufferWidth=p.drawingBufferWidth=t[2]=e[2]=n.drawingBufferWidth,p.viewportHeight=p.framebufferHeight=p.drawingBufferHeight=t[3]=e[3]=n.drawingBufferHeight}function Y(){p.tick+=1,p.time=K(),W(),S.procs.poll()}function q(){T.refresh(),W(),S.procs.refresh(),l&&l.update()}function K(){return(gt()-c)/1e3}function Z(t,e){var r;switch(rt.type(e,"function","listener callback must be a function"),t){case"frame":return V(e);case"lost":r=L;break;case"restore":r=M;break;case"destroy":r=P;break;default:rt.raise("invalid event, must be one of frame,lost,restore,destroy")}return r.push(e),{cancel:function(){for(var t=0;t<r.length;++t)if(r[t]===e)return r[t]=r[r.length-1],void r.pop()}}}q();var J=e(j,{clear:z,prop:pt.define.bind(null,xa),context:pt.define.bind(null,Ta),this:pt.define.bind(null,wa),draw:j({}),buffer:function(t){return y.create(t,ba,!1,!1)},elements:function(t){return E.create(t,!1)},texture:T.create2D,cube:T.createCube,renderbuffer:w.create,framebuffer:A.create,framebufferCube:A.createCube,vao:b.createVAO,attributes:i,frame:V,on:Z,limits:v,hasExtension:function(t){return v.extensions.indexOf(t.toLowerCase())>=0},read:O,destroy:G,_gl:n,_refresh:q,poll:function(){Y(),l&&l.update()},now:K,stats:h});return r.onDone(null,J),J}return Sa}()})),Ng(Gg={},Dg.POINTS,"points"),Ng(Gg,Dg.LINES,"lines"),Ng(Gg,Dg.LINE_LOOP,"line loop"),Ng(Gg,Dg.LINE_STRIP,"line strip"),Ng(Gg,Dg.TRIANGLES,"triangles"),Ng(Gg,Dg.TRIANGLE_FAN,"triangle fan"),Ng(Gg,Dg.TRIANGLE_STRIP,"triangle strip"),Ng(jg={},Dg.STATIC_DRAW,"static"),Ng(jg,Dg.DYNAMIC_DRAW,"dynamic"),Ng(jg,Dg.STREAM_DRAW,"stream"),Ng(Hg={},Dg.BYTE,"int8"),Ng(Hg,Dg.UNSIGNED_INT,"int16"),Ng(Hg,Dg.INT,"int32"),Ng(Hg,Dg.UNSIGNED_BYTE,"uint8"),Ng(Hg,Dg.UNSIGNED_SHORT,"uint16"),Ng(Hg,Dg.UNSIGNED_INT,"uint32"),Ng(Hg,Dg.FLOAT,"float"),Ng(Xg={},Dg.ALPHA,"alpha"),Ng(Xg,Dg.LUMINANCE,"luminance"),Ng(Xg,Dg.LUMINANCE_ALPHA,"luminance alpha"),Ng(Xg,Dg.RGB,"rgb"),Ng(Xg,Dg.RGBA,"rgba"),Ng(Xg,Dg.RGBA4,"rgba4"),Ng(Xg,Dg.RGB5_A1,"rgb5 a1"),Ng(Xg,Dg.RGB565,"rgb565"),Ng(Xg,Dg.DEPTH_COMPONENT,"depth"),Ng(Xg,Dg.DEPTH_STENCIL,"depth stencil"),Ng(zg={},Dg.DONT_CARE,"dont care"),Ng(zg,Dg.NICEST,"nice"),Ng(zg,Dg.FASTEST,"fast"),Ng(Vg={},Dg.NEAREST,"nearest"),Ng(Vg,Dg.LINEAR,"linear"),Ng(Vg,Dg.LINEAR_MIPMAP_LINEAR,"mipmap"),Ng(Vg,Dg.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),Ng(Vg,Dg.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),Ng(Vg,Dg.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),Ng(Wg={},Dg.REPEAT,"repeat"),Ng(Wg,Dg.CLAMP_TO_EDGE,"clamp"),Ng(Wg,Dg.MIRRORED_REPEAT,"mirror"),Ng(Yg={},Dg.NONE,"none"),Ng(Yg,Dg.BROWSER_DEFAULT_WEBGL,"browser"),Ng(qg={},Dg.NEVER,"never"),Ng(qg,Dg.ALWAYS,"always"),Ng(qg,Dg.LESS,"less"),Ng(qg,Dg.LEQUAL,"lequal"),Ng(qg,Dg.GREATER,"greater"),Ng(qg,Dg.GEQUAL,"gequal"),Ng(qg,Dg.EQUAL,"equal"),Ng(qg,Dg.NOTEQUAL,"notequal"),Ng(Kg={},Dg.FUNC_ADD,"add"),Ng(Kg,Dg.MIN_EXT,"min"),Ng(Kg,Dg.MAX_EXT,"max"),Ng(Kg,Dg.FUNC_SUBTRACT,"subtract"),Ng(Kg,Dg.FUNC_REVERSE_SUBTRACT,"reverse subtract"),Ng(Zg={},Dg.ZERO,"zero"),Ng(Zg,Dg.ONE,"one"),Ng(Zg,Dg.SRC_COLOR,"src color"),Ng(Zg,Dg.ONE_MINUS_SRC_COLOR,"one minus src color"),Ng(Zg,Dg.SRC_ALPHA,"src alpha"),Ng(Zg,Dg.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),Ng(Zg,Dg.DST_COLOR,"dst color"),Ng(Zg,Dg.ONE_MINUS_DST_COLOR,"one minus dst color"),Ng(Zg,Dg.DST_ALPHA,"dst alpha"),Ng(Zg,Dg.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),Ng(Zg,Dg.CONSTANT_COLOR,"constant color"),Ng(Zg,Dg.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),Ng(Zg,Dg.CONSTANT_ALPHA,"constant alpha"),Ng(Zg,Dg.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),Ng(Zg,Dg.SRC_ALPHA_SATURATE,"src alpha saturate"),Ng(Jg={},Dg.NEVER,"never"),Ng(Jg,Dg.ALWAYS,"always"),Ng(Jg,Dg.LESS,"less"),Ng(Jg,Dg.LEQUAL,"lequal"),Ng(Jg,Dg.GREATER,"greater"),Ng(Jg,Dg.GEQUAL,"gequal"),Ng(Jg,Dg.EQUAL,"equal"),Ng(Jg,Dg.NOTEQUAL,"notequal"),Ng(Qg={},Dg.ZERO,"zero"),Ng(Qg,Dg.KEEP,"keep"),Ng(Qg,Dg.REPLACE,"replace"),Ng(Qg,Dg.INVERT,"invert"),Ng(Qg,Dg.INCR,"increment"),Ng(Qg,Dg.DECR,"decrement"),Ng(Qg,Dg.INCR_WRAP,"increment wrap"),Ng(Qg,Dg.DECR_WRAP,"decrement wrap"),Ng($g={},Dg.FRONT,"front"),Ng($g,Dg.BACK,"back"),Function.prototype.toString.call(Object);var rv=function(){var t,e,r={};!function(){var t=10;r.exports=function(e,r,n){var i,o,s,a,h,u,l,c,d,f,p,m,g,v,y,b,_,E,x,T,w,A,S,O=r.length,I=n.length,R=e.adjustSizes,N=e.barnesHutTheta*e.barnesHutTheta,L=[];for(s=0;s<O;s+=t)r[s+4]=r[s+2],r[s+5]=r[s+3],r[s+2]=0,r[s+3]=0;if(e.outboundAttractionDistribution){for(p=0,s=0;s<O;s+=t)p+=r[s+6];p/=O/t}if(e.barnesHutOptimize){var M,P,C,D=1/0,U=-1/0,B=1/0,F=-1/0;for(s=0;s<O;s+=t)D=Math.min(D,r[s+0]),U=Math.max(U,r[s+0]),B=Math.min(B,r[s+1]),F=Math.max(F,r[s+1]);var k=U-D,G=F-B;for(k>G?F=(B-=(k-G)/2)+k:U=(D-=(G-k)/2)+G,L[0]=-1,L[1]=(D+U)/2,L[2]=(B+F)/2,L[3]=Math.max(U-D,F-B),L[4]=-1,L[5]=-1,L[6]=0,L[7]=0,L[8]=0,i=1,s=0;s<O;s+=t)for(o=0,C=3;;){if(!(L[o+5]>=0)){if(L[o+0]<0){L[o+0]=s;break}if(L[o+5]=9*i,c=L[o+3]/2,L[(d=L[o+5])+0]=-1,L[d+1]=L[o+1]-c,L[d+2]=L[o+2]-c,L[d+3]=c,L[d+4]=d+9,L[d+5]=-1,L[d+6]=0,L[d+7]=0,L[d+8]=0,L[(d+=9)+0]=-1,L[d+1]=L[o+1]-c,L[d+2]=L[o+2]+c,L[d+3]=c,L[d+4]=d+9,L[d+5]=-1,L[d+6]=0,L[d+7]=0,L[d+8]=0,L[(d+=9)+0]=-1,L[d+1]=L[o+1]+c,L[d+2]=L[o+2]-c,L[d+3]=c,L[d+4]=d+9,L[d+5]=-1,L[d+6]=0,L[d+7]=0,L[d+8]=0,L[(d+=9)+0]=-1,L[d+1]=L[o+1]+c,L[d+2]=L[o+2]+c,L[d+3]=c,L[d+4]=L[o+4],L[d+5]=-1,L[d+6]=0,L[d+7]=0,L[d+8]=0,i+=4,M=r[L[o+0]+0]<L[o+1]?r[L[o+0]+1]<L[o+2]?L[o+5]:L[o+5]+9:r[L[o+0]+1]<L[o+2]?L[o+5]+18:L[o+5]+27,L[o+6]=r[L[o+0]+6],L[o+7]=r[L[o+0]+0],L[o+8]=r[L[o+0]+1],L[M+0]=L[o+0],L[o+0]=-1,M===(P=r[s+0]<L[o+1]?r[s+1]<L[o+2]?L[o+5]:L[o+5]+9:r[s+1]<L[o+2]?L[o+5]+18:L[o+5]+27)){if(C--){o=M;continue}C=3;break}L[P+0]=s;break}M=r[s+0]<L[o+1]?r[s+1]<L[o+2]?L[o+5]:L[o+5]+9:r[s+1]<L[o+2]?L[o+5]+18:L[o+5]+27,L[o+7]=(L[o+7]*L[o+6]+r[s+0]*r[s+6])/(L[o+6]+r[s+6]),L[o+8]=(L[o+8]*L[o+6]+r[s+1]*r[s+6])/(L[o+6]+r[s+6]),L[o+6]+=r[s+6],o=M}}if(e.barnesHutOptimize){for(m=e.scalingRatio,s=0;s<O;s+=t)for(o=0;;)if(L[o+5]>=0){if(b=Math.pow(r[s+0]-L[o+7],2)+Math.pow(r[s+1]-L[o+8],2),4*(f=L[o+3])*f/b<N){if(g=r[s+0]-L[o+7],v=r[s+1]-L[o+8],!0===R?b>0?(_=m*r[s+6]*L[o+6]/b,r[s+2]+=g*_,r[s+3]+=v*_):b<0&&(_=-m*r[s+6]*L[o+6]/Math.sqrt(b),r[s+2]+=g*_,r[s+3]+=v*_):b>0&&(_=m*r[s+6]*L[o+6]/b,r[s+2]+=g*_,r[s+3]+=v*_),(o=L[o+4])<0)break;continue}o=L[o+5]}else if((u=L[o+0])>=0&&u!==s&&(b=(g=r[s+0]-r[u+0])*g+(v=r[s+1]-r[u+1])*v,!0===R?b>0?(_=m*r[s+6]*r[u+6]/b,r[s+2]+=g*_,r[s+3]+=v*_):b<0&&(_=-m*r[s+6]*r[u+6]/Math.sqrt(b),r[s+2]+=g*_,r[s+3]+=v*_):b>0&&(_=m*r[s+6]*r[u+6]/b,r[s+2]+=g*_,r[s+3]+=v*_)),(o=L[o+4])<0)break}else for(m=e.scalingRatio,a=0;a<O;a+=t)for(h=0;h<a;h+=t)g=r[a+0]-r[h+0],v=r[a+1]-r[h+1],!0===R?(b=Math.sqrt(g*g+v*v)-r[a+8]-r[h+8])>0?(_=m*r[a+6]*r[h+6]/b/b,r[a+2]+=g*_,r[a+3]+=v*_,r[h+2]-=g*_,r[h+3]-=v*_):b<0&&(_=100*m*r[a+6]*r[h+6],r[a+2]+=g*_,r[a+3]+=v*_,r[h+2]-=g*_,r[h+3]-=v*_):(b=Math.sqrt(g*g+v*v))>0&&(_=m*r[a+6]*r[h+6]/b/b,r[a+2]+=g*_,r[a+3]+=v*_,r[h+2]-=g*_,r[h+3]-=v*_);for(d=e.gravity/e.scalingRatio,m=e.scalingRatio,s=0;s<O;s+=t)_=0,g=r[s+0],v=r[s+1],b=Math.sqrt(Math.pow(g,2)+Math.pow(v,2)),e.strongGravityMode?b>0&&(_=m*r[s+6]*d):b>0&&(_=m*r[s+6]*d/b),r[s+2]-=g*_,r[s+3]-=v*_;for(m=1*(e.outboundAttractionDistribution?p:1),l=0;l<I;l+=3)a=n[l+0],h=n[l+1],c=n[l+2],y=Math.pow(c,e.edgeWeightInfluence),g=r[a+0]-r[h+0],v=r[a+1]-r[h+1],!0===R?(b=Math.sqrt(g*g+v*v)-r[a+8]-r[h+8],e.linLogMode?e.outboundAttractionDistribution?b>0&&(_=-m*y*Math.log(1+b)/b/r[a+6]):b>0&&(_=-m*y*Math.log(1+b)/b):e.outboundAttractionDistribution?b>0&&(_=-m*y/r[a+6]):b>0&&(_=-m*y)):(b=Math.sqrt(Math.pow(g,2)+Math.pow(v,2)),e.linLogMode?e.outboundAttractionDistribution?b>0&&(_=-m*y*Math.log(1+b)/b/r[a+6]):b>0&&(_=-m*y*Math.log(1+b)/b):e.outboundAttractionDistribution?(b=1,_=-m*y/r[a+6]):(b=1,_=-m*y)),b>0&&(r[a+2]+=g*_,r[a+3]+=v*_,r[h+2]-=g*_,r[h+3]-=v*_);if(!0===R)for(s=0;s<O;s+=t)1!==r[s+9]&&((E=Math.sqrt(Math.pow(r[s+2],2)+Math.pow(r[s+3],2)))>10&&(r[s+2]=10*r[s+2]/E,r[s+3]=10*r[s+3]/E),x=r[s+6]*Math.sqrt((r[s+4]-r[s+2])*(r[s+4]-r[s+2])+(r[s+5]-r[s+3])*(r[s+5]-r[s+3])),T=Math.sqrt((r[s+4]+r[s+2])*(r[s+4]+r[s+2])+(r[s+5]+r[s+3])*(r[s+5]+r[s+3]))/2,w=.1*Math.log(1+T)/(1+Math.sqrt(x)),A=r[s+0]+r[s+2]*(w/e.slowDown),r[s+0]=A,S=r[s+1]+r[s+3]*(w/e.slowDown),r[s+1]=S);else for(s=0;s<O;s+=t)1!==r[s+9]&&(x=r[s+6]*Math.sqrt((r[s+4]-r[s+2])*(r[s+4]-r[s+2])+(r[s+5]-r[s+3])*(r[s+5]-r[s+3])),T=Math.sqrt((r[s+4]+r[s+2])*(r[s+4]+r[s+2])+(r[s+5]+r[s+3])*(r[s+5]+r[s+3]))/2,w=r[s+7]*Math.log(1+T)/(1+Math.sqrt(x)),r[s+7]=Math.min(1,Math.sqrt(w*(Math.pow(r[s+2],2)+Math.pow(r[s+3],2))/(1+Math.sqrt(x)))),A=r[s+0]+r[s+2]*(w/e.slowDown),r[s+0]=A,S=r[s+1]+r[s+3]*(w/e.slowDown),r[s+1]=S);return{}}}();var n=r.exports;self.addEventListener("message",(function(r){var i=r.data;t=new Float32Array(i.nodes),i.edges&&(e=new Float32Array(i.edges)),n(i.settings,t,e),self.postMessage({nodes:t.buffer},[t.buffer])}))},nv=function(t){return null!==t&&"object"==typeof t&&"function"==typeof t.addUndirectedEdgeWithKey&&"function"==typeof t.dropNode&&"boolean"==typeof t.multi};function iv(t){return"number"!=typeof t||isNaN(t)?1:t}function ov(t,e){var r={},n=function(t){return void 0===t?e:t};"function"==typeof e&&(n=e);var i=function(e){return n(e[t])},o=function(){return n(void 0)};return"string"==typeof t?(r.fromAttributes=i,r.fromGraph=function(t,e){return i(t.getEdgeAttributes(e))},r.fromEntry=function(t,e){return i(e)},r.fromPartialEntry=r.fromEntry,r.fromMinimalEntry=r.fromEntry):"function"==typeof t?(r.fromAttributes=function(){throw new Error("graphology-utils/getters/createEdgeValueGetter: irrelevant usage.")},r.fromGraph=function(e,r){var i=e.extremities(r);return n(t(r,e.getEdgeAttributes(r),i[0],i[1],e.getNodeAttributes(i[0]),e.getNodeAttributes(i[1]),e.isUndirected(r)))},r.fromEntry=function(e,r,i,o,s,a,h){return n(t(e,r,i,o,s,a,h))},r.fromPartialEntry=function(e,r,i,o){return n(t(e,r,i,o))},r.fromMinimalEntry=function(e,r){return n(t(e,r))}):(r.fromAttributes=o,r.fromGraph=o,r.fromEntry=o,r.fromMinimalEntry=o),r}var sv=function(t){return ov(t,iv)},av=function(t){t=t||{};var e,r,n,i=Array.prototype.slice.call(arguments).slice(1);for(e=0,n=i.length;e<n;e++)if(i[e])for(r in i[e])t[r]=i[e][r];return t},hv=function(t){return"linLogMode"in t&&"boolean"!=typeof t.linLogMode?{message:"the `linLogMode` setting should be a boolean."}:"outboundAttractionDistribution"in t&&"boolean"!=typeof t.outboundAttractionDistribution?{message:"the `outboundAttractionDistribution` setting should be a boolean."}:"adjustSizes"in t&&"boolean"!=typeof t.adjustSizes?{message:"the `adjustSizes` setting should be a boolean."}:"edgeWeightInfluence"in t&&"number"!=typeof t.edgeWeightInfluence?{message:"the `edgeWeightInfluence` setting should be a number."}:!("scalingRatio"in t)||"number"==typeof t.scalingRatio&&t.scalingRatio>=0?"strongGravityMode"in t&&"boolean"!=typeof t.strongGravityMode?{message:"the `strongGravityMode` setting should be a boolean."}:!("gravity"in t)||"number"==typeof t.gravity&&t.gravity>=0?"slowDown"in t&&!("number"==typeof t.slowDown||t.slowDown>=0)?{message:"the `slowDown` setting should be a number >= 0."}:"barnesHutOptimize"in t&&"boolean"!=typeof t.barnesHutOptimize?{message:"the `barnesHutOptimize` setting should be a boolean."}:!("barnesHutTheta"in t)||"number"==typeof t.barnesHutTheta&&t.barnesHutTheta>=0?null:{message:"the `barnesHutTheta` setting should be a number >= 0."}:{message:"the `gravity` setting should be a number >= 0."}:{message:"the `scalingRatio` setting should be a number >= 0."}},uv=function(t,e){var r,n=t.order,i=t.size,o={},s=new Float32Array(10*n),a=new Float32Array(3*i);return r=0,t.forEachNode((function(t,e){o[t]=r,s[r]=e.x,s[r+1]=e.y,s[r+2]=0,s[r+3]=0,s[r+4]=0,s[r+5]=0,s[r+6]=1,s[r+7]=1,s[r+8]=e.size||1,s[r+9]=e.fixed?1:0,r+=10})),r=0,t.forEachEdge((function(t,n,i,h,u,l,c){var d=o[i],f=o[h],p=e(t,n,i,h,u,l,c);s[d+6]+=p,s[f+6]+=p,a[r]=d,a[r+1]=f,a[r+2]=p,r+=3})),{nodes:s,edges:a}},lv=function(t,e,r){var n=0;t.updateEachNodeAttributes((function(t,i){return i.x=e[n],i.y=e[n+1],n+=10,r?r(t,i):i}))},cv=function(t,e){var r=0;t.forEachNode((function(t,n){e[r]=n.x,e[r+1]=n.y,r+=10}))},dv=function(t,e,r){for(var n=t.nodes(),i={},o=0,s=0,a=e.length;o<a;o+=10){if(r){var h=Object.assign({},t.getNodeAttributes(n[s]));h.x=e[o],h.y=e[o+1],h=r(n[s],h),i[n[s]]={x:h.x,y:h.y}}else i[n[s]]={x:e[o],y:e[o+1]};s++}return i},fv=function(t){var e=window.URL||window.webkitURL,r=t.toString(),n=e.createObjectURL(new Blob(["("+r+").call(this);"],{type:"text/javascript"})),i=new Worker(n);return e.revokeObjectURL(n),i},pv={linLogMode:!1,outboundAttractionDistribution:!1,adjustSizes:!1,edgeWeightInfluence:1,scalingRatio:1,strongGravityMode:!1,gravity:1,slowDown:1,barnesHutOptimize:!1,barnesHutTheta:.5},mv=sv;function gv(t,e){if(e=e||{},!nv(t))throw new Error("graphology-layout-forceatlas2/worker: the given graph is not a valid graphology instance.");var r=mv("getEdgeWeight"in e?e.getEdgeWeight:"weight").fromEntry,n=av({},pv,e.settings),i=hv(n);if(i)throw new Error("graphology-layout-forceatlas2/worker: "+i.message);this.worker=null,this.graph=t,this.settings=n,this.getEdgeWeight=r,this.matrices=null,this.running=!1,this.killed=!1,this.outputReducer="function"==typeof e.outputReducer?e.outputReducer:null,this.handleMessage=this.handleMessage.bind(this);var o=void 0,s=this;this.handleGraphUpdate=function(){s.worker&&s.worker.terminate(),o&&clearTimeout(o),o=setTimeout((function(){o=void 0,s.spawnWorker()}),0)},t.on("nodeAdded",this.handleGraphUpdate),t.on("edgeAdded",this.handleGraphUpdate),t.on("nodeDropped",this.handleGraphUpdate),t.on("edgeDropped",this.handleGraphUpdate),this.spawnWorker()}gv.prototype.isRunning=function(){return this.running},gv.prototype.spawnWorker=function(){this.worker&&this.worker.terminate(),this.worker=fv(rv),this.worker.addEventListener("message",this.handleMessage),this.running&&(this.running=!1,this.start())},gv.prototype.handleMessage=function(t){if(this.running){var e=new Float32Array(t.data.nodes);lv(this.graph,e,this.outputReducer),this.outputReducer&&cv(this.graph,e),this.matrices.nodes=e,this.askForIterations()}},gv.prototype.askForIterations=function(t){var e=this.matrices,r={settings:this.settings,nodes:e.nodes.buffer},n=[e.nodes.buffer];return t&&(r.edges=e.edges.buffer,n.push(e.edges.buffer)),this.worker.postMessage(r,n),this},gv.prototype.start=function(){if(this.killed)throw new Error("graphology-layout-forceatlas2/worker.start: layout was killed.");return this.running||(this.matrices=uv(this.graph,this.getEdgeWeight),this.running=!0,this.askForIterations(!0)),this},gv.prototype.stop=function(){return this.running=!1,this},gv.prototype.kill=function(){if(this.killed)return this;this.running=!1,this.killed=!0,this.matrices=null,this.worker.terminate(),this.graph.removeListener("nodeAdded",this.handleGraphUpdate),this.graph.removeListener("edgeAdded",this.handleGraphUpdate),this.graph.removeListener("nodeDropped",this.handleGraphUpdate),this.graph.removeListener("edgeDropped",this.handleGraphUpdate)};var vv=gv,yv=10,bv=function(t,e,r){var n,i,o,s,a,h,u,l,c,d,f,p,m,g,v,y,b,_,E,x,T,w,A,S=e.length,O=r.length,I=t.adjustSizes,R=t.barnesHutTheta*t.barnesHutTheta,N=[];for(o=0;o<S;o+=yv)e[o+4]=e[o+2],e[o+5]=e[o+3],e[o+2]=0,e[o+3]=0;if(t.outboundAttractionDistribution){for(f=0,o=0;o<S;o+=yv)f+=e[o+6];f/=S/yv}if(t.barnesHutOptimize){var L,M,P,C=1/0,D=-1/0,U=1/0,B=-1/0;for(o=0;o<S;o+=yv)C=Math.min(C,e[o+0]),D=Math.max(D,e[o+0]),U=Math.min(U,e[o+1]),B=Math.max(B,e[o+1]);var F=D-C,k=B-U;for(F>k?B=(U-=(F-k)/2)+F:D=(C-=(k-F)/2)+k,N[0]=-1,N[1]=(C+D)/2,N[2]=(U+B)/2,N[3]=Math.max(D-C,B-U),N[4]=-1,N[5]=-1,N[6]=0,N[7]=0,N[8]=0,n=1,o=0;o<S;o+=yv)for(i=0,P=3;;){if(!(N[i+5]>=0)){if(N[i+0]<0){N[i+0]=o;break}if(N[i+5]=9*n,l=N[i+3]/2,N[(c=N[i+5])+0]=-1,N[c+1]=N[i+1]-l,N[c+2]=N[i+2]-l,N[c+3]=l,N[c+4]=c+9,N[c+5]=-1,N[c+6]=0,N[c+7]=0,N[c+8]=0,N[(c+=9)+0]=-1,N[c+1]=N[i+1]-l,N[c+2]=N[i+2]+l,N[c+3]=l,N[c+4]=c+9,N[c+5]=-1,N[c+6]=0,N[c+7]=0,N[c+8]=0,N[(c+=9)+0]=-1,N[c+1]=N[i+1]+l,N[c+2]=N[i+2]-l,N[c+3]=l,N[c+4]=c+9,N[c+5]=-1,N[c+6]=0,N[c+7]=0,N[c+8]=0,N[(c+=9)+0]=-1,N[c+1]=N[i+1]+l,N[c+2]=N[i+2]+l,N[c+3]=l,N[c+4]=N[i+4],N[c+5]=-1,N[c+6]=0,N[c+7]=0,N[c+8]=0,n+=4,L=e[N[i+0]+0]<N[i+1]?e[N[i+0]+1]<N[i+2]?N[i+5]:N[i+5]+9:e[N[i+0]+1]<N[i+2]?N[i+5]+18:N[i+5]+27,N[i+6]=e[N[i+0]+6],N[i+7]=e[N[i+0]+0],N[i+8]=e[N[i+0]+1],N[L+0]=N[i+0],N[i+0]=-1,L===(M=e[o+0]<N[i+1]?e[o+1]<N[i+2]?N[i+5]:N[i+5]+9:e[o+1]<N[i+2]?N[i+5]+18:N[i+5]+27)){if(P--){i=L;continue}P=3;break}N[M+0]=o;break}L=e[o+0]<N[i+1]?e[o+1]<N[i+2]?N[i+5]:N[i+5]+9:e[o+1]<N[i+2]?N[i+5]+18:N[i+5]+27,N[i+7]=(N[i+7]*N[i+6]+e[o+0]*e[o+6])/(N[i+6]+e[o+6]),N[i+8]=(N[i+8]*N[i+6]+e[o+1]*e[o+6])/(N[i+6]+e[o+6]),N[i+6]+=e[o+6],i=L}}if(t.barnesHutOptimize){for(p=t.scalingRatio,o=0;o<S;o+=yv)for(i=0;;)if(N[i+5]>=0){if(y=Math.pow(e[o+0]-N[i+7],2)+Math.pow(e[o+1]-N[i+8],2),4*(d=N[i+3])*d/y<R){if(m=e[o+0]-N[i+7],g=e[o+1]-N[i+8],!0===I?y>0?(b=p*e[o+6]*N[i+6]/y,e[o+2]+=m*b,e[o+3]+=g*b):y<0&&(b=-p*e[o+6]*N[i+6]/Math.sqrt(y),e[o+2]+=m*b,e[o+3]+=g*b):y>0&&(b=p*e[o+6]*N[i+6]/y,e[o+2]+=m*b,e[o+3]+=g*b),(i=N[i+4])<0)break;continue}i=N[i+5]}else if((h=N[i+0])>=0&&h!==o&&(y=(m=e[o+0]-e[h+0])*m+(g=e[o+1]-e[h+1])*g,!0===I?y>0?(b=p*e[o+6]*e[h+6]/y,e[o+2]+=m*b,e[o+3]+=g*b):y<0&&(b=-p*e[o+6]*e[h+6]/Math.sqrt(y),e[o+2]+=m*b,e[o+3]+=g*b):y>0&&(b=p*e[o+6]*e[h+6]/y,e[o+2]+=m*b,e[o+3]+=g*b)),(i=N[i+4])<0)break}else for(p=t.scalingRatio,s=0;s<S;s+=yv)for(a=0;a<s;a+=yv)m=e[s+0]-e[a+0],g=e[s+1]-e[a+1],!0===I?(y=Math.sqrt(m*m+g*g)-e[s+8]-e[a+8])>0?(b=p*e[s+6]*e[a+6]/y/y,e[s+2]+=m*b,e[s+3]+=g*b,e[a+2]-=m*b,e[a+3]-=g*b):y<0&&(b=100*p*e[s+6]*e[a+6],e[s+2]+=m*b,e[s+3]+=g*b,e[a+2]-=m*b,e[a+3]-=g*b):(y=Math.sqrt(m*m+g*g))>0&&(b=p*e[s+6]*e[a+6]/y/y,e[s+2]+=m*b,e[s+3]+=g*b,e[a+2]-=m*b,e[a+3]-=g*b);for(c=t.gravity/t.scalingRatio,p=t.scalingRatio,o=0;o<S;o+=yv)b=0,m=e[o+0],g=e[o+1],y=Math.sqrt(Math.pow(m,2)+Math.pow(g,2)),t.strongGravityMode?y>0&&(b=p*e[o+6]*c):y>0&&(b=p*e[o+6]*c/y),e[o+2]-=m*b,e[o+3]-=g*b;for(p=1*(t.outboundAttractionDistribution?f:1),u=0;u<O;u+=3)s=r[u+0],a=r[u+1],l=r[u+2],v=Math.pow(l,t.edgeWeightInfluence),m=e[s+0]-e[a+0],g=e[s+1]-e[a+1],!0===I?(y=Math.sqrt(m*m+g*g)-e[s+8]-e[a+8],t.linLogMode?t.outboundAttractionDistribution?y>0&&(b=-p*v*Math.log(1+y)/y/e[s+6]):y>0&&(b=-p*v*Math.log(1+y)/y):t.outboundAttractionDistribution?y>0&&(b=-p*v/e[s+6]):y>0&&(b=-p*v)):(y=Math.sqrt(Math.pow(m,2)+Math.pow(g,2)),t.linLogMode?t.outboundAttractionDistribution?y>0&&(b=-p*v*Math.log(1+y)/y/e[s+6]):y>0&&(b=-p*v*Math.log(1+y)/y):t.outboundAttractionDistribution?(y=1,b=-p*v/e[s+6]):(y=1,b=-p*v)),y>0&&(e[s+2]+=m*b,e[s+3]+=g*b,e[a+2]-=m*b,e[a+3]-=g*b);if(!0===I)for(o=0;o<S;o+=yv)1!==e[o+9]&&((_=Math.sqrt(Math.pow(e[o+2],2)+Math.pow(e[o+3],2)))>10&&(e[o+2]=10*e[o+2]/_,e[o+3]=10*e[o+3]/_),E=e[o+6]*Math.sqrt((e[o+4]-e[o+2])*(e[o+4]-e[o+2])+(e[o+5]-e[o+3])*(e[o+5]-e[o+3])),x=Math.sqrt((e[o+4]+e[o+2])*(e[o+4]+e[o+2])+(e[o+5]+e[o+3])*(e[o+5]+e[o+3]))/2,T=.1*Math.log(1+x)/(1+Math.sqrt(E)),w=e[o+0]+e[o+2]*(T/t.slowDown),e[o+0]=w,A=e[o+1]+e[o+3]*(T/t.slowDown),e[o+1]=A);else for(o=0;o<S;o+=yv)1!==e[o+9]&&(E=e[o+6]*Math.sqrt((e[o+4]-e[o+2])*(e[o+4]-e[o+2])+(e[o+5]-e[o+3])*(e[o+5]-e[o+3])),x=Math.sqrt((e[o+4]+e[o+2])*(e[o+4]+e[o+2])+(e[o+5]+e[o+3])*(e[o+5]+e[o+3]))/2,T=e[o+7]*Math.log(1+x)/(1+Math.sqrt(E)),e[o+7]=Math.min(1,Math.sqrt(T*(Math.pow(e[o+2],2)+Math.pow(e[o+3],2))/(1+Math.sqrt(E)))),w=e[o+0]+e[o+2]*(T/t.slowDown),e[o+0]=w,A=e[o+1]+e[o+3]*(T/t.slowDown),e[o+1]=A);return{}},_v=sv;function Ev(t,e,r){if(!nv(e))throw new Error("graphology-layout-forceatlas2: the given graph is not a valid graphology instance.");"number"==typeof r&&(r={iterations:r});var n=r.iterations;if("number"!=typeof n)throw new Error("graphology-layout-forceatlas2: invalid number of iterations.");if(n<=0)throw new Error("graphology-layout-forceatlas2: you should provide a positive number of iterations.");var i=_v("getEdgeWeight"in r?r.getEdgeWeight:"weight").fromEntry,o="function"==typeof r.outputReducer?r.outputReducer:null,s=av({},pv,r.settings),a=hv(s);if(a)throw new Error("graphology-layout-forceatlas2: "+a.message);var h,u=uv(e,i);for(h=0;h<n;h++)bv(s,u.nodes,u.edges);if(!t)return dv(e,u.nodes);lv(e,u.nodes,o)}var xv=Ev.bind(null,!1);xv.assign=Ev.bind(null,!0),xv.inferSettings=function(t){var e="number"==typeof t?t:t.order;return{barnesHutOptimize:e>2e3,strongGravityMode:!0,gravity:.05,scalingRatio:10,slowDown:1+Math.log(e)}};var Tv=xv,wv=function(){function t(t){this.options=t}return t.prototype.runLayout=function(t,e){e&&t.forEachNode((function(e){t.setNodeAttribute(e,"x",Math.random()),t.setNodeAttribute(e,"y",Math.random())}));var r=new vv(t,{settings:Do(Do({},Tv.inferSettings(t)),this.options)});r.start(),this.layout=r},t.prototype.stopLayout=function(){var t;null===(t=this.layout)||void 0===t||t.stop()},t.prototype.isRunning=function(){var t;return null===(t=this.layout)||void 0===t?void 0:t.isRunning()},t.prototype.kill=function(){var t;null===(t=this.layout)||void 0===t||t.kill()},t}(),Av=function(t){return function(t){return!!t&&"object"==typeof t}(t)&&!function(t){var e=Object.prototype.toString.call(t);return"[object RegExp]"===e||"[object Date]"===e||function(t){return t.$$typeof===Sv}(t)}(t)};var Sv="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function Ov(t,e){return!1!==e.clone&&e.isMergeableObject(t)?Mv((r=t,Array.isArray(r)?[]:{}),t,e):t;var r}function Iv(t,e,r){return t.concat(e).map((function(t){return Ov(t,r)}))}function Rv(t){return Object.keys(t).concat(function(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter((function(e){return t.propertyIsEnumerable(e)})):[]}(t))}function Nv(t,e){try{return e in t}catch(t){return!1}}function Lv(t,e,r){var n={};return r.isMergeableObject(t)&&Rv(t).forEach((function(e){n[e]=Ov(t[e],r)})),Rv(e).forEach((function(i){(function(t,e){return Nv(t,e)&&!(Object.hasOwnProperty.call(t,e)&&Object.propertyIsEnumerable.call(t,e))})(t,i)||(Nv(t,i)&&r.isMergeableObject(e[i])?n[i]=function(t,e){if(!e.customMerge)return Mv;var r=e.customMerge(t);return"function"==typeof r?r:Mv}(i,r)(t[i],e[i],r):n[i]=Ov(e[i],r))})),n}function Mv(t,e,r){(r=r||{}).arrayMerge=r.arrayMerge||Iv,r.isMergeableObject=r.isMergeableObject||Av,r.cloneUnlessOtherwiseSpecified=Ov;var n=Array.isArray(e);return n===Array.isArray(t)?n?r.arrayMerge(t,e,r):Lv(t,e,r):Ov(e,r)}Mv.all=function(t,e){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce((function(t,r){return Mv(t,r,e)}),{})};var Pv=Mv;function Cv(t,e){var r=t.filter((function(t){return!!t})).map((function(t){return function t(e,r){return e instanceof Function?e(r):"object"==typeof e&&null!==e?Object.fromEntries(Object.entries(e).map((function(e){return[e[0],t(e[1],r)]}))):e}(t,e)}));return Pv.all(r)}var Dv=function(){function t(t){this.textures=new Map,this.renderer=t}return t.prototype.get=function(t,e){var r=this.textures.get(t);if(!r){var n=e(),i=n.getLocalBounds(void 0,!0),o=new je(Math.floor(i.x),Math.floor(i.y),Math.ceil(i.width),Math.ceil(i.height));r=this.renderer.generateTexture(n,l.LINEAR,4*this.renderer.resolution,o),this.textures.set(t,r)}return r},t.prototype.delete=function(t){var e=this.textures.get(t);e&&(e.destroy(),this.textures.delete(t))},t.prototype.clear=function(){var t=this;Array.from(this.textures.keys()).forEach((function(e){t.delete(e)}))},t.prototype.destroy=function(){this.clear()},t}();
/*!
     * @pixi/mixin-get-child-by-name - v6.1.2
     * Compiled Thu, 12 Aug 2021 17:11:19 UTC
     *
     * @pixi/mixin-get-child-by-name is licensed under the MIT License.
     * http://www.opensource.org/licenses/mit-license
     */wi.prototype.name=null,Oi.prototype.getChildByName=function(t,e){for(var r=0,n=this.children.length;r<n;r++)if(this.children[r].name===t)return this.children[r];if(e)for(r=0,n=this.children.length;r<n;r++){if(this.children[r].getChildByName){var i=this.children[r].getChildByName(t,!0);if(i)return i}}return null};var Uv={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Bv={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function Fv(t){var e,r,n=[],i=1;if("string"==typeof t)if(Uv[t])n=Uv[t].slice(),r="rgb";else if("transparent"===t)i=0,r="rgb",n=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(t)){var o=t.slice(1);i=1,(h=o.length)<=4?(n=[parseInt(o[0]+o[0],16),parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16)],4===h&&(i=parseInt(o[3]+o[3],16)/255)):(n=[parseInt(o[0]+o[1],16),parseInt(o[2]+o[3],16),parseInt(o[4]+o[5],16)],8===h&&(i=parseInt(o[6]+o[7],16)/255)),n[0]||(n[0]=0),n[1]||(n[1]=0),n[2]||(n[2]=0),r="rgb"}else if(e=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(t)){var s=e[1],a="rgb"===s;r=o=s.replace(/a$/,"");var h="cmyk"===o?4:"gray"===o?1:3;n=e[2].trim().split(/\s*[,\/]\s*|\s+/).map((function(t,e){if(/%$/.test(t))return e===h?parseFloat(t)/100:"rgb"===o?255*parseFloat(t)/100:parseFloat(t);if("h"===o[e]){if(/deg$/.test(t))return parseFloat(t);if(void 0!==Bv[t])return Bv[t]}return parseFloat(t)})),s===o&&n.push(1),i=a||void 0===n[h]?1:n[h],n=n.slice(0,h)}else t.length>10&&/[0-9](?:\s|\/)/.test(t)&&(n=t.match(/([0-9]+)/g).map((function(t){return parseFloat(t)})),r=t.match(/([a-z])/gi).join("").toLowerCase());else isNaN(t)?Array.isArray(t)||t.length?(n=[t[0],t[1],t[2]],r="rgb",i=4===t.length?t[3]:1):t instanceof Object&&(null!=t.r||null!=t.red||null!=t.R?(r="rgb",n=[t.r||t.red||t.R||0,t.g||t.green||t.G||0,t.b||t.blue||t.B||0]):(r="hsl",n=[t.h||t.hue||t.H||0,t.s||t.saturation||t.S||0,t.l||t.lightness||t.L||t.b||t.brightness]),i=t.a||t.alpha||t.opacity||1,null!=t.opacity&&(i/=100)):(r="rgb",n=[t>>>16,(65280&t)>>>8,255&t]);return{space:r,values:n,alpha:i}}var kv=function(t){var e,r,n,i,o,s=t[0]/360,a=t[1]/100,h=t[2]/100;if(0===a)return[o=255*h,o,o];e=2*h-(r=h<.5?h*(1+a):h+a-h*a),i=[0,0,0];for(var u=0;u<3;u++)(n=s+1/3*-(u-1))<0?n++:n>1&&n--,o=6*n<1?e+6*(r-e)*n:2*n<1?r:3*n<2?e+(r-e)*(2/3-n)*6:e,i[u]=255*o;return i};function Gv(t){var e,r=function(t){var e;Array.isArray(t)&&t.raw&&(t=String.raw(...arguments));var r=Fv(t);return r.space?((e=Array(3))[0]=Math.min(Math.max(r.values[0],0),255),e[1]=Math.min(Math.max(r.values[1],0),255),e[2]=Math.min(Math.max(r.values[2],0),255),"h"===r.space[0]&&(e=kv(e)),e.push(Math.min(Math.max(r.alpha,0),1)),e):[]}(t);if(!r)throw new Error("Invalid color "+t);return[(255*(e=[r[0]/255,r[1]/255,r[2]/255])[0]<<16)+(255*e[1]<<8)+(255*e[2]|0),r[3]]}var jv=16777215,Hv="NODE_CIRCLE",Xv="NODE_CIRCLE_BORDER",zv="NODE_ICON";var Vv="NODE_LABEL_TEXT";var Wv=function(t){function e(){var e=t.call(this)||this;return e.hovered=!1,e.selected=!1,e.nodeGfx=e.createNode(),e.nodeLabelGfx=e.createNodeLabel(),e.nodePlaceholderGfx=new Oi,e.nodeLabelPlaceholderGfx=new Oi,e}return Co(e,t),e.prototype.createNode=function(){var t=this,e=new Oi;return e.interactive=!0,e.buttonMode=!0,e.on("mousemove",(function(e){return t.emit("mousemove",e.data.originalEvent)})),e.on("mouseover",(function(e){return t.emit("mouseover",e.data.originalEvent)})),e.on("mouseout",(function(e){return t.emit("mouseout",e.data.originalEvent)})),e.on("mousedown",(function(e){return t.emit("mousedown",e.data.originalEvent)})),e.on("mouseup",(function(e){return t.emit("mouseup",e.data.originalEvent)})),e.on("rightdown",(function(e){return t.emit("rightdown",e.data.originalEvent)})),e.on("rightup",(function(e){return t.emit("rightup",e.data.originalEvent)})),function(t){t.hitArea=new He(0,0);var e=new Mi;e.name=Hv,e.anchor.set(.5),t.addChild(e);var r=new Mi;r.name=Xv,r.anchor.set(.5),t.addChild(r);var n=new Mi;n.name=zv,n.anchor.set(.5),t.addChild(n)}(e),e},e.prototype.createNodeLabel=function(){var t=new Oi;return function(t){var e=new Mi;e.name=Vv,e.anchor.set(.5),t.addChild(e)}(t),t},e.prototype.updatePosition=function(t){this.nodeGfx.position.copyFrom(t),this.nodeLabelGfx.position.copyFrom(t)},e.prototype.updateStyle=function(t,e){!function(t,e,r){var n,i,o=e.size+e.border.width,s=[Hv,e.size].join("::"),a=r.get(s,(function(){var t=new uh;return t.beginFill(jv,1,!0),t.drawCircle(e.size,e.size,e.size),t})),h=[Xv,e.size,e.border.width].join("::"),u=r.get(h,(function(){var t=new uh;return t.lineStyle(e.border.width,jv),t.drawCircle(o,o,e.size),t}));t.hitArea.radius=o;var l=t.getChildByName(Hv);l.texture=a,n=Gv(e.color),l.tint=n[0],l.alpha=n[1];var c=t.getChildByName(Xv);if(c.texture=u,i=Gv(e.border.color),c.tint=i[0],c.alpha=i[1],e.icon.url&&e.icon.width&&e.icon.height){var d=t.getChildByName(zv);d.texture=Ir.from(e.icon.url),d.width=e.icon.width,d.height=e.icon.height,t.addChild(d)}}(this.nodeGfx,t,e),function(t,e,r){var n,i=[Vv,e.label.fontFamily,e.label.fontSize,e.label.content].join("::"),o=r.get(i,(function(){return Mo(e.label.type,e.label.content,{fontFamily:e.label.fontFamily,fontSize:e.label.fontSize})})),s=t.getChildByName(Vv);s.texture=o,s.y=e.size+(o.height+2*e.label.padding)/2,n=Gv(e.label.color),s.tint=n[0],s.alpha=n[1]}(this.nodeLabelGfx,t,e)},e.prototype.updateVisibility=function(t){!function(t,e){t.getChildByName(Xv).visible=e>=1;var r=t.getChildByName(zv);r&&(r.visible=e>=2)}(this.nodeGfx,t),function(t,e){t.getChildByName(Vv).visible=e>=3}(this.nodeLabelGfx,t)},e}(qs);function Yv(t,e,r,n,i,o,s,a,h){return{x:Math.pow(1-t,3)*e+3*t*Math.pow(1-t,2)*n+3*t*t*(1-t)*o+t*t*t*a,y:Math.pow(1-t,3)*r+3*t*Math.pow(1-t,2)*i+3*t*t*(1-t)*s+t*t*t*h}}function qv(t,e,r,n,i,o,s){return{x:Math.pow(1-t,2)*e+2*(1-t)*t*n+t*t*o,y:Math.pow(1-t,2)*r+2*(1-t)*t*i+t*t*s}}function Kv(t,e,r,n,i,o){var s=e/180*Math.PI;return{sx:r+t*Math.cos(s),sy:n+t*Math.sin(s),ex:i+t*Math.cos(s)*-1,ey:o+t*Math.sin(s)}}function Zv(t,e,r,n){var i=(270+5*(e-1))/180*Math.PI,o=(180-5*(e-1))/180*Math.PI,s=r+t*Math.cos(i),a=n+t*Math.sin(i),h=r+t*Math.cos(o),u=n+t*Math.sin(o),l=50*e*(e/3+1);return{sx:s,sy:a,cp1x:r+(t+l)*Math.cos(i),cp1y:n+(t+l)*Math.sin(i),cp2x:r+(t+l)*Math.cos(o),cp2y:n+(t+l)*Math.sin(o),ex:h,ey:u}}Ks.minSegments=64;var Jv="EDGE_LINE",Qv="EDGE_ARROW",$v="EDGE_CURVE",ty="EDGE_CURVE_ARROW";function ey(t,e,r,n,i,o,s,a,h,u){var l,c=n.size,d=Gv(i.color),f=d[0],p=d[1],m=Math.hypot(r.x-e.x,r.y-e.y),g=t.getChildByName(Jv),v=t.getChildByName(Qv),y=t.getChildByName($v),b=t.getChildByName(ty);if(g.visible=!1,v.visible=!1,y.visible=!1,b.visible=!1,a){y.visible=!0,b.visible=!0;var _=Zv(c,u,0,0),E=_.sx,x=_.sy,T=_.cp1x,w=_.cp1y,A=_.cp2x,S=_.cp2y,O=_.ex,I=_.ey;y.clear(),y.lineStyle({width:i.width,color:f,alpha:p}),y.moveTo(E,x),y.bezierCurveTo(T,w,A,S,O,I),ny(y,i.width),b.clear();var R=Yv(1,E,x,T,w,A,S,O,I),N=function(t,e,r,n,i,o,s,a,h){var u=Math.pow(1-t,2)*(n-e)+2*t*(1-t)*(o-n)+t*t*(a-o),l=Math.pow(1-t,2)*(i-r)+2*t*(1-t)*(s-i)+t*t*(h-s);return-Math.atan2(u,l)+.5*Math.PI}(1,E,x,T,w,A,S,O,I);return b.x=R.x,b.y=R.y,b.rotation=N,b.beginFill(f,p,!0),b.moveTo(-10,-5),b.lineTo(0,0),b.lineTo(-10,5),b.lineTo(-10,-5),b.closePath(),void b.endFill()}if(ry(a,h,u)){if(g.visible=!0,v.visible=!0,g.width=m,s){var L=[Qv].join("::"),M=o.get(L,(function(){var t=new uh;return t.beginFill(16777215,1,!0),t.moveTo(-10,-5),t.lineTo(0,0),t.lineTo(-10,5),t.lineTo(-10,-5),t.closePath(),t.endFill(),t}));v.x=m/2-c-10+.5,v.texture=M,l=Gv(i.color),v.tint=l[0],v.alpha=l[1]}}else{y.visible=!0,b.visible=!0;var P=u%2==0?1:-1,C=Math.ceil(u/2),D=Kv(c,5*C*P,-m/2,0,m/2,0),U=(E=D.sx,x=D.sy,O=D.ex,I=D.ey,.25*m*C*P);y.clear(),y.lineStyle({width:1,color:f,alpha:p}),y.moveTo(E,x),y.quadraticCurveTo(0,U,O,I),ny(y,i.width),b.clear();R=qv(1,E,x,0,U,O,I),N=function(t,e,r,n,i,o,s){var a=2*(1-t)*(n-e)+2*t*(o-n),h=2*(1-t)*(i-r)+2*t*(s-i);return-Math.atan2(a,h)+.5*Math.PI}(1,E,x,0,U,O,I);b.x=R.x,b.y=R.y,b.rotation=N,b.beginFill(f,p,!0),b.moveTo(-10,-5),b.lineTo(0,0),b.lineTo(-10,5),b.lineTo(-10,-5),b.closePath(),b.endFill()}}function ry(t,e,r){return!t&&(e<=1||e%2==1&&r===e)}function ny(t,e){var r=function(t,e){for(var r=e.length/2,n=new Array(2*e.length),i=0;i<r;i++){var o=2*i,s=e[o],a=e[o+1],h=void 0!==e[o-2]?e[o-2]:s,u=void 0!==e[o-1]?e[o-1]:a,l=void 0!==e[o+2]?e[o+2]:s,c=void 0!==e[o+3]?e[o+3]:a,d=Math.atan2(-l+h,c-u),f=t*Math.cos(d),p=t*Math.sin(d);n[o]=s+f,n[o+1]=a+p,n[n.length-1-o-1]=s-f,n[n.length-1-o]=a-p}return n.push(n[0],n[1]),n}(e,t.currentPath.points),n=new ze(r);t.hitArea=n}var iy="EDGE_LABEL_TEXT";var oy=function(t){function e(){var e=t.call(this)||this;return e.hovered=!1,e.selected=!1,e.edgeGfx=e.createEdge(),e.edgePlaceholderGfx=new Oi,e.edgeLabelGfx=e.createEdgeLabel(),e.edgeLabelPlaceholderGfx=new Oi,e}return Co(e,t),e.prototype.createEdge=function(){var t=this,e=new Oi;return e.interactive=!0,e.buttonMode=!0,e.on("mousemove",(function(e){return t.emit("mousemove",e.data.originalEvent)})),e.on("mouseover",(function(e){return t.emit("mouseover",e.data.originalEvent)})),e.on("mouseout",(function(e){return t.emit("mouseout",e.data.originalEvent)})),e.on("mousedown",(function(e){return t.emit("mousedown",e.data.originalEvent)})),e.on("mouseup",(function(e){return t.emit("mouseup",e.data.originalEvent)})),function(t){var e=new Mi(Ir.WHITE);e.name=Jv,e.anchor.set(.5),t.addChild(e);var r=new Mi;r.name=Qv,r.anchor.set(0,.5),t.addChild(r);var n=new uh;n.name=$v,t.addChild(n);var i=new uh;i.name=ty,t.addChild(i)}(e),e},e.prototype.createEdgeLabel=function(){var t=new Oi;return function(t){var e=new Mi;e.name=iy,e.anchor.set(.5),t.addChild(e)}(t),t},e.prototype.updatePosition=function(t,e,r,n,i,o,s,a,h){var u={x:(t.x+e.x)/2,y:(t.y+e.y)/2},l=Math.atan2(e.y-t.y,e.x-t.x);this.edgeGfx.position.copyFrom(u),this.edgeGfx.rotation=l;var c=void 0;if(s){var d=Zv(r.size,h,t.x,t.y),f=d.sx,p=d.sy,m=d.cp1x,g=d.cp1y,v=d.cp2x,y=d.cp2y,b=d.ex,_=d.ey,E={x:(f+b)/2,y:(p+_)/2},x=Math.atan2(_-p,b-f);this.edgeLabelGfx.position.copyFrom(E),this.edgeLabelGfx.rotation=x,t={x:-length/2,y:0},e={x:length/2,y:0};var T=Yv(.5,f,p,m,g,v,y,b,_);c=Math.hypot(T.x-E.x,T.y-E.y)}else this.edgeLabelGfx.position.copyFrom(u),this.edgeLabelGfx.rotation=l;ey(this.edgeGfx,t,e,r,n,i,o,s,a,h),function(t,e,r,n,i,o,s,a,h,u,l){var c,d=n.size,f=Math.hypot(r.x-e.x,r.y-e.y),p=t.rotation>=-Math.PI/2&&t.rotation<=Math.PI/2?1:-1,m=t.getChildByName(iy),g=[iy,i.label.fontFamily,i.label.fontSize,i.label.content].join("::"),v=o.get(g,(function(){return Mo(i.label.type,i.label.content,{fontFamily:i.label.fontFamily,fontSize:i.label.fontSize})}));m.texture=v,m.rotation=p>0?0:Math.PI;var y=0;if(a)y=l+-(v.height+2*i.label.padding)/2*p;else if(h<=1||h%2==1&&u===h)y=-(v.height+2*i.label.padding)/2*p;else{var b=u%2==0?1:-1,_=Math.ceil(u/2),E=.25*f*_*b,x=Kv(d,5*_*b,-f/2,0,f/2,0);y=qv(.5,x.sx,x.sy,0,E,x.ex,x.ey).y+-(v.height+2*i.label.padding)/2*p}m.y=y,c=Gv(i.label.color),m.tint=c[0],m.alpha=c[1]}(this.edgeLabelGfx,t,e,r,n,i,0,s,a,h,c)},e.prototype.updateStyle=function(t,e,r,n,i,o){!function(t,e,r,n,i,o,s){var a;if(ry(i,o,s)){var h=t.getChildByName(Jv);h.height=e.width,a=Gv(e.color),h.tint=a[0],h.alpha=a[1]}else{var u=Gv(e.color),l=u[0],c=u[1];t.getChildByName($v).lineStyle({width:e.width,color:l,alpha:c})}}(this.edgeGfx,t,0,0,n,i,o)},e.prototype.updateVisibility=function(t,e,r,n){!function(t,e,r,n,i){var o=t.getChildByName(Jv),s=t.getChildByName(Qv),a=t.getChildByName($v),h=t.getChildByName(ty);ry(r,n,i)?(o.visible=e>=2,s.visible=e>=3,a.visible=!1,h.visible=!1):(a.visible=e>=2,h.visible=e>=3,o.visible=!1,s.visible=!1)}(this.edgeGfx,t,e,r,n),function(t,e){t.getChildByName(iy).visible=e>=3}(this.edgeLabelGfx,t)},e}(qs);Uo.registerPlugin(Be),Uo.registerPlugin(mo),po.registerPlugin(Lo),si.registerPlugin("batch",mi),si.registerPlugin("interaction",Vo);var sy={node:{size:15,color:"#000000",border:{width:2,color:"#ffffff"},icon:{},label:{type:t.TextType.TEXT,fontSize:12,content:"",color:"#333333",padding:4}},edge:{width:1,color:"#cccccc"}},ay=function(t){function e(e){var r=t.call(this)||this;if(r.iterationNum=0,r.iterations=0,r.nodeKeyToNodeObject=new Map,r.edgeKeyToEdgeObject=new Map,r.selectNodeKeys=new Set,r.parallelEdgeMap=new Map,r.mousedownNodeKey=null,r.mousedownEdgeKey=null,r.mouseDownPosition=null,r.onGraphNodeAddedBound=r.onGraphNodeAdded.bind(r),r.onGraphEdgeAddedBound=r.onGraphEdgeAdded.bind(r),r.onGraphNodeDroppedBound=r.onGraphNodeDropped.bind(r),r.onGraphEdgeDroppedBound=r.onGraphEdgeDropped.bind(r),r.onGraphClearedBound=r.onGraphCleared.bind(r),r.onGraphEdgesClearedBound=r.onGraphEdgesCleared.bind(r),r.onGraphNodeAttributesUpdatedBound=r.onGraphNodeAttributesUpdated.bind(r),r.onGraphEdgeAttributesUpdatedBound=r.onGraphEdgeAttributesUpdated.bind(r),r.onGraphEachNodeAttributesUpdatedBound=r.onGraphEachNodeAttributesUpdated.bind(r),r.onGraphEachEdgeAttributesUpdatedBound=r.onGraphEachEdgeAttributesUpdated.bind(r),r.onDocumentMouseMoveBound=r.onDocumentMouseMove.bind(r),r.onDocumentMouseUpBound=r.onDocumentMouseUp.bind(r),r.container=e.container,r.graph=e.graph,r.layoutConfig=e.layout,r.style=e.style,r.hoverStyle=e.hoverStyle,r.selectStyle=e.selectStyle,r.resources=e.resources,r.createLayout(),r.doLayout(),!(r.container instanceof HTMLElement))throw new Error("container should be a HTMLElement");return rh.LINE_SCALE_MODE=va.NORMAL,r.app=new Uo({resizeTo:r.container,resolution:window.devicePixelRatio,transparent:!0,antialias:!0,autoDensity:!0}),r.container.appendChild(r.app.view),r.app.renderer.plugins.interaction.moveWhenInside=!0,r.app.view.addEventListener("wheel",(function(t){t.preventDefault()})),r.textureCache=new Dv(r.app.renderer),r.viewport=new Ss({screenWidth:r.container.clientWidth,screenHeight:r.container.clientHeight,interaction:r.app.renderer.plugins.interaction}).drag().pinch().wheel().decelerate().clampZoom({maxScale:5}),r.app.stage.addChild(r.viewport),r.viewport.on("mousedown",(function(t){if(t.target===r.viewport){var e=t.data.originalEvent;r.mouseDownPosition={x:e.clientX,y:e.clientY}}})),r.viewport.on("mouseup",(function(t){if(t.target===r.viewport&&r.mouseDownPosition){var e=t.data.originalEvent;Math.sqrt(Math.abs(e.clientX-r.mouseDownPosition.x))+Math.sqrt(Math.abs(e.clientY-r.mouseDownPosition.y))<=2&&(r.selectNodeKeys.forEach((function(t){r.unselectNode(t)})),r.selectNodeKeys.clear()),r.mouseDownPosition=null}})),r.viewport.on("rightup",(function(t){if(t.target===r.viewport){var e=t.data.originalEvent;r.emit("rightClick",e)}})),r.edgeLayer=new Oi,r.edgeLabelLayer=new Oi,r.frontEdgeLayer=new Oi,r.frontEdgeLabelLayer=new Oi,r.nodeLayer=new Oi,r.nodeLabelLayer=new Oi,r.frontNodeLayer=new Oi,r.frontNodeLabelLayer=new Oi,r.viewport.addChild(r.edgeLayer),r.viewport.addChild(r.edgeLabelLayer),r.viewport.addChild(r.frontEdgeLayer),r.viewport.addChild(r.frontEdgeLabelLayer),r.viewport.addChild(r.nodeLayer),r.viewport.addChild(r.nodeLabelLayer),r.viewport.addChild(r.frontNodeLayer),r.viewport.addChild(r.frontNodeLabelLayer),r.resizeObserver=new ResizeObserver((function(){r.app.resize(),r.viewport.resize(r.container.clientWidth,r.container.clientHeight),r.updateGraphVisibility()})),r.resources&&r.app.loader.add(r.resources),r.app.loader.load((function(){r.viewport.on("frame-end",(function(){r.viewport.dirty&&(r.updateGraphVisibility(),r.viewport.dirty=!1)})),r.resizeObserver.observe(r.container),r.calculateParallelEdge(),r.graph.on("nodeAdded",r.onGraphNodeAddedBound),r.graph.on("edgeAdded",r.onGraphEdgeAddedBound),r.graph.on("nodeDropped",r.onGraphNodeDroppedBound),r.graph.on("edgeDropped",r.onGraphEdgeDroppedBound),r.graph.on("cleared",r.onGraphClearedBound),r.graph.on("edgesCleared",r.onGraphEdgesClearedBound),r.graph.on("nodeAttributesUpdated",r.onGraphNodeAttributesUpdatedBound),r.graph.on("edgeAttributesUpdated",r.onGraphEdgeAttributesUpdatedBound),r.graph.on("eachNodeAttributesUpdated",r.onGraphEachNodeAttributesUpdatedBound),r.graph.on("eachEdgeAttributesUpdated",r.onGraphEachEdgeAttributesUpdatedBound),r.createGraph(),r.resetView()})),r}return Co(e,t),e.prototype.destroy=function(){this.graph.off("nodeAdded",this.onGraphNodeAddedBound),this.graph.off("edgeAdded",this.onGraphEdgeAddedBound),this.graph.off("nodeDropped",this.onGraphNodeDroppedBound),this.graph.off("edgeDropped",this.onGraphEdgeDroppedBound),this.graph.off("cleared",this.onGraphClearedBound),this.graph.off("edgesCleared",this.onGraphEdgesClearedBound),this.graph.off("nodeAttributesUpdated",this.onGraphNodeAttributesUpdatedBound),this.graph.off("edgeAttributesUpdated",this.onGraphEdgeAttributesUpdatedBound),this.graph.off("eachNodeAttributesUpdated",this.onGraphEachNodeAttributesUpdatedBound),this.graph.off("eachEdgeAttributesUpdated",this.onGraphEachEdgeAttributesUpdatedBound),this.resizeObserver.disconnect(),this.resizeObserver=void 0,this.textureCache.destroy(),this.textureCache=void 0,this.app.destroy(!0,{children:!0,texture:!0,baseTexture:!0}),this.app=void 0},e.prototype.createLayout=function(){switch(this.layoutConfig.type){case"circular":this.layout=new Th(this.layoutConfig);break;case"concentric":this.layout=new Og(this.layoutConfig);break;case"grid":this.layout=new Eh(this.layoutConfig);break;case"dagre":this.layout=new _c(this.layoutConfig);break;case"forceatlas2":this.forceAtlas2Layout=new wv(this.layoutConfig);break;default:throw new Error("unsupported layout: "+this.layoutConfig.type)}},e.prototype.updateLayout=function(t){var e=this.layoutConfig;this.layoutConfig=t,this.layoutConfig.type!==e.type&&this.createLayout(),this.doLayout()},e.prototype.isForceLayout=function(){return"forceatlas2"===this.layoutConfig.type},e.prototype.doForceLayout=function(){console.time(this.layoutConfig.type),"forceatlas2"===this.layoutConfig.type&&(this.iterationNum=0,this.forceAtlas2Layout.runLayout(this.graph,!0))},e.prototype.doLayout=function(){if(this.isForceLayout())this.doForceLayout();else{console.time(this.layoutConfig.type);var t=[],e=[];this.graph.forEachNode((function(e){return t.push({id:e})})),this.graph.forEachEdge((function(t,r,n,i){e.push({source:n,target:i})}));var r=this.layout.layout({nodes:t,edges:e}).nodes,n=0;this.graph.updateEachNodeAttributes((function(t,e){return e.x=r[n].x,e.y=r[n].y,n++,e}));for(var i=0,o=r;i<o.length;i++){var s=o[i];this.graph.setNodeAttribute(s.id,"x",s.x),this.graph.setNodeAttribute(s.id,"y",s.y)}console.timeEnd(this.layoutConfig.type)}},Object.defineProperty(e.prototype,"zoomStep",{get:function(){return Math.min(this.viewport.worldWidth,this.viewport.worldHeight)/10},enumerable:!1,configurable:!0}),e.prototype.zoomIn=function(){this.viewport.zoom(-this.zoomStep,!0)},e.prototype.zoomOut=function(){this.viewport.zoom(this.zoomStep,!0)},e.prototype.resetView=function(){var t=this,e=this.graph.nodes().map((function(e){return t.graph.getNodeAttribute(e,"x")})),r=this.graph.nodes().map((function(e){return t.graph.getNodeAttribute(e,"y")})),n=Math.min.apply(Math,e),i=Math.max.apply(Math,e),o=Math.min.apply(Math,r),s=Math.max.apply(Math,r),a=Math.abs(i-n),h=Math.abs(s-o),u=new We(n+a/2,o+h/2),l=a+200,c=h+200;this.viewport.resize(this.container.clientWidth,this.container.clientHeight,l,c),this.viewport.setZoom(1),this.viewport.center=u,this.viewport.fit(!0)},e.prototype.calculateParallelEdge=function(){var t=this,e=new Map;this.graph.forEachEdge((function(r,n,i,o){var s=i+"_"+o,a=(e.get(s)||0)+1;e.set(s,a),t.graph.setEdgeAttribute(r,"parallelSeq",a)})),this.parallelEdgeMap=e},e.prototype.onGraphNodeAdded=function(t){this.calculateParallelEdge();var e=t.key,r=t.attributes;this.createNode(e,r)},e.prototype.onGraphEdgeAdded=function(t){this.calculateParallelEdge();var e=t.key,r=t.attributes,n=t.source,i=t.target,o=this.graph.getNodeAttributes(n),s=this.graph.getNodeAttributes(i);this.createEdge(e,r,n,i,o,s)},e.prototype.onGraphNodeDropped=function(t){this.calculateParallelEdge();var e=t.key;this.dropNode(e)},e.prototype.onGraphEdgeDropped=function(t){this.calculateParallelEdge();var e=t.key;this.dropEdge(e)},e.prototype.onGraphCleared=function(){Array.from(this.edgeKeyToEdgeObject.keys()).forEach(this.dropEdge.bind(this)),Array.from(this.nodeKeyToNodeObject.keys()).forEach(this.dropNode.bind(this))},e.prototype.onGraphEdgesCleared=function(){Array.from(this.edgeKeyToEdgeObject.keys()).forEach(this.dropEdge.bind(this))},e.prototype.onGraphNodeAttributesUpdated=function(t){var e=t.key;this.updateNodeStyleByKey(e)},e.prototype.onGraphEdgeAttributesUpdated=function(t){var e=t.key;this.updateEdgeStyleByKey(e)},e.prototype.onGraphEachNodeAttributesUpdated=function(){var t=this;"forceatlas2"===this.layoutConfig.type&&(this.iterationNum++,1===this.iterationNum&&this.resetView(),this.iterationNum>=this.layoutConfig.iterations&&(this.forceAtlas2Layout.stopLayout(),console.timeEnd(this.layoutConfig.type))),this.graph.forEachNode((function(e,r){t.nodeKeyToNodeObject.get(e).updatePosition({x:r.x,y:r.y})})),this.graph.forEachNode(this.updateNodeStyle.bind(this)),this.graph.forEachEdge(this.updateEdgeStyle.bind(this))},e.prototype.onGraphEachEdgeAttributesUpdated=function(){this.graph.forEachEdge(this.updateEdgeStyle.bind(this))},e.prototype.setNodeStatus=function(t,e){var r=this.nodeKeyToNodeObject.get(t);if("hovered"!==e||r.selected){if("selected"===e){if(r.selected)return;r.selected=!0}}else{if(r.hovered)return;r.hovered=!0}this.updateNodeStyleByKey(t);var n=this.nodeLayer.children.indexOf(r.nodeGfx);n>=0&&(this.nodeLayer.removeChildAt(n),this.nodeLabelLayer.removeChildAt(n),this.frontNodeLayer.removeChildAt(n),this.frontNodeLabelLayer.removeChildAt(n),this.nodeLayer.addChild(r.nodePlaceholderGfx),this.nodeLabelLayer.addChild(r.nodeLabelPlaceholderGfx),this.frontNodeLayer.addChild(r.nodeGfx),this.frontNodeLabelLayer.addChild(r.nodeLabelGfx))},e.prototype.unsetNodeStatus=function(t,e){var r=this.nodeKeyToNodeObject.get(t);if("hovered"!==e||r.selected){if("selected"===e){if(!r.selected)return;r.selected=!1,r.hovered=!1}}else{if(!r.hovered)return;r.hovered=!1}if(this.updateNodeStyleByKey(t),!r.selected&&!r.hovered){var n=this.frontNodeLayer.getChildIndex(r.nodeGfx);this.nodeLayer.removeChildAt(n),this.nodeLabelLayer.removeChildAt(n),this.frontNodeLayer.removeChildAt(n),this.frontNodeLabelLayer.removeChildAt(n),this.nodeLayer.addChild(r.nodeGfx),this.nodeLabelLayer.addChild(r.nodeLabelGfx),this.frontNodeLayer.addChild(r.nodePlaceholderGfx),this.frontNodeLabelLayer.addChild(r.nodeLabelPlaceholderGfx)}},e.prototype.selectNode=function(t){this.setNodeStatus(t,"selected")},e.prototype.unselectNode=function(t){this.unsetNodeStatus(t,"selected")},e.prototype.hoverNode=function(t){this.setNodeStatus(t,"hovered")},e.prototype.unhoverNode=function(t){this.unsetNodeStatus(t,"hovered")},e.prototype.hoverEdge=function(t){var e=this.edgeKeyToEdgeObject.get(t);if(!e.hovered){e.hovered=!0,this.updateEdgeStyleByKey(t);var r=this.edgeLayer.getChildIndex(e.edgeGfx);r>=0&&(this.edgeLayer.removeChildAt(r),this.edgeLabelLayer.removeChildAt(r),this.frontEdgeLayer.removeChildAt(r),this.frontEdgeLabelLayer.removeChildAt(r),this.edgeLayer.addChild(e.edgePlaceholderGfx),this.edgeLabelLayer.addChild(e.edgeLabelPlaceholderGfx),this.frontEdgeLayer.addChild(e.edgeGfx),this.frontEdgeLabelLayer.addChild(e.edgeLabelGfx))}},e.prototype.unhoverEdge=function(t){var e=this.edgeKeyToEdgeObject.get(t);if(e.hovered){e.hovered=!1,this.updateEdgeStyleByKey(t);var r=this.frontEdgeLayer.getChildIndex(e.edgeGfx);r>=0&&(this.edgeLayer.removeChildAt(r),this.edgeLabelLayer.removeChildAt(r),this.frontEdgeLayer.removeChildAt(r),this.frontEdgeLabelLayer.removeChildAt(r),this.edgeLayer.addChild(e.edgeGfx),this.edgeLabelLayer.addChild(e.edgeLabelGfx),this.frontEdgeLayer.addChild(e.edgePlaceholderGfx),this.frontEdgeLabelLayer.addChild(e.edgeLabelPlaceholderGfx))}},e.prototype.moveNode=function(t,e){this.graph.setNodeAttribute(t,"x",e.x),this.graph.setNodeAttribute(t,"y",e.y);var r=this.nodeKeyToNodeObject.get(t),n={x:e.x,y:e.y};r.updatePosition(n),this.updateNodeStyleByKey(t),this.graph.edges(t).forEach(this.updateEdgeStyleByKey.bind(this))},e.prototype.moveNodebyDelta=function(t,e,r){var n=this.graph.getNodeAttribute(t,"x"),i=this.graph.getNodeAttribute(t,"y");this.graph.setNodeAttribute(t,"x",n+e),this.graph.setNodeAttribute(t,"y",i+r);var o={x:n+e,y:i+r};this.nodeKeyToNodeObject.get(t).updatePosition(o),this.updateNodeStyleByKey(t),this.graph.edges(t).forEach(this.updateEdgeStyleByKey.bind(this))},e.prototype.enableNodeDragging=function(){this.viewport.pause=!0,document.addEventListener("mousemove",this.onDocumentMouseMoveBound),document.addEventListener("mouseup",this.onDocumentMouseUpBound,{once:!0})},e.prototype.onDocumentMouseMove=function(t){var e=this,r=new We(t.offsetX,t.offsetY),n=this.viewport.toWorld(r);if(this.mousedownNodeKey)if(this.selectNodeKeys.has(this.mousedownNodeKey)){var i=this.graph.getNodeAttribute(this.mousedownNodeKey,"x"),o=this.graph.getNodeAttribute(this.mousedownNodeKey,"y"),s=n.x-i,a=n.y-o;this.selectNodeKeys.forEach((function(t){return e.moveNodebyDelta(t,s,a)}))}else this.moveNode(this.mousedownNodeKey,n)},e.prototype.onDocumentMouseUp=function(){this.viewport.pause=!1,document.removeEventListener("mousemove",this.onDocumentMouseMoveBound),this.mousedownNodeKey=null,this.mousedownEdgeKey=null},e.prototype.createGraph=function(){this.graph.forEachNode(this.createNode.bind(this)),this.graph.forEachEdge(this.createEdge.bind(this))},e.prototype.createNode=function(t,e){var r=this,n=new Wv;n.on("mousemove",(function(e){r.emit("nodeMousemove",e,t)})),n.on("mouseover",(function(e){r.mousedownNodeKey||r.hoverNode(t),r.emit("nodeMouseover",e,t,n.nodeGfx.getBounds())})),n.on("mouseout",(function(e){r.mousedownNodeKey||r.unhoverNode(t),r.emit("nodeMouseout",e,t)})),n.on("mousedown",(function(e){r.mousedownNodeKey=t,r.enableNodeDragging(),r.emit("nodeMousedown",e,t),r.mouseDownPosition={x:e.clientX,y:e.clientY}})),n.on("rightdown",(function(e){r.mousedownNodeKey=t})),n.on("rightup",(function(e){r.mousedownNodeKey===t&&r.emit("nodeRightClick",e,t),r.mousedownNodeKey=null}));var i=0;n.on("mouseup",(function(e){if((r.emit("nodeMouseup",e,t),r.mousedownNodeKey===t&&r.mouseDownPosition)&&Math.sqrt(Math.abs(e.clientX-r.mouseDownPosition.x))+Math.sqrt(Math.abs(e.clientY-r.mouseDownPosition.y))<=2){if(e.metaKey||e.ctrlKey||e.shiftKey?(r.selectNodeKeys.add(t),r.selectNode(t)):(r.selectNodeKeys.forEach((function(t){r.unselectNode(t)})),r.selectNodeKeys.clear(),r.selectNodeKeys.add(t),r.selectNode(t)),r.emit("nodeClick",e,t),e.shiftKey||e.ctrlKey||e.metaKey)return;var n=e.timeStamp,o=n-i;if(i=n,o<350)return void r.emit("nodeDoubleClick",e,t)}r.mousedownNodeKey=null})),this.nodeLayer.addChild(n.nodeGfx),this.nodeLabelLayer.addChild(n.nodeLabelGfx),this.frontNodeLayer.addChild(n.nodePlaceholderGfx),this.frontNodeLabelLayer.addChild(n.nodeLabelPlaceholderGfx),this.nodeKeyToNodeObject.set(t,n);var o={x:e.x,y:e.y};n.updatePosition(o),this.updateNodeStyle(t,e)},e.prototype.createEdge=function(t,e,r,n,i,o){var s=this,a=new oy;a.on("mousemove",(function(e){s.emit("edgeMousemove",e,t)})),a.on("mouseover",(function(e){s.hoverEdge(t),s.emit("edgeMouseover",e,t)})),a.on("mouseout",(function(e){s.unhoverEdge(t),s.emit("edgeMouseout",e,t)})),a.on("mousedown",(function(e){s.mousedownEdgeKey=t,s.emit("edgeMousedown",e,t)})),a.on("mouseup",(function(e){s.emit("edgeMouseup",e,t),s.mousedownEdgeKey===t&&s.emit("edgeClick",e,t)})),this.edgeLayer.addChild(a.edgeGfx),this.edgeLabelLayer.addChild(a.edgeLabelGfx),this.frontEdgeLayer.addChild(a.edgePlaceholderGfx),this.frontEdgeLabelLayer.addChild(a.edgeLabelPlaceholderGfx),this.edgeKeyToEdgeObject.set(t,a),this.updateEdgeStyle(t,e,r,n,i,o)},e.prototype.dropNode=function(t){var e=this.nodeKeyToNodeObject.get(t);this.nodeLayer.removeChild(e.nodeGfx),this.nodeLabelLayer.removeChild(e.nodeLabelGfx),this.frontNodeLayer.removeChild(e.nodePlaceholderGfx),this.frontNodeLabelLayer.removeChild(e.nodeLabelPlaceholderGfx),this.nodeKeyToNodeObject.delete(t)},e.prototype.dropEdge=function(t){var e=this.edgeKeyToEdgeObject.get(t);this.edgeLayer.removeChild(e.edgeGfx),this.edgeLabelLayer.removeChild(e.edgeLabelGfx),this.frontEdgeLayer.removeChild(e.edgePlaceholderGfx),this.frontEdgeLabelLayer.removeChild(e.edgeLabelPlaceholderGfx),this.edgeKeyToEdgeObject.delete(t)},e.prototype.updateNodeStyleByKey=function(t){var e=this.graph.getNodeAttributes(t);this.updateNodeStyle(t,e)},e.prototype.updateNodeStyle=function(t,e){var r=this.nodeKeyToNodeObject.get(t),n=void 0;r.selected?n=this.selectStyle.node:r.hovered&&(n=this.hoverStyle.node);var i=Cv([sy.node,this.style.node,n],e);r.updateStyle(i,this.textureCache)},e.prototype.updateEdgeStyleByKey=function(t){var e=this.graph.getEdgeAttributes(t),r=this.graph.source(t),n=this.graph.target(t),i=this.graph.getNodeAttributes(r),o=this.graph.getNodeAttributes(n);this.updateEdgeStyle(t,e,r,n,i,o)},e.prototype.updateEdgeStyle=function(t,e,r,n,i,o){var s=r+"_"+n,a=this.parallelEdgeMap.get(s)||1,h=this.graph.getEdgeAttribute(t,"parallelSeq"),u=this.graph.isDirected(t),l=this.edgeKeyToEdgeObject.get(t),c=this.nodeKeyToNodeObject.get(r),d=this.nodeKeyToNodeObject.get(n),f={x:c.nodeGfx.position.x,y:c.nodeGfx.position.y},p={x:d.nodeGfx.position.x,y:d.nodeGfx.position.y},m=Cv([sy.node,this.style.node],o),g=Cv([sy.edge,this.style.edge,l.hovered?this.hoverStyle.edge:void 0],e);l.updatePosition(f,p,m,g,this.textureCache,u,r===n,a,h),l.updateStyle(g,this.textureCache,u,r===n,a,h)},e.prototype.updateGraphVisibility=function(){var t=this,e=new Is;e.addAll(this.viewport.children.map((function(t){return t.children})).flat()),e.cull(this.app.renderer.screen);var r=this.viewport.scale.x,n=[.1,.2,.4,1/0].findIndex((function(t){return r<=t}));console.log(r,n),this.graph.forEachNode((function(e){t.nodeKeyToNodeObject.get(e).updateVisibility(n)})),this.graph.forEachEdge((function(e,r,i,o){var s=i+"_"+o,a=t.parallelEdgeMap.get(s)||0,h=t.graph.getEdgeAttribute(e,"parallelSeq");t.edgeKeyToEdgeObject.get(e).updateVisibility(n,i===o,a,h)}))},e}(qs);t.PixiGraph=ay,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=pixi-graph.umd.min.js.map
